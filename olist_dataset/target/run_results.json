{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.2", "generated_at": "2025-03-26T22:12:35.591790Z", "invocation_id": "47091b40-06a7-4995-b45f-71c18ad1f347", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-26T22:11:42.525972Z", "completed_at": "2025-03-26T22:11:42.550862Z"}, {"name": "execute", "started_at": "2025-03-26T22:11:42.552211Z", "completed_at": "2025-03-26T22:11:47.354983Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.831935167312622, "adapter_response": {"_message": "CREATE TABLE (99.4k rows, 9.5 MiB processed)", "code": "CREATE TABLE", "rows_affected": 99441, "bytes_processed": 9978354, "bytes_billed": 10485760, "location": "US", "project_id": "olist-ecommerce-454812", "job_id": "8768c01b-e95d-429f-9837-226573936e8b", "slot_ms": 6028}, "message": "CREATE TABLE (99.4k rows, 9.5 MiB processed)", "failures": null, "unique_id": "model.olist_dataset.dim_customer", "compiled": true, "compiled_code": "-- models/star/dim_customer.sql\n\n-- \n\n-- WITH source AS (\n--     SELECT\n--         customer_id,\n--         customer_unique_id,\n--         customer_zip_code_prefix,\n--         customer_city,\n--         customer_state,\n--         CAST(last_updated AS TIMESTAMP) AS last_updated\n--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`\n-- )\n\n-- SELECT * FROM source\n\n-- \n\n-- models/star/dim_customer.sql\n\n\n\nSELECT\n    customer_id,\n    customer_unique_id,\n    customer_zip_code_prefix,\n    customer_city,\n    customer_state,\n    dbt_valid_from,\n    dbt_valid_to\nFROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`\nWHERE dbt_valid_to IS NULL", "relation_name": "`olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-26T22:11:47.367549Z", "completed_at": "2025-03-26T22:11:47.378241Z"}, {"name": "execute", "started_at": "2025-03-26T22:11:47.378962Z", "completed_at": "2025-03-26T22:12:13.653275Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 26.287802934646606, "adapter_response": {"_message": "MERGE (0.0 rows, 62.1 MiB processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 65107578, "bytes_billed": 66060288, "location": "US", "project_id": "olist-ecommerce-454812", "job_id": "d7fce3f9-a235-411f-962a-11cfb3c6c714", "slot_ms": 96072}, "message": "MERGE (0.0 rows, 62.1 MiB processed)", "failures": null, "unique_id": "model.olist_dataset.dim_geolocation", "compiled": true, "compiled_code": "-- models/star/dim_geolocation.sql\n\n\n\nWITH source AS (\n    SELECT\n        geolocation_zip_code_prefix,\n        geolocation_city,\n        geolocation_state,\n        CAST(last_updated AS TIMESTAMP) AS last_updated\n    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`\n)\n\nSELECT * FROM source\n\n\n  WHERE geolocation_zip_code_prefix NOT IN (\n      SELECT geolocation_zip_code_prefix FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`\n  )\n", "relation_name": "`olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-26T22:12:13.665661Z", "completed_at": "2025-03-26T22:12:13.676890Z"}, {"name": "execute", "started_at": "2025-03-26T22:12:13.677771Z", "completed_at": "2025-03-26T22:12:19.319078Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.656283617019653, "adapter_response": {"_message": "MERGE (0.0 rows, 7.2 MiB processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 7525908, "bytes_billed": 20971520, "location": "US", "project_id": "olist-ecommerce-454812", "job_id": "097f8add-3b82-4d3d-927f-6e6d98d0219d", "slot_ms": 22010}, "message": "MERGE (0.0 rows, 7.2 MiB processed)", "failures": null, "unique_id": "model.olist_dataset.dim_product", "compiled": true, "compiled_code": "-- models/star/dim_product.sql\n\n\n\nWITH source AS (\n    SELECT\n        product_id,\n        product_category_name,\n        product_name_lenght,\n        product_description_lenght,\n        product_photos_qty,\n        product_weight_g,\n        product_length_cm,\n        product_height_cm,\n        product_width_cm,\n        CAST(last_updated AS TIMESTAMP) AS last_updated\n    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`\n)\n\nSELECT *\nFROM source\n\n\n  WHERE product_id NOT IN (SELECT product_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`)\n", "relation_name": "`olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-26T22:12:19.328330Z", "completed_at": "2025-03-26T22:12:19.337436Z"}, {"name": "execute", "started_at": "2025-03-26T22:12:19.338614Z", "completed_at": "2025-03-26T22:12:23.535646Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.209814786911011, "adapter_response": {"_message": "MERGE (0.0 rows, 400.0 KiB processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 409580, "bytes_billed": 20971520, "location": "US", "project_id": "olist-ecommerce-454812", "job_id": "a70b6563-9248-4731-be5a-a9368f2fccab", "slot_ms": 28868}, "message": "MERGE (0.0 rows, 400.0 KiB processed)", "failures": null, "unique_id": "model.olist_dataset.dim_seller", "compiled": true, "compiled_code": "-- models/star/dim_seller.sql\n\n\n\nWITH source AS (\n    SELECT\n        seller_id,\n        seller_zip_code_prefix,\n        seller_city,\n        seller_state,\n        CAST(last_updated AS TIMESTAMP) AS last_updated\n    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`\n)\n\nSELECT * FROM source\n\n\n  WHERE seller_id NOT IN (SELECT seller_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`)\n", "relation_name": "`olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-26T22:12:23.553002Z", "completed_at": "2025-03-26T22:12:23.566267Z"}, {"name": "execute", "started_at": "2025-03-26T22:12:23.568398Z", "completed_at": "2025-03-26T22:12:30.034705Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.485589027404785, "adapter_response": {"_message": "MERGE (0.0 rows, 57.9 MiB processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 60733549, "bytes_billed": 60817408, "location": "US", "project_id": "olist-ecommerce-454812", "job_id": "20455dfc-5ac5-4039-8c92-fb137210996e", "slot_ms": 31412}, "message": "MERGE (0.0 rows, 57.9 MiB processed)", "failures": null, "unique_id": "model.olist_dataset.fact_order_items", "compiled": true, "compiled_code": "-- models/fact/fact_order_items.sql\n\n\n\nWITH orders AS (\n    SELECT\n        order_id,\n        customer_id,\n        order_status,\n        order_purchase_timestamp,\n        order_approved_at,\n        order_delivered_carrier_date,\n        order_delivered_customer_date,\n        order_estimated_delivery_date\n    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`\n),\n\norder_items AS (\n    SELECT\n        order_id,\n        order_item_id,\n        product_id,\n        seller_id,\n        price,\n        freight_value\n    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`\n),\n\njoined AS (\n    SELECT\n        o.customer_id,\n        oi.order_id,\n        oi.order_item_id,\n        oi.product_id,\n        oi.seller_id,\n        oi.price,\n        oi.freight_value,\n        o.order_purchase_timestamp,        \n        o.order_approved_at,\n        o.order_delivered_customer_date,\n        o.order_estimated_delivery_date,\n        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item\n    FROM order_items oi\n    LEFT JOIN orders o USING (order_id)\n)\n\nSELECT\n    customer_id,\n    order_id,\n    order_item_id,\n    product_id,\n    seller_id,\n    price,\n    freight_value,\n    order_approved_at,\n    order_purchase_timestamp,\n    order_delivered_customer_date,\n    order_estimated_delivery_date,\n    order_id_item\nFROM joined\n\n\n  WHERE order_id_item NOT IN (SELECT order_id_item FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`)\n", "relation_name": "`olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-26T22:12:30.055894Z", "completed_at": "2025-03-26T22:12:30.073331Z"}, {"name": "execute", "started_at": "2025-03-26T22:12:30.074639Z", "completed_at": "2025-03-26T22:12:35.575270Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.5238683223724365, "adapter_response": {"_message": "MERGE (0.0 rows, 39.6 MiB processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 41543592, "bytes_billed": 41943040, "location": "US", "project_id": "olist-ecommerce-454812", "job_id": "bbf2ad9c-d91d-4b4c-862f-248f8a21f5c5", "slot_ms": 39172}, "message": "MERGE (0.0 rows, 39.6 MiB processed)", "failures": null, "unique_id": "model.olist_dataset.fact_orders", "compiled": true, "compiled_code": "-- models/fact/fact_orders.sql\n\n\n\nWITH orders AS (\n    SELECT\n        order_id,\n        customer_id,\n        order_status,\n        order_purchase_timestamp,\n        order_approved_at,\n        order_delivered_carrier_date,\n        order_delivered_customer_date,\n        order_estimated_delivery_date\n    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`\n),\n\npayments AS (\n    SELECT\n        order_id,\n        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value\n    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`\n    GROUP BY order_id\n)\n\nSELECT\n    o.order_id,\n    o.customer_id,\n    o.order_status,\n    o.order_purchase_timestamp,\n    o.order_approved_at,\n    o.order_delivered_carrier_date,\n    o.order_delivered_customer_date,\n    o.order_estimated_delivery_date,\n    p.payment_value\nFROM orders o\nLEFT JOIN payments p USING (order_id)\n\n\n  WHERE order_id NOT IN (SELECT order_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`)\n", "relation_name": "`olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`", "batch_results": null}], "elapsed_time": 54.647865772247314, "args": {"macro_debugging": false, "use_colors": true, "partial_parse_file_diff": true, "invocation_command": "dbt run", "partial_parse": true, "print": true, "warn_error_options": {"include": [], "exclude": []}, "populate_cache": true, "indirect_selection": "eager", "exclude": [], "which": "run", "printer_width": 80, "log_path": "/home/kangh/dsai-module-2-project/olist_dataset/logs", "use_colors_file": true, "log_level": "info", "source_freshness_run_project_hooks": false, "static_parser": true, "state_modified_compare_more_unrendered_values": false, "version_check": true, "require_resource_names_without_spaces": false, "skip_nodes_if_on_run_start_fails": false, "state_modified_compare_vars": false, "require_nested_cumulative_type_params": false, "require_batched_execution_for_custom_microbatch_strategy": false, "require_explicit_package_overrides_for_builtin_materializations": true, "log_format_file": "debug", "require_yaml_configuration_for_mf_time_spines": false, "introspect": true, "project_dir": "/home/kangh/dsai-module-2-project/olist_dataset", "defer": false, "favor_state": false, "profiles_dir": "/home/kangh/.dbt", "quiet": false, "vars": {}, "select": [], "show_resource_report": false, "log_level_file": "debug", "send_anonymous_usage_stats": true, "strict_mode": false, "cache_selected_only": false, "log_file_max_bytes": 10485760, "log_format": "default", "write_json": true, "empty": false}}
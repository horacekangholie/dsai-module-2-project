[0m06:11:18.895796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb900fe5e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8ffff1420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8ffff13c0>]}


============================== 06:11:18.900272 | 35f8dadb-030f-46d5-8146-74a146514e7f ==============================
[0m06:11:18.900272 [info ] [MainThread]: Running with dbt=1.9.2
[0m06:11:18.901090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:11:18.932633 [info ] [MainThread]: dbt version: 1.9.2
[0m06:11:18.933303 [info ] [MainThread]: python version: 3.10.16
[0m06:11:18.934301 [info ] [MainThread]: python path: /home/kangh/miniconda3/envs/elt/bin/python3.10
[0m06:11:18.934763 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m06:11:22.951423 [info ] [MainThread]: Using profiles dir at /home/kangh/.dbt
[0m06:11:22.952146 [info ] [MainThread]: Using profiles.yml file at /home/kangh/.dbt/profiles.yml
[0m06:11:22.953245 [info ] [MainThread]: Using dbt_project.yml file at /home/kangh/dsai-module-2-project/olist_dataset/dbt_project.yml
[0m06:11:22.953848 [info ] [MainThread]: adapter type: bigquery
[0m06:11:22.954581 [info ] [MainThread]: adapter version: 1.9.1
[0m06:11:23.134139 [info ] [MainThread]: Configuration:
[0m06:11:23.134930 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m06:11:23.135876 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:11:23.136785 [info ] [MainThread]: Required dependencies:
[0m06:11:23.137506 [debug] [MainThread]: Executing "git --help"
[0m06:11:23.140083 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:11:23.140654 [debug] [MainThread]: STDERR: "b''"
[0m06:11:23.141044 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m06:11:23.141501 [info ] [MainThread]: Connection:
[0m06:11:23.142043 [info ] [MainThread]:   method: oauth
[0m06:11:23.142608 [info ] [MainThread]:   database: olist-ecommerce-454812
[0m06:11:23.143104 [info ] [MainThread]:   execution_project: olist-ecommerce-454812
[0m06:11:23.143615 [info ] [MainThread]:   schema: olist_data_ingestion
[0m06:11:23.144101 [info ] [MainThread]:   location: US
[0m06:11:23.144625 [info ] [MainThread]:   priority: interactive
[0m06:11:23.145073 [info ] [MainThread]:   maximum_bytes_billed: None
[0m06:11:23.145558 [info ] [MainThread]:   impersonate_service_account: None
[0m06:11:23.146032 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m06:11:23.146494 [info ] [MainThread]:   job_retries: 1
[0m06:11:23.147054 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m06:11:23.147527 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m06:11:23.148101 [info ] [MainThread]:   timeout_seconds: 300
[0m06:11:23.148742 [info ] [MainThread]:   client_id: None
[0m06:11:23.149474 [info ] [MainThread]:   token_uri: None
[0m06:11:23.150404 [info ] [MainThread]:   dataproc_region: None
[0m06:11:23.150923 [info ] [MainThread]:   dataproc_cluster_name: None
[0m06:11:23.151382 [info ] [MainThread]:   gcs_bucket: None
[0m06:11:23.152178 [info ] [MainThread]:   dataproc_batch: None
[0m06:11:23.153141 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m06:11:23.339106 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m06:11:23.339735 [debug] [MainThread]: On debug: select 1 as id
[0m06:11:23.340190 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:11:26.826616 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:6a65aab3-58d4-47f6-9931-e501f2771739&page=queryresults
[0m06:11:27.843328 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m06:11:27.844282 [info ] [MainThread]: [32mAll checks passed![0m
[0m06:11:27.845349 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 9.034808, "process_in_blocks": "258152", "process_kernel_time": 1.788187, "process_mem_max_rss": "247380", "process_out_blocks": "16", "process_user_time": 4.480187}
[0m06:11:27.846091 [debug] [MainThread]: Command `dbt debug` succeeded at 06:11:27.845908 after 9.04 seconds
[0m06:11:27.846621 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m06:11:27.847220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb900fe5e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8d2200bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8d1f4db70>]}
[0m06:11:27.847942 [debug] [MainThread]: Flushing usage events
[0m06:11:29.172472 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:11:36.667793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307e5f5d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307d7953f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307d795390>]}


============================== 06:11:36.671459 | 47091b40-06a7-4995-b45f-71c18ad1f347 ==============================
[0m06:11:36.671459 [info ] [MainThread]: Running with dbt=1.9.2
[0m06:11:36.672548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:11:38.168710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47091b40-06a7-4995-b45f-71c18ad1f347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307d77cc40>]}
[0m06:11:38.299967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47091b40-06a7-4995-b45f-71c18ad1f347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f304f9094b0>]}
[0m06:11:38.300994 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m06:11:38.466521 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m06:11:38.467436 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:11:38.468022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '47091b40-06a7-4995-b45f-71c18ad1f347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f304f83f040>]}
[0m06:11:40.772835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47091b40-06a7-4995-b45f-71c18ad1f347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f304f094130>]}
[0m06:11:40.908040 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m06:11:40.912671 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m06:11:40.933763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47091b40-06a7-4995-b45f-71c18ad1f347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f304f10f1f0>]}
[0m06:11:40.934827 [info ] [MainThread]: Found 6 models, 1 snapshot, 9 sources, 491 macros
[0m06:11:40.935549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47091b40-06a7-4995-b45f-71c18ad1f347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307e8bcd30>]}
[0m06:11:40.939550 [info ] [MainThread]: 
[0m06:11:40.940356 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:11:40.940895 [info ] [MainThread]: 
[0m06:11:40.941813 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:11:40.948066 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m06:11:40.948661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:11:42.448248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:11:42.859395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m06:11:42.860728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:11:43.369580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m06:11:43.372248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:11:42.071164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m06:11:42.072223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:11:42.515784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47091b40-06a7-4995-b45f-71c18ad1f347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307f91dd20>]}
[0m06:11:42.516865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:11:42.522170 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m06:11:42.523188 [info ] [Thread-1 (]: 1 of 6 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m06:11:42.524328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now model.olist_dataset.dim_customer)
[0m06:11:42.525327 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m06:11:42.542472 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m06:11:42.551308 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m06:11:42.571964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:11:43.065712 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m06:11:43.072590 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 

-- models/star/dim_customer.sql



SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m06:11:43.745990 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:8768c01b-e95d-429f-9837-226573936e8b&page=queryresults
[0m06:11:47.360171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47091b40-06a7-4995-b45f-71c18ad1f347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f304faa9270>]}
[0m06:11:47.361801 [info ] [Thread-1 (]: 1 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_customer . [[32mCREATE TABLE (99.4k rows, 9.5 MiB processed)[0m in 4.83s]
[0m06:11:47.363347 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m06:11:47.364605 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m06:11:47.365732 [info ] [Thread-1 (]: 2 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m06:11:47.366570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_customer, now model.olist_dataset.dim_geolocation)
[0m06:11:47.367162 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m06:11:47.377397 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m06:11:47.378440 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m06:11:47.427273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:11:47.951547 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m06:11:47.952788 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation` as DBT_INTERNAL_DEST
        using (-- models/star/dim_geolocation.sql



WITH source AS (
    SELECT
        geolocation_zip_code_prefix,
        geolocation_city,
        geolocation_state,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source


  WHERE geolocation_zip_code_prefix NOT IN (
      SELECT geolocation_zip_code_prefix FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
  )

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.geolocation_zip_code_prefix = DBT_INTERNAL_DEST.geolocation_zip_code_prefix))

    
    when matched then update set
        `geolocation_zip_code_prefix` = DBT_INTERNAL_SOURCE.`geolocation_zip_code_prefix`,`geolocation_city` = DBT_INTERNAL_SOURCE.`geolocation_city`,`geolocation_state` = DBT_INTERNAL_SOURCE.`geolocation_state`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)
    values
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)


    
[0m06:11:48.690184 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d7fce3f9-a235-411f-962a-11cfb3c6c714&page=queryresults
[0m06:12:13.654560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47091b40-06a7-4995-b45f-71c18ad1f347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f304ef57790>]}
[0m06:12:13.656542 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[32mMERGE (0.0 rows, 62.1 MiB processed)[0m in 26.29s]
[0m06:12:13.659132 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m06:12:13.661108 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m06:12:13.662181 [info ] [Thread-1 (]: 3 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_product . [RUN]
[0m06:12:13.663889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_geolocation, now model.olist_dataset.dim_product)
[0m06:12:13.664909 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m06:12:13.675821 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m06:12:13.677169 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m06:12:13.683847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:12:14.090755 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m06:12:14.092380 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product` as DBT_INTERNAL_DEST
        using (-- models/star/dim_product.sql



WITH source AS (
    SELECT
        product_id,
        product_category_name,
        product_name_lenght,
        product_description_lenght,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
)

SELECT *
FROM source


  WHERE product_id NOT IN (SELECT product_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`)

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id))

    
    when matched then update set
        `product_id` = DBT_INTERNAL_SOURCE.`product_id`,`product_category_name` = DBT_INTERNAL_SOURCE.`product_category_name`,`product_name_lenght` = DBT_INTERNAL_SOURCE.`product_name_lenght`,`product_description_lenght` = DBT_INTERNAL_SOURCE.`product_description_lenght`,`product_photos_qty` = DBT_INTERNAL_SOURCE.`product_photos_qty`,`product_weight_g` = DBT_INTERNAL_SOURCE.`product_weight_g`,`product_length_cm` = DBT_INTERNAL_SOURCE.`product_length_cm`,`product_height_cm` = DBT_INTERNAL_SOURCE.`product_height_cm`,`product_width_cm` = DBT_INTERNAL_SOURCE.`product_width_cm`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`product_id`, `product_category_name`, `product_name_lenght`, `product_description_lenght`, `product_photos_qty`, `product_weight_g`, `product_length_cm`, `product_height_cm`, `product_width_cm`, `last_updated`)
    values
        (`product_id`, `product_category_name`, `product_name_lenght`, `product_description_lenght`, `product_photos_qty`, `product_weight_g`, `product_length_cm`, `product_height_cm`, `product_width_cm`, `last_updated`)


    
[0m06:12:14.865540 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:097f8add-3b82-4d3d-927f-6e6d98d0219d&page=queryresults
[0m06:12:19.320144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47091b40-06a7-4995-b45f-71c18ad1f347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f304faa9270>]}
[0m06:12:19.321650 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model olist_data_ingestion_dim_tables.dim_product  [[32mMERGE (0.0 rows, 7.2 MiB processed)[0m in 5.66s]
[0m06:12:19.323007 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m06:12:19.324161 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_seller
[0m06:12:19.325286 [info ] [Thread-1 (]: 4 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_seller .. [RUN]
[0m06:12:19.326825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_product, now model.olist_dataset.dim_seller)
[0m06:12:19.327711 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_seller
[0m06:12:19.335571 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_seller"
[0m06:12:19.337769 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_seller
[0m06:12:19.345509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:12:19.870863 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_seller"
[0m06:12:19.872285 [debug] [Thread-1 (]: On model.olist_dataset.dim_seller: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_seller"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller` as DBT_INTERNAL_DEST
        using (-- models/star/dim_seller.sql



WITH source AS (
    SELECT
        seller_id,
        seller_zip_code_prefix,
        seller_city,
        seller_state,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`
)

SELECT * FROM source


  WHERE seller_id NOT IN (SELECT seller_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`)

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.seller_id = DBT_INTERNAL_DEST.seller_id))

    
    when matched then update set
        `seller_id` = DBT_INTERNAL_SOURCE.`seller_id`,`seller_zip_code_prefix` = DBT_INTERNAL_SOURCE.`seller_zip_code_prefix`,`seller_city` = DBT_INTERNAL_SOURCE.`seller_city`,`seller_state` = DBT_INTERNAL_SOURCE.`seller_state`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`seller_id`, `seller_zip_code_prefix`, `seller_city`, `seller_state`, `last_updated`)
    values
        (`seller_id`, `seller_zip_code_prefix`, `seller_city`, `seller_state`, `last_updated`)


    
[0m06:12:20.646715 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:a70b6563-9248-4731-be5a-a9368f2fccab&page=queryresults
[0m06:12:23.536626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47091b40-06a7-4995-b45f-71c18ad1f347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f304f29e440>]}
[0m06:12:23.538414 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model olist_data_ingestion_dim_tables.dim_seller  [[32mMERGE (0.0 rows, 400.0 KiB processed)[0m in 4.21s]
[0m06:12:23.543511 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_seller
[0m06:12:23.546718 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m06:12:23.548504 [info ] [Thread-1 (]: 5 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m06:12:23.550849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_seller, now model.olist_dataset.fact_order_items)
[0m06:12:23.552239 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m06:12:23.562076 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m06:12:23.566957 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m06:12:23.573872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:12:24.164812 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m06:12:24.170264 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,        
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    LEFT JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_approved_at,
    order_purchase_timestamp,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined


  WHERE order_id_item NOT IN (SELECT order_id_item FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`)

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id_item = DBT_INTERNAL_DEST.order_id_item))

    
    when matched then update set
        `customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_id` = DBT_INTERNAL_SOURCE.`order_id`,`order_item_id` = DBT_INTERNAL_SOURCE.`order_item_id`,`product_id` = DBT_INTERNAL_SOURCE.`product_id`,`seller_id` = DBT_INTERNAL_SOURCE.`seller_id`,`price` = DBT_INTERNAL_SOURCE.`price`,`freight_value` = DBT_INTERNAL_SOURCE.`freight_value`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`order_id_item` = DBT_INTERNAL_SOURCE.`order_id_item`
    

    when not matched then insert
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_approved_at`, `order_purchase_timestamp`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)
    values
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_approved_at`, `order_purchase_timestamp`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)


    
[0m06:12:24.877007 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:20455dfc-5ac5-4039-8c92-fb137210996e&page=queryresults
[0m06:12:30.036087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47091b40-06a7-4995-b45f-71c18ad1f347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f304c900b20>]}
[0m06:12:30.038009 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mMERGE (0.0 rows, 57.9 MiB processed)[0m in 6.49s]
[0m06:12:30.047219 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m06:12:30.049116 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m06:12:30.051079 [info ] [Thread-1 (]: 6 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m06:12:30.052718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.fact_order_items, now model.olist_dataset.fact_orders)
[0m06:12:30.053901 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m06:12:30.072070 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m06:12:30.073835 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m06:12:30.080360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:12:30.590574 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m06:12:30.593094 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)


  WHERE order_id NOT IN (SELECT order_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`)

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        `order_id` = DBT_INTERNAL_SOURCE.`order_id`,`customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_status` = DBT_INTERNAL_SOURCE.`order_status`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_carrier_date` = DBT_INTERNAL_SOURCE.`order_delivered_carrier_date`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`payment_value` = DBT_INTERNAL_SOURCE.`payment_value`
    

    when not matched then insert
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)
    values
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)


    
[0m06:12:31.339221 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:bbf2ad9c-d91d-4b4c-862f-248f8a21f5c5&page=queryresults
[0m06:12:35.576603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47091b40-06a7-4995-b45f-71c18ad1f347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f304c900b20>]}
[0m06:12:35.578341 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mMERGE (0.0 rows, 39.6 MiB processed)[0m in 5.52s]
[0m06:12:35.581141 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m06:12:35.585960 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:12:35.587822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:12:35.588643 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m06:12:35.589609 [info ] [MainThread]: 
[0m06:12:35.590848 [info ] [MainThread]: Finished running 5 incremental models, 1 table model in 0 hours 0 minutes and 54.65 seconds (54.65s).
[0m06:12:35.596352 [debug] [MainThread]: Command end result
[0m06:12:35.649187 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m06:12:35.653597 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m06:12:35.669204 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m06:12:35.670748 [info ] [MainThread]: 
[0m06:12:35.672501 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:12:35.673634 [info ] [MainThread]: 
[0m06:12:35.675309 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:12:35.677111 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 62.64114, "process_in_blocks": "2768", "process_kernel_time": 1.376968, "process_mem_max_rss": "270920", "process_out_blocks": "3312", "process_user_time": 6.788391}
[0m06:12:35.678114 [debug] [MainThread]: Command `dbt run` succeeded at 06:12:35.677899 after 62.64 seconds
[0m06:12:35.679584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307e5f5d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307d77cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f304f30d840>]}
[0m06:12:35.680538 [debug] [MainThread]: Flushing usage events
[0m06:12:37.347535 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:41:04.725560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7140059f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7131810f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa713181090>]}


============================== 16:41:04.732189 | 161ab46c-0bf3-4268-a5f8-8fef06a055d5 ==============================
[0m16:41:04.732189 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:41:04.732876 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/kangh/.dbt', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:41:06.726859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '161ab46c-0bf3-4268-a5f8-8fef06a055d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e52f1120>]}
[0m16:41:06.805632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '161ab46c-0bf3-4268-a5f8-8fef06a055d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e54adfc0>]}
[0m16:41:06.806502 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m16:41:06.945825 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:41:07.238156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:41:07.238742 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:41:07.291737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '161ab46c-0bf3-4268-a5f8-8fef06a055d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e4e04640>]}
[0m16:41:07.389986 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m16:41:07.393341 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m16:41:07.421257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '161ab46c-0bf3-4268-a5f8-8fef06a055d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e505a050>]}
[0m16:41:07.421978 [info ] [MainThread]: Found 6 models, 1 snapshot, 9 sources, 491 macros
[0m16:41:07.422386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '161ab46c-0bf3-4268-a5f8-8fef06a055d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e5058bb0>]}
[0m16:41:07.424479 [info ] [MainThread]: 
[0m16:41:07.424893 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:41:07.425193 [info ] [MainThread]: 
[0m16:41:07.425710 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:41:07.431551 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m16:41:07.432477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:07.878953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:08.256571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now create_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m16:41:08.257597 [debug] [ThreadPool]: Creating schema "database: "olist-ecommerce-454812"
schema: "olist_data_ingestion_dim_tables"
"
[0m16:41:08.276361 [debug] [ThreadPool]: On create_olist-ecommerce-454812_olist_data_ingestion_dim_tables: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "connection_name": "create_olist-ecommerce-454812_olist_data_ingestion_dim_tables"} */
create schema if not exists `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`
  
[0m16:41:08.276997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:08.971251 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:f9c4e364-e536-4041-bae4-cba071d5f55a&page=queryresults
[0m16:41:09.997800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now create_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m16:41:09.999368 [debug] [ThreadPool]: Creating schema "database: "olist-ecommerce-454812"
schema: "olist_data_ingestion_fact_tables"
"
[0m16:41:10.003245 [debug] [ThreadPool]: On create_olist-ecommerce-454812_olist_data_ingestion_fact_tables: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "connection_name": "create_olist-ecommerce-454812_olist_data_ingestion_fact_tables"} */
create schema if not exists `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`
  
[0m16:41:10.003953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:10.479858 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:fba576b3-272b-4d5e-a545-4b0720a65606&page=queryresults
[0m16:41:13.356591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m16:41:13.357971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:13.842793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m16:41:13.843535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:14.283062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m16:41:14.283792 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:14.983714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '161ab46c-0bf3-4268-a5f8-8fef06a055d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e4df7700>]}
[0m16:41:14.985075 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:41:14.991835 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m16:41:14.992725 [info ] [Thread-1 (]: 1 of 6 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m16:41:14.993512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now model.olist_dataset.dim_customer)
[0m16:41:14.993954 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m16:41:15.006446 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m16:41:15.007426 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m16:41:15.038018 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m16:41:15.038876 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 

-- models/star/dim_customer.sql



SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m16:41:15.039346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:15.517023 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:725d1113-a1a4-4989-9c19-ee07de18a5c4&page=queryresults
[0m16:41:15.518609 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:725d1113-a1a4-4989-9c19-ee07de18a5c4&page=queryresults
[0m16:41:15.543954 [debug] [Thread-1 (]: Database Error in model dim_customer (models/star/dim_customer.sql)
  Not found: Dataset olist-ecommerce-454812:olist_data_snapshots was not found in location US
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql
[0m16:41:15.552676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '161ab46c-0bf3-4268-a5f8-8fef06a055d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7142dd8d0>]}
[0m16:41:15.554916 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model olist_data_ingestion_dim_tables.dim_customer  [[31mERROR[0m in 0.55s]
[0m16:41:15.557115 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m16:41:15.558323 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m16:41:15.560848 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_customer' to be skipped because of status 'error'.  Reason: Database Error in model dim_customer (models/star/dim_customer.sql)
  Not found: Dataset olist-ecommerce-454812:olist_data_snapshots was not found in location US
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql.
[0m16:41:15.559406 [info ] [Thread-1 (]: 2 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m16:41:15.566554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_customer, now model.olist_dataset.dim_geolocation)
[0m16:41:15.567769 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m16:41:15.577310 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m16:41:15.578030 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m16:41:15.626474 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m16:41:15.627538 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_geolocation.sql



WITH source AS (
    SELECT
        geolocation_zip_code_prefix,
        geolocation_city,
        geolocation_state,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source


    );
  
[0m16:41:15.628229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:16.489160 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:7052380c-2dec-4453-8b77-19990c243d63&page=queryresults
[0m16:41:19.954020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '161ab46c-0bf3-4268-a5f8-8fef06a055d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e40c0340>]}
[0m16:41:19.954839 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[32mCREATE TABLE (1.0m rows, 31.0 MiB processed)[0m in 4.39s]
[0m16:41:19.955434 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m16:41:19.955799 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m16:41:19.956210 [info ] [Thread-1 (]: 3 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_product . [RUN]
[0m16:41:19.956671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_geolocation, now model.olist_dataset.dim_product)
[0m16:41:19.956998 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m16:41:19.960755 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m16:41:19.961993 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m16:41:19.966536 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m16:41:19.967329 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_product.sql



WITH source AS (
    SELECT
        product_id,
        product_category_name,
        product_name_lenght,
        product_description_lenght,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
)

SELECT *
FROM source


    );
  
[0m16:41:19.967795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:20.797063 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:ef001610-1b39-4cc8-b45f-f9953fe56217&page=queryresults
[0m16:41:23.511495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '161ab46c-0bf3-4268-a5f8-8fef06a055d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa713325510>]}
[0m16:41:23.512641 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model olist_data_ingestion_dim_tables.dim_product  [[32mCREATE TABLE (33.0k rows, 3.6 MiB processed)[0m in 3.55s]
[0m16:41:23.513408 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m16:41:23.513906 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_seller
[0m16:41:23.514490 [info ] [Thread-1 (]: 4 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_seller .. [RUN]
[0m16:41:23.515126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_product, now model.olist_dataset.dim_seller)
[0m16:41:23.515553 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_seller
[0m16:41:23.523568 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_seller"
[0m16:41:23.524552 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_seller
[0m16:41:23.528816 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_seller"
[0m16:41:23.529674 [debug] [Thread-1 (]: On model.olist_dataset.dim_seller: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_seller"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_seller.sql



WITH source AS (
    SELECT
        seller_id,
        seller_zip_code_prefix,
        seller_city,
        seller_state,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`
)

SELECT * FROM source


    );
  
[0m16:41:23.530224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:24.146088 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:7c05cb80-6be7-4eab-a766-5f48f9ba9a86&page=queryresults
[0m16:41:26.669373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '161ab46c-0bf3-4268-a5f8-8fef06a055d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e4e2de10>]}
[0m16:41:26.670735 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model olist_data_ingestion_dim_tables.dim_seller  [[32mCREATE TABLE (3.1k rows, 200.0 KiB processed)[0m in 3.15s]
[0m16:41:26.671792 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_seller
[0m16:41:26.672738 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m16:41:26.673915 [info ] [Thread-1 (]: 5 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m16:41:26.674857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_seller, now model.olist_dataset.fact_order_items)
[0m16:41:26.675497 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m16:41:26.683629 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m16:41:26.684679 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m16:41:26.690229 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m16:41:26.691353 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
      
    
    

    OPTIONS()
    as (
      -- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,        
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    LEFT JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_approved_at,
    order_purchase_timestamp,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined


    );
  
[0m16:41:26.692157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:27.512175 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:bcd54ec3-920d-49c5-b24d-e4c5364c098b&page=queryresults
[0m16:41:32.968226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '161ab46c-0bf3-4268-a5f8-8fef06a055d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e4e2de10>]}
[0m16:41:32.970252 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mCREATE TABLE (112.7k rows, 27.9 MiB processed)[0m in 6.29s]
[0m16:41:32.971551 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m16:41:32.972788 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m16:41:32.973839 [info ] [Thread-1 (]: 6 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m16:41:32.975296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.fact_order_items, now model.olist_dataset.fact_orders)
[0m16:41:32.976054 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m16:41:32.990462 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m16:41:32.991490 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m16:41:32.998309 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m16:41:32.999315 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
      
    
    

    OPTIONS()
    as (
      -- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)


    );
  
[0m16:41:32.999984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:34.065466 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:5c084bc7-f4ad-46d2-a982-a35848fbd42b&page=queryresults
[0m16:41:38.472755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '161ab46c-0bf3-4268-a5f8-8fef06a055d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa713325510>]}
[0m16:41:38.473889 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mCREATE TABLE (99.4k rows, 21.5 MiB processed)[0m in 5.50s]
[0m16:41:38.475000 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m16:41:38.477870 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:41:38.478810 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:38.480160 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m16:41:38.481069 [info ] [MainThread]: 
[0m16:41:38.481518 [info ] [MainThread]: Finished running 5 incremental models, 1 table model in 0 hours 0 minutes and 31.06 seconds (31.06s).
[0m16:41:38.483188 [debug] [MainThread]: Command end result
[0m16:41:38.513802 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m16:41:38.516365 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m16:41:38.524552 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m16:41:38.525002 [info ] [MainThread]: 
[0m16:41:38.525444 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:41:38.525794 [info ] [MainThread]: 
[0m16:41:38.526546 [error] [MainThread]:   Database Error in model dim_customer (models/star/dim_customer.sql)
  Not found: Dataset olist-ecommerce-454812:olist_data_snapshots was not found in location US
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql
[0m16:41:38.526988 [info ] [MainThread]: 
[0m16:41:38.527355 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m16:41:38.528056 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 35.46116, "process_in_blocks": "130424", "process_kernel_time": 1.329313, "process_mem_max_rss": "256216", "process_out_blocks": "2296", "process_user_time": 3.929293}
[0m16:41:38.528579 [debug] [MainThread]: Command `dbt run` failed at 16:41:38.528457 after 35.46 seconds
[0m16:41:38.529112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7140059f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e52f1120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa713ed5480>]}
[0m16:41:38.529576 [debug] [MainThread]: Flushing usage events
[0m16:41:39.849659 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:57:04.919216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff378079990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff377221090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff377221030>]}


============================== 16:57:04.925670 | 5175901b-2155-4782-aaac-b7fea5b5e191 ==============================
[0m16:57:04.925670 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:57:04.926314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'version_check': 'True', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m16:57:07.008691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5175901b-2155-4782-aaac-b7fea5b5e191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff349395180>]}
[0m16:57:07.082689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5175901b-2155-4782-aaac-b7fea5b5e191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff377232f20>]}
[0m16:57:07.083593 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m16:57:07.206171 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:57:07.483451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:57:07.483969 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:57:07.533477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5175901b-2155-4782-aaac-b7fea5b5e191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff348eb8670>]}
[0m16:57:07.620380 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m16:57:07.623876 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m16:57:07.651169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5175901b-2155-4782-aaac-b7fea5b5e191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff348ee5570>]}
[0m16:57:07.651802 [info ] [MainThread]: Found 6 models, 1 snapshot, 9 sources, 491 macros
[0m16:57:07.652207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5175901b-2155-4782-aaac-b7fea5b5e191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff349995930>]}
[0m16:57:07.654186 [info ] [MainThread]: 
[0m16:57:07.654586 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:57:07.654827 [info ] [MainThread]: 
[0m16:57:07.655313 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:57:07.656663 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m16:57:07.657250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:08.112909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now create_olist-ecommerce-454812_olist_data_snapshots)
[0m16:57:08.113645 [debug] [ThreadPool]: Creating schema "database: "olist-ecommerce-454812"
schema: "olist_data_snapshots"
"
[0m16:57:08.126808 [debug] [ThreadPool]: On create_olist-ecommerce-454812_olist_data_snapshots: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "connection_name": "create_olist-ecommerce-454812_olist_data_snapshots"} */
create schema if not exists `olist-ecommerce-454812`.`olist_data_snapshots`
  
[0m16:57:08.127372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:08.812068 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:3124c3f5-e9bd-4b00-b9c6-0bb0c5e01146&page=queryresults
[0m16:57:09.866452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m16:57:09.867578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:10.316408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m16:57:10.318139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:10.922558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m16:57:10.923238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:11.566733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5175901b-2155-4782-aaac-b7fea5b5e191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3793c1cc0>]}
[0m16:57:11.568097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:57:11.576455 [debug] [Thread-1 (]: Began running node snapshot.olist_dataset.customer_snapshot
[0m16:57:11.578088 [info ] [Thread-1 (]: 1 of 1 START snapshot olist_data_snapshots.customer_snapshot ................... [RUN]
[0m16:57:11.579093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now snapshot.olist_dataset.customer_snapshot)
[0m16:57:11.579704 [debug] [Thread-1 (]: Began compiling node snapshot.olist_dataset.customer_snapshot
[0m16:57:11.590541 [debug] [Thread-1 (]: Began executing node snapshot.olist_dataset.customer_snapshot
[0m16:57:11.661962 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        
    

    select *,
        to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id,
        last_updated as dbt_updated_at,
        last_updated as dbt_valid_from,
        
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
from (
        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`

    ) sbq



    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m16:57:11.662674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:12.413498 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:01147514-3f84-4b77-927e-e62cea712aa0&page=queryresults
[0m16:57:12.852272 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m16:57:13.515508 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d165a51d-f5c1-4755-94a0-11f8620b206f&page=queryresults
[0m16:57:13.874084 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.olist_dataset.customer_snapshot"
[0m16:57:13.877333 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.customer_snapshot"} */

      
  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
      
    
    

    OPTIONS()
    as (
      
    

    select *,
        to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id,
        last_updated as dbt_updated_at,
        last_updated as dbt_valid_from,
        
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
from (
        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`

    ) sbq



    );
  
  
[0m16:57:14.728311 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:97272e07-4271-4899-a859-eeb53e4cec0f&page=queryresults
[0m16:57:16.747585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5175901b-2155-4782-aaac-b7fea5b5e191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3773c5870>]}
[0m16:57:16.748581 [info ] [Thread-1 (]: 1 of 1 OK snapshotted olist_data_snapshots.customer_snapshot ................... [[32mCREATE TABLE (99.4k rows, 9.5 MiB processed)[0m in 5.16s]
[0m16:57:16.749241 [debug] [Thread-1 (]: Finished running node snapshot.olist_dataset.customer_snapshot
[0m16:57:16.751143 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:57:16.751769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:16.752065 [debug] [MainThread]: Connection 'snapshot.olist_dataset.customer_snapshot' was properly closed.
[0m16:57:16.752430 [info ] [MainThread]: 
[0m16:57:16.752725 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 9.10 seconds (9.10s).
[0m16:57:16.753279 [debug] [MainThread]: Command end result
[0m16:57:16.773176 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m16:57:16.775132 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m16:57:16.780908 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m16:57:16.781213 [info ] [MainThread]: 
[0m16:57:16.781599 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:57:16.781870 [info ] [MainThread]: 
[0m16:57:16.782143 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:57:16.782684 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 13.745313, "process_in_blocks": "122312", "process_kernel_time": 1.382174, "process_mem_max_rss": "261364", "process_out_blocks": "2136", "process_user_time": 3.621873}
[0m16:57:16.783072 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:57:16.782979 after 13.75 seconds
[0m16:57:16.783432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff378079990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff377232f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37814cdf0>]}
[0m16:57:16.783744 [debug] [MainThread]: Flushing usage events
[0m16:57:17.745359 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:57:19.355268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f624a325990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6249479090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6249479030>]}


============================== 16:57:19.357881 | a3f76c90-22d1-4e05-a28d-69ed0b9c085e ==============================
[0m16:57:19.357881 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:57:19.358347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'profiles_dir': '/home/kangh/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:57:20.429260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3f76c90-22d1-4e05-a28d-69ed0b9c085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f624b5b92d0>]}
[0m16:57:20.502922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3f76c90-22d1-4e05-a28d-69ed0b9c085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62494b2f20>]}
[0m16:57:20.503836 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m16:57:20.615916 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:57:20.818319 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:57:20.818846 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:57:20.868355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3f76c90-22d1-4e05-a28d-69ed0b9c085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f621b1386a0>]}
[0m16:57:20.953190 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m16:57:20.955127 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m16:57:20.966593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3f76c90-22d1-4e05-a28d-69ed0b9c085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f621b3938b0>]}
[0m16:57:20.967169 [info ] [MainThread]: Found 6 models, 1 snapshot, 9 sources, 491 macros
[0m16:57:20.967522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3f76c90-22d1-4e05-a28d-69ed0b9c085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f621b391120>]}
[0m16:57:20.969329 [info ] [MainThread]: 
[0m16:57:20.969690 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:57:20.969947 [info ] [MainThread]: 
[0m16:57:20.970411 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:57:20.975165 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m16:57:20.975872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:21.393447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:21.806190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now create_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m16:57:21.807175 [debug] [ThreadPool]: Creating schema "database: "olist-ecommerce-454812"
schema: "olist_data_ingestion_fact_tables"
"
[0m16:57:21.819333 [debug] [ThreadPool]: On create_olist-ecommerce-454812_olist_data_ingestion_fact_tables: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "connection_name": "create_olist-ecommerce-454812_olist_data_ingestion_fact_tables"} */
create schema if not exists `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`
  
[0m16:57:21.819869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:22.272739 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:08c5c856-6bee-41b8-8055-4be6fa45d0bb&page=queryresults
[0m16:57:23.270894 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now create_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m16:57:23.271884 [debug] [ThreadPool]: Creating schema "database: "olist-ecommerce-454812"
schema: "olist_data_ingestion_dim_tables"
"
[0m16:57:23.274783 [debug] [ThreadPool]: On create_olist-ecommerce-454812_olist_data_ingestion_dim_tables: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "connection_name": "create_olist-ecommerce-454812_olist_data_ingestion_dim_tables"} */
create schema if not exists `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`
  
[0m16:57:23.275303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:23.948254 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:a91dfd51-ce34-47a3-9f37-8338a2a9ad61&page=queryresults
[0m16:57:24.916775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m16:57:24.918516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:25.429922 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m16:57:25.431038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:25.935701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m16:57:25.936573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:26.353359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3f76c90-22d1-4e05-a28d-69ed0b9c085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f621b699a50>]}
[0m16:57:26.354406 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:57:26.357840 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m16:57:26.358433 [info ] [Thread-1 (]: 1 of 6 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m16:57:26.358910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now model.olist_dataset.dim_customer)
[0m16:57:26.359217 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m16:57:26.369750 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m16:57:26.370333 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m16:57:26.398674 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m16:57:26.399613 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 

-- models/star/dim_customer.sql



SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m16:57:26.400070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:27.233992 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:a00eadb2-44b9-4fed-86dc-db5652aec6c4&page=queryresults
[0m16:57:30.741147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3f76c90-22d1-4e05-a28d-69ed0b9c085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6249649870>]}
[0m16:57:30.742067 [info ] [Thread-1 (]: 1 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_customer . [[32mCREATE TABLE (99.4k rows, 9.5 MiB processed)[0m in 4.38s]
[0m16:57:30.742691 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m16:57:30.743117 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m16:57:30.743545 [info ] [Thread-1 (]: 2 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m16:57:30.744020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_customer, now model.olist_dataset.dim_geolocation)
[0m16:57:30.744368 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m16:57:30.748205 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m16:57:30.749072 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m16:57:30.786811 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m16:57:30.787787 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_geolocation.sql



WITH source AS (
    SELECT
        geolocation_zip_code_prefix,
        geolocation_city,
        geolocation_state,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source


    );
  
[0m16:57:30.788284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:31.596062 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:b02bd954-9ebe-44c9-9a91-df5ccf2941ad&page=queryresults
[0m16:57:35.320854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3f76c90-22d1-4e05-a28d-69ed0b9c085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f621b173250>]}
[0m16:57:35.322402 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[32mCREATE TABLE (1.0m rows, 31.0 MiB processed)[0m in 4.58s]
[0m16:57:35.323634 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m16:57:35.324432 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m16:57:35.325443 [info ] [Thread-1 (]: 3 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_product . [RUN]
[0m16:57:35.326865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_geolocation, now model.olist_dataset.dim_product)
[0m16:57:35.327952 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m16:57:35.335239 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m16:57:35.336458 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m16:57:35.346733 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m16:57:35.348357 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_product.sql



WITH source AS (
    SELECT
        product_id,
        product_category_name,
        product_name_lenght,
        product_description_lenght,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
)

SELECT *
FROM source


    );
  
[0m16:57:35.349239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:36.048446 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:11142cc5-833a-4aa8-ac38-e2d6f20b6e75&page=queryresults
[0m16:57:38.888082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3f76c90-22d1-4e05-a28d-69ed0b9c085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6249649870>]}
[0m16:57:38.889618 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model olist_data_ingestion_dim_tables.dim_product  [[32mCREATE TABLE (33.0k rows, 3.6 MiB processed)[0m in 3.56s]
[0m16:57:38.890949 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m16:57:38.891888 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_seller
[0m16:57:38.893827 [info ] [Thread-1 (]: 4 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_seller .. [RUN]
[0m16:57:38.895828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_product, now model.olist_dataset.dim_seller)
[0m16:57:38.896723 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_seller
[0m16:57:38.904935 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_seller"
[0m16:57:38.906119 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_seller
[0m16:57:38.912078 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_seller"
[0m16:57:38.915106 [debug] [Thread-1 (]: On model.olist_dataset.dim_seller: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_seller"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_seller.sql



WITH source AS (
    SELECT
        seller_id,
        seller_zip_code_prefix,
        seller_city,
        seller_state,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`
)

SELECT * FROM source


    );
  
[0m16:57:38.916919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:39.722189 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:7b38f961-dd3a-499a-8ad3-ebe791fd5204&page=queryresults
[0m16:57:42.324023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3f76c90-22d1-4e05-a28d-69ed0b9c085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6218af0730>]}
[0m16:57:42.325161 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model olist_data_ingestion_dim_tables.dim_seller  [[32mCREATE TABLE (3.1k rows, 200.0 KiB processed)[0m in 3.43s]
[0m16:57:42.326057 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_seller
[0m16:57:42.326598 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m16:57:42.327193 [info ] [Thread-1 (]: 5 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m16:57:42.327816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_seller, now model.olist_dataset.fact_order_items)
[0m16:57:42.328617 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m16:57:42.333795 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m16:57:42.334558 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m16:57:42.338467 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m16:57:42.339387 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
      
    
    

    OPTIONS()
    as (
      -- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,        
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    LEFT JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_approved_at,
    order_purchase_timestamp,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined


    );
  
[0m16:57:42.339960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:43.085091 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:f70d15b8-5c40-4281-86cd-ef5e4c713327&page=queryresults
[0m16:57:46.075019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3f76c90-22d1-4e05-a28d-69ed0b9c085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f621a4b71c0>]}
[0m16:57:46.076368 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mCREATE TABLE (112.7k rows, 27.9 MiB processed)[0m in 3.75s]
[0m16:57:46.077345 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m16:57:46.077995 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m16:57:46.078661 [info ] [Thread-1 (]: 6 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m16:57:46.079670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.fact_order_items, now model.olist_dataset.fact_orders)
[0m16:57:46.080209 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m16:57:46.085714 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m16:57:46.086364 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m16:57:46.093383 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m16:57:46.094852 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
      
    
    

    OPTIONS()
    as (
      -- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)


    );
  
[0m16:57:46.095337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:46.908093 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:a6ee84fe-c41c-4dc1-b249-e041d1a4f677&page=queryresults
[0m16:57:51.014987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3f76c90-22d1-4e05-a28d-69ed0b9c085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f624a5fe7d0>]}
[0m16:57:51.015993 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mCREATE TABLE (99.4k rows, 21.5 MiB processed)[0m in 4.94s]
[0m16:57:51.016685 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m16:57:51.019370 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:57:51.020789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:51.021258 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m16:57:51.021810 [info ] [MainThread]: 
[0m16:57:51.022250 [info ] [MainThread]: Finished running 5 incremental models, 1 table model in 0 hours 0 minutes and 30.05 seconds (30.05s).
[0m16:57:51.023800 [debug] [MainThread]: Command end result
[0m16:57:51.048669 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m16:57:51.050482 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m16:57:51.056754 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m16:57:51.057179 [info ] [MainThread]: 
[0m16:57:51.057493 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:57:51.057758 [info ] [MainThread]: 
[0m16:57:51.058027 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:57:51.058547 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 33.63869, "process_in_blocks": "8", "process_kernel_time": 1.18813, "process_mem_max_rss": "260456", "process_out_blocks": "2328", "process_user_time": 3.441806}
[0m16:57:51.058940 [debug] [MainThread]: Command `dbt run` succeeded at 16:57:51.058844 after 33.64 seconds
[0m16:57:51.059274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f624a325990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f621b1653c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f624a1fa380>]}
[0m16:57:51.059601 [debug] [MainThread]: Flushing usage events
[0m16:57:52.288599 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:06:04.069593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca10cc5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0fe65090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0fe65030>]}


============================== 08:06:04.074508 | a786ebb1-060a-414d-9fe4-0e3e825a0fd3 ==============================
[0m08:06:04.074508 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:06:04.074998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'debug': 'False', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:06:05.850844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a786ebb1-060a-414d-9fe4-0e3e825a0fd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9e1fd5180>]}
[0m08:06:05.922987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a786ebb1-060a-414d-9fe4-0e3e825a0fd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0fe76f20>]}
[0m08:06:05.923806 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m08:06:06.041549 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:06:06.305005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:06:06.305974 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_customer.sql
[0m08:06:06.615548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a786ebb1-060a-414d-9fe4-0e3e825a0fd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9e18fc100>]}
[0m08:06:06.696877 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m08:06:06.700187 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m08:06:06.727728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a786ebb1-060a-414d-9fe4-0e3e825a0fd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9e1fd52d0>]}
[0m08:06:06.728341 [info ] [MainThread]: Found 6 models, 1 snapshot, 9 sources, 491 macros
[0m08:06:06.728742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a786ebb1-060a-414d-9fe4-0e3e825a0fd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9e2664d00>]}
[0m08:06:06.730556 [info ] [MainThread]: 
[0m08:06:06.730949 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:06:06.731232 [info ] [MainThread]: 
[0m08:06:06.731714 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:06:06.733021 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m08:06:06.733774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:06:07.114629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now create_olist-ecommerce-454812_olist_data_snapshots)
[0m08:06:07.115977 [debug] [ThreadPool]: Creating schema "database: "olist-ecommerce-454812"
schema: "olist_data_snapshots"
"
[0m08:06:07.124759 [debug] [ThreadPool]: On create_olist-ecommerce-454812_olist_data_snapshots: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "connection_name": "create_olist-ecommerce-454812_olist_data_snapshots"} */
create schema if not exists `olist-ecommerce-454812`.`olist_data_snapshots`
  
[0m08:06:07.125135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:06:07.824180 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:8bb7c603-37a8-433c-bd7c-9fcd782c3149&page=queryresults
[0m08:06:08.804478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m08:06:08.805947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:06:09.235501 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m08:06:09.236845 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:06:09.961155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m08:06:09.962470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:06:10.773328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a786ebb1-060a-414d-9fe4-0e3e825a0fd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca11fe9cc0>]}
[0m08:06:10.774427 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:06:10.781594 [debug] [Thread-1 (]: Began running node snapshot.olist_dataset.customer_snapshot
[0m08:06:10.782598 [info ] [Thread-1 (]: 1 of 1 START snapshot olist_data_snapshots.customer_snapshot ................... [RUN]
[0m08:06:10.783481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now snapshot.olist_dataset.customer_snapshot)
[0m08:06:10.784106 [debug] [Thread-1 (]: Began compiling node snapshot.olist_dataset.customer_snapshot
[0m08:06:10.797440 [debug] [Thread-1 (]: Began executing node snapshot.olist_dataset.customer_snapshot
[0m08:06:10.860271 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        
    

    select *,
        to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id,
        last_updated as dbt_updated_at,
        last_updated as dbt_valid_from,
        
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
from (
        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`

    ) sbq



    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m08:06:10.860918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:06:11.286241 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:6881be76-c857-4d2d-bfd9-59aaa56f0ea7&page=queryresults
[0m08:06:11.288034 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:6881be76-c857-4d2d-bfd9-59aaa56f0ea7&page=queryresults
[0m08:06:11.315120 [debug] [Thread-1 (]: Database Error in snapshot customer_snapshot (snapshots/customer_snapshot.sql)
  Not found: Dataset olist-ecommerce-454812:olist_data_staging was not found in location US
[0m08:06:11.319709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a786ebb1-060a-414d-9fe4-0e3e825a0fd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9e18d94b0>]}
[0m08:06:11.321548 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting olist_data_snapshots.customer_snapshot ............... [[31mERROR[0m in 0.53s]
[0m08:06:11.322643 [debug] [Thread-1 (]: Finished running node snapshot.olist_dataset.customer_snapshot
[0m08:06:11.323973 [debug] [Thread-4 (]: Marking all children of 'snapshot.olist_dataset.customer_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot customer_snapshot (snapshots/customer_snapshot.sql)
  Not found: Dataset olist-ecommerce-454812:olist_data_staging was not found in location US.
[0m08:06:11.328632 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:06:11.329943 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:06:11.330553 [debug] [MainThread]: Connection 'snapshot.olist_dataset.customer_snapshot' was properly closed.
[0m08:06:11.331055 [info ] [MainThread]: 
[0m08:06:11.331569 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.60 seconds (4.60s).
[0m08:06:11.332499 [debug] [MainThread]: Command end result
[0m08:06:11.354625 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m08:06:11.356303 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m08:06:11.363137 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m08:06:11.363455 [info ] [MainThread]: 
[0m08:06:11.363807 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:06:11.364091 [info ] [MainThread]: 
[0m08:06:11.364400 [error] [MainThread]:   Database Error in snapshot customer_snapshot (snapshots/customer_snapshot.sql)
  Not found: Dataset olist-ecommerce-454812:olist_data_staging was not found in location US
[0m08:06:11.364653 [info ] [MainThread]: 
[0m08:06:11.364918 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:06:11.365399 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 7.3598094, "process_in_blocks": "123216", "process_kernel_time": 1.44985, "process_mem_max_rss": "264548", "process_out_blocks": "3152", "process_user_time": 3.644219}
[0m08:06:11.365774 [debug] [MainThread]: Command `dbt snapshot` failed at 08:06:11.365682 after 7.36 seconds
[0m08:06:11.366119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca10cc5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9e2035f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca10b98df0>]}
[0m08:06:11.366439 [debug] [MainThread]: Flushing usage events
[0m08:06:12.378299 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:06:14.045023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde8e119c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde7f65060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde7f65000>]}


============================== 08:06:14.047441 | 29da9e2c-a2c0-48a9-a1da-50bb02769d0c ==============================
[0m08:06:14.047441 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:06:14.047870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:06:15.026980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29da9e2c-a2c0-48a9-a1da-50bb02769d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdba162350>]}
[0m08:06:15.096478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29da9e2c-a2c0-48a9-a1da-50bb02769d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde7fa2f50>]}
[0m08:06:15.097219 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m08:06:15.200967 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:06:15.393164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:06:15.393582 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:06:15.438780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29da9e2c-a2c0-48a9-a1da-50bb02769d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdb9c3fdc0>]}
[0m08:06:15.517010 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m08:06:15.519349 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m08:06:15.529781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29da9e2c-a2c0-48a9-a1da-50bb02769d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdba1267d0>]}
[0m08:06:15.530361 [info ] [MainThread]: Found 6 models, 1 snapshot, 9 sources, 491 macros
[0m08:06:15.530721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29da9e2c-a2c0-48a9-a1da-50bb02769d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdba1245b0>]}
[0m08:06:15.532425 [info ] [MainThread]: 
[0m08:06:15.532778 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:06:15.533052 [info ] [MainThread]: 
[0m08:06:15.533533 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:06:15.538076 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m08:06:15.538556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:06:16.062338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:06:16.405162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now create_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m08:06:16.406301 [debug] [ThreadPool]: Creating schema "database: "olist-ecommerce-454812"
schema: "olist_data_ingestion_fact_tables"
"
[0m08:06:16.427169 [debug] [ThreadPool]: On create_olist-ecommerce-454812_olist_data_ingestion_fact_tables: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "connection_name": "create_olist-ecommerce-454812_olist_data_ingestion_fact_tables"} */
create schema if not exists `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`
  
[0m08:06:16.427748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:06:16.942683 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:a1008dd4-8ee0-4caa-b509-4d43ebff58cd&page=queryresults
[0m08:06:17.879711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now create_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m08:06:17.881467 [debug] [ThreadPool]: Creating schema "database: "olist-ecommerce-454812"
schema: "olist_data_ingestion_dim_tables"
"
[0m08:06:17.886990 [debug] [ThreadPool]: On create_olist-ecommerce-454812_olist_data_ingestion_dim_tables: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "connection_name": "create_olist-ecommerce-454812_olist_data_ingestion_dim_tables"} */
create schema if not exists `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`
  
[0m08:06:17.888033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:06:18.370176 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:eca1278b-40fc-4f39-8102-fe12713b7669&page=queryresults
[0m08:06:19.277063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m08:06:19.278785 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:06:19.710004 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m08:06:19.711226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:06:20.212803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m08:06:20.214067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:06:20.747271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29da9e2c-a2c0-48a9-a1da-50bb02769d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdea12dd20>]}
[0m08:06:20.748397 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:06:20.760027 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m08:06:20.761056 [info ] [Thread-1 (]: 1 of 6 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m08:06:20.761878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now model.olist_dataset.dim_customer)
[0m08:06:20.762469 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m08:06:20.779597 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m08:06:20.780872 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m08:06:20.808824 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m08:06:20.809538 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 



SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    valid_from,
    valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE valid_to IS NULL
    );
  
[0m08:06:20.809992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:06:21.456964 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:8b3c1b64-bf6b-4de8-9b3e-e313553168d6&page=queryresults
[0m08:06:21.458176 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:8b3c1b64-bf6b-4de8-9b3e-e313553168d6&page=queryresults
[0m08:06:21.463286 [debug] [Thread-1 (]: Database Error in model dim_customer (models/star/dim_customer.sql)
  Not found: Table olist-ecommerce-454812:olist_data_snapshots.customer_snapshot was not found in location US
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql
[0m08:06:21.466743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29da9e2c-a2c0-48a9-a1da-50bb02769d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde90eac80>]}
[0m08:06:21.468145 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model olist_data_ingestion_dim_tables.dim_customer  [[31mERROR[0m in 0.70s]
[0m08:06:21.469294 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m08:06:21.470058 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m08:06:21.470915 [info ] [Thread-1 (]: 2 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m08:06:21.471811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_customer, now model.olist_dataset.dim_geolocation)
[0m08:06:21.472493 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m08:06:21.478522 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_customer' to be skipped because of status 'error'.  Reason: Database Error in model dim_customer (models/star/dim_customer.sql)
  Not found: Table olist-ecommerce-454812:olist_data_snapshots.customer_snapshot was not found in location US
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql.
[0m08:06:21.478061 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m08:06:21.480374 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m08:06:21.516755 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m08:06:21.517506 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_geolocation.sql



WITH source AS (
    SELECT
        geolocation_zip_code_prefix,
        geolocation_city,
        geolocation_state,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source


    );
  
[0m08:06:21.517924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:06:21.970346 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:b932a421-b14a-4bc6-a225-d81833ec6339&page=queryresults
[0m08:06:21.971558 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:b932a421-b14a-4bc6-a225-d81833ec6339&page=queryresults
[0m08:06:21.974178 [debug] [Thread-1 (]: Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  Not found: Dataset olist-ecommerce-454812:olist_data_staging was not found in location US
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql
[0m08:06:21.975185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29da9e2c-a2c0-48a9-a1da-50bb02769d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdb867a890>]}
[0m08:06:21.976381 [error] [Thread-1 (]: 2 of 6 ERROR creating sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[31mERROR[0m in 0.50s]
[0m08:06:21.977386 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m08:06:21.978080 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m08:06:21.978906 [info ] [Thread-1 (]: 3 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_product . [RUN]
[0m08:06:21.979735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_geolocation, now model.olist_dataset.dim_product)
[0m08:06:21.980424 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m08:06:21.986568 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_geolocation' to be skipped because of status 'error'.  Reason: Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  Not found: Dataset olist-ecommerce-454812:olist_data_staging was not found in location US
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql.
[0m08:06:21.987589 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m08:06:21.991016 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m08:06:21.994965 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m08:06:21.995579 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_product.sql



WITH source AS (
    SELECT
        product_id,
        product_category_name,
        product_name_lenght,
        product_description_lenght,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
)

SELECT *
FROM source


    );
  
[0m08:06:21.995978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:06:22.508182 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:77e9ab6e-5df8-42a3-993b-fc221419548a&page=queryresults
[0m08:06:22.509360 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:77e9ab6e-5df8-42a3-993b-fc221419548a&page=queryresults
[0m08:06:22.512166 [debug] [Thread-1 (]: Database Error in model dim_product (models/star/dim_product.sql)
  Not found: Dataset olist-ecommerce-454812:olist_data_staging was not found in location US
  compiled code at target/run/olist_dataset/models/star/dim_product.sql
[0m08:06:22.513405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29da9e2c-a2c0-48a9-a1da-50bb02769d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdb8689750>]}
[0m08:06:22.514769 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model olist_data_ingestion_dim_tables.dim_product  [[31mERROR[0m in 0.53s]
[0m08:06:22.515882 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m08:06:22.516705 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_seller
[0m08:06:22.517779 [info ] [Thread-1 (]: 4 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_seller .. [RUN]
[0m08:06:22.518926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_product, now model.olist_dataset.dim_seller)
[0m08:06:22.519688 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_seller
[0m08:06:22.526299 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_product' to be skipped because of status 'error'.  Reason: Database Error in model dim_product (models/star/dim_product.sql)
  Not found: Dataset olist-ecommerce-454812:olist_data_staging was not found in location US
  compiled code at target/run/olist_dataset/models/star/dim_product.sql.
[0m08:06:22.530330 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_seller"
[0m08:06:22.531681 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_seller
[0m08:06:22.535486 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_seller"
[0m08:06:22.537106 [debug] [Thread-1 (]: On model.olist_dataset.dim_seller: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_seller"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_seller.sql



WITH source AS (
    SELECT
        seller_id,
        seller_zip_code_prefix,
        seller_city,
        seller_state,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`
)

SELECT * FROM source


    );
  
[0m08:06:22.537517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:06:21.862732 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:8c182322-d1f0-42f8-8b0a-55ec180c9649&page=queryresults
[0m08:06:21.863815 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:8c182322-d1f0-42f8-8b0a-55ec180c9649&page=queryresults
[0m08:06:21.866347 [debug] [Thread-1 (]: Database Error in model dim_seller (models/star/dim_seller.sql)
  Not found: Dataset olist-ecommerce-454812:olist_data_staging was not found in location US
  compiled code at target/run/olist_dataset/models/star/dim_seller.sql
[0m08:06:21.867349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29da9e2c-a2c0-48a9-a1da-50bb02769d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdb9c63e20>]}
[0m08:06:21.868572 [error] [Thread-1 (]: 4 of 6 ERROR creating sql incremental model olist_data_ingestion_dim_tables.dim_seller  [[31mERROR[0m in -0.65s]
[0m08:06:21.869665 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_seller
[0m08:06:21.870400 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m08:06:21.871336 [info ] [Thread-1 (]: 5 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m08:06:21.872261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_seller, now model.olist_dataset.fact_order_items)
[0m08:06:21.873027 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m08:06:21.879641 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_seller' to be skipped because of status 'error'.  Reason: Database Error in model dim_seller (models/star/dim_seller.sql)
  Not found: Dataset olist-ecommerce-454812:olist_data_staging was not found in location US
  compiled code at target/run/olist_dataset/models/star/dim_seller.sql.
[0m08:06:21.881959 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m08:06:21.883388 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m08:06:21.887114 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m08:06:21.887699 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
      
    
    

    OPTIONS()
    as (
      -- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,        
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    LEFT JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_approved_at,
    order_purchase_timestamp,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined


    );
  
[0m08:06:21.888101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:06:22.337962 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:5000f66e-f6de-4553-b696-4db5efe1fd5d&page=queryresults
[0m08:06:22.339275 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:5000f66e-f6de-4553-b696-4db5efe1fd5d&page=queryresults
[0m08:06:22.342040 [debug] [Thread-1 (]: Database Error in model fact_order_items (models/fact/fact_order_items.sql)
  Not found: Dataset olist-ecommerce-454812:olist_data_staging was not found in location US
  compiled code at target/run/olist_dataset/models/fact/fact_order_items.sql
[0m08:06:22.343035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29da9e2c-a2c0-48a9-a1da-50bb02769d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdb86818d0>]}
[0m08:06:22.344282 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[31mERROR[0m in 0.47s]
[0m08:06:22.345336 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m08:06:22.346056 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m08:06:22.346893 [info ] [Thread-1 (]: 6 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m08:06:22.347717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.fact_order_items, now model.olist_dataset.fact_orders)
[0m08:06:22.348400 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m08:06:22.354958 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.fact_order_items' to be skipped because of status 'error'.  Reason: Database Error in model fact_order_items (models/fact/fact_order_items.sql)
  Not found: Dataset olist-ecommerce-454812:olist_data_staging was not found in location US
  compiled code at target/run/olist_dataset/models/fact/fact_order_items.sql.
[0m08:06:22.356114 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m08:06:22.357515 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m08:06:22.361150 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m08:06:22.361728 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
      
    
    

    OPTIONS()
    as (
      -- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)


    );
  
[0m08:06:22.362116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:06:22.754134 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:703aeea2-7f81-4d7e-8fea-365474e9dc4a&page=queryresults
[0m08:06:22.755493 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:703aeea2-7f81-4d7e-8fea-365474e9dc4a&page=queryresults
[0m08:06:22.758315 [debug] [Thread-1 (]: Database Error in model fact_orders (models/fact/fact_orders.sql)
  Not found: Dataset olist-ecommerce-454812:olist_data_staging was not found in location US
  compiled code at target/run/olist_dataset/models/fact/fact_orders.sql
[0m08:06:22.759446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29da9e2c-a2c0-48a9-a1da-50bb02769d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde84d64d0>]}
[0m08:06:22.760637 [error] [Thread-1 (]: 6 of 6 ERROR creating sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[31mERROR[0m in 0.41s]
[0m08:06:22.761664 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m08:06:22.763157 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_orders (models/fact/fact_orders.sql)
  Not found: Dataset olist-ecommerce-454812:olist_data_staging was not found in location US
  compiled code at target/run/olist_dataset/models/fact/fact_orders.sql.
[0m08:06:22.766762 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:06:22.768139 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:06:22.768786 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m08:06:22.769495 [info ] [MainThread]: 
[0m08:06:22.770138 [info ] [MainThread]: Finished running 5 incremental models, 1 table model in 0 hours 0 minutes and 7.24 seconds (7.24s).
[0m08:06:22.772380 [debug] [MainThread]: Command end result
[0m08:06:22.793486 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m08:06:22.794869 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m08:06:22.800337 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m08:06:22.800673 [info ] [MainThread]: 
[0m08:06:22.801011 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m08:06:22.801278 [info ] [MainThread]: 
[0m08:06:22.801587 [error] [MainThread]:   Database Error in model dim_customer (models/star/dim_customer.sql)
  Not found: Table olist-ecommerce-454812:olist_data_snapshots.customer_snapshot was not found in location US
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql
[0m08:06:22.801830 [info ] [MainThread]: 
[0m08:06:22.802111 [error] [MainThread]:   Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  Not found: Dataset olist-ecommerce-454812:olist_data_staging was not found in location US
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql
[0m08:06:22.802350 [info ] [MainThread]: 
[0m08:06:22.802646 [error] [MainThread]:   Database Error in model dim_product (models/star/dim_product.sql)
  Not found: Dataset olist-ecommerce-454812:olist_data_staging was not found in location US
  compiled code at target/run/olist_dataset/models/star/dim_product.sql
[0m08:06:22.802880 [info ] [MainThread]: 
[0m08:06:22.803148 [error] [MainThread]:   Database Error in model dim_seller (models/star/dim_seller.sql)
  Not found: Dataset olist-ecommerce-454812:olist_data_staging was not found in location US
  compiled code at target/run/olist_dataset/models/star/dim_seller.sql
[0m08:06:22.803371 [info ] [MainThread]: 
[0m08:06:22.803635 [error] [MainThread]:   Database Error in model fact_order_items (models/fact/fact_order_items.sql)
  Not found: Dataset olist-ecommerce-454812:olist_data_staging was not found in location US
  compiled code at target/run/olist_dataset/models/fact/fact_order_items.sql
[0m08:06:22.803871 [info ] [MainThread]: 
[0m08:06:22.804136 [error] [MainThread]:   Database Error in model fact_orders (models/fact/fact_orders.sql)
  Not found: Dataset olist-ecommerce-454812:olist_data_staging was not found in location US
  compiled code at target/run/olist_dataset/models/fact/fact_orders.sql
[0m08:06:22.804356 [info ] [MainThread]: 
[0m08:06:22.804623 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m08:06:22.805066 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.924645, "process_in_blocks": "24", "process_kernel_time": 1.214721, "process_mem_max_rss": "262352", "process_out_blocks": "2280", "process_user_time": 3.352631}
[0m08:06:22.805433 [debug] [MainThread]: Command `dbt run` failed at 08:06:22.805349 after 9.93 seconds
[0m08:06:22.805742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde8e119c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdb868a080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efde8ce36a0>]}
[0m08:06:22.806053 [debug] [MainThread]: Flushing usage events
[0m08:06:24.017065 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:12:03.997392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ec489990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88eb62d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88eb62d030>]}


============================== 08:12:04.002820 | 6d747163-202a-404e-85e7-12648f667824 ==============================
[0m08:12:04.002820 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:12:04.003408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m08:12:05.899367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d747163-202a-404e-85e7-12648f667824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bd7cb100>]}
[0m08:12:05.979938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d747163-202a-404e-85e7-12648f667824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ebcbc490>]}
[0m08:12:05.980768 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m08:12:06.099467 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:12:06.379815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:12:06.380337 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:12:06.427958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d747163-202a-404e-85e7-12648f667824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bd2f45b0>]}
[0m08:12:06.508697 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m08:12:06.512536 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m08:12:06.539054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d747163-202a-404e-85e7-12648f667824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bd283940>]}
[0m08:12:06.539683 [info ] [MainThread]: Found 6 models, 1 snapshot, 9 sources, 491 macros
[0m08:12:06.540063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d747163-202a-404e-85e7-12648f667824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bdb88370>]}
[0m08:12:06.541661 [info ] [MainThread]: 
[0m08:12:06.542070 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:12:06.542338 [info ] [MainThread]: 
[0m08:12:06.542803 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:12:06.544178 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m08:12:06.545333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:12:07.022070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m08:12:07.023485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:07.508284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m08:12:07.509510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:08.051933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m08:12:08.052965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:08.468439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d747163-202a-404e-85e7-12648f667824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bd7caa70>]}
[0m08:12:08.469549 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:12:08.476703 [debug] [Thread-1 (]: Began running node snapshot.olist_dataset.customer_snapshot
[0m08:12:08.478143 [info ] [Thread-1 (]: 1 of 1 START snapshot olist_data_snapshots.customer_snapshot ................... [RUN]
[0m08:12:08.479182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now snapshot.olist_dataset.customer_snapshot)
[0m08:12:08.479912 [debug] [Thread-1 (]: Began compiling node snapshot.olist_dataset.customer_snapshot
[0m08:12:08.494577 [debug] [Thread-1 (]: Began executing node snapshot.olist_dataset.customer_snapshot
[0m08:12:08.557326 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        
    

    select *,
        to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id,
        last_updated as dbt_updated_at,
        last_updated as dbt_valid_from,
        
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
from (
        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`

    ) sbq



    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m08:12:08.557956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:09.336055 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:3508539a-f16d-4ae6-b042-2747bd5af832&page=queryresults
[0m08:12:09.708501 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m08:12:10.367493 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:77de9e5a-0d4e-46fe-9978-49799fbfb58c&page=queryresults
[0m08:12:10.732249 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.olist_dataset.customer_snapshot"
[0m08:12:10.738881 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.customer_snapshot"} */

      
  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
      
    
    

    OPTIONS()
    as (
      
    

    select *,
        to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id,
        last_updated as dbt_updated_at,
        last_updated as dbt_valid_from,
        
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
from (
        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`

    ) sbq



    );
  
  
[0m08:12:11.341544 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:bff65073-eff7-4d0e-b85a-2f342af47b67&page=queryresults
[0m08:12:15.163211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d747163-202a-404e-85e7-12648f667824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88eb5d1870>]}
[0m08:12:15.164161 [info ] [Thread-1 (]: 1 of 1 OK snapshotted olist_data_snapshots.customer_snapshot ................... [[32mCREATE TABLE (99.4k rows, 9.5 MiB processed)[0m in 6.68s]
[0m08:12:15.164722 [debug] [Thread-1 (]: Finished running node snapshot.olist_dataset.customer_snapshot
[0m08:12:15.166803 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:12:15.167811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:12:15.168173 [debug] [MainThread]: Connection 'snapshot.olist_dataset.customer_snapshot' was properly closed.
[0m08:12:15.168472 [info ] [MainThread]: 
[0m08:12:15.168783 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 8.63 seconds (8.63s).
[0m08:12:15.169378 [debug] [MainThread]: Command end result
[0m08:12:15.190803 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m08:12:15.192445 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m08:12:15.197867 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m08:12:15.198171 [info ] [MainThread]: 
[0m08:12:15.198513 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:12:15.198765 [info ] [MainThread]: 
[0m08:12:15.199029 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:12:15.199483 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 11.2728405, "process_in_blocks": "122360", "process_kernel_time": 1.31067, "process_mem_max_rss": "253256", "process_out_blocks": "2128", "process_user_time": 3.669876}
[0m08:12:15.199843 [debug] [MainThread]: Command `dbt snapshot` succeeded at 08:12:15.199753 after 11.27 seconds
[0m08:12:15.200151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ec489990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ebcbc490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bd738610>]}
[0m08:12:15.200468 [debug] [MainThread]: Flushing usage events
[0m08:12:16.185173 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:12:17.722555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fb4399c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fa619060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fa619000>]}


============================== 08:12:17.724917 | bfa5fe35-51a5-45cf-9c94-9b7dc31cc90a ==============================
[0m08:12:17.724917 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:12:17.725374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'profiles_dir': '/home/kangh/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:12:18.792907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfa5fe35-51a5-45cf-9c94-9b7dc31cc90a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51cc7b6b90>]}
[0m08:12:18.863932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfa5fe35-51a5-45cf-9c94-9b7dc31cc90a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fac6d990>]}
[0m08:12:18.864774 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m08:12:18.969116 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:12:19.159657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:12:19.160101 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:12:19.205766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfa5fe35-51a5-45cf-9c94-9b7dc31cc90a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51cc2a06a0>]}
[0m08:12:19.287843 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m08:12:19.289585 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m08:12:19.299916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfa5fe35-51a5-45cf-9c94-9b7dc31cc90a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51cc2fc8e0>]}
[0m08:12:19.300443 [info ] [MainThread]: Found 6 models, 1 snapshot, 9 sources, 491 macros
[0m08:12:19.300828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfa5fe35-51a5-45cf-9c94-9b7dc31cc90a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51cc2ff2b0>]}
[0m08:12:19.302532 [info ] [MainThread]: 
[0m08:12:19.302913 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:12:19.303191 [info ] [MainThread]: 
[0m08:12:19.303704 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:12:19.308298 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m08:12:19.309111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:12:19.713380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:20.119418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m08:12:20.121622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:20.469338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m08:12:20.470693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:20.919610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m08:12:20.920819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:21.336998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfa5fe35-51a5-45cf-9c94-9b7dc31cc90a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fc75dd20>]}
[0m08:12:21.338015 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:12:21.343145 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m08:12:21.344600 [info ] [Thread-1 (]: 1 of 6 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m08:12:21.345655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now model.olist_dataset.dim_customer)
[0m08:12:21.346343 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m08:12:21.367330 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m08:12:21.368088 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m08:12:21.400677 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m08:12:21.401526 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 



SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    valid_from,
    valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE valid_to IS NULL
    );
  
[0m08:12:21.402012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:22.046966 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:0bb60292-841f-4ed3-a5f5-8708e2770e1c&page=queryresults
[0m08:12:22.329681 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:0bb60292-841f-4ed3-a5f5-8708e2770e1c&page=queryresults
[0m08:12:22.362615 [debug] [Thread-1 (]: Database Error in model dim_customer (models/star/dim_customer.sql)
  Unrecognized name: valid_to at [43:7]
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql
[0m08:12:22.366848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfa5fe35-51a5-45cf-9c94-9b7dc31cc90a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fba429b0>]}
[0m08:12:22.368379 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model olist_data_ingestion_dim_tables.dim_customer  [[31mERROR[0m in 1.02s]
[0m08:12:22.369306 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m08:12:22.369905 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m08:12:22.370746 [info ] [Thread-1 (]: 2 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m08:12:22.371412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_customer, now model.olist_dataset.dim_geolocation)
[0m08:12:22.371853 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m08:12:22.375640 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m08:12:22.376128 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_customer' to be skipped because of status 'error'.  Reason: Database Error in model dim_customer (models/star/dim_customer.sql)
  Unrecognized name: valid_to at [43:7]
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql.
[0m08:12:22.377991 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m08:12:22.412670 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m08:12:22.413473 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_geolocation.sql



WITH source AS (
    SELECT
        geolocation_zip_code_prefix,
        geolocation_city,
        geolocation_state,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source


    );
  
[0m08:12:22.413915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:23.053332 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:1772fe85-f9fa-41ec-b723-48b4aaa63ddc&page=queryresults
[0m08:12:26.559291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfa5fe35-51a5-45cf-9c94-9b7dc31cc90a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fb716c80>]}
[0m08:12:26.560030 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[32mCREATE TABLE (1.0m rows, 31.0 MiB processed)[0m in 4.19s]
[0m08:12:26.560582 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m08:12:26.560939 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m08:12:26.561333 [info ] [Thread-1 (]: 3 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_product . [RUN]
[0m08:12:26.561751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_geolocation, now model.olist_dataset.dim_product)
[0m08:12:26.562048 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m08:12:26.565230 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m08:12:26.565922 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m08:12:26.568862 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m08:12:26.569383 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_product.sql



WITH source AS (
    SELECT
        product_id,
        product_category_name,
        product_name_lenght,
        product_description_lenght,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
)

SELECT *
FROM source


    );
  
[0m08:12:26.569756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:27.206738 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:9f0762ee-18d1-4df6-ab0e-e15049d244fe&page=queryresults
[0m08:12:29.785101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfa5fe35-51a5-45cf-9c94-9b7dc31cc90a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fa5be5c0>]}
[0m08:12:29.786514 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model olist_data_ingestion_dim_tables.dim_product  [[32mCREATE TABLE (33.0k rows, 3.6 MiB processed)[0m in 3.22s]
[0m08:12:29.787689 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m08:12:29.788431 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_seller
[0m08:12:29.789285 [info ] [Thread-1 (]: 4 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_seller .. [RUN]
[0m08:12:29.790192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_product, now model.olist_dataset.dim_seller)
[0m08:12:29.790918 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_seller
[0m08:12:29.797302 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_seller"
[0m08:12:29.798087 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_seller
[0m08:12:29.801966 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_seller"
[0m08:12:29.802522 [debug] [Thread-1 (]: On model.olist_dataset.dim_seller: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_seller"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_seller.sql



WITH source AS (
    SELECT
        seller_id,
        seller_zip_code_prefix,
        seller_city,
        seller_state,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`
)

SELECT * FROM source


    );
  
[0m08:12:29.802945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:30.427372 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:431dc9c6-9c0e-4cb7-a0ff-0cabc8f7b599&page=queryresults
[0m08:12:32.991337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfa5fe35-51a5-45cf-9c94-9b7dc31cc90a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fa5be5c0>]}
[0m08:12:32.993099 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model olist_data_ingestion_dim_tables.dim_seller  [[32mCREATE TABLE (3.1k rows, 200.0 KiB processed)[0m in 3.20s]
[0m08:12:32.994299 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_seller
[0m08:12:32.995239 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m08:12:32.996761 [info ] [Thread-1 (]: 5 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m08:12:32.998125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_seller, now model.olist_dataset.fact_order_items)
[0m08:12:32.998867 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m08:12:33.009307 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m08:12:33.011577 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m08:12:33.020434 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m08:12:33.022362 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
      
    
    

    OPTIONS()
    as (
      -- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,        
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    LEFT JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_approved_at,
    order_purchase_timestamp,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined


    );
  
[0m08:12:33.023724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:33.619252 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:47673139-8a09-450a-b18b-712ab38a96e5&page=queryresults
[0m08:12:37.261195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfa5fe35-51a5-45cf-9c94-9b7dc31cc90a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ca0e3b50>]}
[0m08:12:37.262305 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mCREATE TABLE (112.7k rows, 27.9 MiB processed)[0m in 4.26s]
[0m08:12:37.263081 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m08:12:37.263539 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m08:12:37.264224 [info ] [Thread-1 (]: 6 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m08:12:37.264776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.fact_order_items, now model.olist_dataset.fact_orders)
[0m08:12:37.265124 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m08:12:37.268828 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m08:12:37.269605 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m08:12:37.272461 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m08:12:37.273342 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
      
    
    

    OPTIONS()
    as (
      -- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)


    );
  
[0m08:12:37.274191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:37.824731 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:31b4b94d-8a19-4839-8123-98fbb48e744a&page=queryresults
[0m08:12:41.800699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfa5fe35-51a5-45cf-9c94-9b7dc31cc90a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51cc2840d0>]}
[0m08:12:41.801432 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mCREATE TABLE (99.4k rows, 21.5 MiB processed)[0m in 4.54s]
[0m08:12:41.801998 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m08:12:41.805588 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:12:41.807100 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:12:41.807804 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m08:12:41.808653 [info ] [MainThread]: 
[0m08:12:41.809327 [info ] [MainThread]: Finished running 5 incremental models, 1 table model in 0 hours 0 minutes and 22.50 seconds (22.50s).
[0m08:12:41.812011 [debug] [MainThread]: Command end result
[0m08:12:41.846395 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m08:12:41.871365 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m08:12:41.880832 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m08:12:41.881603 [info ] [MainThread]: 
[0m08:12:41.882376 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:12:41.883112 [info ] [MainThread]: 
[0m08:12:41.883945 [error] [MainThread]:   Database Error in model dim_customer (models/star/dim_customer.sql)
  Unrecognized name: valid_to at [43:7]
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql
[0m08:12:41.884595 [info ] [MainThread]: 
[0m08:12:41.885184 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m08:12:41.886133 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 26.25462, "process_in_blocks": "592", "process_kernel_time": 1.273658, "process_mem_max_rss": "253020", "process_out_blocks": "2280", "process_user_time": 3.403055}
[0m08:12:41.886501 [debug] [MainThread]: Command `dbt run` failed at 08:12:41.886415 after 26.26 seconds
[0m08:12:41.886838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fb4399c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51cc22e2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fb314d60>]}
[0m08:12:41.887316 [debug] [MainThread]: Flushing usage events
[0m08:12:42.997483 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:14:01.977038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f261e629900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f261d7c0f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f261d7c0f10>]}


============================== 08:14:01.979761 | 0415cd93-826b-4b0f-a190-5dfc0051c6b2 ==============================
[0m08:14:01.979761 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:14:01.980302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'debug': 'False', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:14:03.024752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0415cd93-826b-4b0f-a190-5dfc0051c6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f261f8e5090>]}
[0m08:14:03.076203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0415cd93-826b-4b0f-a190-5dfc0051c6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f261d7d1db0>]}
[0m08:14:03.076900 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m08:14:03.160291 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:14:03.376014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:14:03.377106 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_customer.sql
[0m08:14:03.807312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0415cd93-826b-4b0f-a190-5dfc0051c6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ef250130>]}
[0m08:14:03.915269 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m08:14:03.917371 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m08:14:03.932918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0415cd93-826b-4b0f-a190-5dfc0051c6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ef35fd90>]}
[0m08:14:03.934085 [info ] [MainThread]: Found 6 models, 1 snapshot, 9 sources, 491 macros
[0m08:14:03.934661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0415cd93-826b-4b0f-a190-5dfc0051c6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ef8331c0>]}
[0m08:14:03.937043 [info ] [MainThread]: 
[0m08:14:03.937588 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:14:03.938050 [info ] [MainThread]: 
[0m08:14:03.938839 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:14:03.940559 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m08:14:03.941626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:14:04.456333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m08:14:04.457871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:14:04.855315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m08:14:04.857377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:14:05.254803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m08:14:05.255824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:14:05.641297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0415cd93-826b-4b0f-a190-5dfc0051c6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ef9095d0>]}
[0m08:14:05.642485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:14:05.648712 [debug] [Thread-1 (]: Began running node snapshot.olist_dataset.customer_snapshot
[0m08:14:05.649979 [info ] [Thread-1 (]: 1 of 1 START snapshot olist_data_snapshots.customer_snapshot ................... [RUN]
[0m08:14:05.650993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now snapshot.olist_dataset.customer_snapshot)
[0m08:14:05.651668 [debug] [Thread-1 (]: Began compiling node snapshot.olist_dataset.customer_snapshot
[0m08:14:05.670099 [debug] [Thread-1 (]: Began executing node snapshot.olist_dataset.customer_snapshot
[0m08:14:05.738346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:14:06.268446 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.customer_snapshot"} */

        
  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
    
[0m08:14:06.891413 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:f578fd70-d90c-4471-a36a-0b0595e1ddc9&page=queryresults
[0m08:14:10.470146 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`".
[0m08:14:11.624334 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        
    
    with snapshot_query as (

        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m08:14:12.287223 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:9bbce0b3-c414-4d9d-8916-1fc4665860fa&page=queryresults
[0m08:14:12.607487 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m08:14:12.129902 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:2439a17c-ee28-4e9d-8fcc-f38fa62890e1&page=queryresults
[0m08:14:12.454399 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.olist_dataset.customer_snapshot"
[0m08:14:12.455465 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.customer_snapshot"} */

      merge into `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot` as DBT_INTERNAL_DEST
    using `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`customer_id`, `customer_unique_id`, `customer_zip_code_prefix`, `customer_city`, `customer_state`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`customer_id`, `customer_unique_id`, `customer_zip_code_prefix`, `customer_city`, `customer_state`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m08:14:13.026388 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:2ff7fdf8-b6a1-4684-8033-0e33e22cc61c&page=queryresults
[0m08:14:15.782462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0415cd93-826b-4b0f-a190-5dfc0051c6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f261d769420>]}
[0m08:14:15.784255 [info ] [Thread-1 (]: 1 of 1 OK snapshotted olist_data_snapshots.customer_snapshot ................... [[32mMERGE (0.0 rows, 14.3 MiB processed)[0m in 10.13s]
[0m08:14:15.785333 [debug] [Thread-1 (]: Finished running node snapshot.olist_dataset.customer_snapshot
[0m08:14:15.790228 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:14:15.791615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:14:15.792227 [debug] [MainThread]: Connection 'snapshot.olist_dataset.customer_snapshot' was properly closed.
[0m08:14:15.792744 [info ] [MainThread]: 
[0m08:14:15.793366 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 11.85 seconds (11.85s).
[0m08:14:15.794712 [debug] [MainThread]: Command end result
[0m08:14:15.820482 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m08:14:15.822541 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m08:14:15.828586 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m08:14:15.828912 [info ] [MainThread]: 
[0m08:14:15.829282 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:14:15.829542 [info ] [MainThread]: 
[0m08:14:15.829794 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:14:15.830373 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 14.983574, "process_in_blocks": "280", "process_kernel_time": 1.302084, "process_mem_max_rss": "265448", "process_out_blocks": "3176", "process_user_time": 4.093675}
[0m08:14:15.830770 [debug] [MainThread]: Command `dbt snapshot` succeeded at 08:14:15.830679 after 14.98 seconds
[0m08:14:15.831136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f261e629900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f261f8e5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ef35fd90>]}
[0m08:14:15.831457 [debug] [MainThread]: Flushing usage events
[0m08:14:16.794609 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:14:18.428963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b8f998a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b810cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b810cf40>]}


============================== 08:14:18.431304 | 4cff5325-56bd-485e-b8b6-99ff9e6e476a ==============================
[0m08:14:18.431304 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:14:18.431719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:14:19.434298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cff5325-56bd-485e-b8b6-99ff9e6e476a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878a1852a0>]}
[0m08:14:19.505960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cff5325-56bd-485e-b8b6-99ff9e6e476a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b837b1c0>]}
[0m08:14:19.506767 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m08:14:19.608214 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:14:19.809485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:14:19.809925 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:14:19.855452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cff5325-56bd-485e-b8b6-99ff9e6e476a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8789e0c520>]}
[0m08:14:19.935333 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m08:14:19.936853 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m08:14:19.947353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cff5325-56bd-485e-b8b6-99ff9e6e476a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878a022080>]}
[0m08:14:19.948168 [info ] [MainThread]: Found 6 models, 1 snapshot, 9 sources, 491 macros
[0m08:14:19.948517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cff5325-56bd-485e-b8b6-99ff9e6e476a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878a020700>]}
[0m08:14:19.950187 [info ] [MainThread]: 
[0m08:14:19.950549 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:14:19.950810 [info ] [MainThread]: 
[0m08:14:19.951265 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:14:19.955837 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m08:14:19.956632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:14:20.385615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:14:20.761596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m08:14:20.763193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:14:21.127343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m08:14:21.130101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:14:21.498946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m08:14:21.501424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:14:21.850010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cff5325-56bd-485e-b8b6-99ff9e6e476a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ba275cc0>]}
[0m08:14:21.851016 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:14:21.857182 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m08:14:21.858310 [info ] [Thread-1 (]: 1 of 6 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m08:14:21.859174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now model.olist_dataset.dim_customer)
[0m08:14:21.859752 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m08:14:21.875330 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m08:14:21.875938 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m08:14:21.906222 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m08:14:21.906970 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 



SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m08:14:21.907401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:14:22.464700 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:8197b959-a96a-482f-8070-6a858e5b8fe7&page=queryresults
[0m08:14:25.763291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cff5325-56bd-485e-b8b6-99ff9e6e476a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b811e5f0>]}
[0m08:14:25.764090 [info ] [Thread-1 (]: 1 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_customer . [[32mCREATE TABLE (99.4k rows, 9.5 MiB processed)[0m in 3.90s]
[0m08:14:25.764662 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m08:14:25.765042 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m08:14:25.765477 [info ] [Thread-1 (]: 2 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m08:14:25.765948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_customer, now model.olist_dataset.dim_geolocation)
[0m08:14:25.766276 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m08:14:25.772166 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m08:14:25.773002 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m08:14:25.803766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:14:26.286645 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m08:14:26.287543 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation` as DBT_INTERNAL_DEST
        using (-- models/star/dim_geolocation.sql



WITH source AS (
    SELECT
        geolocation_zip_code_prefix,
        geolocation_city,
        geolocation_state,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source


  WHERE geolocation_zip_code_prefix NOT IN (
      SELECT geolocation_zip_code_prefix FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
  )

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.geolocation_zip_code_prefix = DBT_INTERNAL_DEST.geolocation_zip_code_prefix))

    
    when matched then update set
        `geolocation_zip_code_prefix` = DBT_INTERNAL_SOURCE.`geolocation_zip_code_prefix`,`geolocation_city` = DBT_INTERNAL_SOURCE.`geolocation_city`,`geolocation_state` = DBT_INTERNAL_SOURCE.`geolocation_state`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)
    values
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)


    
[0m08:14:26.889674 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:6e1efd67-51d6-4641-b84d-f9dc7f44cf75&page=queryresults
[0m08:14:52.040534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cff5325-56bd-485e-b8b6-99ff9e6e476a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878a247c40>]}
[0m08:14:52.041831 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[32mMERGE (0.0 rows, 62.1 MiB processed)[0m in 26.27s]
[0m08:14:52.042853 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m08:14:52.043542 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m08:14:52.044426 [info ] [Thread-1 (]: 3 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_product . [RUN]
[0m08:14:52.045318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_geolocation, now model.olist_dataset.dim_product)
[0m08:14:52.046022 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m08:14:52.053464 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m08:14:52.054531 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m08:14:52.059207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:14:52.429216 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m08:14:52.431031 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product` as DBT_INTERNAL_DEST
        using (-- models/star/dim_product.sql



WITH source AS (
    SELECT
        product_id,
        product_category_name,
        product_name_lenght,
        product_description_lenght,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
)

SELECT *
FROM source


  WHERE product_id NOT IN (SELECT product_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`)

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id))

    
    when matched then update set
        `product_id` = DBT_INTERNAL_SOURCE.`product_id`,`product_category_name` = DBT_INTERNAL_SOURCE.`product_category_name`,`product_name_lenght` = DBT_INTERNAL_SOURCE.`product_name_lenght`,`product_description_lenght` = DBT_INTERNAL_SOURCE.`product_description_lenght`,`product_photos_qty` = DBT_INTERNAL_SOURCE.`product_photos_qty`,`product_weight_g` = DBT_INTERNAL_SOURCE.`product_weight_g`,`product_length_cm` = DBT_INTERNAL_SOURCE.`product_length_cm`,`product_height_cm` = DBT_INTERNAL_SOURCE.`product_height_cm`,`product_width_cm` = DBT_INTERNAL_SOURCE.`product_width_cm`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`product_id`, `product_category_name`, `product_name_lenght`, `product_description_lenght`, `product_photos_qty`, `product_weight_g`, `product_length_cm`, `product_height_cm`, `product_width_cm`, `last_updated`)
    values
        (`product_id`, `product_category_name`, `product_name_lenght`, `product_description_lenght`, `product_photos_qty`, `product_weight_g`, `product_length_cm`, `product_height_cm`, `product_width_cm`, `last_updated`)


    
[0m08:14:53.035563 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:28a532ea-6831-4b21-af50-0e13e8154d54&page=queryresults
[0m08:14:56.176473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cff5325-56bd-485e-b8b6-99ff9e6e476a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8789df10f0>]}
[0m08:14:56.177779 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model olist_data_ingestion_dim_tables.dim_product  [[32mMERGE (0.0 rows, 7.2 MiB processed)[0m in 4.13s]
[0m08:14:56.178801 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m08:14:56.179487 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_seller
[0m08:14:56.180331 [info ] [Thread-1 (]: 4 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_seller .. [RUN]
[0m08:14:56.181270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_product, now model.olist_dataset.dim_seller)
[0m08:14:56.181895 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_seller
[0m08:14:56.190302 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_seller"
[0m08:14:56.191426 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_seller
[0m08:14:56.195715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:14:56.595925 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_seller"
[0m08:14:56.597634 [debug] [Thread-1 (]: On model.olist_dataset.dim_seller: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_seller"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller` as DBT_INTERNAL_DEST
        using (-- models/star/dim_seller.sql



WITH source AS (
    SELECT
        seller_id,
        seller_zip_code_prefix,
        seller_city,
        seller_state,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`
)

SELECT * FROM source


  WHERE seller_id NOT IN (SELECT seller_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`)

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.seller_id = DBT_INTERNAL_DEST.seller_id))

    
    when matched then update set
        `seller_id` = DBT_INTERNAL_SOURCE.`seller_id`,`seller_zip_code_prefix` = DBT_INTERNAL_SOURCE.`seller_zip_code_prefix`,`seller_city` = DBT_INTERNAL_SOURCE.`seller_city`,`seller_state` = DBT_INTERNAL_SOURCE.`seller_state`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`seller_id`, `seller_zip_code_prefix`, `seller_city`, `seller_state`, `last_updated`)
    values
        (`seller_id`, `seller_zip_code_prefix`, `seller_city`, `seller_state`, `last_updated`)


    
[0m08:14:57.204336 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:94854c98-33ee-473c-9aa3-19f1e6c6336a&page=queryresults
[0m08:15:00.036816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cff5325-56bd-485e-b8b6-99ff9e6e476a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f877b768460>]}
[0m08:15:00.038222 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model olist_data_ingestion_dim_tables.dim_seller  [[32mMERGE (0.0 rows, 400.0 KiB processed)[0m in 3.86s]
[0m08:15:00.039228 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_seller
[0m08:15:00.040119 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m08:15:00.041322 [info ] [Thread-1 (]: 5 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m08:15:00.042130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_seller, now model.olist_dataset.fact_order_items)
[0m08:15:00.042707 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m08:15:00.048163 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m08:15:00.048874 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m08:15:00.051366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:15:00.398626 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m08:15:00.400269 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,        
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    LEFT JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_approved_at,
    order_purchase_timestamp,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined


  WHERE order_id_item NOT IN (SELECT order_id_item FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`)

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id_item = DBT_INTERNAL_DEST.order_id_item))

    
    when matched then update set
        `customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_id` = DBT_INTERNAL_SOURCE.`order_id`,`order_item_id` = DBT_INTERNAL_SOURCE.`order_item_id`,`product_id` = DBT_INTERNAL_SOURCE.`product_id`,`seller_id` = DBT_INTERNAL_SOURCE.`seller_id`,`price` = DBT_INTERNAL_SOURCE.`price`,`freight_value` = DBT_INTERNAL_SOURCE.`freight_value`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`order_id_item` = DBT_INTERNAL_SOURCE.`order_id_item`
    

    when not matched then insert
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_approved_at`, `order_purchase_timestamp`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)
    values
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_approved_at`, `order_purchase_timestamp`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)


    
[0m08:15:00.897897 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:e30ec310-979e-450f-9963-5a48e71ce3f2&page=queryresults
[0m08:15:05.171696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cff5325-56bd-485e-b8b6-99ff9e6e476a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f877b7b7bb0>]}
[0m08:15:05.172774 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mMERGE (0.0 rows, 57.9 MiB processed)[0m in 5.13s]
[0m08:15:05.173378 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m08:15:05.173824 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m08:15:05.174329 [info ] [Thread-1 (]: 6 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m08:15:05.175372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.fact_order_items, now model.olist_dataset.fact_orders)
[0m08:15:05.175799 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m08:15:05.181331 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m08:15:05.181928 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m08:15:05.184604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:15:05.565562 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m08:15:05.567130 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)


  WHERE order_id NOT IN (SELECT order_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`)

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        `order_id` = DBT_INTERNAL_SOURCE.`order_id`,`customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_status` = DBT_INTERNAL_SOURCE.`order_status`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_carrier_date` = DBT_INTERNAL_SOURCE.`order_delivered_carrier_date`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`payment_value` = DBT_INTERNAL_SOURCE.`payment_value`
    

    when not matched then insert
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)
    values
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)


    
[0m08:15:06.195447 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:a4dca128-5d0a-434e-a3d8-0d79d1d8edea&page=queryresults
[0m08:15:10.582606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cff5325-56bd-485e-b8b6-99ff9e6e476a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f877b7dd630>]}
[0m08:15:10.584038 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mMERGE (0.0 rows, 39.6 MiB processed)[0m in 5.41s]
[0m08:15:10.585137 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m08:15:10.590351 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:15:10.591773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:15:10.592390 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m08:15:10.593175 [info ] [MainThread]: 
[0m08:15:10.593833 [info ] [MainThread]: Finished running 5 incremental models, 1 table model in 0 hours 0 minutes and 50.64 seconds (50.64s).
[0m08:15:10.596341 [debug] [MainThread]: Command end result
[0m08:15:10.627380 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m08:15:10.629614 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m08:15:10.636865 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m08:15:10.637232 [info ] [MainThread]: 
[0m08:15:10.637607 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:15:10.637892 [info ] [MainThread]: 
[0m08:15:10.638224 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m08:15:10.638881 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 53.41541, "process_in_blocks": "0", "process_kernel_time": 1.105747, "process_mem_max_rss": "253712", "process_out_blocks": "2288", "process_user_time": 3.586667}
[0m08:15:10.639314 [debug] [MainThread]: Command `dbt run` succeeded at 08:15:10.639213 after 53.42 seconds
[0m08:15:10.639759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b8f998a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878a1852a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878a0bfc70>]}
[0m08:15:10.640121 [debug] [MainThread]: Flushing usage events
[0m08:15:11.881600 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:22:18.285378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd1595f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd05b5600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd05b55a0>]}


============================== 08:22:18.287724 | 1bbb1146-6c4d-405a-8855-e125c60ccb8f ==============================
[0m08:22:18.287724 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:22:18.288245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'profiles_dir': '/home/kangh/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:22:19.313216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bbb1146-6c4d-405a-8855-e125c60ccb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd26cd420>]}
[0m08:22:19.379637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bbb1146-6c4d-405a-8855-e125c60ccb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd0dafe20>]}
[0m08:22:19.380442 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m08:22:19.518455 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:22:19.774688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m08:22:19.775455 [debug] [MainThread]: Partial parsing: added file: olist_dataset://snapshots/seller_snapshot.sql
[0m08:22:19.776068 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_seller.sql
[0m08:22:20.029305 [error] [MainThread]: Encountered an error:
Compilation Error in model dim_seller (models/star/dim_seller.sql)
  unexpected ')'
    line 4
      -- ) }}
[0m08:22:20.030021 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 1.802464, "process_in_blocks": "272", "process_kernel_time": 1.198283, "process_mem_max_rss": "248396", "process_out_blocks": "8", "process_user_time": 3.292761}
[0m08:22:20.030450 [debug] [MainThread]: Command `dbt snapshot` failed at 08:22:20.030354 after 1.80 seconds
[0m08:22:20.030952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd1595f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbca2117fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbca21160b0>]}
[0m08:22:20.031352 [debug] [MainThread]: Flushing usage events
[0m08:22:21.341806 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:22:42.123834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47ea2b2020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47e91f16f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47e91f1690>]}


============================== 08:22:42.126176 | 977bad3f-fc1a-40e6-815e-d165d8b15309 ==============================
[0m08:22:42.126176 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:22:42.126700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:22:43.125666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '977bad3f-fc1a-40e6-815e-d165d8b15309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47e91ff790>]}
[0m08:22:43.191348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '977bad3f-fc1a-40e6-815e-d165d8b15309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47e99fbc40>]}
[0m08:22:43.192096 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m08:22:43.305721 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:22:43.493377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m08:22:43.493947 [debug] [MainThread]: Partial parsing: added file: olist_dataset://snapshots/seller_snapshot.sql
[0m08:22:43.494358 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_seller.sql
[0m08:22:43.971935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '977bad3f-fc1a-40e6-815e-d165d8b15309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47baa4a320>]}
[0m08:22:44.048738 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m08:22:44.050235 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m08:22:44.065806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '977bad3f-fc1a-40e6-815e-d165d8b15309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47baa37010>]}
[0m08:22:44.066402 [info ] [MainThread]: Found 6 models, 2 snapshots, 9 sources, 491 macros
[0m08:22:44.066832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '977bad3f-fc1a-40e6-815e-d165d8b15309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47bb9e5330>]}
[0m08:22:44.068385 [info ] [MainThread]: 
[0m08:22:44.068815 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:22:44.069135 [info ] [MainThread]: 
[0m08:22:44.069655 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:22:44.073884 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m08:22:44.074717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:22:45.970182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m08:22:45.971789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:22:46.388678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m08:22:46.390580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:22:46.781934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m08:22:46.783156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:22:47.193468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '977bad3f-fc1a-40e6-815e-d165d8b15309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47e91fdb40>]}
[0m08:22:47.194629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:22:47.200439 [debug] [Thread-1 (]: Began running node snapshot.olist_dataset.customer_snapshot
[0m08:22:47.201659 [info ] [Thread-1 (]: 1 of 2 START snapshot olist_data_snapshots.customer_snapshot ................... [RUN]
[0m08:22:47.202701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now snapshot.olist_dataset.customer_snapshot)
[0m08:22:47.203495 [debug] [Thread-1 (]: Began compiling node snapshot.olist_dataset.customer_snapshot
[0m08:22:47.213459 [debug] [Thread-1 (]: Began executing node snapshot.olist_dataset.customer_snapshot
[0m08:22:47.253114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:22:47.711292 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.customer_snapshot"} */

        
  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
    
[0m08:22:48.347874 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:c467149f-b155-43c8-ba5a-32bd3429089b&page=queryresults
[0m08:22:52.234292 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`".
[0m08:22:53.436487 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        
    
    with snapshot_query as (

        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m08:22:54.070464 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:b70b7fe4-093b-444f-bf59-8602c832800c&page=queryresults
[0m08:22:54.397199 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m08:22:54.945525 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:e7ae914d-c298-4bc7-b9ce-4129c548d1c9&page=queryresults
[0m08:22:55.306262 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.olist_dataset.customer_snapshot"
[0m08:22:55.307939 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.customer_snapshot"} */

      merge into `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot` as DBT_INTERNAL_DEST
    using `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`customer_id`, `customer_unique_id`, `customer_zip_code_prefix`, `customer_city`, `customer_state`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`customer_id`, `customer_unique_id`, `customer_zip_code_prefix`, `customer_city`, `customer_state`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m08:22:55.938549 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:db78d87b-7cad-4f6a-aea8-c8f3c4eff032&page=queryresults
[0m08:22:58.921579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '977bad3f-fc1a-40e6-815e-d165d8b15309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47e938a650>]}
[0m08:22:58.923246 [info ] [Thread-1 (]: 1 of 2 OK snapshotted olist_data_snapshots.customer_snapshot ................... [[32mMERGE (0.0 rows, 14.3 MiB processed)[0m in 11.72s]
[0m08:22:58.924705 [debug] [Thread-1 (]: Finished running node snapshot.olist_dataset.customer_snapshot
[0m08:22:58.925662 [debug] [Thread-1 (]: Began running node snapshot.olist_dataset.seller_snapshot
[0m08:22:58.927064 [info ] [Thread-1 (]: 2 of 2 START snapshot olist_data_snapshots.seller_snapshot ..................... [RUN]
[0m08:22:58.928288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.olist_dataset.customer_snapshot, now snapshot.olist_dataset.seller_snapshot)
[0m08:22:58.929124 [debug] [Thread-1 (]: Began compiling node snapshot.olist_dataset.seller_snapshot
[0m08:22:58.936123 [debug] [Thread-1 (]: Began executing node snapshot.olist_dataset.seller_snapshot
[0m08:22:58.948444 [debug] [Thread-1 (]: On snapshot.olist_dataset.seller_snapshot: select * from (
        
    

    select *,
        to_hex(md5(concat(coalesce(cast(seller_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id,
        last_updated as dbt_updated_at,
        last_updated as dbt_valid_from,
        
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
from (
        



SELECT
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`

    ) sbq



    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m08:22:58.949108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:22:59.494607 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:f3d54009-42f1-4463-8f22-9dd1b0001086&page=queryresults
[0m08:22:59.818538 [debug] [Thread-1 (]: On snapshot.olist_dataset.seller_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m08:23:00.347439 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:6bb361ee-1a88-43ae-b870-0f5d015e3adb&page=queryresults
[0m08:23:00.672061 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.olist_dataset.seller_snapshot"
[0m08:23:00.673582 [debug] [Thread-1 (]: On snapshot.olist_dataset.seller_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.seller_snapshot"} */

      
  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot`
      
    
    

    OPTIONS()
    as (
      
    

    select *,
        to_hex(md5(concat(coalesce(cast(seller_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id,
        last_updated as dbt_updated_at,
        last_updated as dbt_valid_from,
        
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
from (
        



SELECT
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`

    ) sbq



    );
  
  
[0m08:23:01.225981 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:c1355d8a-95c2-4336-ab13-69bf77aee419&page=queryresults
[0m08:23:03.849047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '977bad3f-fc1a-40e6-815e-d165d8b15309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b8280160>]}
[0m08:23:03.850820 [info ] [Thread-1 (]: 2 of 2 OK snapshotted olist_data_snapshots.seller_snapshot ..................... [[32mCREATE TABLE (3.1k rows, 200.0 KiB processed)[0m in 4.92s]
[0m08:23:03.851905 [debug] [Thread-1 (]: Finished running node snapshot.olist_dataset.seller_snapshot
[0m08:23:03.855345 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:23:03.857535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:23:03.858057 [debug] [MainThread]: Connection 'snapshot.olist_dataset.seller_snapshot' was properly closed.
[0m08:23:03.858558 [info ] [MainThread]: 
[0m08:23:03.859046 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 19.79 seconds (19.79s).
[0m08:23:03.860056 [debug] [MainThread]: Command end result
[0m08:23:03.901660 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m08:23:03.903802 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m08:23:03.912037 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m08:23:03.912621 [info ] [MainThread]: 
[0m08:23:03.913301 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:23:03.913780 [info ] [MainThread]: 
[0m08:23:03.914257 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:23:03.914948 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 22.964767, "process_in_blocks": "0", "process_kernel_time": 1.159538, "process_mem_max_rss": "262584", "process_out_blocks": "3200", "process_user_time": 4.00341}
[0m08:23:03.915530 [debug] [MainThread]: Command `dbt snapshot` succeeded at 08:23:03.915409 after 22.97 seconds
[0m08:23:03.916033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47ea2b2020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47e91ff790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47ea0d8400>]}
[0m08:23:03.916535 [debug] [MainThread]: Flushing usage events
[0m08:23:04.960194 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:48:19.204567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94420fde10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94410354e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9441035480>]}


============================== 09:48:19.210924 | c796191c-ec04-44ad-8bc3-0715985371a9 ==============================
[0m09:48:19.210924 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:48:19.211431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:48:21.126737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c796191c-ec04-44ad-8bc3-0715985371a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f944313cf70>]}
[0m09:48:21.198955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c796191c-ec04-44ad-8bc3-0715985371a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f944104b3a0>]}
[0m09:48:21.199671 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m09:48:21.317416 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:48:21.592116 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:48:21.593176 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_customer.sql
[0m09:48:21.896463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c796191c-ec04-44ad-8bc3-0715985371a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9412a94130>]}
[0m09:48:21.977380 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m09:48:21.981031 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m09:48:22.006592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c796191c-ec04-44ad-8bc3-0715985371a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9412e1be80>]}
[0m09:48:22.007168 [info ] [MainThread]: Found 6 models, 2 snapshots, 9 sources, 491 macros
[0m09:48:22.007578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c796191c-ec04-44ad-8bc3-0715985371a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9412e1b940>]}
[0m09:48:22.009531 [info ] [MainThread]: 
[0m09:48:22.010087 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:48:22.010409 [info ] [MainThread]: 
[0m09:48:22.010932 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:48:22.015742 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m09:48:22.016348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:48:23.672735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:48:24.045508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m09:48:24.047292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:48:24.442794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m09:48:24.443749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:48:24.854878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m09:48:24.856770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:48:25.249142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c796191c-ec04-44ad-8bc3-0715985371a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94431bdd80>]}
[0m09:48:25.250223 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:48:25.255976 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m09:48:25.257159 [info ] [Thread-1 (]: 1 of 6 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m09:48:25.258260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now model.olist_dataset.dim_customer)
[0m09:48:25.259298 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m09:48:25.274898 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m09:48:25.275676 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m09:48:25.287729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:48:25.744340 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m09:48:25.745225 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 



SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    snapshot_created_at AS valid_from,
    snapshot_updated_at AS valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m09:48:26.323518 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:70d5e815-a262-4ab0-9a9f-6d0422c3cdfa&page=queryresults
[0m09:48:26.636219 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:70d5e815-a262-4ab0-9a9f-6d0422c3cdfa&page=queryresults
[0m09:48:26.654344 [debug] [Thread-1 (]: Database Error in model dim_customer (models/star/dim_customer.sql)
  Unrecognized name: snapshot_created_at at [40:5]
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql
[0m09:48:26.659513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c796191c-ec04-44ad-8bc3-0715985371a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9442138f10>]}
[0m09:48:26.661365 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model olist_data_ingestion_dim_tables.dim_customer  [[31mERROR[0m in 1.40s]
[0m09:48:26.662922 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m09:48:26.664247 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m09:48:26.666275 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_customer' to be skipped because of status 'error'.  Reason: Database Error in model dim_customer (models/star/dim_customer.sql)
  Unrecognized name: snapshot_created_at at [40:5]
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql.
[0m09:48:26.668993 [info ] [Thread-1 (]: 2 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m09:48:26.673868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_customer, now model.olist_dataset.dim_geolocation)
[0m09:48:26.675111 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m09:48:26.688091 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m09:48:26.689579 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m09:48:26.737544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:48:27.153691 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m09:48:27.154514 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation` as DBT_INTERNAL_DEST
        using (-- models/star/dim_geolocation.sql



WITH source AS (
    SELECT
        geolocation_zip_code_prefix,
        geolocation_city,
        geolocation_state,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source


  WHERE geolocation_zip_code_prefix NOT IN (
      SELECT geolocation_zip_code_prefix FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
  )

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.geolocation_zip_code_prefix = DBT_INTERNAL_DEST.geolocation_zip_code_prefix))

    
    when matched then update set
        `geolocation_zip_code_prefix` = DBT_INTERNAL_SOURCE.`geolocation_zip_code_prefix`,`geolocation_city` = DBT_INTERNAL_SOURCE.`geolocation_city`,`geolocation_state` = DBT_INTERNAL_SOURCE.`geolocation_state`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)
    values
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)


    
[0m09:48:27.719319 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:cacb6373-1c72-4e66-8681-e65beab47312&page=queryresults
[0m09:48:51.314871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c796191c-ec04-44ad-8bc3-0715985371a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9442138f10>]}
[0m09:48:51.316224 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[32mMERGE (0.0 rows, 62.1 MiB processed)[0m in 24.64s]
[0m09:48:51.317259 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m09:48:51.317909 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m09:48:51.319005 [info ] [Thread-1 (]: 3 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_product . [RUN]
[0m09:48:51.319850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_geolocation, now model.olist_dataset.dim_product)
[0m09:48:51.320510 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m09:48:51.326067 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m09:48:51.327167 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m09:48:51.331347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:48:51.750957 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m09:48:51.754069 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product` as DBT_INTERNAL_DEST
        using (-- models/star/dim_product.sql



WITH source AS (
    SELECT
        product_id,
        product_category_name,
        product_name_lenght,
        product_description_lenght,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
)

SELECT *
FROM source


  WHERE product_id NOT IN (SELECT product_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`)

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id))

    
    when matched then update set
        `product_id` = DBT_INTERNAL_SOURCE.`product_id`,`product_category_name` = DBT_INTERNAL_SOURCE.`product_category_name`,`product_name_lenght` = DBT_INTERNAL_SOURCE.`product_name_lenght`,`product_description_lenght` = DBT_INTERNAL_SOURCE.`product_description_lenght`,`product_photos_qty` = DBT_INTERNAL_SOURCE.`product_photos_qty`,`product_weight_g` = DBT_INTERNAL_SOURCE.`product_weight_g`,`product_length_cm` = DBT_INTERNAL_SOURCE.`product_length_cm`,`product_height_cm` = DBT_INTERNAL_SOURCE.`product_height_cm`,`product_width_cm` = DBT_INTERNAL_SOURCE.`product_width_cm`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`product_id`, `product_category_name`, `product_name_lenght`, `product_description_lenght`, `product_photos_qty`, `product_weight_g`, `product_length_cm`, `product_height_cm`, `product_width_cm`, `last_updated`)
    values
        (`product_id`, `product_category_name`, `product_name_lenght`, `product_description_lenght`, `product_photos_qty`, `product_weight_g`, `product_length_cm`, `product_height_cm`, `product_width_cm`, `last_updated`)


    
[0m09:48:52.363335 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d2816749-4ddb-4da5-9c18-d52b04e46e34&page=queryresults
[0m09:48:55.325024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c796191c-ec04-44ad-8bc3-0715985371a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f944101db40>]}
[0m09:48:55.326105 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model olist_data_ingestion_dim_tables.dim_product  [[32mMERGE (0.0 rows, 7.2 MiB processed)[0m in 4.01s]
[0m09:48:55.327039 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m09:48:55.327613 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_seller
[0m09:48:55.328499 [info ] [Thread-1 (]: 4 of 6 START sql table model olist_data_ingestion_dim_tables.dim_seller ........ [RUN]
[0m09:48:55.330256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_product, now model.olist_dataset.dim_seller)
[0m09:48:55.331654 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_seller
[0m09:48:55.339149 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_seller"
[0m09:48:55.340978 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_seller
[0m09:48:55.344191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:48:55.709544 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_seller"
[0m09:48:55.711094 [debug] [Thread-1 (]: On model.olist_dataset.dim_seller: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_seller"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_seller.sql

-- 

-- WITH source AS (
--     SELECT
--         seller_id,
--         seller_zip_code_prefix,
--         seller_city,
--         seller_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`
-- )

-- SELECT * FROM source

-- 



SELECT
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m09:48:56.280034 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:73127a17-b998-4940-81f2-c75f66a2fd81&page=queryresults
[0m09:48:58.680063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c796191c-ec04-44ad-8bc3-0715985371a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f944101db40>]}
[0m09:48:58.681075 [info ] [Thread-1 (]: 4 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_seller ... [[32mCREATE TABLE (3.1k rows, 200.0 KiB processed)[0m in 3.35s]
[0m09:48:58.681733 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_seller
[0m09:48:58.682147 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m09:48:58.682937 [info ] [Thread-1 (]: 5 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m09:48:58.685079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_seller, now model.olist_dataset.fact_order_items)
[0m09:48:58.685915 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m09:48:58.690582 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m09:48:58.691500 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m09:48:58.697515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:48:59.108425 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m09:48:59.111388 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,        
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    LEFT JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_approved_at,
    order_purchase_timestamp,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined


  WHERE order_id_item NOT IN (SELECT order_id_item FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`)

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id_item = DBT_INTERNAL_DEST.order_id_item))

    
    when matched then update set
        `customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_id` = DBT_INTERNAL_SOURCE.`order_id`,`order_item_id` = DBT_INTERNAL_SOURCE.`order_item_id`,`product_id` = DBT_INTERNAL_SOURCE.`product_id`,`seller_id` = DBT_INTERNAL_SOURCE.`seller_id`,`price` = DBT_INTERNAL_SOURCE.`price`,`freight_value` = DBT_INTERNAL_SOURCE.`freight_value`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`order_id_item` = DBT_INTERNAL_SOURCE.`order_id_item`
    

    when not matched then insert
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_approved_at`, `order_purchase_timestamp`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)
    values
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_approved_at`, `order_purchase_timestamp`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)


    
[0m09:48:59.886222 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d5c86ab0-e1d1-40e5-9c6c-2bfb4cf47d7a&page=queryresults
[0m09:49:02.848034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c796191c-ec04-44ad-8bc3-0715985371a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f944101db40>]}
[0m09:49:02.849713 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mMERGE (0.0 rows, 57.9 MiB processed)[0m in 4.16s]
[0m09:49:02.850891 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m09:49:02.851613 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m09:49:02.852688 [info ] [Thread-1 (]: 6 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m09:49:02.853605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.fact_order_items, now model.olist_dataset.fact_orders)
[0m09:49:02.854238 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m09:49:02.862668 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m09:49:02.863462 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m09:49:02.866402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:03.304731 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m09:49:03.308259 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)


  WHERE order_id NOT IN (SELECT order_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`)

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        `order_id` = DBT_INTERNAL_SOURCE.`order_id`,`customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_status` = DBT_INTERNAL_SOURCE.`order_status`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_carrier_date` = DBT_INTERNAL_SOURCE.`order_delivered_carrier_date`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`payment_value` = DBT_INTERNAL_SOURCE.`payment_value`
    

    when not matched then insert
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)
    values
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)


    
[0m09:49:03.974599 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:082d2120-0ff5-47ec-8723-a76a55fe3e12&page=queryresults
[0m09:49:10.196618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c796191c-ec04-44ad-8bc3-0715985371a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f944101db40>]}
[0m09:49:10.198270 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mMERGE (0.0 rows, 39.6 MiB processed)[0m in 7.34s]
[0m09:49:10.199723 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m09:49:10.204290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:49:10.207352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:49:10.208393 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m09:49:10.209513 [info ] [MainThread]: 
[0m09:49:10.210626 [info ] [MainThread]: Finished running 4 incremental models, 2 table models in 0 hours 0 minutes and 48.20 seconds (48.20s).
[0m09:49:10.214543 [debug] [MainThread]: Command end result
[0m09:49:10.247803 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m09:49:10.251753 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m09:49:10.260208 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m09:49:10.260670 [info ] [MainThread]: 
[0m09:49:10.261165 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:49:10.261569 [info ] [MainThread]: 
[0m09:49:10.261938 [error] [MainThread]:   Database Error in model dim_customer (models/star/dim_customer.sql)
  Unrecognized name: snapshot_created_at at [40:5]
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql
[0m09:49:10.262281 [info ] [MainThread]: 
[0m09:49:10.262648 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m09:49:10.263299 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 54.13922, "process_in_blocks": "123408", "process_kernel_time": 1.448719, "process_mem_max_rss": "258624", "process_out_blocks": "3352", "process_user_time": 4.220601}
[0m09:49:10.263762 [debug] [MainThread]: Command `dbt run` failed at 09:49:10.263659 after 54.14 seconds
[0m09:49:10.264176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94420fde10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9441da2b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9412a96ce0>]}
[0m09:49:10.264576 [debug] [MainThread]: Flushing usage events
[0m09:49:11.560034 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:50:01.768316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f345b5e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f334dd5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f334dd540>]}


============================== 09:50:01.773270 | eb937b8e-e9bf-4c18-9f4e-d72ccc7d8854 ==============================
[0m09:50:01.773270 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:50:01.773789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot --select customer_snapshot', 'send_anonymous_usage_stats': 'True'}
[0m09:50:03.475147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb937b8e-e9bf-4c18-9f4e-d72ccc7d8854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f0562d6f0>]}
[0m09:50:03.547122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb937b8e-e9bf-4c18-9f4e-d72ccc7d8854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f057d5240>]}
[0m09:50:03.547955 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m09:50:03.667576 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:50:03.955677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:50:03.956326 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:50:04.006732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb937b8e-e9bf-4c18-9f4e-d72ccc7d8854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f0517cf40>]}
[0m09:50:04.088052 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m09:50:04.090267 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m09:50:04.114495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb937b8e-e9bf-4c18-9f4e-d72ccc7d8854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f0562e560>]}
[0m09:50:04.115083 [info ] [MainThread]: Found 6 models, 2 snapshots, 9 sources, 491 macros
[0m09:50:04.115513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb937b8e-e9bf-4c18-9f4e-d72ccc7d8854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f05ce8fa0>]}
[0m09:50:04.116887 [info ] [MainThread]: 
[0m09:50:04.117322 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:50:04.117650 [info ] [MainThread]: 
[0m09:50:04.118213 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:50:04.120247 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m09:50:04.121019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:04.275420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m09:50:04.277073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:04.691648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m09:50:04.693478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:05.047510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m09:50:05.049445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:05.459497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb937b8e-e9bf-4c18-9f4e-d72ccc7d8854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f334e98a0>]}
[0m09:50:05.460568 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:50:05.466684 [debug] [Thread-1 (]: Began running node snapshot.olist_dataset.customer_snapshot
[0m09:50:05.467936 [info ] [Thread-1 (]: 1 of 1 START snapshot olist_data_snapshots.customer_snapshot ................... [RUN]
[0m09:50:05.469227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now snapshot.olist_dataset.customer_snapshot)
[0m09:50:05.470014 [debug] [Thread-1 (]: Began compiling node snapshot.olist_dataset.customer_snapshot
[0m09:50:05.486385 [debug] [Thread-1 (]: Began executing node snapshot.olist_dataset.customer_snapshot
[0m09:50:05.518877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:50:06.045655 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.customer_snapshot"} */

        
  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
    
[0m09:50:06.701672 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:ef521e2c-5359-4a36-88ce-ee4a75fec75d&page=queryresults
[0m09:50:10.428981 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`".
[0m09:50:11.814895 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        
    
    with snapshot_query as (

        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m09:50:12.410719 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:8baf59ab-1f16-40e8-9446-0ab4dddb7902&page=queryresults
[0m09:50:12.734341 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m09:50:13.290275 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:197c84d7-b61d-4abd-b842-f8140034be07&page=queryresults
[0m09:50:13.626024 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.olist_dataset.customer_snapshot"
[0m09:50:13.631743 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.customer_snapshot"} */

      merge into `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot` as DBT_INTERNAL_DEST
    using `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`customer_id`, `customer_unique_id`, `customer_zip_code_prefix`, `customer_city`, `customer_state`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`customer_id`, `customer_unique_id`, `customer_zip_code_prefix`, `customer_city`, `customer_state`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m09:50:14.283839 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:be3b1fde-ef4c-4934-8e23-3f4d10c3297e&page=queryresults
[0m09:50:17.283465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb937b8e-e9bf-4c18-9f4e-d72ccc7d8854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f05195ea0>]}
[0m09:50:17.285895 [info ] [Thread-1 (]: 1 of 1 OK snapshotted olist_data_snapshots.customer_snapshot ................... [[32mMERGE (0.0 rows, 14.3 MiB processed)[0m in 11.81s]
[0m09:50:17.287996 [debug] [Thread-1 (]: Finished running node snapshot.olist_dataset.customer_snapshot
[0m09:50:17.291627 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:50:17.293605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:50:17.294429 [debug] [MainThread]: Connection 'snapshot.olist_dataset.customer_snapshot' was properly closed.
[0m09:50:17.295807 [info ] [MainThread]: 
[0m09:50:17.297404 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 13.18 seconds (13.18s).
[0m09:50:17.299951 [debug] [MainThread]: Command end result
[0m09:50:17.348554 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m09:50:17.351531 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m09:50:17.359654 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m09:50:17.360105 [info ] [MainThread]: 
[0m09:50:17.362006 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:50:17.363211 [info ] [MainThread]: 
[0m09:50:17.366410 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:50:17.367944 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 17.221367, "process_in_blocks": "112280", "process_kernel_time": 1.264197, "process_mem_max_rss": "254988", "process_out_blocks": "2160", "process_user_time": 4.137372}
[0m09:50:17.369170 [debug] [MainThread]: Command `dbt snapshot` succeeded at 09:50:17.368818 after 17.22 seconds
[0m09:50:17.369893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f345b5e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f057d5240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f053d3730>]}
[0m09:50:17.370473 [debug] [MainThread]: Flushing usage events
[0m09:50:18.412052 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:50:35.833176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e4305e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e3231540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e32314e0>]}


============================== 09:50:35.835579 | c49b3062-329c-4d80-ab57-d2ae37779823 ==============================
[0m09:50:35.835579 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:50:35.836075 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models star.dim_customer', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:50:35.350991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c49b3062-329c-4d80-ab57-d2ae37779823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e5334f40>]}
[0m09:50:35.431260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c49b3062-329c-4d80-ab57-d2ae37779823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e3884cd0>]}
[0m09:50:35.432486 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m09:50:35.540726 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:50:35.730617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:50:35.731049 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:50:35.778214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c49b3062-329c-4d80-ab57-d2ae37779823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8b4ec8fa0>]}
[0m09:50:35.859746 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m09:50:35.861445 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m09:50:35.871551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c49b3062-329c-4d80-ab57-d2ae37779823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8b511e6e0>]}
[0m09:50:35.872142 [info ] [MainThread]: Found 6 models, 2 snapshots, 9 sources, 491 macros
[0m09:50:35.872547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c49b3062-329c-4d80-ab57-d2ae37779823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8b511d330>]}
[0m09:50:35.873895 [info ] [MainThread]: 
[0m09:50:35.874306 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:50:35.874606 [info ] [MainThread]: 
[0m09:50:35.875092 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:50:35.876550 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m09:50:35.877414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:36.878607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m09:50:36.879906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:37.309653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m09:50:37.310853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:38.039085 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m09:50:38.041595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:38.410317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c49b3062-329c-4d80-ab57-d2ae37779823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e53b9e70>]}
[0m09:50:38.411694 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:50:38.419017 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m09:50:38.420196 [info ] [Thread-1 (]: 1 of 1 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m09:50:38.421300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now model.olist_dataset.dim_customer)
[0m09:50:38.422016 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m09:50:38.441141 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m09:50:38.441891 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m09:50:38.454119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:50:38.885647 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m09:50:38.886496 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 



SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    snapshot_created_at AS valid_from,
    snapshot_updated_at AS valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m09:50:39.510371 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d19d5499-4c6b-4764-b556-2fbedffb0c93&page=queryresults
[0m09:50:39.834660 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d19d5499-4c6b-4764-b556-2fbedffb0c93&page=queryresults
[0m09:50:39.860722 [debug] [Thread-1 (]: Database Error in model dim_customer (models/star/dim_customer.sql)
  Unrecognized name: snapshot_created_at at [40:5]
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql
[0m09:50:39.866145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c49b3062-329c-4d80-ab57-d2ae37779823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e50aece0>]}
[0m09:50:39.867937 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model olist_data_ingestion_dim_tables.dim_customer  [[31mERROR[0m in 1.44s]
[0m09:50:39.869197 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m09:50:39.871050 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_customer' to be skipped because of status 'error'.  Reason: Database Error in model dim_customer (models/star/dim_customer.sql)
  Unrecognized name: snapshot_created_at at [40:5]
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql.
[0m09:50:39.875721 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:50:39.876624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:50:39.877051 [debug] [MainThread]: Connection 'model.olist_dataset.dim_customer' was properly closed.
[0m09:50:39.877402 [info ] [MainThread]: 
[0m09:50:39.877767 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.00 seconds (4.00s).
[0m09:50:39.878477 [debug] [MainThread]: Command end result
[0m09:50:39.901049 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m09:50:39.902933 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m09:50:39.909318 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m09:50:39.909751 [info ] [MainThread]: 
[0m09:50:39.910186 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:50:39.910515 [info ] [MainThread]: 
[0m09:50:39.910909 [error] [MainThread]:   Database Error in model dim_customer (models/star/dim_customer.sql)
  Unrecognized name: snapshot_created_at at [40:5]
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql
[0m09:50:39.911245 [info ] [MainThread]: 
[0m09:50:39.911596 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:50:39.912301 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.65452, "process_in_blocks": "584", "process_kernel_time": 1.227577, "process_mem_max_rss": "242036", "process_out_blocks": "2160", "process_user_time": 3.286426}
[0m09:50:39.912802 [debug] [MainThread]: Command `dbt run` failed at 09:50:39.912699 after 5.66 seconds
[0m09:50:39.913260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e4305e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8b5379b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8b511df90>]}
[0m09:50:39.913681 [debug] [MainThread]: Flushing usage events
[0m09:50:40.939184 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:52:19.528122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9667f81db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9666ebd450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9666ebd3f0>]}


============================== 09:52:19.533151 | 35082402-7d8d-48dc-aa45-deebf4118e8b ==============================
[0m09:52:19.533151 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:52:19.533658 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot --select customer_snapshot', 'send_anonymous_usage_stats': 'True'}
[0m09:52:21.309329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35082402-7d8d-48dc-aa45-deebf4118e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9667dcb160>]}
[0m09:52:21.379388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35082402-7d8d-48dc-aa45-deebf4118e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9667c277c0>]}
[0m09:52:21.380127 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m09:52:21.498246 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:52:21.779170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:52:21.779862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:52:21.827127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35082402-7d8d-48dc-aa45-deebf4118e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9638b7cf70>]}
[0m09:52:21.908512 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m09:52:21.912295 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m09:52:21.941176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35082402-7d8d-48dc-aa45-deebf4118e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9638aed210>]}
[0m09:52:21.941866 [info ] [MainThread]: Found 6 models, 2 snapshots, 9 sources, 491 macros
[0m09:52:21.942304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35082402-7d8d-48dc-aa45-deebf4118e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9639405d50>]}
[0m09:52:21.943796 [info ] [MainThread]: 
[0m09:52:21.944337 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:52:21.944651 [info ] [MainThread]: 
[0m09:52:21.945180 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:52:21.946514 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m09:52:21.947493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:23.651990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m09:52:23.653727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:24.087254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m09:52:24.089788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:24.514848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m09:52:24.517460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:24.892617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35082402-7d8d-48dc-aa45-deebf4118e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9669041d20>]}
[0m09:52:24.893464 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:52:24.899324 [debug] [Thread-1 (]: Began running node snapshot.olist_dataset.customer_snapshot
[0m09:52:24.900922 [info ] [Thread-1 (]: 1 of 1 START snapshot olist_data_snapshots.customer_snapshot ................... [RUN]
[0m09:52:24.902156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now snapshot.olist_dataset.customer_snapshot)
[0m09:52:24.903003 [debug] [Thread-1 (]: Began compiling node snapshot.olist_dataset.customer_snapshot
[0m09:52:24.923272 [debug] [Thread-1 (]: Began executing node snapshot.olist_dataset.customer_snapshot
[0m09:52:24.958769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:25.401280 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.customer_snapshot"} */

        
  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
    
[0m09:52:26.115446 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:765d2bd6-b511-4908-b6c7-31bf8d830625&page=queryresults
[0m09:52:29.981289 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`".
[0m09:52:31.165510 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        
    
    with snapshot_query as (

        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m09:52:32.046239 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:2d495e21-0dfa-4ffb-a39d-8b3d192d47ca&page=queryresults
[0m09:52:32.356744 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m09:52:32.879306 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:e13b5d8e-09b0-41a1-ba84-6b8bf2b3cf8d&page=queryresults
[0m09:52:33.210200 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.olist_dataset.customer_snapshot"
[0m09:52:33.215976 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.customer_snapshot"} */

      merge into `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot` as DBT_INTERNAL_DEST
    using `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`customer_id`, `customer_unique_id`, `customer_zip_code_prefix`, `customer_city`, `customer_state`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`customer_id`, `customer_unique_id`, `customer_zip_code_prefix`, `customer_city`, `customer_state`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m09:52:34.133499 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:84373644-c377-4c76-8dac-d1d6704e6888&page=queryresults
[0m09:52:36.779054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35082402-7d8d-48dc-aa45-deebf4118e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9638ba0eb0>]}
[0m09:52:36.782481 [info ] [Thread-1 (]: 1 of 1 OK snapshotted olist_data_snapshots.customer_snapshot ................... [[32mMERGE (0.0 rows, 14.3 MiB processed)[0m in 11.87s]
[0m09:52:36.784650 [debug] [Thread-1 (]: Finished running node snapshot.olist_dataset.customer_snapshot
[0m09:52:36.789881 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:52:36.791164 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:36.791598 [debug] [MainThread]: Connection 'snapshot.olist_dataset.customer_snapshot' was properly closed.
[0m09:52:36.792191 [info ] [MainThread]: 
[0m09:52:36.792696 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 14.85 seconds (14.85s).
[0m09:52:36.793545 [debug] [MainThread]: Command end result
[0m09:52:36.825706 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m09:52:36.828898 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m09:52:36.841107 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m09:52:36.841895 [info ] [MainThread]: 
[0m09:52:36.842856 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:52:36.843612 [info ] [MainThread]: 
[0m09:52:36.844350 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:52:36.846105 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 17.382282, "process_in_blocks": "122584", "process_kernel_time": 1.451027, "process_mem_max_rss": "253576", "process_out_blocks": "2160", "process_user_time": 3.913459}
[0m09:52:36.847196 [debug] [MainThread]: Command `dbt snapshot` succeeded at 09:52:36.846969 after 17.38 seconds
[0m09:52:36.848181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9667f81db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9667dcb160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9667c27190>]}
[0m09:52:36.849167 [debug] [MainThread]: Flushing usage events
[0m09:52:37.903192 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:52:53.264196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bbaa49e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bb99615a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bb9961540>]}


============================== 09:52:53.267803 | eba4111f-55d2-4c69-b251-957d7fba0768 ==============================
[0m09:52:53.267803 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:52:53.268626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'debug': 'False', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models star.dim_customer', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:52:52.420339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eba4111f-55d2-4c69-b251-957d7fba0768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bbba90f10>]}
[0m09:52:52.486296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eba4111f-55d2-4c69-b251-957d7fba0768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bb999f430>]}
[0m09:52:52.487040 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m09:52:52.596719 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:52:52.781748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:52:52.782242 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:52:52.825679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eba4111f-55d2-4c69-b251-957d7fba0768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b8b605000>]}
[0m09:52:52.901408 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m09:52:52.903138 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m09:52:52.913339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eba4111f-55d2-4c69-b251-957d7fba0768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b8b859000>]}
[0m09:52:52.913903 [info ] [MainThread]: Found 6 models, 2 snapshots, 9 sources, 491 macros
[0m09:52:52.914291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eba4111f-55d2-4c69-b251-957d7fba0768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b8b859120>]}
[0m09:52:52.915626 [info ] [MainThread]: 
[0m09:52:52.916122 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:52:52.916452 [info ] [MainThread]: 
[0m09:52:52.917035 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:52:52.918434 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m09:52:52.919505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:53.949603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m09:52:53.950320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:54.312597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m09:52:54.315086 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:54.695727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m09:52:54.698285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:55.068444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eba4111f-55d2-4c69-b251-957d7fba0768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bb999d8a0>]}
[0m09:52:55.069058 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:52:55.072093 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m09:52:55.072775 [info ] [Thread-1 (]: 1 of 1 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m09:52:55.073419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now model.olist_dataset.dim_customer)
[0m09:52:55.073820 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m09:52:55.087518 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m09:52:55.090571 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m09:52:55.103668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:55.497062 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m09:52:55.497860 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 



SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    snapshot_created_at AS valid_from,
    snapshot_updated_at AS valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m09:52:56.205234 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:0629ccdf-57e6-4df0-a07b-251191ffd695&page=queryresults
[0m09:52:56.513489 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:0629ccdf-57e6-4df0-a07b-251191ffd695&page=queryresults
[0m09:52:56.531212 [debug] [Thread-1 (]: Database Error in model dim_customer (models/star/dim_customer.sql)
  Unrecognized name: snapshot_created_at at [40:5]
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql
[0m09:52:56.535805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eba4111f-55d2-4c69-b251-957d7fba0768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b8b62ef50>]}
[0m09:52:56.537793 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model olist_data_ingestion_dim_tables.dim_customer  [[31mERROR[0m in 1.46s]
[0m09:52:56.538901 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m09:52:56.539986 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_customer' to be skipped because of status 'error'.  Reason: Database Error in model dim_customer (models/star/dim_customer.sql)
  Unrecognized name: snapshot_created_at at [40:5]
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql.
[0m09:52:56.545119 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:52:56.546208 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:56.546762 [debug] [MainThread]: Connection 'model.olist_dataset.dim_customer' was properly closed.
[0m09:52:56.547259 [info ] [MainThread]: 
[0m09:52:56.547884 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.63 seconds (3.63s).
[0m09:52:56.549032 [debug] [MainThread]: Command end result
[0m09:52:56.586306 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m09:52:56.588551 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m09:52:56.595101 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m09:52:56.595558 [info ] [MainThread]: 
[0m09:52:56.596077 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:52:56.596546 [info ] [MainThread]: 
[0m09:52:56.596960 [error] [MainThread]:   Database Error in model dim_customer (models/star/dim_customer.sql)
  Unrecognized name: snapshot_created_at at [40:5]
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql
[0m09:52:56.597265 [info ] [MainThread]: 
[0m09:52:56.597625 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:52:56.598237 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.652312, "process_in_blocks": "592", "process_kernel_time": 1.132799, "process_mem_max_rss": "244552", "process_out_blocks": "2152", "process_user_time": 4.050955}
[0m09:52:56.598631 [debug] [MainThread]: Command `dbt run` failed at 09:52:56.598538 after 5.65 seconds
[0m09:52:56.599008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bbaa49e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b8b85b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bbb78aad0>]}
[0m09:52:56.599381 [debug] [MainThread]: Flushing usage events
[0m09:52:57.612335 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:59:02.315332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f207908de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2077fc94b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2077fc9450>]}


============================== 09:59:02.321513 | 2ad0430a-6c6c-4c5b-b9da-6ce8d972c019 ==============================
[0m09:59:02.321513 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:59:02.322072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'debug': 'False', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot --select customer_snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:59:04.107531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ad0430a-6c6c-4c5b-b9da-6ce8d972c019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f207a0ccf70>]}
[0m09:59:04.178064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ad0430a-6c6c-4c5b-b9da-6ce8d972c019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2077fd73d0>]}
[0m09:59:04.178843 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m09:59:04.297840 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:59:04.580526 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:59:04.581011 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:59:04.627337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ad0430a-6c6c-4c5b-b9da-6ce8d972c019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2049c9cfd0>]}
[0m09:59:04.709754 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m09:59:04.712094 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m09:59:04.735915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ad0430a-6c6c-4c5b-b9da-6ce8d972c019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2049cc96c0>]}
[0m09:59:04.736476 [info ] [MainThread]: Found 6 models, 2 snapshots, 9 sources, 491 macros
[0m09:59:04.736885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ad0430a-6c6c-4c5b-b9da-6ce8d972c019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f204a551db0>]}
[0m09:59:04.738194 [info ] [MainThread]: 
[0m09:59:04.738648 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:59:04.738974 [info ] [MainThread]: 
[0m09:59:04.739500 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:59:04.740959 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m09:59:04.741680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:06.413959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m09:59:06.414830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:06.771942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m09:59:06.773059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:07.155790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m09:59:07.158212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:07.559892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ad0430a-6c6c-4c5b-b9da-6ce8d972c019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f207a14dd80>]}
[0m09:59:07.561078 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:59:07.568287 [debug] [Thread-1 (]: Began running node snapshot.olist_dataset.customer_snapshot
[0m09:59:07.569418 [info ] [Thread-1 (]: 1 of 1 START snapshot olist_data_snapshots.customer_snapshot ................... [RUN]
[0m09:59:07.570489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now snapshot.olist_dataset.customer_snapshot)
[0m09:59:07.571224 [debug] [Thread-1 (]: Began compiling node snapshot.olist_dataset.customer_snapshot
[0m09:59:07.586810 [debug] [Thread-1 (]: Began executing node snapshot.olist_dataset.customer_snapshot
[0m09:59:07.619862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:08.100716 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.customer_snapshot"} */

        
  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
    
[0m09:59:08.704341 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:fb5894e8-f2ce-463a-b1e5-7b3dee8bc5b8&page=queryresults
[0m09:59:12.208504 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`".
[0m09:59:13.485966 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        
    
    with snapshot_query as (

        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m09:59:14.214762 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:3ac7e4db-38ad-4138-a672-236e8e8bf888&page=queryresults
[0m09:59:14.552310 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m09:59:15.101237 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:0b6cd883-95c4-455c-b47e-f7cb1d254620&page=queryresults
[0m09:59:15.441236 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.olist_dataset.customer_snapshot"
[0m09:59:15.462951 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.customer_snapshot"} */

      merge into `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot` as DBT_INTERNAL_DEST
    using `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`customer_id`, `customer_unique_id`, `customer_zip_code_prefix`, `customer_city`, `customer_state`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`customer_id`, `customer_unique_id`, `customer_zip_code_prefix`, `customer_city`, `customer_state`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m09:59:16.061026 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:9d8fcfa2-0c76-4ce5-93e9-54b506529adb&page=queryresults
[0m09:59:17.293066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad0430a-6c6c-4c5b-b9da-6ce8d972c019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2049f4fdf0>]}
[0m09:59:17.294698 [info ] [Thread-1 (]: 1 of 1 OK snapshotted olist_data_snapshots.customer_snapshot ................... [[32mMERGE (0.0 rows, 14.3 MiB processed)[0m in 9.72s]
[0m09:59:17.295887 [debug] [Thread-1 (]: Finished running node snapshot.olist_dataset.customer_snapshot
[0m09:59:17.299392 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:59:17.301524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:59:17.302523 [debug] [MainThread]: Connection 'snapshot.olist_dataset.customer_snapshot' was properly closed.
[0m09:59:17.303294 [info ] [MainThread]: 
[0m09:59:17.304160 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 12.56 seconds (12.56s).
[0m09:59:17.305724 [debug] [MainThread]: Command end result
[0m09:59:17.356009 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m09:59:17.359184 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m09:59:17.368597 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m09:59:17.369122 [info ] [MainThread]: 
[0m09:59:17.369664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:59:17.370062 [info ] [MainThread]: 
[0m09:59:17.371953 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:59:17.374560 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 16.645737, "process_in_blocks": "123160", "process_kernel_time": 1.465344, "process_mem_max_rss": "257848", "process_out_blocks": "2160", "process_user_time": 3.707029}
[0m09:59:17.375409 [debug] [MainThread]: Command `dbt snapshot` succeeded at 09:59:17.375195 after 16.65 seconds
[0m09:59:17.376398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f207908de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f207a0ccf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2078eafb50>]}
[0m09:59:17.377050 [debug] [MainThread]: Flushing usage events
[0m09:59:18.377600 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:06:01.595898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea4989de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea38b94e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea38b9480>]}


============================== 10:06:01.601313 | d66d5278-06f1-4507-921c-03fd6d4fc9f4 ==============================
[0m10:06:01.601313 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:06:01.601827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models star.dim_customer', 'send_anonymous_usage_stats': 'True'}
[0m10:06:03.259433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd66d5278-06f1-4507-921c-03fd6d4fc9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde75a6a3e0>]}
[0m10:06:03.334009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd66d5278-06f1-4507-921c-03fd6d4fc9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea38cf3a0>]}
[0m10:06:03.334749 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:06:03.449221 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:06:03.722821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:06:03.723429 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:06:03.769244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd66d5278-06f1-4507-921c-03fd6d4fc9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde75548f70>]}
[0m10:06:03.850532 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:06:03.854343 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:06:03.886371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd66d5278-06f1-4507-921c-03fd6d4fc9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde75758670>]}
[0m10:06:03.887000 [info ] [MainThread]: Found 6 models, 2 snapshots, 9 sources, 491 macros
[0m10:06:03.887397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd66d5278-06f1-4507-921c-03fd6d4fc9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde75758370>]}
[0m10:06:03.888817 [info ] [MainThread]: 
[0m10:06:03.889253 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:06:03.889558 [info ] [MainThread]: 
[0m10:06:03.890078 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:06:03.891540 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m10:06:03.892047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:06:05.581038 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m10:06:05.582740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:06:06.004267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m10:06:06.006374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:06:06.416307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m10:06:06.419660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:06:07.040969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd66d5278-06f1-4507-921c-03fd6d4fc9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea5a41d80>]}
[0m10:06:07.041894 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:06:07.048384 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m10:06:07.049164 [info ] [Thread-1 (]: 1 of 1 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m10:06:07.049856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now model.olist_dataset.dim_customer)
[0m10:06:07.050451 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m10:06:07.066206 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m10:06:07.069707 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m10:06:07.084890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:06:07.495368 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m10:06:07.496324 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 



SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    snapshot_created_at AS valid_from,
    snapshot_updated_at AS valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m10:06:08.282174 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:79b0739f-f66c-43ce-bc6d-a150f65cd8bd&page=queryresults
[0m10:06:08.594147 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:79b0739f-f66c-43ce-bc6d-a150f65cd8bd&page=queryresults
[0m10:06:08.607821 [debug] [Thread-1 (]: Database Error in model dim_customer (models/star/dim_customer.sql)
  Unrecognized name: snapshot_created_at at [40:5]
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql
[0m10:06:08.611204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd66d5278-06f1-4507-921c-03fd6d4fc9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde755726e0>]}
[0m10:06:08.612314 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model olist_data_ingestion_dim_tables.dim_customer  [[31mERROR[0m in 1.56s]
[0m10:06:08.613036 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m10:06:08.613829 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_customer' to be skipped because of status 'error'.  Reason: Database Error in model dim_customer (models/star/dim_customer.sql)
  Unrecognized name: snapshot_created_at at [40:5]
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql.
[0m10:06:08.616995 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:06:08.618440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:06:08.619001 [debug] [MainThread]: Connection 'model.olist_dataset.dim_customer' was properly closed.
[0m10:06:08.619531 [info ] [MainThread]: 
[0m10:06:08.620039 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m10:06:08.621033 [debug] [MainThread]: Command end result
[0m10:06:08.654217 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:06:08.656749 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:06:08.667111 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m10:06:08.667803 [info ] [MainThread]: 
[0m10:06:08.668526 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:06:08.669038 [info ] [MainThread]: 
[0m10:06:08.669617 [error] [MainThread]:   Database Error in model dim_customer (models/star/dim_customer.sql)
  Unrecognized name: snapshot_created_at at [40:5]
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql
[0m10:06:08.670119 [info ] [MainThread]: 
[0m10:06:08.670661 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:06:08.671515 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.1403975, "process_in_blocks": "121576", "process_kernel_time": 1.350116, "process_mem_max_rss": "251532", "process_out_blocks": "2152", "process_user_time": 3.716484}
[0m10:06:08.672128 [debug] [MainThread]: Command `dbt run` failed at 10:06:08.671973 after 7.14 seconds
[0m10:06:08.672789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea4989de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde757586d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde75758b50>]}
[0m10:06:08.673400 [debug] [MainThread]: Flushing usage events
[0m10:06:09.696811 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:08:18.874012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c05245e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c04161540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c041614e0>]}


============================== 10:08:18.879336 | f7b27a9d-f8c8-4ffc-b387-018679ae6451 ==============================
[0m10:08:18.879336 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:08:18.879915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --select customer_snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:08:20.673251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7b27a9d-f8c8-4ffc-b387-018679ae6451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bd64887c0>]}
[0m10:08:20.751548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7b27a9d-f8c8-4ffc-b387-018679ae6451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0416f400>]}
[0m10:08:20.752350 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:08:20.872672 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:08:21.141360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:08:21.142593 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_customer.sql
[0m10:08:21.462612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7b27a9d-f8c8-4ffc-b387-018679ae6451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bd5bcc130>]}
[0m10:08:21.543061 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:08:21.545733 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:08:21.569026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7b27a9d-f8c8-4ffc-b387-018679ae6451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bd5f524d0>]}
[0m10:08:21.569580 [info ] [MainThread]: Found 6 models, 2 snapshots, 9 sources, 491 macros
[0m10:08:21.569990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7b27a9d-f8c8-4ffc-b387-018679ae6451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bd68d51b0>]}
[0m10:08:21.571267 [info ] [MainThread]: 
[0m10:08:21.571685 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:08:21.572039 [info ] [MainThread]: 
[0m10:08:21.572551 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:08:21.573881 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m10:08:21.574633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:08:23.279629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m10:08:23.281026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:08:23.640201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m10:08:23.642473 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:08:24.068388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m10:08:24.071404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:08:24.472371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7b27a9d-f8c8-4ffc-b387-018679ae6451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bd63321d0>]}
[0m10:08:24.473576 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:08:24.480082 [debug] [Thread-1 (]: Began running node snapshot.olist_dataset.customer_snapshot
[0m10:08:24.481705 [info ] [Thread-1 (]: 1 of 1 START snapshot olist_data_snapshots.customer_snapshot ................... [RUN]
[0m10:08:24.482851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now snapshot.olist_dataset.customer_snapshot)
[0m10:08:24.483636 [debug] [Thread-1 (]: Began compiling node snapshot.olist_dataset.customer_snapshot
[0m10:08:24.497360 [debug] [Thread-1 (]: Began executing node snapshot.olist_dataset.customer_snapshot
[0m10:08:24.560880 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        
    

    select *,
        to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id,
        last_updated as dbt_updated_at,
        last_updated as dbt_valid_from,
        
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
from (
        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`

    ) sbq



    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m10:08:24.561502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:08:25.254894 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:c6c32315-12a5-4c60-af44-eb9d862f6f60&page=queryresults
[0m10:08:25.622453 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m10:08:26.233552 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:9c0f7fe5-5d10-40a4-a3f7-4bb1a2856db6&page=queryresults
[0m10:08:26.618690 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.olist_dataset.customer_snapshot"
[0m10:08:26.622645 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.customer_snapshot"} */

      
  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
      
    
    

    OPTIONS()
    as (
      
    

    select *,
        to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id,
        last_updated as dbt_updated_at,
        last_updated as dbt_valid_from,
        
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
from (
        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`

    ) sbq



    );
  
  
[0m10:08:27.221041 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:bb2ca678-95a1-45f4-9438-202c30f61390&page=queryresults
[0m10:08:31.037166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7b27a9d-f8c8-4ffc-b387-018679ae6451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c042f5a80>]}
[0m10:08:31.038036 [info ] [Thread-1 (]: 1 of 1 OK snapshotted olist_data_snapshots.customer_snapshot ................... [[32mCREATE TABLE (99.4k rows, 9.5 MiB processed)[0m in 6.55s]
[0m10:08:31.038641 [debug] [Thread-1 (]: Finished running node snapshot.olist_dataset.customer_snapshot
[0m10:08:31.040973 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:08:31.041785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:08:31.042121 [debug] [MainThread]: Connection 'snapshot.olist_dataset.customer_snapshot' was properly closed.
[0m10:08:31.042431 [info ] [MainThread]: 
[0m10:08:31.042778 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 9.47 seconds (9.47s).
[0m10:08:31.043376 [debug] [MainThread]: Command end result
[0m10:08:31.063326 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:08:31.065787 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:08:31.072786 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m10:08:31.073254 [info ] [MainThread]: 
[0m10:08:31.073688 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:08:31.074013 [info ] [MainThread]: 
[0m10:08:31.074362 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:08:31.075130 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 12.26798, "process_in_blocks": "122816", "process_kernel_time": 1.402949, "process_mem_max_rss": "261856", "process_out_blocks": "3192", "process_user_time": 3.672149}
[0m10:08:31.075711 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:08:31.075616 after 12.27 seconds
[0m10:08:31.076057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c05245e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0416f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bd5b63580>]}
[0m10:08:31.076434 [debug] [MainThread]: Flushing usage events
[0m10:08:32.062701 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:09:02.323589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc65029ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc63f6d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc63f6d570>]}


============================== 10:09:02.328517 | d068f721-a7c1-4443-8580-f4ac24d5c634 ==============================
[0m10:09:02.328517 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:09:02.329141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models star.dim_customer', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:09:03.999087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd068f721-a7c1-4443-8580-f4ac24d5c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc361551b0>]}
[0m10:09:04.068422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd068f721-a7c1-4443-8580-f4ac24d5c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc63f7f460>]}
[0m10:09:04.069140 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:09:04.186860 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:09:04.464232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:09:04.464780 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:09:04.511921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd068f721-a7c1-4443-8580-f4ac24d5c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc35be0fd0>]}
[0m10:09:04.598670 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:09:04.601900 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:09:04.628148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd068f721-a7c1-4443-8580-f4ac24d5c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc35be2440>]}
[0m10:09:04.628775 [info ] [MainThread]: Found 6 models, 2 snapshots, 9 sources, 491 macros
[0m10:09:04.629204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd068f721-a7c1-4443-8580-f4ac24d5c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc35be23b0>]}
[0m10:09:04.630759 [info ] [MainThread]: 
[0m10:09:04.631180 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:09:04.631538 [info ] [MainThread]: 
[0m10:09:04.632057 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:09:04.633392 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m10:09:04.634418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:09:06.343479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m10:09:06.345739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:09:06.793133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m10:09:06.796500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:09:07.266859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m10:09:07.270201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:09:07.777479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd068f721-a7c1-4443-8580-f4ac24d5c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc63f7d9f0>]}
[0m10:09:07.779100 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:09:07.787871 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m10:09:07.789199 [info ] [Thread-1 (]: 1 of 1 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m10:09:07.790208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now model.olist_dataset.dim_customer)
[0m10:09:07.790966 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m10:09:07.812681 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m10:09:07.816376 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m10:09:07.851302 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m10:09:07.852136 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- This is incremental approach
-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 


-- This is snapshot approach, refer to customer_snapshot.sql


SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    snapshot_created_at AS valid_from,
    snapshot_updated_at AS valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m10:09:07.852629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:09:08.529992 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:bfe29222-1be1-44f4-9593-6f2839aedfff&page=queryresults
[0m10:09:08.845981 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:bfe29222-1be1-44f4-9593-6f2839aedfff&page=queryresults
[0m10:09:08.874592 [debug] [Thread-1 (]: Database Error in model dim_customer (models/star/dim_customer.sql)
  Unrecognized name: snapshot_created_at at [43:5]
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql
[0m10:09:08.880394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd068f721-a7c1-4443-8580-f4ac24d5c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc35bc52a0>]}
[0m10:09:08.882142 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model olist_data_ingestion_dim_tables.dim_customer  [[31mERROR[0m in 1.09s]
[0m10:09:08.883470 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m10:09:08.885089 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_customer' to be skipped because of status 'error'.  Reason: Database Error in model dim_customer (models/star/dim_customer.sql)
  Unrecognized name: snapshot_created_at at [43:5]
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql.
[0m10:09:08.891837 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:09:08.893380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:09:08.894114 [debug] [MainThread]: Connection 'model.olist_dataset.dim_customer' was properly closed.
[0m10:09:08.894924 [info ] [MainThread]: 
[0m10:09:08.895645 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m10:09:08.897271 [debug] [MainThread]: Command end result
[0m10:09:08.920758 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:09:08.923827 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:09:08.931131 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m10:09:08.931520 [info ] [MainThread]: 
[0m10:09:08.931960 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:09:08.932300 [info ] [MainThread]: 
[0m10:09:08.932678 [error] [MainThread]:   Database Error in model dim_customer (models/star/dim_customer.sql)
  Unrecognized name: snapshot_created_at at [43:5]
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql
[0m10:09:08.932962 [info ] [MainThread]: 
[0m10:09:08.933327 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:09:08.933907 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.67424, "process_in_blocks": "121824", "process_kernel_time": 1.401587, "process_mem_max_rss": "240504", "process_out_blocks": "2160", "process_user_time": 3.403854}
[0m10:09:08.934323 [debug] [MainThread]: Command `dbt run` failed at 10:09:08.934229 after 6.67 seconds
[0m10:09:08.934688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc65029ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc35d4ed70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc35be1600>]}
[0m10:09:08.935061 [debug] [MainThread]: Flushing usage events
[0m10:09:09.967013 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:09:45.471086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82870c9db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8285ffd450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8285ffd3f0>]}


============================== 10:09:45.473378 | 7f152ac4-ffce-4cda-a096-4942b33eb4b5 ==============================
[0m10:09:45.473378 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:09:45.473846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models star.dim_customer', 'send_anonymous_usage_stats': 'True'}
[0m10:09:46.471603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f152ac4-ffce-4cda-a096-4942b33eb4b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8286d2e050>]}
[0m10:09:46.537753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f152ac4-ffce-4cda-a096-4942b33eb4b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8286d2c1f0>]}
[0m10:09:46.538504 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:09:46.637828 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:09:46.822410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:09:46.823014 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_customer.sql
[0m10:09:47.106027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f152ac4-ffce-4cda-a096-4942b33eb4b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8257a88130>]}
[0m10:09:47.180638 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:09:47.182055 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:09:47.192771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f152ac4-ffce-4cda-a096-4942b33eb4b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f825c1b0e50>]}
[0m10:09:47.193311 [info ] [MainThread]: Found 6 models, 2 snapshots, 9 sources, 491 macros
[0m10:09:47.193700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f152ac4-ffce-4cda-a096-4942b33eb4b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f825c1b3dc0>]}
[0m10:09:47.194970 [info ] [MainThread]: 
[0m10:09:47.195375 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:09:47.195689 [info ] [MainThread]: 
[0m10:09:47.196156 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:09:47.197640 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m10:09:47.198149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:09:48.192493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m10:09:48.194007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:09:48.624128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m10:09:48.625106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:09:47.938713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m10:09:47.940826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:09:48.305665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f152ac4-ffce-4cda-a096-4942b33eb4b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f828600d270>]}
[0m10:09:48.306774 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:09:48.312376 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m10:09:48.313554 [info ] [Thread-1 (]: 1 of 1 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m10:09:48.314424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now model.olist_dataset.dim_customer)
[0m10:09:48.315038 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m10:09:48.330444 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m10:09:48.333214 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m10:09:48.370442 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m10:09:48.371265 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- This is incremental approach
-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 


-- This is snapshot approach, refer to customer_snapshot.sql


SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    valid_from,
    valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m10:09:48.371730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:09:48.942390 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:8f501ab5-e004-4f38-b294-623a047946f2&page=queryresults
[0m10:09:49.303290 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:8f501ab5-e004-4f38-b294-623a047946f2&page=queryresults
[0m10:09:49.308065 [debug] [Thread-1 (]: Database Error in model dim_customer (models/star/dim_customer.sql)
  Unrecognized name: valid_from; Did you mean dbt_valid_from? at [43:5]
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql
[0m10:09:49.312036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f152ac4-ffce-4cda-a096-4942b33eb4b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f825c1e8a60>]}
[0m10:09:49.313623 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model olist_data_ingestion_dim_tables.dim_customer  [[31mERROR[0m in 0.99s]
[0m10:09:49.314856 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m10:09:49.316262 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_customer' to be skipped because of status 'error'.  Reason: Database Error in model dim_customer (models/star/dim_customer.sql)
  Unrecognized name: valid_from; Did you mean dbt_valid_from? at [43:5]
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql.
[0m10:09:49.321397 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:09:49.322998 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:09:49.323693 [debug] [MainThread]: Connection 'model.olist_dataset.dim_customer' was properly closed.
[0m10:09:49.324337 [info ] [MainThread]: 
[0m10:09:49.324974 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m10:09:49.326039 [debug] [MainThread]: Command end result
[0m10:09:49.347222 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:09:49.348782 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:09:49.354047 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m10:09:49.354392 [info ] [MainThread]: 
[0m10:09:49.354947 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:09:49.355460 [info ] [MainThread]: 
[0m10:09:49.356007 [error] [MainThread]:   Database Error in model dim_customer (models/star/dim_customer.sql)
  Unrecognized name: valid_from; Did you mean dbt_valid_from? at [43:5]
  compiled code at target/run/olist_dataset/models/star/dim_customer.sql
[0m10:09:49.356353 [info ] [MainThread]: 
[0m10:09:49.356661 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:09:49.357210 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.978134, "process_in_blocks": "288", "process_kernel_time": 1.282976, "process_mem_max_rss": "249156", "process_out_blocks": "3192", "process_user_time": 3.280893}
[0m10:09:49.357597 [debug] [MainThread]: Command `dbt run` failed at 10:09:49.357500 after 4.98 seconds
[0m10:09:49.357971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82870c9db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f825c1b1a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8286d2e050>]}
[0m10:09:49.358332 [debug] [MainThread]: Flushing usage events
[0m10:09:50.328143 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:11:52.932002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba0fbde10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b9fed94b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b9fed9450>]}


============================== 10:11:52.936681 | 06f1f7cc-391b-4b67-98d6-86b433400a17 ==============================
[0m10:11:52.936681 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:11:52.937226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --select customer_snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:11:54.602268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06f1f7cc-391b-4b67-98d6-86b433400a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba1ff0f70>]}
[0m10:11:54.669162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06f1f7cc-391b-4b67-98d6-86b433400a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b9feeb3d0>]}
[0m10:11:54.669857 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:11:54.785382 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:11:55.056519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:11:55.057546 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_customer.sql
[0m10:11:55.347051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06f1f7cc-391b-4b67-98d6-86b433400a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b71984130>]}
[0m10:11:55.423497 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:11:55.427217 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:11:55.450547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06f1f7cc-391b-4b67-98d6-86b433400a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b71957970>]}
[0m10:11:55.451092 [info ] [MainThread]: Found 6 models, 2 snapshots, 9 sources, 491 macros
[0m10:11:55.451467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06f1f7cc-391b-4b67-98d6-86b433400a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b72435de0>]}
[0m10:11:55.452832 [info ] [MainThread]: 
[0m10:11:55.453298 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:11:55.453592 [info ] [MainThread]: 
[0m10:11:55.454099 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:11:55.455375 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m10:11:55.456219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:57.005198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m10:11:57.006566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:11:57.450015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m10:11:57.452326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:11:57.962184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m10:11:57.964163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:11:58.431678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06f1f7cc-391b-4b67-98d6-86b433400a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba2075d80>]}
[0m10:11:58.432840 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:11:58.438964 [debug] [Thread-1 (]: Began running node snapshot.olist_dataset.customer_snapshot
[0m10:11:58.440000 [info ] [Thread-1 (]: 1 of 1 START snapshot olist_data_snapshots.customer_snapshot ................... [RUN]
[0m10:11:58.441005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now snapshot.olist_dataset.customer_snapshot)
[0m10:11:58.441678 [debug] [Thread-1 (]: Began compiling node snapshot.olist_dataset.customer_snapshot
[0m10:11:58.455329 [debug] [Thread-1 (]: Began executing node snapshot.olist_dataset.customer_snapshot
[0m10:11:58.488679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:11:58.907344 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.customer_snapshot"} */

        
  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
    
[0m10:11:59.533477 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:8f121e7a-2b37-4cba-80d9-cc6bec5848bd&page=queryresults
[0m10:12:04.332584 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`".
[0m10:12:05.583445 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        
    
    with snapshot_query as (

        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m10:12:06.160446 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d963ca0d-f0ca-49fc-819b-a63850362d90&page=queryresults
[0m10:12:06.508174 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m10:12:07.035728 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:329ebfde-d273-496e-9f30-f69b6d5dbd77&page=queryresults
[0m10:12:07.364693 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.olist_dataset.customer_snapshot"
[0m10:12:07.369494 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.customer_snapshot"} */

      merge into `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot` as DBT_INTERNAL_DEST
    using `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`customer_id`, `customer_unique_id`, `customer_zip_code_prefix`, `customer_city`, `customer_state`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`customer_id`, `customer_unique_id`, `customer_zip_code_prefix`, `customer_city`, `customer_state`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m10:12:07.932555 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:6dc2096f-17d5-4baf-9dda-181c746d8e45&page=queryresults
[0m10:12:10.870500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06f1f7cc-391b-4b67-98d6-86b433400a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b9fec3f40>]}
[0m10:12:10.872815 [info ] [Thread-1 (]: 1 of 1 OK snapshotted olist_data_snapshots.customer_snapshot ................... [[32mMERGE (0.0 rows, 14.3 MiB processed)[0m in 12.42s]
[0m10:12:10.873686 [debug] [Thread-1 (]: Finished running node snapshot.olist_dataset.customer_snapshot
[0m10:12:10.876280 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:12:10.877307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:12:10.877871 [debug] [MainThread]: Connection 'snapshot.olist_dataset.customer_snapshot' was properly closed.
[0m10:12:10.878365 [info ] [MainThread]: 
[0m10:12:10.878956 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 15.42 seconds (15.42s).
[0m10:12:10.880544 [debug] [MainThread]: Command end result
[0m10:12:10.915123 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:12:10.917436 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:12:10.923108 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m10:12:10.923579 [info ] [MainThread]: 
[0m10:12:10.924045 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:12:10.924442 [info ] [MainThread]: 
[0m10:12:10.924916 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:12:10.925585 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 18.055021, "process_in_blocks": "122856", "process_kernel_time": 1.326562, "process_mem_max_rss": "255572", "process_out_blocks": "3192", "process_user_time": 3.949764}
[0m10:12:10.925989 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:12:10.925887 after 18.06 seconds
[0m10:12:10.926366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba0fbde10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba1ff0f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba0ddfb50>]}
[0m10:12:10.926768 [debug] [MainThread]: Flushing usage events
[0m10:12:11.901661 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:12:20.439836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27aee45ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27addc15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27addc1570>]}


============================== 10:12:20.442522 | b7f0b6b0-d759-4772-b004-3e8549800cbe ==============================
[0m10:12:20.442522 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:12:20.443029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models star.dim_customer', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:12:21.359723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7f0b6b0-d759-4772-b004-3e8549800cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27afe83760>]}
[0m10:12:21.426714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7f0b6b0-d759-4772-b004-3e8549800cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27ae426ce0>]}
[0m10:12:21.427803 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:12:21.527610 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:12:21.716915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:12:21.717330 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:12:21.761781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7f0b6b0-d759-4772-b004-3e8549800cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277f9b5030>]}
[0m10:12:21.838636 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:12:21.840149 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:12:21.849647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7f0b6b0-d759-4772-b004-3e8549800cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277fbcc250>]}
[0m10:12:21.850193 [info ] [MainThread]: Found 6 models, 2 snapshots, 9 sources, 491 macros
[0m10:12:21.850561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7f0b6b0-d759-4772-b004-3e8549800cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277fbcdba0>]}
[0m10:12:21.851916 [info ] [MainThread]: 
[0m10:12:21.852306 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:12:21.852595 [info ] [MainThread]: 
[0m10:12:21.853056 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:12:21.854937 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m10:12:21.855728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:12:22.829555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m10:12:22.830747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:12:23.206269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m10:12:23.208207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:12:23.627304 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m10:12:23.628546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:12:23.988537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7f0b6b0-d759-4772-b004-3e8549800cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27add919f0>]}
[0m10:12:23.989761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:12:23.995393 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m10:12:23.996478 [info ] [Thread-1 (]: 1 of 1 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m10:12:23.997419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now model.olist_dataset.dim_customer)
[0m10:12:23.998056 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m10:12:24.017379 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m10:12:24.020747 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m10:12:24.050980 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m10:12:24.051674 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- This is incremental approach
-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 


-- This is snapshot approach, refer to customer_snapshot.sql


SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m10:12:24.052108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:12:24.700333 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:0f7b5777-739e-44bc-857b-c648fd19d133&page=queryresults
[0m10:12:27.582980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7f0b6b0-d759-4772-b004-3e8549800cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277f9921d0>]}
[0m10:12:27.583754 [info ] [Thread-1 (]: 1 of 1 OK created sql table model olist_data_ingestion_dim_tables.dim_customer . [[32mCREATE TABLE (99.4k rows, 9.5 MiB processed)[0m in 3.58s]
[0m10:12:27.584323 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m10:12:27.586614 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:12:27.587404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:12:27.587734 [debug] [MainThread]: Connection 'model.olist_dataset.dim_customer' was properly closed.
[0m10:12:27.588049 [info ] [MainThread]: 
[0m10:12:27.588398 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.74 seconds (5.74s).
[0m10:12:27.589033 [debug] [MainThread]: Command end result
[0m10:12:27.610220 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:12:27.611798 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:12:27.617212 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m10:12:27.617543 [info ] [MainThread]: 
[0m10:12:27.617925 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:12:27.618230 [info ] [MainThread]: 
[0m10:12:27.618514 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:12:27.619100 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.236049, "process_in_blocks": "8", "process_kernel_time": 0.947381, "process_mem_max_rss": "247160", "process_out_blocks": "2152", "process_user_time": 3.739134}
[0m10:12:27.619504 [debug] [MainThread]: Command `dbt run` succeeded at 10:12:27.619407 after 7.24 seconds
[0m10:12:27.619865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27aee45ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27afe83760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277f921270>]}
[0m10:12:27.620231 [debug] [MainThread]: Flushing usage events
[0m10:12:28.587203 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:14:50.577167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a3c5d1e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a3b505540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a3b5054e0>]}


============================== 10:14:50.579842 | cbb38fe6-bb7b-4c0b-bc9e-6413a56c7fb9 ==============================
[0m10:14:50.579842 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:14:50.580332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --select seller_snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:14:51.648467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbb38fe6-bb7b-4c0b-bc9e-6413a56c7fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a0d621810>]}
[0m10:14:51.723448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbb38fe6-bb7b-4c0b-bc9e-6413a56c7fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a3d56e350>]}
[0m10:14:51.724373 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:14:51.830559 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:14:52.020935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:14:52.021457 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:14:52.069704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbb38fe6-bb7b-4c0b-bc9e-6413a56c7fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a0d1b8fd0>]}
[0m10:14:52.152498 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:14:52.154241 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:14:52.165609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbb38fe6-bb7b-4c0b-bc9e-6413a56c7fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a0d682d40>]}
[0m10:14:52.166207 [info ] [MainThread]: Found 6 models, 2 snapshots, 9 sources, 491 macros
[0m10:14:52.166621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbb38fe6-bb7b-4c0b-bc9e-6413a56c7fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a0da49db0>]}
[0m10:14:52.168022 [info ] [MainThread]: 
[0m10:14:52.168453 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:14:52.168793 [info ] [MainThread]: 
[0m10:14:52.169301 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:14:52.170585 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m10:14:52.171433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:14:53.256946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m10:14:53.258566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:14:54.324073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m10:14:54.326372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:14:54.763624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m10:14:54.765192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:14:55.172120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbb38fe6-bb7b-4c0b-bc9e-6413a56c7fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a3d689e70>]}
[0m10:14:55.173476 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:14:55.180904 [debug] [Thread-1 (]: Began running node snapshot.olist_dataset.seller_snapshot
[0m10:14:55.182363 [info ] [Thread-1 (]: 1 of 1 START snapshot olist_data_snapshots.seller_snapshot ..................... [RUN]
[0m10:14:55.183541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now snapshot.olist_dataset.seller_snapshot)
[0m10:14:55.184108 [debug] [Thread-1 (]: Began compiling node snapshot.olist_dataset.seller_snapshot
[0m10:14:55.209216 [debug] [Thread-1 (]: Began executing node snapshot.olist_dataset.seller_snapshot
[0m10:14:55.254823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:14:55.685123 [debug] [Thread-1 (]: On snapshot.olist_dataset.seller_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.seller_snapshot"} */

        
  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        



SELECT
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        seller_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        seller_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(seller_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        seller_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
    
[0m10:14:56.439804 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:7cfa1aa3-74ff-4677-afda-5cfb82d5d919&page=queryresults
[0m10:15:00.069203 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot`".
[0m10:15:01.365097 [debug] [Thread-1 (]: On snapshot.olist_dataset.seller_snapshot: select * from (
        
    
    with snapshot_query as (

        



SELECT
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        seller_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        seller_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(seller_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        seller_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m10:15:02.046737 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:f7460fd8-f566-43dd-b483-4fa103403ed8&page=queryresults
[0m10:15:02.400787 [debug] [Thread-1 (]: On snapshot.olist_dataset.seller_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m10:15:03.091748 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:46565fa1-7d5d-49a2-8b98-62ec5e7647c6&page=queryresults
[0m10:15:03.407638 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.olist_dataset.seller_snapshot"
[0m10:15:03.410072 [debug] [Thread-1 (]: On snapshot.olist_dataset.seller_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.seller_snapshot"} */

      merge into `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot` as DBT_INTERNAL_DEST
    using `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`seller_id`, `seller_zip_code_prefix`, `seller_city`, `seller_state`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`seller_id`, `seller_zip_code_prefix`, `seller_city`, `seller_state`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m10:15:04.087573 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:e1e778a0-044c-4632-89ba-f4e528cb17f2&page=queryresults
[0m10:15:07.024425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbb38fe6-bb7b-4c0b-bc9e-6413a56c7fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a0d1d2ec0>]}
[0m10:15:07.025897 [info ] [Thread-1 (]: 1 of 1 OK snapshotted olist_data_snapshots.seller_snapshot ..................... [[32mMERGE (0.0 rows, 351.1 KiB processed)[0m in 11.84s]
[0m10:15:07.027107 [debug] [Thread-1 (]: Finished running node snapshot.olist_dataset.seller_snapshot
[0m10:15:07.030862 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:15:07.032357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:07.033021 [debug] [MainThread]: Connection 'snapshot.olist_dataset.seller_snapshot' was properly closed.
[0m10:15:07.033660 [info ] [MainThread]: 
[0m10:15:07.034374 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 14.86 seconds (14.86s).
[0m10:15:07.035569 [debug] [MainThread]: Command end result
[0m10:15:07.062930 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:15:07.064802 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:15:07.070486 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m10:15:07.070805 [info ] [MainThread]: 
[0m10:15:07.071211 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:15:07.071500 [info ] [MainThread]: 
[0m10:15:07.071824 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:15:07.072369 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 16.556385, "process_in_blocks": "264", "process_kernel_time": 1.120443, "process_mem_max_rss": "250044", "process_out_blocks": "2160", "process_user_time": 3.794443}
[0m10:15:07.072790 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:15:07.072684 after 16.56 seconds
[0m10:15:07.073166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a3c5d1e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a0d621810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a3c27aa10>]}
[0m10:15:07.073518 [debug] [MainThread]: Flushing usage events
[0m10:15:08.059630 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:16:35.814014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe872311e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe871201540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8712014e0>]}


============================== 10:16:35.816368 | 9e0900ec-5cb1-4817-a29c-f0856d876e64 ==============================
[0m10:16:35.816368 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:16:35.816870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models star.dim_seller', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:16:36.808534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e0900ec-5cb1-4817-a29c-f0856d876e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe843519810>]}
[0m10:16:36.882720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e0900ec-5cb1-4817-a29c-f0856d876e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87328a350>]}
[0m10:16:36.883573 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:16:36.992815 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:16:37.190970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:37.191553 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:37.242082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e0900ec-5cb1-4817-a29c-f0856d876e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe842eb8fd0>]}
[0m10:16:37.329528 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:16:37.331514 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:16:37.343160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e0900ec-5cb1-4817-a29c-f0856d876e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8430d0580>]}
[0m10:16:37.343827 [info ] [MainThread]: Found 6 models, 2 snapshots, 9 sources, 491 macros
[0m10:16:37.344254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e0900ec-5cb1-4817-a29c-f0856d876e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8430d0370>]}
[0m10:16:37.345828 [info ] [MainThread]: 
[0m10:16:37.346364 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:16:37.346704 [info ] [MainThread]: 
[0m10:16:37.347253 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:16:37.348666 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m10:16:37.349563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:38.441586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m10:16:38.443462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:38.946303 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m10:16:38.949069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:39.422701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m10:16:39.426101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:39.823438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e0900ec-5cb1-4817-a29c-f0856d876e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8733c9e70>]}
[0m10:16:39.824522 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:39.831213 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_seller
[0m10:16:39.832537 [info ] [Thread-1 (]: 1 of 1 START sql table model olist_data_ingestion_dim_tables.dim_seller ........ [RUN]
[0m10:16:39.833773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now model.olist_dataset.dim_seller)
[0m10:16:39.834634 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_seller
[0m10:16:39.857332 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_seller"
[0m10:16:39.858131 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_seller
[0m10:16:39.871836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:40.394004 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_seller"
[0m10:16:40.394991 [debug] [Thread-1 (]: On model.olist_dataset.dim_seller: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_seller"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_seller.sql

-- 

-- WITH source AS (
--     SELECT
--         seller_id,
--         seller_zip_code_prefix,
--         seller_city,
--         seller_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`
-- )

-- SELECT * FROM source

-- 



SELECT
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m10:16:41.070250 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:9fe4f728-67d9-4de8-8564-5bd65dd1f29f&page=queryresults
[0m10:16:43.681938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e0900ec-5cb1-4817-a29c-f0856d876e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe842ed2ec0>]}
[0m10:16:43.682805 [info ] [Thread-1 (]: 1 of 1 OK created sql table model olist_data_ingestion_dim_tables.dim_seller ... [[32mCREATE TABLE (3.1k rows, 200.0 KiB processed)[0m in 3.85s]
[0m10:16:43.683450 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_seller
[0m10:16:43.686133 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:43.687449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:43.687876 [debug] [MainThread]: Connection 'model.olist_dataset.dim_seller' was properly closed.
[0m10:16:43.688259 [info ] [MainThread]: 
[0m10:16:43.688622 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.34 seconds (6.34s).
[0m10:16:43.689327 [debug] [MainThread]: Command end result
[0m10:16:43.714714 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:16:43.716491 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:16:43.722869 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m10:16:43.723325 [info ] [MainThread]: 
[0m10:16:43.723778 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:43.724103 [info ] [MainThread]: 
[0m10:16:43.724477 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:16:43.725058 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.969623, "process_in_blocks": "0", "process_kernel_time": 1.32839, "process_mem_max_rss": "249024", "process_out_blocks": "2152", "process_user_time": 3.503632}
[0m10:16:43.725480 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:43.725385 after 7.97 seconds
[0m10:16:43.725890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe872311e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe843519810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe842ee2950>]}
[0m10:16:43.726257 [debug] [MainThread]: Flushing usage events
[0m10:16:44.738068 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:16:49.564110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4352eb9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4351dd54b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4351dd5450>]}


============================== 10:16:49.566523 | 008b9840-965a-44a7-8707-96e66b4537ac ==============================
[0m10:16:49.566523 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:16:49.567052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models star', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:16:50.628980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '008b9840-965a-44a7-8707-96e66b4537ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f435246c0d0>]}
[0m10:16:50.700160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '008b9840-965a-44a7-8707-96e66b4537ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4323f066b0>]}
[0m10:16:50.700973 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:16:50.824982 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:16:51.026433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:51.026873 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:51.074931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '008b9840-965a-44a7-8707-96e66b4537ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4323a68f40>]}
[0m10:16:51.161178 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:16:51.162689 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:16:51.173014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '008b9840-965a-44a7-8707-96e66b4537ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4323a69bd0>]}
[0m10:16:51.173573 [info ] [MainThread]: Found 6 models, 2 snapshots, 9 sources, 491 macros
[0m10:16:51.173953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '008b9840-965a-44a7-8707-96e66b4537ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4323a69b70>]}
[0m10:16:51.175922 [info ] [MainThread]: 
[0m10:16:51.176486 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:16:51.176800 [info ] [MainThread]: 
[0m10:16:51.177309 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:16:51.182167 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m10:16:51.182993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:52.270908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m10:16:52.271808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:52.714462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m10:16:52.716838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:53.127526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m10:16:53.130517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:53.527622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '008b9840-965a-44a7-8707-96e66b4537ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4353f75d80>]}
[0m10:16:53.528962 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:53.535693 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m10:16:53.536853 [info ] [Thread-1 (]: 1 of 4 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m10:16:53.537891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now model.olist_dataset.dim_customer)
[0m10:16:53.538596 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m10:16:53.560144 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m10:16:53.560903 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m10:16:53.573275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:54.042341 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m10:16:54.043282 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- This is incremental approach
-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 


-- This is snapshot approach, refer to customer_snapshot.sql


SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m10:16:54.691557 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d62aa3f2-3c34-4068-97e3-2772e5b408e7&page=queryresults
[0m10:16:58.094346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '008b9840-965a-44a7-8707-96e66b4537ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4351dbff40>]}
[0m10:16:58.095114 [info ] [Thread-1 (]: 1 of 4 OK created sql table model olist_data_ingestion_dim_tables.dim_customer . [[32mCREATE TABLE (99.4k rows, 9.5 MiB processed)[0m in 4.56s]
[0m10:16:58.095758 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m10:16:58.096152 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m10:16:58.096984 [info ] [Thread-1 (]: 2 of 4 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m10:16:58.097556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_customer, now model.olist_dataset.dim_geolocation)
[0m10:16:58.097920 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m10:16:58.104102 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m10:16:58.104912 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m10:16:58.136999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:58.649333 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m10:16:58.650371 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation` as DBT_INTERNAL_DEST
        using (-- models/star/dim_geolocation.sql



WITH source AS (
    SELECT
        geolocation_zip_code_prefix,
        geolocation_city,
        geolocation_state,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source


  WHERE geolocation_zip_code_prefix NOT IN (
      SELECT geolocation_zip_code_prefix FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
  )

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.geolocation_zip_code_prefix = DBT_INTERNAL_DEST.geolocation_zip_code_prefix))

    
    when matched then update set
        `geolocation_zip_code_prefix` = DBT_INTERNAL_SOURCE.`geolocation_zip_code_prefix`,`geolocation_city` = DBT_INTERNAL_SOURCE.`geolocation_city`,`geolocation_state` = DBT_INTERNAL_SOURCE.`geolocation_state`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)
    values
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)


    
[0m10:16:58.047103 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:1338c77d-a2b5-4355-8ade-77a5cc45fc6f&page=queryresults
[0m10:17:18.268904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '008b9840-965a-44a7-8707-96e66b4537ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4323ea2fb0>]}
[0m10:17:18.270132 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[32mMERGE (0.0 rows, 62.1 MiB processed)[0m in 20.17s]
[0m10:17:18.271258 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m10:17:18.273199 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m10:17:18.275811 [info ] [Thread-1 (]: 3 of 4 START sql incremental model olist_data_ingestion_dim_tables.dim_product . [RUN]
[0m10:17:18.278066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_geolocation, now model.olist_dataset.dim_product)
[0m10:17:18.279464 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m10:17:18.290395 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m10:17:18.292731 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m10:17:18.299795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:18.592316 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m10:17:18.593913 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product` as DBT_INTERNAL_DEST
        using (-- models/star/dim_product.sql



WITH source AS (
    SELECT
        product_id,
        product_category_name,
        product_name_lenght,
        product_description_lenght,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
)

SELECT *
FROM source


  WHERE product_id NOT IN (SELECT product_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`)

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id))

    
    when matched then update set
        `product_id` = DBT_INTERNAL_SOURCE.`product_id`,`product_category_name` = DBT_INTERNAL_SOURCE.`product_category_name`,`product_name_lenght` = DBT_INTERNAL_SOURCE.`product_name_lenght`,`product_description_lenght` = DBT_INTERNAL_SOURCE.`product_description_lenght`,`product_photos_qty` = DBT_INTERNAL_SOURCE.`product_photos_qty`,`product_weight_g` = DBT_INTERNAL_SOURCE.`product_weight_g`,`product_length_cm` = DBT_INTERNAL_SOURCE.`product_length_cm`,`product_height_cm` = DBT_INTERNAL_SOURCE.`product_height_cm`,`product_width_cm` = DBT_INTERNAL_SOURCE.`product_width_cm`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`product_id`, `product_category_name`, `product_name_lenght`, `product_description_lenght`, `product_photos_qty`, `product_weight_g`, `product_length_cm`, `product_height_cm`, `product_width_cm`, `last_updated`)
    values
        (`product_id`, `product_category_name`, `product_name_lenght`, `product_description_lenght`, `product_photos_qty`, `product_weight_g`, `product_length_cm`, `product_height_cm`, `product_width_cm`, `last_updated`)


    
[0m10:17:19.171713 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:3e18d08f-b1b2-40c1-a302-bfcee4d436ee&page=queryresults
[0m10:17:21.717003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '008b9840-965a-44a7-8707-96e66b4537ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4323a42650>]}
[0m10:17:21.717627 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model olist_data_ingestion_dim_tables.dim_product  [[32mMERGE (0.0 rows, 7.2 MiB processed)[0m in 3.44s]
[0m10:17:21.718104 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m10:17:21.718436 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_seller
[0m10:17:21.718818 [info ] [Thread-1 (]: 4 of 4 START sql table model olist_data_ingestion_dim_tables.dim_seller ........ [RUN]
[0m10:17:21.719491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_product, now model.olist_dataset.dim_seller)
[0m10:17:21.719780 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_seller
[0m10:17:21.724329 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_seller"
[0m10:17:21.725011 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_seller
[0m10:17:21.727025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:22.032600 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_seller"
[0m10:17:22.034495 [debug] [Thread-1 (]: On model.olist_dataset.dim_seller: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_seller"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_seller.sql

-- 

-- WITH source AS (
--     SELECT
--         seller_id,
--         seller_zip_code_prefix,
--         seller_city,
--         seller_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`
-- )

-- SELECT * FROM source

-- 



SELECT
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m10:17:22.517518 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:3b043a2b-69eb-4f7b-90ea-4d993ddd1376&page=queryresults
[0m10:17:25.046293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '008b9840-965a-44a7-8707-96e66b4537ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43214fda80>]}
[0m10:17:25.047023 [info ] [Thread-1 (]: 4 of 4 OK created sql table model olist_data_ingestion_dim_tables.dim_seller ... [[32mCREATE TABLE (3.1k rows, 200.0 KiB processed)[0m in 3.33s]
[0m10:17:25.047569 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_seller
[0m10:17:25.050199 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:17:25.051280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:25.051661 [debug] [MainThread]: Connection 'model.olist_dataset.dim_seller' was properly closed.
[0m10:17:25.052093 [info ] [MainThread]: 
[0m10:17:25.052436 [info ] [MainThread]: Finished running 2 incremental models, 2 table models in 0 hours 0 minutes and 33.87 seconds (33.87s).
[0m10:17:25.053303 [debug] [MainThread]: Command end result
[0m10:17:25.072213 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:17:25.073992 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:17:25.079328 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m10:17:25.079699 [info ] [MainThread]: 
[0m10:17:25.080050 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:17:25.080324 [info ] [MainThread]: 
[0m10:17:25.080658 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:17:25.081194 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 36.793976, "process_in_blocks": "0", "process_kernel_time": 1.113036, "process_mem_max_rss": "249648", "process_out_blocks": "2248", "process_user_time": 3.441994}
[0m10:17:25.081543 [debug] [MainThread]: Command `dbt run` succeeded at 10:17:25.081460 after 36.79 seconds
[0m10:17:25.081926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4352eb9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f435246c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4352b5eb90>]}
[0m10:17:25.082290 [debug] [MainThread]: Flushing usage events
[0m10:17:26.234522 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:27:51.026315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca7735ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca66795d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca6679570>]}


============================== 10:27:51.032230 | 0e8dea55-b995-48e3-8637-a3a6063f49d5 ==============================
[0m10:27:51.032230 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:27:51.032767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'debug': 'False', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot --select product_snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:27:52.897815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e8dea55-b995-48e3-8637-a3a6063f49d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca89bb760>]}
[0m10:27:52.968874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e8dea55-b995-48e3-8637-a3a6063f49d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca6d0ece0>]}
[0m10:27:52.969651 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:27:53.086016 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:27:53.359160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m10:27:53.359916 [debug] [MainThread]: Partial parsing: added file: olist_dataset://snapshots/product_snapshot.sql
[0m10:27:53.360413 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_seller.sql
[0m10:27:53.360799 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_geolocation.sql
[0m10:27:53.361161 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_product.sql
[0m10:27:53.886054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e8dea55-b995-48e3-8637-a3a6063f49d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c77f32680>]}
[0m10:27:53.966998 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:27:53.970060 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:27:54.006855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e8dea55-b995-48e3-8637-a3a6063f49d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c77eb5840>]}
[0m10:27:54.007500 [info ] [MainThread]: Found 6 models, 3 snapshots, 9 sources, 491 macros
[0m10:27:54.007933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e8dea55-b995-48e3-8637-a3a6063f49d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c78c011e0>]}
[0m10:27:54.009323 [info ] [MainThread]: 
[0m10:27:54.009817 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:27:54.010126 [info ] [MainThread]: 
[0m10:27:54.010623 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:27:54.012092 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m10:27:54.013026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:55.727041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m10:27:55.728587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:56.239668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m10:27:56.241768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:57.530902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m10:27:57.534102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:57.899309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e8dea55-b995-48e3-8637-a3a6063f49d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c7819e230>]}
[0m10:27:57.900964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:27:57.905264 [debug] [Thread-1 (]: Began running node snapshot.olist_dataset.product_snapshot
[0m10:27:57.907041 [info ] [Thread-1 (]: 1 of 1 START snapshot olist_data_snapshots.product_snapshot .................... [RUN]
[0m10:27:57.908100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now snapshot.olist_dataset.product_snapshot)
[0m10:27:57.908940 [debug] [Thread-1 (]: Began compiling node snapshot.olist_dataset.product_snapshot
[0m10:27:57.927912 [debug] [Thread-1 (]: Began executing node snapshot.olist_dataset.product_snapshot
[0m10:27:58.008548 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: select * from (
        
    

    select *,
        to_hex(md5(concat(coalesce(cast(product_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id,
        last_updated as dbt_updated_at,
        last_updated as dbt_valid_from,
        
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
from (
        



SELECT
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`

    ) sbq



    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m10:27:58.009151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:58.689531 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:816d395d-a913-4825-88cd-9cddd1906271&page=queryresults
[0m10:27:59.040988 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m10:27:59.534515 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:2cedd060-b62b-447b-aa13-08407ccd77a8&page=queryresults
[0m10:27:59.873060 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.olist_dataset.product_snapshot"
[0m10:27:59.876478 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.product_snapshot"} */

      
  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
      
    
    

    OPTIONS()
    as (
      
    

    select *,
        to_hex(md5(concat(coalesce(cast(product_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id,
        last_updated as dbt_updated_at,
        last_updated as dbt_valid_from,
        
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
from (
        



SELECT
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`

    ) sbq



    );
  
  
[0m10:28:00.465990 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:e1964af3-9243-4156-bdf9-7a8f702c8706&page=queryresults
[0m10:28:03.505607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e8dea55-b995-48e3-8637-a3a6063f49d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c77f319f0>]}
[0m10:28:03.506655 [info ] [Thread-1 (]: 1 of 1 OK snapshotted olist_data_snapshots.product_snapshot .................... [[32mCREATE TABLE (33.0k rows, 3.6 MiB processed)[0m in 5.60s]
[0m10:28:03.507287 [debug] [Thread-1 (]: Finished running node snapshot.olist_dataset.product_snapshot
[0m10:28:03.509517 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:28:03.510371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:03.510746 [debug] [MainThread]: Connection 'snapshot.olist_dataset.product_snapshot' was properly closed.
[0m10:28:03.511084 [info ] [MainThread]: 
[0m10:28:03.511474 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 9.50 seconds (9.50s).
[0m10:28:03.512186 [debug] [MainThread]: Command end result
[0m10:28:03.532981 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:28:03.534732 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:28:03.540358 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m10:28:03.540748 [info ] [MainThread]: 
[0m10:28:03.541159 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:28:03.541481 [info ] [MainThread]: 
[0m10:28:03.541815 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:28:03.542455 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 12.583228, "process_in_blocks": "122824", "process_kernel_time": 1.469017, "process_mem_max_rss": "265140", "process_out_blocks": "3216", "process_user_time": 4.022994}
[0m10:28:03.542872 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:28:03.542777 after 12.58 seconds
[0m10:28:03.543226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca7735ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca89bb760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca73e0c70>]}
[0m10:28:03.543588 [debug] [MainThread]: Flushing usage events
[0m10:28:04.565585 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:28:11.250950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f360c7b9de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f360b6ed4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f360b6ed480>]}


============================== 10:28:11.253418 | ac2545b9-b7bd-493d-8e01-09c48b4675c1 ==============================
[0m10:28:11.253418 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:28:11.253933 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models star.dim_product', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:28:12.205092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac2545b9-b7bd-493d-8e01-09c48b4675c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f360b6d77c0>]}
[0m10:28:12.273443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac2545b9-b7bd-493d-8e01-09c48b4675c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35dd9e4a60>]}
[0m10:28:12.274211 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:28:12.379481 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:28:12.580184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:28:12.580666 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:28:12.626631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac2545b9-b7bd-493d-8e01-09c48b4675c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35dd389450>]}
[0m10:28:12.705770 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:28:12.707340 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:28:12.717397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac2545b9-b7bd-493d-8e01-09c48b4675c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35dd59d7b0>]}
[0m10:28:12.717952 [info ] [MainThread]: Found 6 models, 3 snapshots, 9 sources, 491 macros
[0m10:28:12.718362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac2545b9-b7bd-493d-8e01-09c48b4675c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35dd59dc00>]}
[0m10:28:12.719756 [info ] [MainThread]: 
[0m10:28:12.720154 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:28:12.720450 [info ] [MainThread]: 
[0m10:28:12.720923 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:28:12.722367 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m10:28:12.723227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:13.753207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m10:28:13.754737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:14.126982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m10:28:14.129582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:14.482056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m10:28:14.483023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:14.842614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac2545b9-b7bd-493d-8e01-09c48b4675c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f360d875d80>]}
[0m10:28:14.843755 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:28:14.849219 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m10:28:14.850402 [info ] [Thread-1 (]: 1 of 1 START sql table model olist_data_ingestion_dim_tables.dim_product ....... [RUN]
[0m10:28:14.851415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now model.olist_dataset.dim_product)
[0m10:28:14.852117 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m10:28:14.872060 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m10:28:14.872736 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m10:28:14.884946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:15.296940 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m10:28:15.297749 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_product.sql

-- This is incremental approach
-- 

-- WITH source AS (
--     SELECT
--         product_id,
--         product_category_name,
--         product_name_lenght,
--         product_description_lenght,
--         product_photos_qty,
--         product_weight_g,
--         product_length_cm,
--         product_height_cm,
--         product_width_cm,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
-- )

-- SELECT * FROM source

-- 

-- This is snapshot approach


SELECT
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    snapshot_created_at AS valid_from,
    snapshot_updated_at AS valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
WHERE snapshot_updated_at IS NULL
    );
  
[0m10:28:15.959187 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:3141401e-6604-46a1-bc70-4877b579c58b&page=queryresults
[0m10:28:16.264469 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:3141401e-6604-46a1-bc70-4877b579c58b&page=queryresults
[0m10:28:16.291451 [debug] [Thread-1 (]: Database Error in model dim_product (models/star/dim_product.sql)
  Unrecognized name: snapshot_updated_at at [53:7]
  compiled code at target/run/olist_dataset/models/star/dim_product.sql
[0m10:28:16.295787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac2545b9-b7bd-493d-8e01-09c48b4675c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f360c7ea230>]}
[0m10:28:16.297086 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model olist_data_ingestion_dim_tables.dim_product  [[31mERROR[0m in 1.44s]
[0m10:28:16.298055 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m10:28:16.299250 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_product' to be skipped because of status 'error'.  Reason: Database Error in model dim_product (models/star/dim_product.sql)
  Unrecognized name: snapshot_updated_at at [53:7]
  compiled code at target/run/olist_dataset/models/star/dim_product.sql.
[0m10:28:16.302343 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:28:16.303196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:16.303590 [debug] [MainThread]: Connection 'model.olist_dataset.dim_product' was properly closed.
[0m10:28:16.303955 [info ] [MainThread]: 
[0m10:28:16.304293 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.58 seconds (3.58s).
[0m10:28:16.304904 [debug] [MainThread]: Command end result
[0m10:28:16.325940 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:28:16.327711 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:28:16.333365 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m10:28:16.333704 [info ] [MainThread]: 
[0m10:28:16.334075 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:28:16.334395 [info ] [MainThread]: 
[0m10:28:16.334755 [error] [MainThread]:   Database Error in model dim_product (models/star/dim_product.sql)
  Unrecognized name: snapshot_updated_at at [53:7]
  compiled code at target/run/olist_dataset/models/star/dim_product.sql
[0m10:28:16.335046 [info ] [MainThread]: 
[0m10:28:16.335339 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:28:16.335849 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.1442566, "process_in_blocks": "584", "process_kernel_time": 1.073337, "process_mem_max_rss": "243340", "process_out_blocks": "2168", "process_user_time": 3.181334}
[0m10:28:16.336334 [debug] [MainThread]: Command `dbt run` failed at 10:28:16.336225 after 5.14 seconds
[0m10:28:16.336777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f360c7b9de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35dd48f2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f360c5dbb20>]}
[0m10:28:16.337164 [debug] [MainThread]: Flushing usage events
[0m10:28:17.295974 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:28:32.142340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b52df1e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b51d31540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b51d314e0>]}


============================== 10:28:32.144635 | 56850cd8-bd58-428a-ace1-dc82b6d7300b ==============================
[0m10:28:32.144635 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:28:32.145133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/kangh/.dbt', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --select product_snapshot customer_snapshot', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:28:33.131495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56850cd8-bd58-428a-ace1-dc82b6d7300b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b52c22b30>]}
[0m10:28:33.199662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56850cd8-bd58-428a-ace1-dc82b6d7300b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b52542c20>]}
[0m10:28:33.200442 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:28:33.303724 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:28:33.488689 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:28:33.489126 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:28:33.534982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56850cd8-bd58-428a-ace1-dc82b6d7300b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b239a5510>]}
[0m10:28:33.613833 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:28:33.615311 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:28:33.625159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56850cd8-bd58-428a-ace1-dc82b6d7300b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b23aae230>]}
[0m10:28:33.625717 [info ] [MainThread]: Found 6 models, 3 snapshots, 9 sources, 491 macros
[0m10:28:33.626086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56850cd8-bd58-428a-ace1-dc82b6d7300b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b282a9de0>]}
[0m10:28:33.627565 [info ] [MainThread]: 
[0m10:28:33.627982 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:28:33.628269 [info ] [MainThread]: 
[0m10:28:33.628735 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:28:33.633886 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m10:28:33.634824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:34.625019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m10:28:34.626047 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:34.962717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m10:28:34.965426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:35.397130 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m10:28:35.399371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:35.739796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56850cd8-bd58-428a-ace1-dc82b6d7300b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b51d3d870>]}
[0m10:28:35.741147 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:28:35.746795 [debug] [Thread-1 (]: Began running node snapshot.olist_dataset.customer_snapshot
[0m10:28:35.747726 [info ] [Thread-1 (]: 1 of 2 START snapshot olist_data_snapshots.customer_snapshot ................... [RUN]
[0m10:28:35.748607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now snapshot.olist_dataset.customer_snapshot)
[0m10:28:35.749167 [debug] [Thread-1 (]: Began compiling node snapshot.olist_dataset.customer_snapshot
[0m10:28:35.761087 [debug] [Thread-1 (]: Began executing node snapshot.olist_dataset.customer_snapshot
[0m10:28:35.794327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:36.223775 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.customer_snapshot"} */

        
  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
    
[0m10:28:36.814782 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:92b18229-0f66-48de-a2ff-dfec719a7082&page=queryresults
[0m10:28:40.103283 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`".
[0m10:28:41.268968 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        
    
    with snapshot_query as (

        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m10:28:41.847474 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:e4096bd0-3d5f-40bf-a0f6-752e6d575bb8&page=queryresults
[0m10:28:42.206828 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m10:28:42.753183 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:11097e0b-d6a4-4d5c-a28d-c846ddf86921&page=queryresults
[0m10:28:43.112197 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.olist_dataset.customer_snapshot"
[0m10:28:43.113299 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.customer_snapshot"} */

      merge into `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot` as DBT_INTERNAL_DEST
    using `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`customer_id`, `customer_unique_id`, `customer_zip_code_prefix`, `customer_city`, `customer_state`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`customer_id`, `customer_unique_id`, `customer_zip_code_prefix`, `customer_city`, `customer_state`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m10:28:43.741533 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:6b997814-9cdb-4816-96ce-eb206201556e&page=queryresults
[0m10:28:46.672472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56850cd8-bd58-428a-ace1-dc82b6d7300b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b239a7130>]}
[0m10:28:46.673344 [info ] [Thread-1 (]: 1 of 2 OK snapshotted olist_data_snapshots.customer_snapshot ................... [[32mMERGE (0.0 rows, 14.3 MiB processed)[0m in 10.92s]
[0m10:28:46.673995 [debug] [Thread-1 (]: Finished running node snapshot.olist_dataset.customer_snapshot
[0m10:28:46.674376 [debug] [Thread-1 (]: Began running node snapshot.olist_dataset.product_snapshot
[0m10:28:46.674821 [info ] [Thread-1 (]: 2 of 2 START snapshot olist_data_snapshots.product_snapshot .................... [RUN]
[0m10:28:46.675577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.olist_dataset.customer_snapshot, now snapshot.olist_dataset.product_snapshot)
[0m10:28:46.676206 [debug] [Thread-1 (]: Began compiling node snapshot.olist_dataset.product_snapshot
[0m10:28:46.684307 [debug] [Thread-1 (]: Began executing node snapshot.olist_dataset.product_snapshot
[0m10:28:46.691302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:47.040882 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.product_snapshot"} */

        
  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        



SELECT
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        product_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(product_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
    
[0m10:28:47.652907 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:01a3f935-8a04-41ec-8d18-5ef1c4eb44ee&page=queryresults
[0m10:28:51.020335 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`".
[0m10:28:52.364997 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: select * from (
        
    
    with snapshot_query as (

        



SELECT
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        product_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(product_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m10:28:52.949330 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:f8c8f04d-b6d6-4402-b908-4486359c1ec3&page=queryresults
[0m10:28:53.289887 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m10:28:52.029572 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:13b5f2bf-b222-489c-af74-73c62dea0a08&page=queryresults
[0m10:28:52.339865 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.olist_dataset.product_snapshot"
[0m10:28:52.341343 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.product_snapshot"} */

      merge into `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot` as DBT_INTERNAL_DEST
    using `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`product_id`, `product_category_name`, `product_name_lenght`, `product_description_lenght`, `product_photos_qty`, `product_weight_g`, `product_length_cm`, `product_height_cm`, `product_width_cm`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`product_id`, `product_category_name`, `product_name_lenght`, `product_description_lenght`, `product_photos_qty`, `product_weight_g`, `product_length_cm`, `product_height_cm`, `product_width_cm`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m10:28:52.919833 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:305638c3-2f0d-4f24-a296-259859631e2d&page=queryresults
[0m10:28:55.251845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56850cd8-bd58-428a-ace1-dc82b6d7300b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b239a62f0>]}
[0m10:28:55.254283 [info ] [Thread-1 (]: 2 of 2 OK snapshotted olist_data_snapshots.product_snapshot .................... [[32mMERGE (0.0 rows, 5.2 MiB processed)[0m in 8.58s]
[0m10:28:55.256690 [debug] [Thread-1 (]: Finished running node snapshot.olist_dataset.product_snapshot
[0m10:28:55.260502 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:28:55.263504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:55.263980 [debug] [MainThread]: Connection 'snapshot.olist_dataset.product_snapshot' was properly closed.
[0m10:28:55.264487 [info ] [MainThread]: 
[0m10:28:55.265488 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 21.64 seconds (21.64s).
[0m10:28:55.268990 [debug] [MainThread]: Command end result
[0m10:28:55.314368 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:28:55.317473 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:28:55.326437 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m10:28:55.327260 [info ] [MainThread]: 
[0m10:28:55.327916 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:28:55.328762 [info ] [MainThread]: 
[0m10:28:55.329993 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m10:28:55.331015 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 25.016048, "process_in_blocks": "0", "process_kernel_time": 1.141718, "process_mem_max_rss": "248432", "process_out_blocks": "2208", "process_user_time": 3.639838}
[0m10:28:55.332111 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:28:55.331743 after 25.02 seconds
[0m10:28:55.332899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b52df1e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b52aa5840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b522d4550>]}
[0m10:28:55.333413 [debug] [MainThread]: Flushing usage events
[0m10:28:56.313320 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:29:28.724187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5ec95e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5dbcd540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5dbcd4e0>]}


============================== 10:29:28.726623 | 2ed2bc16-4e53-4210-b7e0-081ddb02b086 ==============================
[0m10:29:28.726623 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:29:28.727151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/kangh/.dbt', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models star.dim_product', 'send_anonymous_usage_stats': 'True'}
[0m10:29:29.773992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ed2bc16-4e53-4210-b7e0-081ddb02b086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5e938d90>]}
[0m10:29:29.842322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ed2bc16-4e53-4210-b7e0-081ddb02b086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5dbe3400>]}
[0m10:29:29.843063 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:29:29.944278 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:29:30.134507 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:29:30.135227 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_product.sql
[0m10:29:30.423280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ed2bc16-4e53-4210-b7e0-081ddb02b086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2f5844f0>]}
[0m10:29:30.499855 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:29:30.501333 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:29:30.511511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ed2bc16-4e53-4210-b7e0-081ddb02b086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2f9ff880>]}
[0m10:29:30.512038 [info ] [MainThread]: Found 6 models, 3 snapshots, 9 sources, 491 macros
[0m10:29:30.512406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ed2bc16-4e53-4210-b7e0-081ddb02b086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2f7a80a0>]}
[0m10:29:30.513628 [info ] [MainThread]: 
[0m10:29:30.514020 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:29:30.514318 [info ] [MainThread]: 
[0m10:29:30.514805 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:29:30.517081 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m10:29:30.517958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:31.519138 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m10:29:31.520549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:31.884488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m10:29:31.886745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:32.271979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m10:29:32.274271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:32.678058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ed2bc16-4e53-4210-b7e0-081ddb02b086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5fd55e70>]}
[0m10:29:32.679316 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:32.684916 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m10:29:32.686031 [info ] [Thread-1 (]: 1 of 1 START sql table model olist_data_ingestion_dim_tables.dim_product ....... [RUN]
[0m10:29:32.687122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now model.olist_dataset.dim_product)
[0m10:29:32.687798 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m10:29:32.700800 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m10:29:32.701472 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m10:29:32.713336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:33.290172 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m10:29:33.292184 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_product.sql

-- This is incremental approach
-- 

-- WITH source AS (
--     SELECT
--         product_id,
--         product_category_name,
--         product_name_lenght,
--         product_description_lenght,
--         product_photos_qty,
--         product_weight_g,
--         product_length_cm,
--         product_height_cm,
--         product_width_cm,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
-- )

-- SELECT * FROM source

-- 

-- This is snapshot approach


SELECT
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
WHERE snapshot_updated_at IS NULL
    );
  
[0m10:29:33.887844 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:3b4915ce-3c53-4bf5-b415-48ae5386353e&page=queryresults
[0m10:29:34.179221 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:3b4915ce-3c53-4bf5-b415-48ae5386353e&page=queryresults
[0m10:29:34.183244 [debug] [Thread-1 (]: Database Error in model dim_product (models/star/dim_product.sql)
  Unrecognized name: snapshot_updated_at at [53:7]
  compiled code at target/run/olist_dataset/models/star/dim_product.sql
[0m10:29:34.185020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed2bc16-4e53-4210-b7e0-081ddb02b086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5ecd1d20>]}
[0m10:29:34.185737 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model olist_data_ingestion_dim_tables.dim_product  [[31mERROR[0m in 1.50s]
[0m10:29:34.186383 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m10:29:34.187046 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_product' to be skipped because of status 'error'.  Reason: Database Error in model dim_product (models/star/dim_product.sql)
  Unrecognized name: snapshot_updated_at at [53:7]
  compiled code at target/run/olist_dataset/models/star/dim_product.sql.
[0m10:29:34.191623 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:34.193358 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:34.194055 [debug] [MainThread]: Connection 'model.olist_dataset.dim_product' was properly closed.
[0m10:29:34.194752 [info ] [MainThread]: 
[0m10:29:34.195448 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.68 seconds (3.68s).
[0m10:29:34.196701 [debug] [MainThread]: Command end result
[0m10:29:34.223261 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:29:34.227289 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:29:34.239880 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m10:29:34.240713 [info ] [MainThread]: 
[0m10:29:34.241622 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:29:34.242277 [info ] [MainThread]: 
[0m10:29:34.242665 [error] [MainThread]:   Database Error in model dim_product (models/star/dim_product.sql)
  Unrecognized name: snapshot_updated_at at [53:7]
  compiled code at target/run/olist_dataset/models/star/dim_product.sql
[0m10:29:34.242974 [info ] [MainThread]: 
[0m10:29:34.243316 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:29:34.243853 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.5789, "process_in_blocks": "0", "process_kernel_time": 1.065961, "process_mem_max_rss": "255500", "process_out_blocks": "3224", "process_user_time": 3.716196}
[0m10:29:34.244256 [debug] [MainThread]: Command `dbt run` failed at 10:29:34.244161 after 5.58 seconds
[0m10:29:34.244642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5ec95e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2fc61030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5f9cece0>]}
[0m10:29:34.245047 [debug] [MainThread]: Flushing usage events
[0m10:29:35.251957 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:30:58.132368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc839425ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83836d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83836d570>]}


============================== 10:30:58.136913 | 5429292c-cb83-4e0b-9baf-24cf1e794bcf ==============================
[0m10:30:58.136913 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:30:58.137462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'profiles_dir': '/home/kangh/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --select product_snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:31:00.061049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5429292c-cb83-4e0b-9baf-24cf1e794bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc80a52d690>]}
[0m10:31:00.133956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5429292c-cb83-4e0b-9baf-24cf1e794bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8385df8b0>]}
[0m10:31:00.134792 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:31:00.256816 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:31:00.560505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:31:00.561057 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:31:00.608318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5429292c-cb83-4e0b-9baf-24cf1e794bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc80a015540>]}
[0m10:31:00.690348 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:31:00.694332 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:31:00.720992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5429292c-cb83-4e0b-9baf-24cf1e794bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc80a1166b0>]}
[0m10:31:00.721608 [info ] [MainThread]: Found 6 models, 3 snapshots, 9 sources, 491 macros
[0m10:31:00.721990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5429292c-cb83-4e0b-9baf-24cf1e794bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc80a8ad1b0>]}
[0m10:31:00.723264 [info ] [MainThread]: 
[0m10:31:00.723657 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:31:00.723955 [info ] [MainThread]: 
[0m10:31:00.724430 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:31:00.725677 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m10:31:00.726603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:31:02.408749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m10:31:02.410018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:31:02.778400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m10:31:02.780244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:31:03.159246 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m10:31:03.160388 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:31:03.528338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5429292c-cb83-4e0b-9baf-24cf1e794bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83a4cf820>]}
[0m10:31:03.529645 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:31:03.536130 [debug] [Thread-1 (]: Began running node snapshot.olist_dataset.product_snapshot
[0m10:31:03.536949 [info ] [Thread-1 (]: 1 of 1 START snapshot olist_data_snapshots.product_snapshot .................... [RUN]
[0m10:31:03.538079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now snapshot.olist_dataset.product_snapshot)
[0m10:31:03.538738 [debug] [Thread-1 (]: Began compiling node snapshot.olist_dataset.product_snapshot
[0m10:31:03.550288 [debug] [Thread-1 (]: Began executing node snapshot.olist_dataset.product_snapshot
[0m10:31:03.581310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:31:04.004506 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.product_snapshot"} */

        
  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        



SELECT
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        product_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(product_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
    
[0m10:31:05.101055 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:ebd62355-39ed-495c-a7e7-92db49643de1&page=queryresults
[0m10:31:08.772432 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`".
[0m10:31:10.141544 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: select * from (
        
    
    with snapshot_query as (

        



SELECT
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        product_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(product_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m10:31:10.906125 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:bb26b881-a5f9-4c31-8d90-3f8065c1ce4f&page=queryresults
[0m10:31:11.224832 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m10:31:11.740943 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:f088ef74-3a02-47e3-9261-c7bdb3c50d9b&page=queryresults
[0m10:31:12.060733 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.olist_dataset.product_snapshot"
[0m10:31:12.066447 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.product_snapshot"} */

      merge into `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot` as DBT_INTERNAL_DEST
    using `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`product_id`, `product_category_name`, `product_name_lenght`, `product_description_lenght`, `product_photos_qty`, `product_weight_g`, `product_length_cm`, `product_height_cm`, `product_width_cm`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`product_id`, `product_category_name`, `product_name_lenght`, `product_description_lenght`, `product_photos_qty`, `product_weight_g`, `product_length_cm`, `product_height_cm`, `product_width_cm`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m10:31:12.624454 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:fa82ec9a-5d01-4709-a717-d10d1d185310&page=queryresults
[0m10:31:15.208406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5429292c-cb83-4e0b-9baf-24cf1e794bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc80a02e260>]}
[0m10:31:15.210237 [info ] [Thread-1 (]: 1 of 1 OK snapshotted olist_data_snapshots.product_snapshot .................... [[32mMERGE (0.0 rows, 5.2 MiB processed)[0m in 11.67s]
[0m10:31:15.211509 [debug] [Thread-1 (]: Finished running node snapshot.olist_dataset.product_snapshot
[0m10:31:15.215888 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:31:15.217659 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:31:15.218509 [debug] [MainThread]: Connection 'snapshot.olist_dataset.product_snapshot' was properly closed.
[0m10:31:15.219299 [info ] [MainThread]: 
[0m10:31:15.220157 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 14.49 seconds (14.49s).
[0m10:31:15.221648 [debug] [MainThread]: Command end result
[0m10:31:15.248245 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:31:15.250158 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:31:15.255837 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m10:31:15.256151 [info ] [MainThread]: 
[0m10:31:15.256550 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:31:15.256851 [info ] [MainThread]: 
[0m10:31:15.257214 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:31:15.257769 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 17.192602, "process_in_blocks": "122616", "process_kernel_time": 1.428027, "process_mem_max_rss": "255664", "process_out_blocks": "2176", "process_user_time": 3.616073}
[0m10:31:15.258187 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:31:15.258097 after 17.19 seconds
[0m10:31:15.258532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc839425ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc80a52d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8390d4c70>]}
[0m10:31:15.258876 [debug] [MainThread]: Flushing usage events
[0m10:31:16.240681 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:31:26.607923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aef2ddd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aee4a5480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aee4a5420>]}


============================== 10:31:26.611572 | 62d59157-0b7e-45f7-9b26-32a5591078f3 ==============================
[0m10:31:26.611572 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:31:26.612288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'profiles_dir': '/home/kangh/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models star.dim_product', 'send_anonymous_usage_stats': 'True'}
[0m10:31:27.598807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62d59157-0b7e-45f7-9b26-32a5591078f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac069d240>]}
[0m10:31:27.664397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62d59157-0b7e-45f7-9b26-32a5591078f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac04f1690>]}
[0m10:31:27.665178 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:31:27.764236 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:31:27.944580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:31:27.945018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:31:27.988777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62d59157-0b7e-45f7-9b26-32a5591078f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac017d420>]}
[0m10:31:28.065267 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:31:28.067669 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:31:28.078412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62d59157-0b7e-45f7-9b26-32a5591078f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac017d780>]}
[0m10:31:28.078967 [info ] [MainThread]: Found 6 models, 3 snapshots, 9 sources, 491 macros
[0m10:31:28.079348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62d59157-0b7e-45f7-9b26-32a5591078f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac017d810>]}
[0m10:31:28.080676 [info ] [MainThread]: 
[0m10:31:28.081086 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:31:28.081390 [info ] [MainThread]: 
[0m10:31:28.081882 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:31:28.083139 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m10:31:28.083935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:31:29.055525 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m10:31:29.057011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:31:28.135097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m10:31:28.137204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:31:28.499271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m10:31:28.501327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:31:28.866726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62d59157-0b7e-45f7-9b26-32a5591078f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aee4b4790>]}
[0m10:31:28.867953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:31:28.873983 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m10:31:28.875047 [info ] [Thread-1 (]: 1 of 1 START sql table model olist_data_ingestion_dim_tables.dim_product ....... [RUN]
[0m10:31:28.876043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now model.olist_dataset.dim_product)
[0m10:31:28.876678 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m10:31:28.896279 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m10:31:28.897127 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m10:31:28.927543 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m10:31:28.928311 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_product.sql

-- This is incremental approach
-- 

-- WITH source AS (
--     SELECT
--         product_id,
--         product_category_name,
--         product_name_lenght,
--         product_description_lenght,
--         product_photos_qty,
--         product_weight_g,
--         product_length_cm,
--         product_height_cm,
--         product_width_cm,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
-- )

-- SELECT * FROM source

-- 

-- This is snapshot approach


SELECT
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
WHERE snapshot_updated_at IS NULL
    );
  
[0m10:31:28.928774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:31:29.609169 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:71d4e4e4-bea3-4dd4-8522-3c5372da4b6b&page=queryresults
[0m10:31:29.928167 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:71d4e4e4-bea3-4dd4-8522-3c5372da4b6b&page=queryresults
[0m10:31:29.959912 [debug] [Thread-1 (]: Database Error in model dim_product (models/star/dim_product.sql)
  Unrecognized name: snapshot_updated_at at [53:7]
  compiled code at target/run/olist_dataset/models/star/dim_product.sql
[0m10:31:29.964391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62d59157-0b7e-45f7-9b26-32a5591078f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aef9847c0>]}
[0m10:31:29.966089 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model olist_data_ingestion_dim_tables.dim_product  [[31mERROR[0m in 1.09s]
[0m10:31:29.967242 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m10:31:29.968304 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_product' to be skipped because of status 'error'.  Reason: Database Error in model dim_product (models/star/dim_product.sql)
  Unrecognized name: snapshot_updated_at at [53:7]
  compiled code at target/run/olist_dataset/models/star/dim_product.sql.
[0m10:31:29.972758 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:31:29.973837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:31:29.974329 [debug] [MainThread]: Connection 'model.olist_dataset.dim_product' was properly closed.
[0m10:31:29.974741 [info ] [MainThread]: 
[0m10:31:29.975165 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m10:31:29.975877 [debug] [MainThread]: Command end result
[0m10:31:29.997085 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:31:29.998748 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:31:30.004494 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m10:31:30.004891 [info ] [MainThread]: 
[0m10:31:30.005298 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:31:30.005627 [info ] [MainThread]: 
[0m10:31:30.005971 [error] [MainThread]:   Database Error in model dim_product (models/star/dim_product.sql)
  Unrecognized name: snapshot_updated_at at [53:7]
  compiled code at target/run/olist_dataset/models/star/dim_product.sql
[0m10:31:30.006252 [info ] [MainThread]: 
[0m10:31:30.006549 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:31:30.007094 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.80769, "process_in_blocks": "592", "process_kernel_time": 1.211378, "process_mem_max_rss": "248596", "process_out_blocks": "2176", "process_user_time": 3.533187}
[0m10:31:30.007478 [debug] [MainThread]: Command `dbt run` failed at 10:31:30.007391 after 4.81 seconds
[0m10:31:30.007853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aef2ddd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac017f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac017faf0>]}
[0m10:31:30.008231 [debug] [MainThread]: Flushing usage events
[0m10:31:31.049947 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:35:02.488446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2894695e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28936a94b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28936a9450>]}


============================== 10:35:02.490933 | 206f3ac6-f1f2-4825-a599-46f9e3122da9 ==============================
[0m10:35:02.490933 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:35:02.491548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/kangh/.dbt', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --select product_snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:35:03.508361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '206f3ac6-f1f2-4825-a599-46f9e3122da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28957c4f70>]}
[0m10:35:03.585285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '206f3ac6-f1f2-4825-a599-46f9e3122da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28936b73d0>]}
[0m10:35:03.586270 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:35:03.691944 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:35:03.884708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:35:03.885214 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:35:03.941708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '206f3ac6-f1f2-4825-a599-46f9e3122da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28653494e0>]}
[0m10:35:04.030542 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:35:04.032722 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:35:04.045380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '206f3ac6-f1f2-4825-a599-46f9e3122da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f286544e1d0>]}
[0m10:35:04.046067 [info ] [MainThread]: Found 6 models, 3 snapshots, 9 sources, 491 macros
[0m10:35:04.046520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '206f3ac6-f1f2-4825-a599-46f9e3122da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2865be5d80>]}
[0m10:35:04.048103 [info ] [MainThread]: 
[0m10:35:04.048620 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:35:04.048930 [info ] [MainThread]: 
[0m10:35:04.049436 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:35:04.050603 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m10:35:04.051071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:05.168552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m10:35:05.170326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:05.533201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m10:35:05.534121 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:05.885651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m10:35:05.886583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:06.256827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '206f3ac6-f1f2-4825-a599-46f9e3122da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2895849d80>]}
[0m10:35:06.258531 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:35:06.263533 [debug] [Thread-1 (]: Began running node snapshot.olist_dataset.product_snapshot
[0m10:35:06.264360 [info ] [Thread-1 (]: 1 of 1 START snapshot olist_data_snapshots.product_snapshot .................... [RUN]
[0m10:35:06.265119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now snapshot.olist_dataset.product_snapshot)
[0m10:35:06.265690 [debug] [Thread-1 (]: Began compiling node snapshot.olist_dataset.product_snapshot
[0m10:35:06.283880 [debug] [Thread-1 (]: Began executing node snapshot.olist_dataset.product_snapshot
[0m10:35:06.324959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:06.794352 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.product_snapshot"} */

        
  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        



SELECT
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        product_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(product_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
    
[0m10:35:07.454662 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:0a248312-108a-4280-a030-4d4e127aa2f4&page=queryresults
[0m10:35:11.318287 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`".
[0m10:35:11.637015 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: select * from (
        
    
    with snapshot_query as (

        



SELECT
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        product_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(product_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m10:35:12.211588 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:7f3f2866-6d72-4ab6-8c79-3d62d0880f5d&page=queryresults
[0m10:35:12.550169 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m10:35:13.070422 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:b6184d45-e895-44ec-a145-67f20cb8df33&page=queryresults
[0m10:35:13.392154 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.olist_dataset.product_snapshot"
[0m10:35:13.393874 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.product_snapshot"} */

      merge into `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot` as DBT_INTERNAL_DEST
    using `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`product_id`, `product_category_name`, `product_name_lenght`, `product_description_lenght`, `product_photos_qty`, `product_weight_g`, `product_length_cm`, `product_height_cm`, `product_width_cm`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`product_id`, `product_category_name`, `product_name_lenght`, `product_description_lenght`, `product_photos_qty`, `product_weight_g`, `product_length_cm`, `product_height_cm`, `product_width_cm`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m10:35:13.889095 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:10d4b140-55b8-4c5c-9804-abb945eb2cc3&page=queryresults
[0m10:35:16.338910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '206f3ac6-f1f2-4825-a599-46f9e3122da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f286532d810>]}
[0m10:35:16.339857 [info ] [Thread-1 (]: 1 of 1 OK snapshotted olist_data_snapshots.product_snapshot .................... [[32mMERGE (0.0 rows, 5.2 MiB processed)[0m in 10.07s]
[0m10:35:16.340481 [debug] [Thread-1 (]: Finished running node snapshot.olist_dataset.product_snapshot
[0m10:35:16.344503 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:35:16.346156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:35:16.346963 [debug] [MainThread]: Connection 'snapshot.olist_dataset.product_snapshot' was properly closed.
[0m10:35:16.347785 [info ] [MainThread]: 
[0m10:35:16.348585 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 12.30 seconds (12.30s).
[0m10:35:16.350124 [debug] [MainThread]: Command end result
[0m10:35:16.377361 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:35:16.379278 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:35:16.385024 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m10:35:16.385408 [info ] [MainThread]: 
[0m10:35:16.385861 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:35:16.386184 [info ] [MainThread]: 
[0m10:35:16.386501 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:35:16.387035 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 14.845428, "process_in_blocks": "0", "process_kernel_time": 1.228255, "process_mem_max_rss": "252040", "process_out_blocks": "2176", "process_user_time": 3.615429}
[0m10:35:16.387516 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:35:16.387418 after 14.85 seconds
[0m10:35:16.387904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2894695e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28957c4f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2894412b90>]}
[0m10:35:16.388264 [debug] [MainThread]: Flushing usage events
[0m10:35:17.388782 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:35:56.937416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60c8c1de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60c7c014b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60c7c01450>]}


============================== 10:35:56.939887 | c8d5f53c-bbb3-4072-a62a-b3ac049acbda ==============================
[0m10:35:56.939887 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:35:56.940364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models star.dim_product', 'send_anonymous_usage_stats': 'True'}
[0m10:35:57.984021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8d5f53c-bbb3-4072-a62a-b3ac049acbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60c9d48f70>]}
[0m10:35:58.056071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8d5f53c-bbb3-4072-a62a-b3ac049acbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60c7c3f3d0>]}
[0m10:35:58.056889 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:35:58.170765 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:35:58.370409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:35:58.370860 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:35:58.418486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8d5f53c-bbb3-4072-a62a-b3ac049acbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60999014e0>]}
[0m10:35:58.500214 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:35:58.501755 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:35:58.511901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8d5f53c-bbb3-4072-a62a-b3ac049acbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6099902380>]}
[0m10:35:58.512460 [info ] [MainThread]: Found 6 models, 3 snapshots, 9 sources, 491 macros
[0m10:35:58.512870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8d5f53c-bbb3-4072-a62a-b3ac049acbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6099902440>]}
[0m10:35:58.514228 [info ] [MainThread]: 
[0m10:35:58.514656 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:35:58.514986 [info ] [MainThread]: 
[0m10:35:58.515566 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:35:58.516686 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m10:35:58.517095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:59.568950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m10:35:59.570431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:59.929017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m10:35:59.931803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:36:00.329440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m10:36:00.331064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:36:00.806406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8d5f53c-bbb3-4072-a62a-b3ac049acbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60c9dcdd80>]}
[0m10:36:00.807667 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:36:00.813881 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m10:36:00.815148 [info ] [Thread-1 (]: 1 of 1 START sql table model olist_data_ingestion_dim_tables.dim_product ....... [RUN]
[0m10:36:00.816361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now model.olist_dataset.dim_product)
[0m10:36:00.817139 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m10:36:00.840395 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m10:36:00.841105 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m10:36:00.873742 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m10:36:00.874529 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_product.sql

-- This is incremental approach
-- 

-- WITH source AS (
--     SELECT
--         product_id,
--         product_category_name,
--         product_name_lenght,
--         product_description_lenght,
--         product_photos_qty,
--         product_weight_g,
--         product_length_cm,
--         product_height_cm,
--         product_width_cm,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
-- )

-- SELECT * FROM source

-- 

-- This is snapshot approach


SELECT
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
WHERE snapshot_updated_at IS NULL
    );
  
[0m10:36:00.875030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:36:01.530298 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:2cdf975a-b571-4cc9-a5b2-6df6981c6fdc&page=queryresults
[0m10:36:01.880864 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:2cdf975a-b571-4cc9-a5b2-6df6981c6fdc&page=queryresults
[0m10:36:01.887519 [debug] [Thread-1 (]: Database Error in model dim_product (models/star/dim_product.sql)
  Unrecognized name: snapshot_updated_at at [53:7]
  compiled code at target/run/olist_dataset/models/star/dim_product.sql
[0m10:36:01.891789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8d5f53c-bbb3-4072-a62a-b3ac049acbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f609991b160>]}
[0m10:36:01.893322 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model olist_data_ingestion_dim_tables.dim_product  [[31mERROR[0m in 1.07s]
[0m10:36:01.894599 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m10:36:01.896133 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_product' to be skipped because of status 'error'.  Reason: Database Error in model dim_product (models/star/dim_product.sql)
  Unrecognized name: snapshot_updated_at at [53:7]
  compiled code at target/run/olist_dataset/models/star/dim_product.sql.
[0m10:36:01.900068 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:36:01.901398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:36:01.902051 [debug] [MainThread]: Connection 'model.olist_dataset.dim_product' was properly closed.
[0m10:36:01.902663 [info ] [MainThread]: 
[0m10:36:01.903368 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.39 seconds (3.39s).
[0m10:36:01.904639 [debug] [MainThread]: Command end result
[0m10:36:01.932480 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:36:01.934130 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:36:01.939837 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m10:36:01.940225 [info ] [MainThread]: 
[0m10:36:01.940599 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:36:01.940916 [info ] [MainThread]: 
[0m10:36:01.941260 [error] [MainThread]:   Database Error in model dim_product (models/star/dim_product.sql)
  Unrecognized name: snapshot_updated_at at [53:7]
  compiled code at target/run/olist_dataset/models/star/dim_product.sql
[0m10:36:01.941534 [info ] [MainThread]: 
[0m10:36:01.941826 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:36:01.942358 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.0673103, "process_in_blocks": "0", "process_kernel_time": 1.102341, "process_mem_max_rss": "240972", "process_out_blocks": "2176", "process_user_time": 3.447153}
[0m10:36:01.942755 [debug] [MainThread]: Command `dbt run` failed at 10:36:01.942664 after 5.07 seconds
[0m10:36:01.943115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60c8c1de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6099a071c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6099901c90>]}
[0m10:36:01.943485 [debug] [MainThread]: Flushing usage events
[0m10:36:02.982697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:37:58.012808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8778705e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8777645540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87776454e0>]}


============================== 10:37:58.015273 | 4556bbf9-b175-4f2e-8f99-cfda25c36896 ==============================
[0m10:37:58.015273 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:37:58.015791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'profiles_dir': '/home/kangh/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot --select product_snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:37:59.014431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4556bbf9-b175-4f2e-8f99-cfda25c36896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8779748f40>]}
[0m10:37:59.083050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4556bbf9-b175-4f2e-8f99-cfda25c36896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8777c88cd0>]}
[0m10:37:59.083805 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:37:59.190218 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:37:59.388296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:37:59.388841 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:37:59.437937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4556bbf9-b175-4f2e-8f99-cfda25c36896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87493014e0>]}
[0m10:37:59.522106 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:37:59.524863 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:37:59.538165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4556bbf9-b175-4f2e-8f99-cfda25c36896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f874940a500>]}
[0m10:37:59.539100 [info ] [MainThread]: Found 6 models, 3 snapshots, 9 sources, 491 macros
[0m10:37:59.539485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4556bbf9-b175-4f2e-8f99-cfda25c36896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8749bbcfd0>]}
[0m10:37:59.541081 [info ] [MainThread]: 
[0m10:37:59.541545 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:37:59.541880 [info ] [MainThread]: 
[0m10:37:59.542437 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:37:59.543829 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m10:37:59.544532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:00.675304 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m10:38:00.676922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:01.060176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m10:38:01.063769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:01.412934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m10:38:01.415022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:01.847604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4556bbf9-b175-4f2e-8f99-cfda25c36896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87797c9e70>]}
[0m10:38:01.849052 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:38:01.859596 [debug] [Thread-1 (]: Began running node snapshot.olist_dataset.product_snapshot
[0m10:38:01.860661 [info ] [Thread-1 (]: 1 of 1 START snapshot olist_data_snapshots.product_snapshot .................... [RUN]
[0m10:38:01.861628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now snapshot.olist_dataset.product_snapshot)
[0m10:38:01.862235 [debug] [Thread-1 (]: Began compiling node snapshot.olist_dataset.product_snapshot
[0m10:38:01.876068 [debug] [Thread-1 (]: Began executing node snapshot.olist_dataset.product_snapshot
[0m10:38:01.912138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:02.357790 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.product_snapshot"} */

        
  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        



SELECT
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        product_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(product_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
    
[0m10:38:02.954223 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:45c43695-3280-49af-9a92-5c2109fdb79b&page=queryresults
[0m10:38:08.762246 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`".
[0m10:38:10.013286 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: select * from (
        
    
    with snapshot_query as (

        



SELECT
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        product_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(product_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m10:38:10.725627 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:445da952-e320-4eca-8824-2eddb1172959&page=queryresults
[0m10:38:11.101647 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m10:38:11.577638 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:076d1bf5-e6d9-46dc-9371-07e82970c55e&page=queryresults
[0m10:38:11.900424 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.olist_dataset.product_snapshot"
[0m10:38:11.902224 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.product_snapshot"} */

      merge into `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot` as DBT_INTERNAL_DEST
    using `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`product_id`, `product_category_name`, `product_name_lenght`, `product_description_lenght`, `product_photos_qty`, `product_weight_g`, `product_length_cm`, `product_height_cm`, `product_width_cm`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`product_id`, `product_category_name`, `product_name_lenght`, `product_description_lenght`, `product_photos_qty`, `product_weight_g`, `product_length_cm`, `product_height_cm`, `product_width_cm`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m10:38:13.618460 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:0599d20b-09a7-4e88-a9bb-286d7545a4d3&page=queryresults
[0m10:38:16.320278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4556bbf9-b175-4f2e-8f99-cfda25c36896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87492918a0>]}
[0m10:38:16.322654 [info ] [Thread-1 (]: 1 of 1 OK snapshotted olist_data_snapshots.product_snapshot .................... [[32mMERGE (0.0 rows, 5.2 MiB processed)[0m in 14.46s]
[0m10:38:16.325719 [debug] [Thread-1 (]: Finished running node snapshot.olist_dataset.product_snapshot
[0m10:38:16.329831 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:38:16.332103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:38:16.333159 [debug] [MainThread]: Connection 'snapshot.olist_dataset.product_snapshot' was properly closed.
[0m10:38:16.333894 [info ] [MainThread]: 
[0m10:38:16.334920 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 16.79 seconds (16.79s).
[0m10:38:16.336314 [debug] [MainThread]: Command end result
[0m10:38:16.374950 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:38:16.377287 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:38:16.387228 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m10:38:16.388235 [info ] [MainThread]: 
[0m10:38:16.389089 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:38:16.390003 [info ] [MainThread]: 
[0m10:38:16.390899 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:38:16.392196 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 18.439152, "process_in_blocks": "0", "process_kernel_time": 1.242816, "process_mem_max_rss": "256348", "process_out_blocks": "2176", "process_user_time": 3.632847}
[0m10:38:16.392850 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:38:16.392713 after 18.44 seconds
[0m10:38:16.393379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8778705e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8779748f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87783ad9f0>]}
[0m10:38:16.393875 [debug] [MainThread]: Flushing usage events
[0m10:38:17.413767 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:38:43.827114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c68be1e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c67b055a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c67b05540>]}


============================== 10:38:43.829418 | 30decbf2-8066-4a46-bb02-aea715c5301e ==============================
[0m10:38:43.829418 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:38:43.829939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models star.dim_product', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:38:44.826539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30decbf2-8066-4a46-bb02-aea715c5301e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c69c20f10>]}
[0m10:38:44.894105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30decbf2-8066-4a46-bb02-aea715c5301e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c67b1b430>]}
[0m10:38:44.894832 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:38:44.998560 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:38:45.188598 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:38:45.189314 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_product.sql
[0m10:38:45.483869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30decbf2-8066-4a46-bb02-aea715c5301e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c395b4550>]}
[0m10:38:45.562649 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:38:45.564144 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:38:45.574168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30decbf2-8066-4a46-bb02-aea715c5301e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c397d8c70>]}
[0m10:38:45.574735 [info ] [MainThread]: Found 6 models, 3 snapshots, 9 sources, 491 macros
[0m10:38:45.575134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30decbf2-8066-4a46-bb02-aea715c5301e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c3982f310>]}
[0m10:38:45.576626 [info ] [MainThread]: 
[0m10:38:45.577102 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:38:45.577457 [info ] [MainThread]: 
[0m10:38:45.577946 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:38:45.579193 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m10:38:45.579632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:46.628049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m10:38:46.629759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:46.991925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m10:38:46.993377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:47.356281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m10:38:47.357112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:47.736406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30decbf2-8066-4a46-bb02-aea715c5301e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c67b198a0>]}
[0m10:38:47.737764 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:38:47.744626 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m10:38:47.745808 [info ] [Thread-1 (]: 1 of 1 START sql table model olist_data_ingestion_dim_tables.dim_product ....... [RUN]
[0m10:38:47.747066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now model.olist_dataset.dim_product)
[0m10:38:47.747842 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m10:38:47.762441 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m10:38:47.763197 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m10:38:47.799360 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m10:38:47.800191 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_product.sql

-- This is incremental approach
-- 

-- WITH source AS (
--     SELECT
--         product_id,
--         product_category_name,
--         product_name_lenght,
--         product_description_lenght,
--         product_photos_qty,
--         product_weight_g,
--         product_length_cm,
--         product_height_cm,
--         product_width_cm,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
-- )

-- SELECT * FROM source

-- 

-- This is snapshot approach


SELECT
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    -- dbt_valid_from,
    -- dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
WHERE snapshot_updated_at IS NULL
    );
  
[0m10:38:47.800701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:48.430034 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:4efb521d-bdd3-4ab3-8d97-6c7330d3a6f0&page=queryresults
[0m10:38:48.717647 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:4efb521d-bdd3-4ab3-8d97-6c7330d3a6f0&page=queryresults
[0m10:38:48.724060 [debug] [Thread-1 (]: Database Error in model dim_product (models/star/dim_product.sql)
  Unrecognized name: snapshot_updated_at at [53:7]
  compiled code at target/run/olist_dataset/models/star/dim_product.sql
[0m10:38:48.727826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30decbf2-8066-4a46-bb02-aea715c5301e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c395a6b90>]}
[0m10:38:48.728954 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model olist_data_ingestion_dim_tables.dim_product  [[31mERROR[0m in 0.98s]
[0m10:38:48.729835 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m10:38:48.730823 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_product' to be skipped because of status 'error'.  Reason: Database Error in model dim_product (models/star/dim_product.sql)
  Unrecognized name: snapshot_updated_at at [53:7]
  compiled code at target/run/olist_dataset/models/star/dim_product.sql.
[0m10:38:48.733916 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:38:48.734801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:38:48.735196 [debug] [MainThread]: Connection 'model.olist_dataset.dim_product' was properly closed.
[0m10:38:48.735559 [info ] [MainThread]: 
[0m10:38:48.735914 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.16 seconds (3.16s).
[0m10:38:48.736532 [debug] [MainThread]: Command end result
[0m10:38:48.757537 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:38:48.759251 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:38:48.765031 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m10:38:48.765434 [info ] [MainThread]: 
[0m10:38:48.765867 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:38:48.766194 [info ] [MainThread]: 
[0m10:38:48.766567 [error] [MainThread]:   Database Error in model dim_product (models/star/dim_product.sql)
  Unrecognized name: snapshot_updated_at at [53:7]
  compiled code at target/run/olist_dataset/models/star/dim_product.sql
[0m10:38:48.766895 [info ] [MainThread]: 
[0m10:38:48.767263 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:38:48.767778 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.0002007, "process_in_blocks": "280", "process_kernel_time": 1.044994, "process_mem_max_rss": "251676", "process_out_blocks": "3224", "process_user_time": 3.470531}
[0m10:38:48.768161 [debug] [MainThread]: Command `dbt run` failed at 10:38:48.768068 after 5.00 seconds
[0m10:38:48.768540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c68be1e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c397d8c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c6888cc10>]}
[0m10:38:48.768900 [debug] [MainThread]: Flushing usage events
[0m10:38:48.479015 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:42:37.202685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdecb1de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdeba554b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdeba55450>]}


============================== 10:42:37.208675 | 6b25d07d-770e-46f5-a0a3-a74847064ed8 ==============================
[0m10:42:37.208675 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:42:37.209265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models star.dim_product', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:42:38.915508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b25d07d-770e-46f5-a0a3-a74847064ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdedb58f70>]}
[0m10:42:38.984775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b25d07d-770e-46f5-a0a3-a74847064ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdeba673d0>]}
[0m10:42:38.985496 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:42:39.115150 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:42:39.382829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:42:39.383624 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_product.sql
[0m10:42:39.682659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b25d07d-770e-46f5-a0a3-a74847064ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdbd4cc520>]}
[0m10:42:39.759857 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:42:39.762863 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:42:39.787088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b25d07d-770e-46f5-a0a3-a74847064ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdbdbc8a60>]}
[0m10:42:39.787674 [info ] [MainThread]: Found 6 models, 3 snapshots, 9 sources, 491 macros
[0m10:42:39.788075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b25d07d-770e-46f5-a0a3-a74847064ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdbd5cd990>]}
[0m10:42:39.789372 [info ] [MainThread]: 
[0m10:42:39.789807 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:42:39.790122 [info ] [MainThread]: 
[0m10:42:39.790613 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:42:39.791931 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m10:42:39.792772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:41.416294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m10:42:41.417619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:41.779752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m10:42:41.781557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:42.161448 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m10:42:42.162458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:42.532458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b25d07d-770e-46f5-a0a3-a74847064ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdedbd9d80>]}
[0m10:42:42.533600 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:42:42.541230 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m10:42:42.542493 [info ] [Thread-1 (]: 1 of 1 START sql table model olist_data_ingestion_dim_tables.dim_product ....... [RUN]
[0m10:42:42.543595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now model.olist_dataset.dim_product)
[0m10:42:42.544395 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m10:42:42.560390 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m10:42:42.561205 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m10:42:42.594543 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m10:42:42.595422 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_product.sql

-- This is incremental approach
-- 

-- WITH source AS (
--     SELECT
--         product_id,
--         product_category_name,
--         product_name_lenght,
--         product_description_lenght,
--         product_photos_qty,
--         product_weight_g,
--         product_length_cm,
--         product_height_cm,
--         product_width_cm,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
-- )

-- SELECT * FROM source

-- 

-- This is snapshot approach


SELECT
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m10:42:42.595931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:43.321033 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:45482e31-f0b3-4e6e-8d3e-20767dfb0a05&page=queryresults
[0m10:42:45.756009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b25d07d-770e-46f5-a0a3-a74847064ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdeba3bf40>]}
[0m10:42:45.756782 [info ] [Thread-1 (]: 1 of 1 OK created sql table model olist_data_ingestion_dim_tables.dim_product .. [[32mCREATE TABLE (33.0k rows, 3.6 MiB processed)[0m in 3.21s]
[0m10:42:45.757386 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m10:42:45.759338 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:42:45.760054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:42:45.760392 [debug] [MainThread]: Connection 'model.olist_dataset.dim_product' was properly closed.
[0m10:42:45.760688 [info ] [MainThread]: 
[0m10:42:45.761185 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.97 seconds (5.97s).
[0m10:42:45.761927 [debug] [MainThread]: Command end result
[0m10:42:45.782008 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:42:45.784751 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:42:45.790282 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m10:42:45.790627 [info ] [MainThread]: 
[0m10:42:45.791020 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:42:45.791324 [info ] [MainThread]: 
[0m10:42:45.791630 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:42:45.792124 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.6554985, "process_in_blocks": "122840", "process_kernel_time": 1.276139, "process_mem_max_rss": "258704", "process_out_blocks": "3216", "process_user_time": 3.733532}
[0m10:42:45.792706 [debug] [MainThread]: Command `dbt run` succeeded at 10:42:45.792598 after 8.66 seconds
[0m10:42:45.793072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdecb1de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdedb58f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdbdb1df30>]}
[0m10:42:45.793421 [debug] [MainThread]: Flushing usage events
[0m10:42:46.843455 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:54:45.804638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86141b9e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86130e9540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86130e94e0>]}


============================== 10:54:45.809965 | bcda57f4-c45c-4c7d-ab49-f77ebccbd45c ==============================
[0m10:54:45.809965 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:54:45.810531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'profiles_dir': '/home/kangh/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models star.geolocation', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:54:47.576172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcda57f4-c45c-4c7d-ab49-f77ebccbd45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e521dd50>]}
[0m10:54:47.647478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcda57f4-c45c-4c7d-ab49-f77ebccbd45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86130ff3d0>]}
[0m10:54:47.648295 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:54:47.766307 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:54:48.047831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m10:54:48.048815 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_product.sql
[0m10:54:48.049414 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_geolocation.sql
[0m10:54:48.049894 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_customer.sql
[0m10:54:48.050325 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_seller.sql
[0m10:54:48.374189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcda57f4-c45c-4c7d-ab49-f77ebccbd45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e4d9d570>]}
[0m10:54:48.453617 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:54:48.456542 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:54:48.485126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcda57f4-c45c-4c7d-ab49-f77ebccbd45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e523d450>]}
[0m10:54:48.485756 [info ] [MainThread]: Found 6 models, 3 snapshots, 9 sources, 491 macros
[0m10:54:48.486175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcda57f4-c45c-4c7d-ab49-f77ebccbd45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e523cfd0>]}
[0m10:54:48.486815 [warn ] [MainThread]: The selection criterion 'star.geolocation' does not match any enabled nodes
[0m10:54:48.487994 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:54:48.488574 [debug] [MainThread]: Command end result
[0m10:54:48.509648 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:54:48.511314 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:54:48.514565 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m10:54:48.515205 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7760003, "process_in_blocks": "121144", "process_kernel_time": 1.335084, "process_mem_max_rss": "244408", "process_out_blocks": "3200", "process_user_time": 3.810351}
[0m10:54:48.515668 [debug] [MainThread]: Command `dbt run` succeeded at 10:54:48.515567 after 2.78 seconds
[0m10:54:48.516038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86141b9e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e521dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e4e8a680>]}
[0m10:54:48.516412 [debug] [MainThread]: Flushing usage events
[0m10:54:49.549243 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:54:57.697224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c5e45e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c4d4d540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c4d4d4e0>]}


============================== 10:54:57.699785 | 86ecf216-1435-42d0-ace4-164a3d3691ea ==============================
[0m10:54:57.699785 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:54:57.700282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models star.dim_geolocation', 'send_anonymous_usage_stats': 'True'}
[0m10:54:58.784980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86ecf216-1435-42d0-ace4-164a3d3691ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c6e7f0d0>]}
[0m10:54:58.855623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86ecf216-1435-42d0-ace4-164a3d3691ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c53c8cd0>]}
[0m10:54:58.856412 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:54:58.961756 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:54:59.162415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:54:59.162892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:54:59.211479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86ecf216-1435-42d0-ace4-164a3d3691ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81969f54e0>]}
[0m10:54:59.294174 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:54:59.295840 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:54:59.306198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86ecf216-1435-42d0-ace4-164a3d3691ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81969f6d40>]}
[0m10:54:59.306759 [info ] [MainThread]: Found 6 models, 3 snapshots, 9 sources, 491 macros
[0m10:54:59.307168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86ecf216-1435-42d0-ace4-164a3d3691ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81969f4100>]}
[0m10:54:59.308618 [info ] [MainThread]: 
[0m10:54:59.309071 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:54:59.309395 [info ] [MainThread]: 
[0m10:54:59.309911 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:54:59.311292 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m10:54:59.312456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:55:01.087637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m10:55:01.089490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:55:01.472615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m10:55:01.475855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:55:01.878967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m10:55:01.881697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:55:02.299706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86ecf216-1435-42d0-ace4-164a3d3691ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c6efde70>]}
[0m10:55:02.301805 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:55:02.308797 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m10:55:02.309838 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m10:55:02.310588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now model.olist_dataset.dim_geolocation)
[0m10:55:02.311145 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m10:55:02.327420 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m10:55:02.329558 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m10:55:02.386792 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m10:55:02.387696 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_geolocation.sql

-- This is incremental approach (Type 1 SCD)


WITH source AS (
    SELECT
        geolocation_zip_code_prefix,
        geolocation_city,
        geolocation_state,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source


    );
  
[0m10:55:02.388197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:55:03.169474 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:f91e1a3e-8e5d-41c6-8691-513c5fd161b0&page=queryresults
[0m10:55:06.583812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86ecf216-1435-42d0-ace4-164a3d3691ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8196b67850>]}
[0m10:55:06.584765 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[32mCREATE TABLE (1.0m rows, 31.0 MiB processed)[0m in 4.27s]
[0m10:55:06.585497 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m10:55:06.588106 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:55:06.589197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:55:06.589593 [debug] [MainThread]: Connection 'model.olist_dataset.dim_geolocation' was properly closed.
[0m10:55:06.589954 [info ] [MainThread]: 
[0m10:55:06.590300 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.28 seconds (7.28s).
[0m10:55:06.591038 [debug] [MainThread]: Command end result
[0m10:55:06.612581 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m10:55:06.614871 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m10:55:06.620753 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m10:55:06.621113 [info ] [MainThread]: 
[0m10:55:06.621603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:55:06.621954 [info ] [MainThread]: 
[0m10:55:06.622297 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:55:06.622998 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.985188, "process_in_blocks": "1672", "process_kernel_time": 0.97846, "process_mem_max_rss": "250300", "process_out_blocks": "2160", "process_user_time": 3.578096}
[0m10:55:06.623493 [debug] [MainThread]: Command `dbt run` succeeded at 10:55:06.623367 after 8.99 seconds
[0m10:55:06.623946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c5e45e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c6e7f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c5c69390>]}
[0m10:55:06.624351 [debug] [MainThread]: Flushing usage events
[0m10:55:07.637773 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:01:47.011209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1074a35e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10739414b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1073941450>]}


============================== 11:01:47.015797 | 43b0ad4a-38d1-464f-b2d2-0f8a7c829e33 ==============================
[0m11:01:47.015797 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:01:47.016311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/kangh/.dbt', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models fact.fact_orders', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:01:48.768975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43b0ad4a-38d1-464f-b2d2-0f8a7c829e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10746a7a00>]}
[0m11:01:48.841807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43b0ad4a-38d1-464f-b2d2-0f8a7c829e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107397f3d0>]}
[0m11:01:48.842543 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m11:01:48.959219 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:01:49.235470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:01:49.236831 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/fact/fact_orders.sql
[0m11:01:49.543530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43b0ad4a-38d1-464f-b2d2-0f8a7c829e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10454104f0>]}
[0m11:01:49.624799 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m11:01:49.629521 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m11:01:49.657708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43b0ad4a-38d1-464f-b2d2-0f8a7c829e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1045407e20>]}
[0m11:01:49.658357 [info ] [MainThread]: Found 6 models, 3 snapshots, 9 sources, 491 macros
[0m11:01:49.658769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43b0ad4a-38d1-464f-b2d2-0f8a7c829e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1045407df0>]}
[0m11:01:49.660162 [info ] [MainThread]: 
[0m11:01:49.660656 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:01:49.661102 [info ] [MainThread]: 
[0m11:01:49.661671 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:01:49.663294 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m11:01:49.663850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:51.405049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m11:01:51.407013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:01:51.794917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m11:01:51.797160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:01:52.153749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m11:01:52.156091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:01:51.625295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43b0ad4a-38d1-464f-b2d2-0f8a7c829e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107397c970>]}
[0m11:01:51.626646 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:01:51.633799 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m11:01:51.635168 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m11:01:51.636541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now model.olist_dataset.fact_orders)
[0m11:01:51.637434 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m11:01:51.660160 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m11:01:51.664263 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m11:01:51.725539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:01:52.167906 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m11:01:52.168740 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)

-- 
--   WHERE order_id NOT IN (SELECT order_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        `order_id` = DBT_INTERNAL_SOURCE.`order_id`,`customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_status` = DBT_INTERNAL_SOURCE.`order_status`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_carrier_date` = DBT_INTERNAL_SOURCE.`order_delivered_carrier_date`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`payment_value` = DBT_INTERNAL_SOURCE.`payment_value`
    

    when not matched then insert
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)
    values
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)


    
[0m11:01:52.863713 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:e7c5bdb6-5181-4a1f-8775-dd1b13f33722&page=queryresults
[0m11:01:59.870180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43b0ad4a-38d1-464f-b2d2-0f8a7c829e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1073953f40>]}
[0m11:01:59.870983 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mMERGE (99.4k rows, 39.6 MiB processed)[0m in 8.23s]
[0m11:01:59.871703 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m11:01:59.874146 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:01:59.875421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:01:59.875826 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m11:01:59.876164 [info ] [MainThread]: 
[0m11:01:59.876499 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.21 seconds (10.21s).
[0m11:01:59.877085 [debug] [MainThread]: Command end result
[0m11:01:59.897755 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m11:01:59.900597 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m11:01:59.906381 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m11:01:59.906746 [info ] [MainThread]: 
[0m11:01:59.907150 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:01:59.907438 [info ] [MainThread]: 
[0m11:01:59.907734 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:01:59.908234 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.451933, "process_in_blocks": "122584", "process_kernel_time": 1.436537, "process_mem_max_rss": "261820", "process_out_blocks": "3224", "process_user_time": 3.900532}
[0m11:01:59.908630 [debug] [MainThread]: Command `dbt run` succeeded at 11:01:59.908537 after 14.45 seconds
[0m11:01:59.908991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1074a35e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107397f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10454672e0>]}
[0m11:01:59.909344 [debug] [MainThread]: Flushing usage events
[0m11:02:00.934899 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:15:50.222259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7807b5de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77f6c94e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77f6c9480>]}


============================== 11:15:50.227025 | 5b27338c-4748-41ed-8e12-6a8bbbd344c3 ==============================
[0m11:15:50.227025 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:15:50.227555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/kangh/.dbt', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models fact', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:15:52.012401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b27338c-4748-41ed-8e12-6a8bbbd344c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7518ae3e0>]}
[0m11:15:52.079278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b27338c-4748-41ed-8e12-6a8bbbd344c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77f6db3a0>]}
[0m11:15:52.080046 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m11:15:52.190773 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:15:52.449876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:15:52.451124 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/fact/fact_orders.sql
[0m11:15:52.452019 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/fact/fact_order_items.sql
[0m11:15:52.754166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b27338c-4748-41ed-8e12-6a8bbbd344c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7511b86a0>]}
[0m11:15:52.829991 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m11:15:52.833120 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m11:15:52.856138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b27338c-4748-41ed-8e12-6a8bbbd344c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7513a4fa0>]}
[0m11:15:52.856719 [info ] [MainThread]: Found 3 snapshots, 6 models, 9 sources, 491 macros
[0m11:15:52.857134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b27338c-4748-41ed-8e12-6a8bbbd344c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7513a6f50>]}
[0m11:15:52.858662 [info ] [MainThread]: 
[0m11:15:52.859137 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:15:52.859455 [info ] [MainThread]: 
[0m11:15:52.859957 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:15:52.864242 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m11:15:52.865034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:54.376191 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now create_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m11:15:54.377675 [debug] [ThreadPool]: Creating schema "database: "olist-ecommerce-454812"
schema: "olist_data_ingestion_fact_tables"
"
[0m11:15:54.392417 [debug] [ThreadPool]: On create_olist-ecommerce-454812_olist_data_ingestion_fact_tables: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "connection_name": "create_olist-ecommerce-454812_olist_data_ingestion_fact_tables"} */
create schema if not exists `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`
  
[0m11:15:54.392950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:54.828223 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:16d35216-4480-4c8a-afad-776dfd9c41ca&page=queryresults
[0m11:15:56.020121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m11:15:56.021536 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:56.461588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m11:15:56.462943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:56.859099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m11:15:56.860129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:57.240812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b27338c-4748-41ed-8e12-6a8bbbd344c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77f6d92a0>]}
[0m11:15:57.241916 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:15:57.247309 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m11:15:57.248513 [info ] [Thread-1 (]: 1 of 2 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m11:15:57.249669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now model.olist_dataset.fact_order_items)
[0m11:15:57.250408 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m11:15:57.266335 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m11:15:57.269343 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m11:15:57.320815 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m11:15:57.321742 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
      
    
    

    OPTIONS()
    as (
      -- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    LEFT JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order item id that already in fact_order_item table
-- which assume data already in table never change

-- 
    );
  
[0m11:15:57.322225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:58.022328 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:67b22779-b3bb-44cb-a5cc-897a60982500&page=queryresults
[0m11:16:03.535551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b27338c-4748-41ed-8e12-6a8bbbd344c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75112f9a0>]}
[0m11:16:03.536517 [info ] [Thread-1 (]: 1 of 2 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mCREATE TABLE (112.7k rows, 27.9 MiB processed)[0m in 6.28s]
[0m11:16:03.537168 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m11:16:03.537571 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m11:16:03.537994 [info ] [Thread-1 (]: 2 of 2 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m11:16:03.538716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.fact_order_items, now model.olist_dataset.fact_orders)
[0m11:16:03.539088 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m11:16:03.543472 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m11:16:03.545294 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m11:16:03.551174 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m11:16:03.552137 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
      
    
    

    OPTIONS()
    as (
      -- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order id that already in fact_orders table
-- which assume data already in table never change

-- 
    );
  
[0m11:16:03.552678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:16:04.269471 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:a443a8bf-7431-4732-8e2e-9342eba6e103&page=queryresults
[0m11:16:08.776831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b27338c-4748-41ed-8e12-6a8bbbd344c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7807e2230>]}
[0m11:16:08.778076 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mCREATE TABLE (99.4k rows, 21.5 MiB processed)[0m in 5.24s]
[0m11:16:08.779152 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m11:16:08.782993 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:16:08.784470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:16:08.785218 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m11:16:08.786101 [info ] [MainThread]: 
[0m11:16:08.786997 [info ] [MainThread]: Finished running 2 incremental models in 0 hours 0 minutes and 15.93 seconds (15.93s).
[0m11:16:08.788927 [debug] [MainThread]: Command end result
[0m11:16:08.831867 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m11:16:08.834427 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m11:16:08.842673 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m11:16:08.843350 [info ] [MainThread]: 
[0m11:16:08.843997 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:16:08.844504 [info ] [MainThread]: 
[0m11:16:08.845002 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:16:08.845787 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.688322, "process_in_blocks": "122592", "process_kernel_time": 1.446304, "process_mem_max_rss": "263876", "process_out_blocks": "3264", "process_user_time": 4.13833}
[0m11:16:08.846355 [debug] [MainThread]: Command `dbt run` succeeded at 11:16:08.846224 after 18.69 seconds
[0m11:16:08.846844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7807b5de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7518ae3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7513f6800>]}
[0m11:16:08.847358 [debug] [MainThread]: Flushing usage events
[0m11:16:09.835973 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:33:28.253376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77677a5db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77666995a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7766699540>]}


============================== 11:33:28.258573 | 9d2559b0-6dde-4c90-be7a-50b20f18d8d1 ==============================
[0m11:33:28.258573 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:33:28.259070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m11:33:29.974101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d2559b0-6dde-4c90-be7a-50b20f18d8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77388aca30>]}
[0m11:33:30.042947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d2559b0-6dde-4c90-be7a-50b20f18d8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7738841f60>]}
[0m11:33:30.043692 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m11:33:30.157661 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:33:30.332375 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:33:30.332952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9d2559b0-6dde-4c90-be7a-50b20f18d8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7738826a40>]}
[0m11:33:31.668108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d2559b0-6dde-4c90-be7a-50b20f18d8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7737eb0100>]}
[0m11:33:31.744209 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m11:33:31.747044 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m11:33:31.789587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d2559b0-6dde-4c90-be7a-50b20f18d8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7737e75360>]}
[0m11:33:31.790133 [info ] [MainThread]: Found 6 models, 3 snapshots, 9 sources, 491 macros
[0m11:33:31.790498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d2559b0-6dde-4c90-be7a-50b20f18d8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7738c13070>]}
[0m11:33:31.792021 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:33:31.792627 [debug] [MainThread]: Command end result
[0m11:33:31.813451 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m11:33:31.814997 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m11:33:31.817796 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m11:33:31.818325 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.6275167, "process_in_blocks": "122840", "process_kernel_time": 1.362961, "process_mem_max_rss": "269288", "process_out_blocks": "3184", "process_user_time": 4.506726}
[0m11:33:31.818713 [debug] [MainThread]: Command `dbt test` succeeded at 11:33:31.818625 after 3.63 seconds
[0m11:33:31.819048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77677a5db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77388aca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7737f10e50>]}
[0m11:33:31.819425 [debug] [MainThread]: Flushing usage events
[0m11:33:32.812555 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:37:10.854262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9316ee5e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9315ef54e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9315ef5480>]}


============================== 11:37:10.859964 | accf1391-1bf0-408e-845f-b49db114ab97 ==============================
[0m11:37:10.859964 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:37:10.860484 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m11:37:12.569745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'accf1391-1bf0-408e-845f-b49db114ab97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93165840d0>]}
[0m11:37:12.638230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'accf1391-1bf0-408e-845f-b49db114ab97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ec0626b0>]}
[0m11:37:12.638933 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m11:37:12.753577 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:37:13.075517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:37:13.076693 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:37:13.127238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'accf1391-1bf0-408e-845f-b49db114ab97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92e7b9d630>]}
[0m11:37:13.207476 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m11:37:13.210609 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m11:37:13.233508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'accf1391-1bf0-408e-845f-b49db114ab97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92e7b0d9f0>]}
[0m11:37:13.234089 [info ] [MainThread]: Found 6 models, 3 snapshots, 9 sources, 491 macros
[0m11:37:13.234457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'accf1391-1bf0-408e-845f-b49db114ab97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ec44dd20>]}
[0m11:37:13.236093 [info ] [MainThread]: 
[0m11:37:13.236520 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:37:13.236807 [info ] [MainThread]: 
[0m11:37:13.237275 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:37:13.242384 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m11:37:13.243220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:14.839594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m11:37:14.840617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:15.220634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m11:37:15.222823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:15.604718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m11:37:15.607466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:16.037116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'accf1391-1bf0-408e-845f-b49db114ab97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9318095d80>]}
[0m11:37:16.038395 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:37:16.044238 [debug] [Thread-1 (]: Began running node snapshot.olist_dataset.customer_snapshot
[0m11:37:16.045318 [info ] [Thread-1 (]: 1 of 3 START snapshot olist_data_snapshots.customer_snapshot ................... [RUN]
[0m11:37:16.046282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now snapshot.olist_dataset.customer_snapshot)
[0m11:37:16.046967 [debug] [Thread-1 (]: Began compiling node snapshot.olist_dataset.customer_snapshot
[0m11:37:16.063007 [debug] [Thread-1 (]: Began executing node snapshot.olist_dataset.customer_snapshot
[0m11:37:16.094345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:37:16.548053 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.customer_snapshot"} */

        
  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
    
[0m11:37:17.205303 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:b5b74461-048a-4efb-ac03-aceb0e218577&page=queryresults
[0m11:37:20.581285 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`".
[0m11:37:21.770734 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        
    
    with snapshot_query as (

        





SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m11:37:22.340492 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:c7c0b3dc-df0e-4f3a-94d5-6a327bcc9804&page=queryresults
[0m11:37:22.677492 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m11:37:23.210484 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d3352b86-75f2-4f94-946b-0bf1aa2fdffa&page=queryresults
[0m11:37:23.533030 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.olist_dataset.customer_snapshot"
[0m11:37:23.538371 [debug] [Thread-1 (]: On snapshot.olist_dataset.customer_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.customer_snapshot"} */

      merge into `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot` as DBT_INTERNAL_DEST
    using `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`customer_id`, `customer_unique_id`, `customer_zip_code_prefix`, `customer_city`, `customer_state`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`customer_id`, `customer_unique_id`, `customer_zip_code_prefix`, `customer_city`, `customer_state`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m11:37:24.076057 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:981d4238-f653-4e5d-a2cb-1f1c232b9edc&page=queryresults
[0m11:37:26.699675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'accf1391-1bf0-408e-845f-b49db114ab97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9315eddb40>]}
[0m11:37:26.701873 [info ] [Thread-1 (]: 1 of 3 OK snapshotted olist_data_snapshots.customer_snapshot ................... [[32mMERGE (0.0 rows, 14.3 MiB processed)[0m in 10.65s]
[0m11:37:26.703494 [debug] [Thread-1 (]: Finished running node snapshot.olist_dataset.customer_snapshot
[0m11:37:26.704397 [debug] [Thread-1 (]: Began running node snapshot.olist_dataset.product_snapshot
[0m11:37:26.705950 [info ] [Thread-1 (]: 2 of 3 START snapshot olist_data_snapshots.product_snapshot .................... [RUN]
[0m11:37:26.707576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.olist_dataset.customer_snapshot, now snapshot.olist_dataset.product_snapshot)
[0m11:37:26.708487 [debug] [Thread-1 (]: Began compiling node snapshot.olist_dataset.product_snapshot
[0m11:37:26.718209 [debug] [Thread-1 (]: Began executing node snapshot.olist_dataset.product_snapshot
[0m11:37:26.724932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:37:27.148057 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.product_snapshot"} */

        
  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        



SELECT
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        product_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(product_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
    
[0m11:37:27.741607 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:b22f2974-ce47-4a78-a5da-8f5ff64fc08f&page=queryresults
[0m11:37:31.006822 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`".
[0m11:37:32.219425 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: select * from (
        
    
    with snapshot_query as (

        



SELECT
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        product_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(product_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m11:37:32.755053 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d8808444-f47f-4286-b2db-bee4448346b1&page=queryresults
[0m11:37:33.077662 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m11:37:33.620025 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:319a05d9-eed3-460f-b664-b360a360031b&page=queryresults
[0m11:37:33.956135 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.olist_dataset.product_snapshot"
[0m11:37:33.962917 [debug] [Thread-1 (]: On snapshot.olist_dataset.product_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.product_snapshot"} */

      merge into `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot` as DBT_INTERNAL_DEST
    using `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`product_id`, `product_category_name`, `product_name_lenght`, `product_description_lenght`, `product_photos_qty`, `product_weight_g`, `product_length_cm`, `product_height_cm`, `product_width_cm`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`product_id`, `product_category_name`, `product_name_lenght`, `product_description_lenght`, `product_photos_qty`, `product_weight_g`, `product_length_cm`, `product_height_cm`, `product_width_cm`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m11:37:34.549436 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:920aca55-266e-48a1-9b29-082059b3ce4a&page=queryresults
[0m11:37:36.844503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'accf1391-1bf0-408e-845f-b49db114ab97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92e593a6e0>]}
[0m11:37:36.846831 [info ] [Thread-1 (]: 2 of 3 OK snapshotted olist_data_snapshots.product_snapshot .................... [[32mMERGE (0.0 rows, 5.2 MiB processed)[0m in 10.14s]
[0m11:37:36.851516 [debug] [Thread-1 (]: Finished running node snapshot.olist_dataset.product_snapshot
[0m11:37:36.852952 [debug] [Thread-1 (]: Began running node snapshot.olist_dataset.seller_snapshot
[0m11:37:36.854608 [info ] [Thread-1 (]: 3 of 3 START snapshot olist_data_snapshots.seller_snapshot ..................... [RUN]
[0m11:37:36.855781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.olist_dataset.product_snapshot, now snapshot.olist_dataset.seller_snapshot)
[0m11:37:36.856188 [debug] [Thread-1 (]: Began compiling node snapshot.olist_dataset.seller_snapshot
[0m11:37:36.861708 [debug] [Thread-1 (]: Began executing node snapshot.olist_dataset.seller_snapshot
[0m11:37:36.864798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:37:37.223852 [debug] [Thread-1 (]: On snapshot.olist_dataset.seller_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.seller_snapshot"} */

        
  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        



SELECT
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        seller_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        seller_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(seller_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        seller_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
    
[0m11:37:38.266227 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:29b711eb-d988-451d-a1ad-fd6be6d15fac&page=queryresults
[0m11:37:41.259352 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot`".
[0m11:37:42.404959 [debug] [Thread-1 (]: On snapshot.olist_dataset.seller_snapshot: select * from (
        
    
    with snapshot_query as (

        



SELECT
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`


    ),

    snapshotted_data as (

        select *, 
    
        seller_id as dbt_unique_key
    

        from `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        seller_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(seller_id as string), ''), '|',coalesce(cast(last_updated as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        seller_id as dbt_unique_key
    
,
            last_updated as dbt_updated_at,
            last_updated as dbt_valid_from,
            last_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.last_updated))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.last_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m11:37:43.001539 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:5c81abe7-5152-4cba-abce-a9355069491b&page=queryresults
[0m11:37:43.311995 [debug] [Thread-1 (]: On snapshot.olist_dataset.seller_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m11:37:43.748339 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:9631cf07-fb83-432d-ae17-bc1d829e2af0&page=queryresults
[0m11:37:44.062583 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.olist_dataset.seller_snapshot"
[0m11:37:44.067626 [debug] [Thread-1 (]: On snapshot.olist_dataset.seller_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "snapshot.olist_dataset.seller_snapshot"} */

      merge into `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot` as DBT_INTERNAL_DEST
    using `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`seller_id`, `seller_zip_code_prefix`, `seller_city`, `seller_state`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`seller_id`, `seller_zip_code_prefix`, `seller_city`, `seller_state`, `last_updated`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m11:37:44.634795 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:830f2227-0921-423b-b994-fcd0cf1244d3&page=queryresults
[0m11:37:46.940873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'accf1391-1bf0-408e-845f-b49db114ab97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93171e0f10>]}
[0m11:37:46.942653 [info ] [Thread-1 (]: 3 of 3 OK snapshotted olist_data_snapshots.seller_snapshot ..................... [[32mMERGE (0.0 rows, 351.1 KiB processed)[0m in 10.08s]
[0m11:37:46.943887 [debug] [Thread-1 (]: Finished running node snapshot.olist_dataset.seller_snapshot
[0m11:37:46.946954 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:37:46.948280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:46.948934 [debug] [MainThread]: Connection 'snapshot.olist_dataset.seller_snapshot' was properly closed.
[0m11:37:46.949611 [info ] [MainThread]: 
[0m11:37:46.950440 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 33.71 seconds (33.71s).
[0m11:37:46.952354 [debug] [MainThread]: Command end result
[0m11:37:46.991529 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m11:37:46.994264 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m11:37:47.002218 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m11:37:47.002862 [info ] [MainThread]: 
[0m11:37:47.004161 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:37:47.004628 [info ] [MainThread]: 
[0m11:37:47.005225 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:37:47.006307 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 36.215508, "process_in_blocks": "123184", "process_kernel_time": 1.468444, "process_mem_max_rss": "256472", "process_out_blocks": "2264", "process_user_time": 4.089726}
[0m11:37:47.006925 [debug] [MainThread]: Command `dbt snapshot` succeeded at 11:37:47.006734 after 36.22 seconds
[0m11:37:47.007483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9316ee5e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93165840d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9316dd7b50>]}
[0m11:37:47.008110 [debug] [MainThread]: Flushing usage events
[0m11:37:47.995197 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:37:49.913016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf25f5db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf1521420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf15213c0>]}


============================== 11:37:49.915347 | 5a2a0f44-080e-4bfc-98bc-4431acd457f3 ==============================
[0m11:37:49.915347 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:37:49.915852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:37:50.886567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a2a0f44-080e-4bfc-98bc-4431acd457f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcc3629360>]}
[0m11:37:50.951361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a2a0f44-080e-4bfc-98bc-4431acd457f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcc3549690>]}
[0m11:37:50.952147 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m11:37:51.060341 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:37:51.235147 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:37:51.235604 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:37:51.278876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a2a0f44-080e-4bfc-98bc-4431acd457f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcc31d9570>]}
[0m11:37:51.354775 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m11:37:51.356988 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m11:37:51.366622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a2a0f44-080e-4bfc-98bc-4431acd457f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcc3163160>]}
[0m11:37:51.367138 [info ] [MainThread]: Found 6 models, 3 snapshots, 9 sources, 491 macros
[0m11:37:51.367503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a2a0f44-080e-4bfc-98bc-4431acd457f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcc3162c50>]}
[0m11:37:51.369160 [info ] [MainThread]: 
[0m11:37:51.369568 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:37:51.369882 [info ] [MainThread]: 
[0m11:37:51.370389 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:37:51.374969 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m11:37:51.375906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:52.324040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:52.694578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m11:37:52.695744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:53.061626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m11:37:53.063129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:53.395350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m11:37:53.396259 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:54.954806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a2a0f44-080e-4bfc-98bc-4431acd457f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf36a9d20>]}
[0m11:37:54.956326 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:37:54.962797 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m11:37:54.964290 [info ] [Thread-1 (]: 1 of 6 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m11:37:54.967328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now model.olist_dataset.dim_customer)
[0m11:37:54.968306 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m11:37:54.994289 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m11:37:54.997423 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m11:37:55.018431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:37:55.403471 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m11:37:55.404343 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 


-- This is snapshot approach, refer to customer_snapshot.sql (Type 2 SCD)


SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m11:37:55.880749 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:e952d07d-d2f5-42f9-af3d-ef878d623ac3&page=queryresults
[0m11:37:59.027948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a2a0f44-080e-4bfc-98bc-4431acd457f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf14c1d50>]}
[0m11:37:59.028680 [info ] [Thread-1 (]: 1 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_customer . [[32mCREATE TABLE (99.4k rows, 9.5 MiB processed)[0m in 4.06s]
[0m11:37:59.029278 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m11:37:59.029672 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m11:37:59.030087 [info ] [Thread-1 (]: 2 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m11:37:59.030960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_customer, now model.olist_dataset.dim_geolocation)
[0m11:37:59.031407 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m11:37:59.037285 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m11:37:59.037910 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m11:37:59.068067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:37:59.478804 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m11:37:59.479564 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation` as DBT_INTERNAL_DEST
        using (-- models/star/dim_geolocation.sql

-- This is incremental approach (Type 1 SCD)


WITH source AS (
    SELECT
        geolocation_zip_code_prefix,
        geolocation_city,
        geolocation_state,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source


  WHERE geolocation_zip_code_prefix NOT IN (
      SELECT geolocation_zip_code_prefix FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
  )

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.geolocation_zip_code_prefix = DBT_INTERNAL_DEST.geolocation_zip_code_prefix))

    
    when matched then update set
        `geolocation_zip_code_prefix` = DBT_INTERNAL_SOURCE.`geolocation_zip_code_prefix`,`geolocation_city` = DBT_INTERNAL_SOURCE.`geolocation_city`,`geolocation_state` = DBT_INTERNAL_SOURCE.`geolocation_state`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)
    values
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)


    
[0m11:38:00.050771 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:e51c6a0a-43c8-42c4-8843-72c3686174b1&page=queryresults
[0m11:38:23.640785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a2a0f44-080e-4bfc-98bc-4431acd457f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcc3024a90>]}
[0m11:38:23.642761 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[32mMERGE (0.0 rows, 62.1 MiB processed)[0m in 24.61s]
[0m11:38:23.647036 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m11:38:23.651571 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m11:38:23.653797 [info ] [Thread-1 (]: 3 of 6 START sql table model olist_data_ingestion_dim_tables.dim_product ....... [RUN]
[0m11:38:23.655404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_geolocation, now model.olist_dataset.dim_product)
[0m11:38:23.656487 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m11:38:23.670089 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m11:38:23.672314 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m11:38:23.676574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:24.092916 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m11:38:24.094032 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_product.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         product_id,
--         product_category_name,
--         product_name_lenght,
--         product_description_lenght,
--         product_photos_qty,
--         product_weight_g,
--         product_length_cm,
--         product_height_cm,
--         product_width_cm,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
-- )

-- SELECT * FROM source

-- 

-- This is snapshot approach, refer to product_snapshot (Type 2 SCD)


SELECT
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m11:38:24.557195 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:def1ceee-a97f-4509-b4c9-7447bdd7eae6&page=queryresults
[0m11:38:27.097558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a2a0f44-080e-4bfc-98bc-4431acd457f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf14c1d50>]}
[0m11:38:27.099136 [info ] [Thread-1 (]: 3 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_product .. [[32mCREATE TABLE (33.0k rows, 3.6 MiB processed)[0m in 3.44s]
[0m11:38:27.100600 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m11:38:27.102182 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_seller
[0m11:38:27.104051 [info ] [Thread-1 (]: 4 of 6 START sql table model olist_data_ingestion_dim_tables.dim_seller ........ [RUN]
[0m11:38:27.105451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_product, now model.olist_dataset.dim_seller)
[0m11:38:27.106735 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_seller
[0m11:38:27.118809 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_seller"
[0m11:38:27.119988 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_seller
[0m11:38:27.124189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:27.470436 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_seller"
[0m11:38:27.471971 [debug] [Thread-1 (]: On model.olist_dataset.dim_seller: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_seller"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_seller.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         seller_id,
--         seller_zip_code_prefix,
--         seller_city,
--         seller_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`
-- )

-- SELECT * FROM source

-- 


-- This is snapshot approach, refer to seller_snapshot (Type 2 SCD)


SELECT
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m11:38:27.992045 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:8cf67793-d20b-4cad-bee7-253b297dd2a9&page=queryresults
[0m11:38:29.992354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a2a0f44-080e-4bfc-98bc-4431acd457f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcc0cc2200>]}
[0m11:38:29.994751 [info ] [Thread-1 (]: 4 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_seller ... [[32mCREATE TABLE (3.1k rows, 200.0 KiB processed)[0m in 2.89s]
[0m11:38:30.003043 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_seller
[0m11:38:30.004654 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m11:38:30.006318 [info ] [Thread-1 (]: 5 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m11:38:30.007927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_seller, now model.olist_dataset.fact_order_items)
[0m11:38:30.009431 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m11:38:30.019534 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m11:38:30.022667 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m11:38:30.026267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:30.423428 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m11:38:30.427246 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    LEFT JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order item id that already in fact_order_item table
-- which assume data already in table never change

-- 
--   WHERE order_id_item NOT IN (SELECT order_id_item FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id_item = DBT_INTERNAL_DEST.order_id_item))

    
    when matched then update set
        `customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_id` = DBT_INTERNAL_SOURCE.`order_id`,`order_item_id` = DBT_INTERNAL_SOURCE.`order_item_id`,`product_id` = DBT_INTERNAL_SOURCE.`product_id`,`seller_id` = DBT_INTERNAL_SOURCE.`seller_id`,`price` = DBT_INTERNAL_SOURCE.`price`,`freight_value` = DBT_INTERNAL_SOURCE.`freight_value`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`order_id_item` = DBT_INTERNAL_SOURCE.`order_id_item`
    

    when not matched then insert
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)
    values
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)


    
[0m11:38:30.967468 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:3e0c187a-de83-4708-970c-c37e086314b6&page=queryresults
[0m11:38:36.970237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a2a0f44-080e-4bfc-98bc-4431acd457f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcc0cc1450>]}
[0m11:38:36.974176 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mMERGE (112.7k rows, 57.9 MiB processed)[0m in 6.96s]
[0m11:38:36.975566 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m11:38:36.976877 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m11:38:36.979531 [info ] [Thread-1 (]: 6 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m11:38:36.980681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.fact_order_items, now model.olist_dataset.fact_orders)
[0m11:38:36.981205 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m11:38:36.990457 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m11:38:36.991956 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m11:38:36.997861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:37.412203 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m11:38:37.413973 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order id that already in fact_orders table
-- which assume data already in table never change

-- 
--   WHERE order_id NOT IN (SELECT order_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        `order_id` = DBT_INTERNAL_SOURCE.`order_id`,`customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_status` = DBT_INTERNAL_SOURCE.`order_status`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_carrier_date` = DBT_INTERNAL_SOURCE.`order_delivered_carrier_date`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`payment_value` = DBT_INTERNAL_SOURCE.`payment_value`
    

    when not matched then insert
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)
    values
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)


    
[0m11:38:37.913763 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:ee784af3-bd5c-4e0a-9e53-277a5fa4a102&page=queryresults
[0m11:38:43.172685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a2a0f44-080e-4bfc-98bc-4431acd457f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf2699480>]}
[0m11:38:43.174003 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mMERGE (99.4k rows, 39.6 MiB processed)[0m in 6.19s]
[0m11:38:43.175266 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m11:38:43.183738 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:38:43.185016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:43.185543 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m11:38:43.186187 [info ] [MainThread]: 
[0m11:38:43.186716 [info ] [MainThread]: Finished running 3 incremental models, 3 table models in 0 hours 0 minutes and 51.82 seconds (51.82s).
[0m11:38:43.188598 [debug] [MainThread]: Command end result
[0m11:38:43.234197 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m11:38:43.238418 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m11:38:43.250447 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m11:38:43.251229 [info ] [MainThread]: 
[0m11:38:43.251903 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:38:43.252474 [info ] [MainThread]: 
[0m11:38:43.253229 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:38:43.255112 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 53.397808, "process_in_blocks": "544", "process_kernel_time": 1.184318, "process_mem_max_rss": "249300", "process_out_blocks": "2320", "process_user_time": 3.891331}
[0m11:38:43.257379 [debug] [MainThread]: Command `dbt run` succeeded at 11:38:43.256946 after 53.40 seconds
[0m11:38:43.259711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf25f5db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf229f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcc31ba920>]}
[0m11:38:43.261901 [debug] [MainThread]: Flushing usage events
[0m11:38:44.461805 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:39:22.224721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53c13c9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53c02e9630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53c02e95d0>]}


============================== 11:39:22.229195 | 369508ad-e47c-45ba-b4ff-b37c92e27463 ==============================
[0m11:39:22.229195 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:39:22.229709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:39:23.936646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '369508ad-e47c-45ba-b4ff-b37c92e27463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53c24030a0>]}
[0m11:39:24.004608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '369508ad-e47c-45ba-b4ff-b37c92e27463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53924209d0>]}
[0m11:39:24.005383 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m11:39:24.118431 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:39:24.387721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:39:24.388817 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/schema.yml
[0m11:39:24.869931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '369508ad-e47c-45ba-b4ff-b37c92e27463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5391b4d360>]}
[0m11:39:24.960389 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m11:39:24.962810 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m11:39:25.005283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '369508ad-e47c-45ba-b4ff-b37c92e27463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53921ceef0>]}
[0m11:39:25.005928 [info ] [MainThread]: Found 6 models, 3 snapshots, 2 data tests, 9 sources, 491 macros
[0m11:39:25.006340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '369508ad-e47c-45ba-b4ff-b37c92e27463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5392ae30a0>]}
[0m11:39:25.008050 [info ] [MainThread]: 
[0m11:39:25.008560 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:39:25.008883 [info ] [MainThread]: 
[0m11:39:25.009412 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:39:25.016456 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_snapshots'
[0m11:39:25.017217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:26.654667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m11:39:26.656906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:27.006945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m11:39:27.009224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:27.382607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '369508ad-e47c-45ba-b4ff-b37c92e27463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53c02f5a80>]}
[0m11:39:27.383622 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:27.393081 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m11:39:27.394414 [info ] [Thread-1 (]: 1 of 2 START test not_null_dim_customer_customer_id ............................ [RUN]
[0m11:39:27.395492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc)
[0m11:39:27.396154 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m11:39:27.418900 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"
[0m11:39:27.422247 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m11:39:27.439481 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"
[0m11:39:27.441526 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_id is null



      
    ) dbt_internal_test
[0m11:39:27.441972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:28.152143 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:3f40d759-f657-4c95-8cd2-df6f860959ba&page=queryresults
[0m11:39:30.934950 [info ] [Thread-1 (]: 1 of 2 PASS not_null_dim_customer_customer_id .................................. [[32mPASS[0m in 3.54s]
[0m11:39:30.936381 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m11:39:30.937141 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m11:39:30.937824 [info ] [Thread-1 (]: 2 of 2 START test unique_dim_customer_customer_id .............................. [RUN]
[0m11:39:30.938847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc, now test.olist_dataset.unique_dim_customer_customer_id.b42affccd1)
[0m11:39:30.939979 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m11:39:30.948478 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"
[0m11:39:30.949151 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m11:39:30.952924 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"
[0m11:39:30.953683 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_customer_customer_id.b42affccd1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:39:30.954224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:31.672649 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:7a35bf8b-7e2e-47c2-8288-2504a38c1c0a&page=queryresults
[0m11:39:32.679205 [info ] [Thread-1 (]: 2 of 2 PASS unique_dim_customer_customer_id .................................... [[32mPASS[0m in 1.74s]
[0m11:39:32.680563 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m11:39:32.683946 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:39:32.685753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:32.686556 [debug] [MainThread]: Connection 'test.olist_dataset.unique_dim_customer_customer_id.b42affccd1' was properly closed.
[0m11:39:32.687327 [info ] [MainThread]: 
[0m11:39:32.688037 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 7.68 seconds (7.68s).
[0m11:39:32.689480 [debug] [MainThread]: Command end result
[0m11:39:32.714241 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m11:39:32.715788 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m11:39:32.721705 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m11:39:32.722049 [info ] [MainThread]: 
[0m11:39:32.722430 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:39:32.722780 [info ] [MainThread]: 
[0m11:39:32.723106 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:39:32.723632 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.561839, "process_in_blocks": "113984", "process_kernel_time": 1.293304, "process_mem_max_rss": "260552", "process_out_blocks": "3272", "process_user_time": 4.043988}
[0m11:39:32.723998 [debug] [MainThread]: Command `dbt test` succeeded at 11:39:32.723911 after 10.56 seconds
[0m11:39:32.724332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53c13c9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53c24030a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53921cfb20>]}
[0m11:39:32.724689 [debug] [MainThread]: Flushing usage events
[0m11:39:33.720385 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:41:11.851067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff168d6de40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff167ca9630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff167ca95d0>]}


============================== 11:41:11.856771 | 042f3c99-a556-499b-a770-fdf344612b98 ==============================
[0m11:41:11.856771 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:41:11.857243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'profiles_dir': '/home/kangh/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:41:13.691952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '042f3c99-a556-499b-a770-fdf344612b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff139e8f430>]}
[0m11:41:13.763059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '042f3c99-a556-499b-a770-fdf344612b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff167cbb550>]}
[0m11:41:13.763906 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m11:41:13.883201 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:41:14.186588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:41:14.187591 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/schema.yml
[0m11:41:14.667038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '042f3c99-a556-499b-a770-fdf344612b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff13953e4a0>]}
[0m11:41:14.757956 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m11:41:14.761412 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m11:41:14.799843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '042f3c99-a556-499b-a770-fdf344612b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff139c08130>]}
[0m11:41:14.800474 [info ] [MainThread]: Found 6 models, 3 snapshots, 6 data tests, 9 sources, 491 macros
[0m11:41:14.800865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '042f3c99-a556-499b-a770-fdf344612b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff13a217130>]}
[0m11:41:14.802705 [info ] [MainThread]: 
[0m11:41:14.803094 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:41:14.803369 [info ] [MainThread]: 
[0m11:41:14.803877 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:41:14.808768 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_ingestion_dim_tables'
[0m11:41:14.809784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:16.471256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m11:41:16.473806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:16.864043 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m11:41:16.866152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:17.260539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '042f3c99-a556-499b-a770-fdf344612b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff169e29e70>]}
[0m11:41:17.261694 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:17.267813 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m11:41:17.268699 [info ] [Thread-1 (]: 1 of 6 START test not_null_dim_customer_customer_city .......................... [RUN]
[0m11:41:17.269763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now test.olist_dataset.not_null_dim_customer_customer_city.98bef70201)
[0m11:41:17.270470 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m11:41:17.291100 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"
[0m11:41:17.291863 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m11:41:17.306312 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"
[0m11:41:17.306992 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_city.98bef70201: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_city
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_city is null



      
    ) dbt_internal_test
[0m11:41:17.307409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:17.968190 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:a8a028e6-8fc3-4c7f-94f9-3cbd9f6e818d&page=queryresults
[0m11:41:19.029746 [info ] [Thread-1 (]: 1 of 6 PASS not_null_dim_customer_customer_city ................................ [[32mPASS[0m in 1.76s]
[0m11:41:19.031646 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m11:41:19.033199 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m11:41:19.035291 [info ] [Thread-1 (]: 2 of 6 START test not_null_dim_customer_customer_id ............................ [RUN]
[0m11:41:19.037253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_city.98bef70201, now test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc)
[0m11:41:19.038726 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m11:41:19.052396 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"
[0m11:41:19.059190 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m11:41:19.066206 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"
[0m11:41:19.067170 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_id is null



      
    ) dbt_internal_test
[0m11:41:19.067642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:19.545073 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:cec672ca-e189-4800-a5fe-558a45b67478&page=queryresults
[0m11:41:20.585571 [info ] [Thread-1 (]: 2 of 6 PASS not_null_dim_customer_customer_id .................................. [[32mPASS[0m in 1.55s]
[0m11:41:20.587092 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m11:41:20.587940 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m11:41:20.588706 [info ] [Thread-1 (]: 3 of 6 START test not_null_dim_customer_customer_state ......................... [RUN]
[0m11:41:20.590122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc, now test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82)
[0m11:41:20.591063 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m11:41:20.600122 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"
[0m11:41:20.601446 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m11:41:20.605715 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"
[0m11:41:20.606827 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_state
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_state is null



      
    ) dbt_internal_test
[0m11:41:20.607488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:21.173370 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:dca1872c-0c7a-4c6e-8f3e-699a81719f4d&page=queryresults
[0m11:41:22.178131 [info ] [Thread-1 (]: 3 of 6 PASS not_null_dim_customer_customer_state ............................... [[32mPASS[0m in 1.59s]
[0m11:41:22.180292 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m11:41:22.181712 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m11:41:22.182587 [info ] [Thread-1 (]: 4 of 6 START test not_null_dim_customer_customer_unique_id ..................... [RUN]
[0m11:41:22.183306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82, now test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4)
[0m11:41:22.183722 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m11:41:22.191436 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"
[0m11:41:22.192690 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m11:41:22.196071 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"
[0m11:41:22.197110 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_unique_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_unique_id is null



      
    ) dbt_internal_test
[0m11:41:22.197649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:22.861967 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:7b97fe52-7844-4a41-8655-537427b06eaf&page=queryresults
[0m11:41:23.813747 [info ] [Thread-1 (]: 4 of 6 PASS not_null_dim_customer_customer_unique_id ........................... [[32mPASS[0m in 1.63s]
[0m11:41:23.815367 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m11:41:23.816407 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m11:41:23.817412 [info ] [Thread-1 (]: 5 of 6 START test not_null_dim_customer_customer_zip_code_prefix ............... [RUN]
[0m11:41:23.819769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4, now test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65)
[0m11:41:23.820969 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m11:41:23.831702 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"
[0m11:41:23.832635 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m11:41:23.835091 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"
[0m11:41:23.835692 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_zip_code_prefix
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_zip_code_prefix is null



      
    ) dbt_internal_test
[0m11:41:23.836062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:24.435137 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:26862bda-328f-40fb-aeac-76a7639e2d22&page=queryresults
[0m11:41:25.365392 [info ] [Thread-1 (]: 5 of 6 PASS not_null_dim_customer_customer_zip_code_prefix ..................... [[32mPASS[0m in 1.55s]
[0m11:41:25.367389 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m11:41:25.368816 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m11:41:25.370229 [info ] [Thread-1 (]: 6 of 6 START test unique_dim_customer_customer_id .............................. [RUN]
[0m11:41:25.370907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65, now test.olist_dataset.unique_dim_customer_customer_id.b42affccd1)
[0m11:41:25.371671 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m11:41:25.386004 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"
[0m11:41:25.388003 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m11:41:25.394645 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"
[0m11:41:25.396606 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_customer_customer_id.b42affccd1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:41:25.397813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:25.827231 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:342fe633-4988-45cb-8948-602ce47b7b8e&page=queryresults
[0m11:41:26.760469 [info ] [Thread-1 (]: 6 of 6 PASS unique_dim_customer_customer_id .................................... [[32mPASS[0m in 1.39s]
[0m11:41:26.762401 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m11:41:26.768130 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:41:26.769656 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:26.770314 [debug] [MainThread]: Connection 'test.olist_dataset.unique_dim_customer_customer_id.b42affccd1' was properly closed.
[0m11:41:26.770877 [info ] [MainThread]: 
[0m11:41:26.771447 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 11.97 seconds (11.97s).
[0m11:41:26.773125 [debug] [MainThread]: Command end result
[0m11:41:26.795198 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m11:41:26.796977 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m11:41:26.803089 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m11:41:26.803430 [info ] [MainThread]: 
[0m11:41:26.803759 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:41:26.804051 [info ] [MainThread]: 
[0m11:41:26.804330 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:41:26.804815 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 15.012936, "process_in_blocks": "124024", "process_kernel_time": 1.38629, "process_mem_max_rss": "265192", "process_out_blocks": "3424", "process_user_time": 4.280298}
[0m11:41:26.805187 [debug] [MainThread]: Command `dbt test` succeeded at 11:41:26.805101 after 15.01 seconds
[0m11:41:26.805507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff168d6de40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff139e8f430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff139a88220>]}
[0m11:41:26.805854 [debug] [MainThread]: Flushing usage events
[0m11:41:27.743235 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:42:09.152112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd2f69e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd1f8d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd1f8d630>]}


============================== 11:42:09.154382 | 28aa38a6-a1b6-4bbc-b719-55f0fcf18e39 ==============================
[0m11:42:09.154382 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:42:09.154846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:42:10.127704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28aa38a6-a1b6-4bbc-b719-55f0fcf18e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd1f9fb50>]}
[0m11:42:10.194796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28aa38a6-a1b6-4bbc-b719-55f0fcf18e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd1f9f580>]}
[0m11:42:10.195524 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m11:42:10.295119 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:42:10.489796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:42:10.490240 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:42:10.544297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28aa38a6-a1b6-4bbc-b719-55f0fcf18e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca3ba5f00>]}
[0m11:42:10.635032 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m11:42:10.636581 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m11:42:10.660100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28aa38a6-a1b6-4bbc-b719-55f0fcf18e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca3bb72e0>]}
[0m11:42:10.660671 [info ] [MainThread]: Found 6 models, 3 snapshots, 6 data tests, 9 sources, 491 macros
[0m11:42:10.661045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28aa38a6-a1b6-4bbc-b719-55f0fcf18e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca84d2e00>]}
[0m11:42:10.662769 [info ] [MainThread]: 
[0m11:42:10.663195 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:42:10.663482 [info ] [MainThread]: 
[0m11:42:10.663946 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:42:10.668556 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_snapshots'
[0m11:42:10.669594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:11.631628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m11:42:11.632269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:12.038059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m11:42:12.038630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:12.437970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28aa38a6-a1b6-4bbc-b719-55f0fcf18e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd1f9db10>]}
[0m11:42:12.439294 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:42:12.446516 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m11:42:12.447536 [info ] [Thread-1 (]: 1 of 6 START test not_null_dim_customer_customer_city .......................... [RUN]
[0m11:42:12.448661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now test.olist_dataset.not_null_dim_customer_customer_city.98bef70201)
[0m11:42:12.449482 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m11:42:12.472163 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"
[0m11:42:12.475165 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m11:42:12.493005 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"
[0m11:42:12.493866 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_city.98bef70201: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_city
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_city is null



      
    ) dbt_internal_test
[0m11:42:12.494318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:13.092528 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:9431654f-4efb-4584-91c2-2d1522d86eaf&page=queryresults
[0m11:42:14.069952 [info ] [Thread-1 (]: 1 of 6 PASS not_null_dim_customer_customer_city ................................ [[32mPASS[0m in 1.62s]
[0m11:42:14.071610 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m11:42:14.072496 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m11:42:14.073191 [info ] [Thread-1 (]: 2 of 6 START test not_null_dim_customer_customer_id ............................ [RUN]
[0m11:42:14.074775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_city.98bef70201, now test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc)
[0m11:42:14.075480 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m11:42:14.084048 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"
[0m11:42:14.085643 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m11:42:14.089889 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"
[0m11:42:14.090890 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_id is null



      
    ) dbt_internal_test
[0m11:42:14.091532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:14.583662 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:accee798-7124-45b1-982e-7b7ea6052318&page=queryresults
[0m11:42:15.473461 [info ] [Thread-1 (]: 2 of 6 PASS not_null_dim_customer_customer_id .................................. [[32mPASS[0m in 1.40s]
[0m11:42:15.475285 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m11:42:15.476438 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m11:42:15.478156 [info ] [Thread-1 (]: 3 of 6 START test not_null_dim_customer_customer_state ......................... [RUN]
[0m11:42:15.479821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc, now test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82)
[0m11:42:15.481177 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m11:42:15.489988 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"
[0m11:42:15.492025 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m11:42:15.501177 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"
[0m11:42:15.503680 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_state
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_state is null



      
    ) dbt_internal_test
[0m11:42:15.505076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:15.948754 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:e76e91a2-8691-421f-98bc-5f8c3ba4a86c&page=queryresults
[0m11:42:16.879690 [info ] [Thread-1 (]: 3 of 6 PASS not_null_dim_customer_customer_state ............................... [[32mPASS[0m in 1.40s]
[0m11:42:16.880994 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m11:42:16.881800 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m11:42:16.882530 [info ] [Thread-1 (]: 4 of 6 START test not_null_dim_customer_customer_unique_id ..................... [RUN]
[0m11:42:16.883420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82, now test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4)
[0m11:42:16.884167 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m11:42:16.894178 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"
[0m11:42:16.895496 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m11:42:16.899585 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"
[0m11:42:16.900964 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_unique_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_unique_id is null



      
    ) dbt_internal_test
[0m11:42:16.901850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:17.349139 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:34dea890-46ce-4be3-9b1b-7fe253a72443&page=queryresults
[0m11:42:18.346727 [info ] [Thread-1 (]: 4 of 6 PASS not_null_dim_customer_customer_unique_id ........................... [[32mPASS[0m in 1.46s]
[0m11:42:18.348144 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m11:42:18.348972 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m11:42:18.349753 [info ] [Thread-1 (]: 5 of 6 START test not_null_dim_customer_customer_zip_code_prefix ............... [RUN]
[0m11:42:18.350712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4, now test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65)
[0m11:42:18.352018 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m11:42:18.361365 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"
[0m11:42:18.362667 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m11:42:18.366311 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"
[0m11:42:18.367106 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_zip_code_prefix
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_zip_code_prefix is null



      
    ) dbt_internal_test
[0m11:42:18.367618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:18.883624 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:050bc142-ed8a-4d89-9c0f-0976d5748d79&page=queryresults
[0m11:42:19.837416 [info ] [Thread-1 (]: 5 of 6 PASS not_null_dim_customer_customer_zip_code_prefix ..................... [[32mPASS[0m in 1.49s]
[0m11:42:19.838856 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m11:42:19.839706 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m11:42:19.840481 [info ] [Thread-1 (]: 6 of 6 START test unique_dim_customer_customer_id .............................. [RUN]
[0m11:42:19.842079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65, now test.olist_dataset.unique_dim_customer_customer_id.b42affccd1)
[0m11:42:19.842936 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m11:42:19.854919 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"
[0m11:42:19.856191 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m11:42:19.860943 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"
[0m11:42:19.861663 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_customer_customer_id.b42affccd1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:42:19.862081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:20.267966 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:80713927-b94c-4e2f-bc79-edf0595f258d&page=queryresults
[0m11:42:21.224283 [info ] [Thread-1 (]: 6 of 6 PASS unique_dim_customer_customer_id .................................... [[32mPASS[0m in 1.38s]
[0m11:42:21.225746 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m11:42:21.230094 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:42:21.231742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:42:21.232528 [debug] [MainThread]: Connection 'test.olist_dataset.unique_dim_customer_customer_id.b42affccd1' was properly closed.
[0m11:42:21.233425 [info ] [MainThread]: 
[0m11:42:21.234352 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 10.57 seconds (10.57s).
[0m11:42:21.236956 [debug] [MainThread]: Command end result
[0m11:42:21.264536 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m11:42:21.266484 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m11:42:21.273010 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m11:42:21.273399 [info ] [MainThread]: 
[0m11:42:21.273795 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:42:21.274088 [info ] [MainThread]: 
[0m11:42:21.274374 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:42:21.274939 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 12.1815815, "process_in_blocks": "8", "process_kernel_time": 1.188632, "process_mem_max_rss": "250928", "process_out_blocks": "2352", "process_user_time": 3.436047}
[0m11:42:21.275363 [debug] [MainThread]: Command `dbt test` succeeded at 11:42:21.275257 after 12.18 seconds
[0m11:42:21.275824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd2f69e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd2e69150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd1f9fb50>]}
[0m11:42:21.276246 [debug] [MainThread]: Flushing usage events
[0m11:42:22.233322 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:43:08.072152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e6005ddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e5ef79540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e5ef794e0>]}


============================== 11:43:08.074622 | 8d55b6d7-e476-4400-b01d-ba8d0d538cf4 ==============================
[0m11:43:08.074622 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:43:08.075131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:43:09.027836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d55b6d7-e476-4400-b01d-ba8d0d538cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e6108cfd0>]}
[0m11:43:09.093543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d55b6d7-e476-4400-b01d-ba8d0d538cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e310d3640>]}
[0m11:43:09.094667 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m11:43:09.196532 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:43:09.401932 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:43:09.402666 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/schema.yml
[0m11:43:09.870387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d55b6d7-e476-4400-b01d-ba8d0d538cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e30808130>]}
[0m11:43:09.959670 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m11:43:09.961223 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m11:43:09.983338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d55b6d7-e476-4400-b01d-ba8d0d538cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e30808160>]}
[0m11:43:09.983911 [info ] [MainThread]: Found 6 models, 3 snapshots, 11 data tests, 9 sources, 491 macros
[0m11:43:09.984293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d55b6d7-e476-4400-b01d-ba8d0d538cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e30faac50>]}
[0m11:43:09.986377 [info ] [MainThread]: 
[0m11:43:09.986900 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:43:09.987251 [info ] [MainThread]: 
[0m11:43:09.987790 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:43:09.993793 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_ingestion_dim_tables'
[0m11:43:09.994954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:11.036125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m11:43:11.038744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:11.441665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m11:43:11.443799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:11.790626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d55b6d7-e476-4400-b01d-ba8d0d538cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e61111d20>]}
[0m11:43:11.791756 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:43:11.798089 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m11:43:11.798929 [info ] [Thread-1 (]: 1 of 11 START test not_null_dim_customer_customer_city ......................... [RUN]
[0m11:43:11.799878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now test.olist_dataset.not_null_dim_customer_customer_city.98bef70201)
[0m11:43:11.800566 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m11:43:11.821863 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"
[0m11:43:11.822558 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m11:43:11.837609 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"
[0m11:43:11.838389 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_city.98bef70201: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_city
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_city is null



      
    ) dbt_internal_test
[0m11:43:11.838819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:12.409168 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:fdbbdcc6-69de-49c7-aeeb-6407692e04ae&page=queryresults
[0m11:43:13.392128 [info ] [Thread-1 (]: 1 of 11 PASS not_null_dim_customer_customer_city ............................... [[32mPASS[0m in 1.59s]
[0m11:43:13.393411 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m11:43:13.394182 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m11:43:13.394853 [info ] [Thread-1 (]: 2 of 11 START test not_null_dim_customer_customer_id ........................... [RUN]
[0m11:43:13.395789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_city.98bef70201, now test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc)
[0m11:43:13.396464 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m11:43:13.404946 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"
[0m11:43:13.405813 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m11:43:13.408189 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"
[0m11:43:13.408780 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_id is null



      
    ) dbt_internal_test
[0m11:43:13.409162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:13.900081 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:603e069a-85af-4d0b-8d82-04b3cd6e36e7&page=queryresults
[0m11:43:14.868823 [info ] [Thread-1 (]: 2 of 11 PASS not_null_dim_customer_customer_id ................................. [[32mPASS[0m in 1.47s]
[0m11:43:14.870110 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m11:43:14.870975 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m11:43:14.872124 [info ] [Thread-1 (]: 3 of 11 START test not_null_dim_customer_customer_state ........................ [RUN]
[0m11:43:14.873149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc, now test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82)
[0m11:43:14.873911 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m11:43:14.879464 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"
[0m11:43:14.880138 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m11:43:14.882403 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"
[0m11:43:14.883027 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_state
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_state is null



      
    ) dbt_internal_test
[0m11:43:14.883431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:15.448967 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:3687e1fc-0205-46db-9e84-7ba619afeb4f&page=queryresults
[0m11:43:16.397777 [info ] [Thread-1 (]: 3 of 11 PASS not_null_dim_customer_customer_state .............................. [[32mPASS[0m in 1.52s]
[0m11:43:16.399392 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m11:43:16.399963 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m11:43:16.400353 [info ] [Thread-1 (]: 4 of 11 START test not_null_dim_customer_customer_unique_id .................... [RUN]
[0m11:43:16.401091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82, now test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4)
[0m11:43:16.401510 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m11:43:16.409069 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"
[0m11:43:16.410436 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m11:43:16.415135 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"
[0m11:43:16.416113 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_unique_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_unique_id is null



      
    ) dbt_internal_test
[0m11:43:16.416742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:16.894026 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:0bf7528d-9790-4a44-b7f6-a71681755d7b&page=queryresults
[0m11:43:17.965718 [info ] [Thread-1 (]: 4 of 11 PASS not_null_dim_customer_customer_unique_id .......................... [[32mPASS[0m in 1.56s]
[0m11:43:17.968307 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m11:43:17.969836 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m11:43:17.971836 [info ] [Thread-1 (]: 5 of 11 START test not_null_dim_customer_customer_zip_code_prefix .............. [RUN]
[0m11:43:17.973991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4, now test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65)
[0m11:43:17.975499 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m11:43:17.991953 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"
[0m11:43:17.993273 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m11:43:17.996298 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"
[0m11:43:17.997078 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_zip_code_prefix
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_zip_code_prefix is null



      
    ) dbt_internal_test
[0m11:43:17.997669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:18.427155 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:720fff3d-b03c-4eff-851b-1a47523f2a1a&page=queryresults
[0m11:43:19.339140 [info ] [Thread-1 (]: 5 of 11 PASS not_null_dim_customer_customer_zip_code_prefix .................... [[32mPASS[0m in 1.37s]
[0m11:43:19.340887 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m11:43:19.341957 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m11:43:19.342944 [info ] [Thread-1 (]: 6 of 11 START test not_null_dim_seller_seller_city ............................. [RUN]
[0m11:43:19.344964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65, now test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d)
[0m11:43:19.345968 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m11:43:19.356630 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d"
[0m11:43:19.358376 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m11:43:19.362662 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d"
[0m11:43:19.363580 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_city
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_city is null



      
    ) dbt_internal_test
[0m11:43:19.364400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:19.991872 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:88d60f52-c89f-4226-9ecf-0cc2fb7fed77&page=queryresults
[0m11:43:20.954205 [info ] [Thread-1 (]: 6 of 11 PASS not_null_dim_seller_seller_city ................................... [[32mPASS[0m in 1.61s]
[0m11:43:20.955724 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m11:43:20.956585 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m11:43:20.957377 [info ] [Thread-1 (]: 7 of 11 START test not_null_dim_seller_seller_id ............................... [RUN]
[0m11:43:20.958949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d, now test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2)
[0m11:43:20.960029 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m11:43:20.969353 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2"
[0m11:43:20.970587 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m11:43:20.974589 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2"
[0m11:43:20.975559 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_id is null



      
    ) dbt_internal_test
[0m11:43:20.976262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:21.633605 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d90529e4-cbce-4214-b0b8-034a28c1dd35&page=queryresults
[0m11:43:22.576946 [info ] [Thread-1 (]: 7 of 11 PASS not_null_dim_seller_seller_id ..................................... [[32mPASS[0m in 1.62s]
[0m11:43:22.578000 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m11:43:22.578561 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m11:43:22.579283 [info ] [Thread-1 (]: 8 of 11 START test not_null_dim_seller_seller_state ............................ [RUN]
[0m11:43:22.579880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2, now test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb)
[0m11:43:22.580263 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m11:43:22.585603 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb"
[0m11:43:22.586294 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m11:43:22.591019 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb"
[0m11:43:22.592780 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_state
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_state is null



      
    ) dbt_internal_test
[0m11:43:22.593651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:23.171423 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:ce129a1b-7a7d-4269-81d4-d04231a180d4&page=queryresults
[0m11:43:24.168605 [info ] [Thread-1 (]: 8 of 11 PASS not_null_dim_seller_seller_state .................................. [[32mPASS[0m in 1.59s]
[0m11:43:24.170158 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m11:43:24.171082 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m11:43:24.172681 [info ] [Thread-1 (]: 9 of 11 START test not_null_dim_seller_seller_zip_code_prefix .................. [RUN]
[0m11:43:24.175008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb, now test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472)
[0m11:43:24.176030 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m11:43:24.183046 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472"
[0m11:43:24.183893 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m11:43:24.186280 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472"
[0m11:43:24.186913 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_zip_code_prefix
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_zip_code_prefix is null



      
    ) dbt_internal_test
[0m11:43:24.187293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:24.788342 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:ebb5d230-8834-4a11-a82a-642d7240a961&page=queryresults
[0m11:43:25.766181 [info ] [Thread-1 (]: 9 of 11 PASS not_null_dim_seller_seller_zip_code_prefix ........................ [[32mPASS[0m in 1.59s]
[0m11:43:25.768587 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m11:43:25.770580 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m11:43:25.772716 [info ] [Thread-1 (]: 10 of 11 START test unique_dim_customer_customer_id ............................ [RUN]
[0m11:43:25.774637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472, now test.olist_dataset.unique_dim_customer_customer_id.b42affccd1)
[0m11:43:25.776529 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m11:43:25.796066 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"
[0m11:43:25.796937 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m11:43:25.802558 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"
[0m11:43:25.804324 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_customer_customer_id.b42affccd1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:43:25.805276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:26.273137 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:75a12a70-8687-4a42-b7ca-5e608cc800e1&page=queryresults
[0m11:43:27.156382 [info ] [Thread-1 (]: 10 of 11 PASS unique_dim_customer_customer_id .................................. [[32mPASS[0m in 1.38s]
[0m11:43:27.157861 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m11:43:27.158685 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m11:43:27.159756 [info ] [Thread-1 (]: 11 of 11 START test unique_dim_seller_seller_id ................................ [RUN]
[0m11:43:27.160809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.unique_dim_customer_customer_id.b42affccd1, now test.olist_dataset.unique_dim_seller_seller_id.a1add5f830)
[0m11:43:27.161700 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m11:43:27.170523 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_seller_seller_id.a1add5f830"
[0m11:43:27.171453 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m11:43:27.173738 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_seller_seller_id.a1add5f830"
[0m11:43:27.174399 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_seller_seller_id.a1add5f830: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_seller_seller_id.a1add5f830"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select seller_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
  where seller_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:43:27.174806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:27.878139 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:c9df948a-0eb1-4ceb-bcad-80f6712cdfa3&page=queryresults
[0m11:43:28.846261 [info ] [Thread-1 (]: 11 of 11 PASS unique_dim_seller_seller_id ...................................... [[32mPASS[0m in 1.69s]
[0m11:43:28.848846 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m11:43:28.855207 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:43:28.857875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:43:28.859074 [debug] [MainThread]: Connection 'test.olist_dataset.unique_dim_seller_seller_id.a1add5f830' was properly closed.
[0m11:43:28.860159 [info ] [MainThread]: 
[0m11:43:28.860641 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 18.87 seconds (18.87s).
[0m11:43:28.866706 [debug] [MainThread]: Command end result
[0m11:43:28.904238 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m11:43:28.906325 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m11:43:28.914177 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m11:43:28.914659 [info ] [MainThread]: 
[0m11:43:28.915223 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:43:28.915652 [info ] [MainThread]: 
[0m11:43:28.916047 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m11:43:28.916798 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 20.90267, "process_in_blocks": "0", "process_kernel_time": 1.275885, "process_mem_max_rss": "264080", "process_out_blocks": "3616", "process_user_time": 3.959295}
[0m11:43:28.917339 [debug] [MainThread]: Command `dbt test` succeeded at 11:43:28.917215 after 20.90 seconds
[0m11:43:28.917857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e6005ddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e6108cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e307a13f0>]}
[0m11:43:28.918326 [debug] [MainThread]: Flushing usage events
[0m11:43:29.891213 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:14.315459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c4d91e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c3cc5630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c3cc55d0>]}


============================== 11:46:14.317806 | 4f0b2a6c-a741-4ecd-8039-9ecc11bd5496 ==============================
[0m11:46:14.317806 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:46:14.318282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --models dim_customer dim_seller', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:46:15.276452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f0b2a6c-a741-4ecd-8039-9ecc11bd5496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c3c615a0>]}
[0m11:46:15.341966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f0b2a6c-a741-4ecd-8039-9ecc11bd5496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa595d00fa0>]}
[0m11:46:15.342710 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m11:46:15.442746 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:46:15.644090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:46:15.644544 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:46:15.698298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f0b2a6c-a741-4ecd-8039-9ecc11bd5496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5959cc1f0>]}
[0m11:46:15.790391 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m11:46:15.792034 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m11:46:15.815169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f0b2a6c-a741-4ecd-8039-9ecc11bd5496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5957e9c60>]}
[0m11:46:15.815766 [info ] [MainThread]: Found 6 models, 3 snapshots, 11 data tests, 9 sources, 491 macros
[0m11:46:15.816123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f0b2a6c-a741-4ecd-8039-9ecc11bd5496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa596242d10>]}
[0m11:46:15.817855 [info ] [MainThread]: 
[0m11:46:15.818286 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:46:15.818589 [info ] [MainThread]: 
[0m11:46:15.819076 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:46:15.823982 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_ingestion_fact_tables'
[0m11:46:15.824541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:16.851638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m11:46:16.852898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:17.217258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m11:46:17.218234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:17.571077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f0b2a6c-a741-4ecd-8039-9ecc11bd5496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c5e49e70>]}
[0m11:46:17.572165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:46:17.578415 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m11:46:17.579319 [info ] [Thread-1 (]: 1 of 11 START test not_null_dim_customer_customer_city ......................... [RUN]
[0m11:46:17.580349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now test.olist_dataset.not_null_dim_customer_customer_city.98bef70201)
[0m11:46:17.581028 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m11:46:17.604543 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"
[0m11:46:17.605251 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m11:46:17.620382 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"
[0m11:46:17.621034 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_city.98bef70201: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_city
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_city is null



      
    ) dbt_internal_test
[0m11:46:17.621452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:18.306194 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:1c9b7164-cad6-4d3e-8214-79edf3b1b855&page=queryresults
[0m11:46:19.296979 [info ] [Thread-1 (]: 1 of 11 PASS not_null_dim_customer_customer_city ............................... [[32mPASS[0m in 1.72s]
[0m11:46:19.298328 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m11:46:19.299035 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m11:46:19.299671 [info ] [Thread-1 (]: 2 of 11 START test not_null_dim_customer_customer_id ........................... [RUN]
[0m11:46:19.301011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_city.98bef70201, now test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc)
[0m11:46:19.301803 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m11:46:19.307667 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"
[0m11:46:19.308383 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m11:46:19.310907 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"
[0m11:46:19.311604 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_id is null



      
    ) dbt_internal_test
[0m11:46:19.312186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:19.839204 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:36c68714-3300-4a3e-bcba-cbf81684c328&page=queryresults
[0m11:46:20.805151 [info ] [Thread-1 (]: 2 of 11 PASS not_null_dim_customer_customer_id ................................. [[32mPASS[0m in 1.50s]
[0m11:46:20.806525 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m11:46:20.807406 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m11:46:20.808212 [info ] [Thread-1 (]: 3 of 11 START test not_null_dim_customer_customer_state ........................ [RUN]
[0m11:46:20.809812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc, now test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82)
[0m11:46:20.810711 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m11:46:20.818769 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"
[0m11:46:20.819769 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m11:46:20.823240 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"
[0m11:46:20.824084 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_state
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_state is null



      
    ) dbt_internal_test
[0m11:46:20.824596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:21.365308 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d1d919ab-6a3b-4988-9416-4366494af7b3&page=queryresults
[0m11:46:22.299694 [info ] [Thread-1 (]: 3 of 11 PASS not_null_dim_customer_customer_state .............................. [[32mPASS[0m in 1.49s]
[0m11:46:22.300675 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m11:46:22.301159 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m11:46:22.301602 [info ] [Thread-1 (]: 4 of 11 START test not_null_dim_customer_customer_unique_id .................... [RUN]
[0m11:46:22.302691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82, now test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4)
[0m11:46:22.303128 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m11:46:22.309389 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"
[0m11:46:22.310088 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m11:46:22.312230 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"
[0m11:46:22.312812 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_unique_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_unique_id is null



      
    ) dbt_internal_test
[0m11:46:22.313199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:22.783811 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:ef0b77f3-6e92-458c-a282-b647ca92d355&page=queryresults
[0m11:46:23.734475 [info ] [Thread-1 (]: 4 of 11 PASS not_null_dim_customer_customer_unique_id .......................... [[32mPASS[0m in 1.43s]
[0m11:46:23.736250 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m11:46:23.737437 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m11:46:23.738953 [info ] [Thread-1 (]: 5 of 11 START test not_null_dim_customer_customer_zip_code_prefix .............. [RUN]
[0m11:46:23.740487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4, now test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65)
[0m11:46:23.741598 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m11:46:23.751888 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"
[0m11:46:23.753016 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m11:46:23.756293 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"
[0m11:46:23.757031 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_zip_code_prefix
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_zip_code_prefix is null



      
    ) dbt_internal_test
[0m11:46:23.757468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:24.296741 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:226750f4-738e-476c-aafc-b35490870fa1&page=queryresults
[0m11:46:25.225813 [info ] [Thread-1 (]: 5 of 11 PASS not_null_dim_customer_customer_zip_code_prefix .................... [[32mPASS[0m in 1.49s]
[0m11:46:25.227377 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m11:46:25.228332 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m11:46:25.229101 [info ] [Thread-1 (]: 6 of 11 START test not_null_dim_seller_seller_city ............................. [RUN]
[0m11:46:25.230098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65, now test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d)
[0m11:46:25.231287 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m11:46:25.239426 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d"
[0m11:46:25.240420 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m11:46:25.245115 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d"
[0m11:46:25.246178 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_city
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_city is null



      
    ) dbt_internal_test
[0m11:46:25.246795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:25.701095 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:36325c44-bec0-428e-ac4e-12e77dac45bf&page=queryresults
[0m11:46:26.664942 [info ] [Thread-1 (]: 6 of 11 PASS not_null_dim_seller_seller_city ................................... [[32mPASS[0m in 1.43s]
[0m11:46:26.667030 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m11:46:26.668946 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m11:46:26.672513 [info ] [Thread-1 (]: 7 of 11 START test not_null_dim_seller_seller_id ............................... [RUN]
[0m11:46:26.673794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d, now test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2)
[0m11:46:26.674612 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m11:46:26.681895 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2"
[0m11:46:26.682807 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m11:46:26.685316 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2"
[0m11:46:26.686000 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_id is null



      
    ) dbt_internal_test
[0m11:46:26.686402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:27.255947 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:34e325f0-f6fa-44ee-9184-70056b3d61d6&page=queryresults
[0m11:46:28.208398 [info ] [Thread-1 (]: 7 of 11 PASS not_null_dim_seller_seller_id ..................................... [[32mPASS[0m in 1.53s]
[0m11:46:28.209977 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m11:46:28.210983 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m11:46:28.211898 [info ] [Thread-1 (]: 8 of 11 START test not_null_dim_seller_seller_state ............................ [RUN]
[0m11:46:28.212991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2, now test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb)
[0m11:46:28.213852 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m11:46:28.222670 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb"
[0m11:46:28.223604 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m11:46:28.226705 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb"
[0m11:46:28.227717 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_state
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_state is null



      
    ) dbt_internal_test
[0m11:46:28.228143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:28.751884 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:4d75a0f8-2ad5-4c0c-b509-1d18be9e4a9a&page=queryresults
[0m11:46:29.721961 [info ] [Thread-1 (]: 8 of 11 PASS not_null_dim_seller_seller_state .................................. [[32mPASS[0m in 1.51s]
[0m11:46:29.724156 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m11:46:29.725957 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m11:46:29.726812 [info ] [Thread-1 (]: 9 of 11 START test not_null_dim_seller_seller_zip_code_prefix .................. [RUN]
[0m11:46:29.728186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb, now test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472)
[0m11:46:29.729341 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m11:46:29.734077 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472"
[0m11:46:29.735777 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m11:46:29.738842 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472"
[0m11:46:29.739547 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_zip_code_prefix
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_zip_code_prefix is null



      
    ) dbt_internal_test
[0m11:46:29.739964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:30.242559 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:e5cfceb6-058d-4225-afac-bccee72ce920&page=queryresults
[0m11:46:31.190989 [info ] [Thread-1 (]: 9 of 11 PASS not_null_dim_seller_seller_zip_code_prefix ........................ [[32mPASS[0m in 1.46s]
[0m11:46:31.191905 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m11:46:31.192567 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m11:46:31.193173 [info ] [Thread-1 (]: 10 of 11 START test unique_dim_customer_customer_id ............................ [RUN]
[0m11:46:31.193720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472, now test.olist_dataset.unique_dim_customer_customer_id.b42affccd1)
[0m11:46:31.194064 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m11:46:31.200652 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"
[0m11:46:31.201510 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m11:46:31.203862 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"
[0m11:46:31.204534 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_customer_customer_id.b42affccd1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:46:31.204982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:31.775900 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:06f8973a-e262-4a8a-b45d-3f7e4b596179&page=queryresults
[0m11:46:32.750875 [info ] [Thread-1 (]: 10 of 11 PASS unique_dim_customer_customer_id .................................. [[32mPASS[0m in 1.56s]
[0m11:46:32.752714 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m11:46:32.753708 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m11:46:32.755355 [info ] [Thread-1 (]: 11 of 11 START test unique_dim_seller_seller_id ................................ [RUN]
[0m11:46:32.756793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.unique_dim_customer_customer_id.b42affccd1, now test.olist_dataset.unique_dim_seller_seller_id.a1add5f830)
[0m11:46:32.757837 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m11:46:32.769026 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_seller_seller_id.a1add5f830"
[0m11:46:32.770501 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m11:46:32.774312 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_seller_seller_id.a1add5f830"
[0m11:46:32.775103 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_seller_seller_id.a1add5f830: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_seller_seller_id.a1add5f830"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select seller_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
  where seller_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:46:32.775580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:33.324627 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:c938b860-837c-4728-a5c8-a86757425ed6&page=queryresults
[0m11:46:34.308321 [info ] [Thread-1 (]: 11 of 11 PASS unique_dim_seller_seller_id ...................................... [[32mPASS[0m in 1.55s]
[0m11:46:34.309808 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m11:46:34.314496 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:46:34.316105 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:34.316907 [debug] [MainThread]: Connection 'test.olist_dataset.unique_dim_seller_seller_id.a1add5f830' was properly closed.
[0m11:46:34.317755 [info ] [MainThread]: 
[0m11:46:34.318612 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 18.50 seconds (18.50s).
[0m11:46:34.322867 [debug] [MainThread]: Command end result
[0m11:46:34.349462 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m11:46:34.351448 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m11:46:34.358646 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m11:46:34.358981 [info ] [MainThread]: 
[0m11:46:34.359412 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:46:34.359750 [info ] [MainThread]: 
[0m11:46:34.360100 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m11:46:34.360730 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 20.102774, "process_in_blocks": "0", "process_kernel_time": 1.224406, "process_mem_max_rss": "254304", "process_out_blocks": "2536", "process_user_time": 3.743471}
[0m11:46:34.361143 [debug] [MainThread]: Command `dbt test` succeeded at 11:46:34.361032 after 20.10 seconds
[0m11:46:34.361534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c4d91e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c3c615a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c4a3aa10>]}
[0m11:46:34.361880 [debug] [MainThread]: Flushing usage events
[0m11:46:35.327849 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:47:36.881514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ec7b1e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3eb6f1690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3eb6f1630>]}


============================== 11:47:36.883782 | 63b9a67b-88fa-42a7-aa81-60367ea28b20 ==============================
[0m11:47:36.883782 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:47:36.884253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'version_check': 'True', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --models dim_product', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:47:37.845829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63b9a67b-88fa-42a7-aa81-60367ea28b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3bd8eab90>]}
[0m11:47:37.910894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63b9a67b-88fa-42a7-aa81-60367ea28b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ebd8ff10>]}
[0m11:47:37.911979 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m11:47:38.009917 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:47:38.212806 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:47:38.213539 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/schema.yml
[0m11:47:38.672854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63b9a67b-88fa-42a7-aa81-60367ea28b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3bcf97e50>]}
[0m11:47:38.762333 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m11:47:38.763854 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m11:47:38.785996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63b9a67b-88fa-42a7-aa81-60367ea28b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3bd87e9e0>]}
[0m11:47:38.786568 [info ] [MainThread]: Found 6 models, 3 snapshots, 14 data tests, 9 sources, 491 macros
[0m11:47:38.786933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63b9a67b-88fa-42a7-aa81-60367ea28b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3eb689300>]}
[0m11:47:38.788387 [info ] [MainThread]: 
[0m11:47:38.788789 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:47:38.789111 [info ] [MainThread]: 
[0m11:47:38.789609 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:47:38.794240 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_snapshots'
[0m11:47:38.794877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:39.821718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m11:47:39.824011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:47:40.180632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m11:47:40.181598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:47:40.578327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63b9a67b-88fa-42a7-aa81-60367ea28b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3eb705b40>]}
[0m11:47:40.580002 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:47:40.587399 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492
[0m11:47:40.588706 [info ] [Thread-1 (]: 1 of 3 START test not_null_dim_product_product_category_name ................... [RUN]
[0m11:47:40.590114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492)
[0m11:47:40.591094 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492
[0m11:47:40.627735 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492"
[0m11:47:40.628680 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492
[0m11:47:40.644463 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492"
[0m11:47:40.645284 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_category_name
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
where product_category_name is null



      
    ) dbt_internal_test
[0m11:47:40.645769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:47:41.396144 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:9d8526a0-076a-47b1-8abf-397edfe2bf34&page=queryresults
[0m11:47:42.432662 [error] [Thread-1 (]: 1 of 3 FAIL 610 not_null_dim_product_product_category_name ..................... [[31mFAIL 610[0m in 1.84s]
[0m11:47:42.435053 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492
[0m11:47:42.436332 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_product_product_id.02b1f06816
[0m11:47:42.438127 [info ] [Thread-1 (]: 2 of 3 START test not_null_dim_product_product_id .............................. [RUN]
[0m11:47:42.439621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492, now test.olist_dataset.not_null_dim_product_product_id.02b1f06816)
[0m11:47:42.440636 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_product_product_id.02b1f06816
[0m11:47:42.451978 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_product_product_id.02b1f06816"
[0m11:47:42.455009 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_product_product_id.02b1f06816
[0m11:47:42.462423 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_product_product_id.02b1f06816"
[0m11:47:42.464460 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_product_product_id.02b1f06816"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
where product_id is null



      
    ) dbt_internal_test
[0m11:47:42.465767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:47:43.233901 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:53a73c58-525e-45e5-8b3f-4ca06f4642b9&page=queryresults
[0m11:47:44.336136 [info ] [Thread-1 (]: 2 of 3 PASS not_null_dim_product_product_id .................................... [[32mPASS[0m in 1.90s]
[0m11:47:44.337670 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_product_product_id.02b1f06816
[0m11:47:44.338245 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_product_product_id.46495bf7fe
[0m11:47:44.338605 [info ] [Thread-1 (]: 3 of 3 START test unique_dim_product_product_id ................................ [RUN]
[0m11:47:44.339112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_product_product_id.02b1f06816, now test.olist_dataset.unique_dim_product_product_id.46495bf7fe)
[0m11:47:44.339467 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_product_product_id.46495bf7fe
[0m11:47:44.345620 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_product_product_id.46495bf7fe"
[0m11:47:44.346274 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_product_product_id.46495bf7fe
[0m11:47:44.348424 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_product_product_id.46495bf7fe"
[0m11:47:44.349032 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_product_product_id.46495bf7fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:47:44.349477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:47:45.263471 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:1f1dd9c1-45c9-4902-8f9d-0e2725312ac1&page=queryresults
[0m11:47:46.220958 [info ] [Thread-1 (]: 3 of 3 PASS unique_dim_product_product_id ...................................... [[32mPASS[0m in 1.88s]
[0m11:47:46.222395 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_product_product_id.46495bf7fe
[0m11:47:46.226212 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:47:46.227753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:47:46.228463 [debug] [MainThread]: Connection 'test.olist_dataset.unique_dim_product_product_id.46495bf7fe' was properly closed.
[0m11:47:46.229260 [info ] [MainThread]: 
[0m11:47:46.230024 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 7.44 seconds (7.44s).
[0m11:47:46.231966 [debug] [MainThread]: Command end result
[0m11:47:46.258791 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m11:47:46.260581 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m11:47:46.266434 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m11:47:46.266761 [info ] [MainThread]: 
[0m11:47:46.267107 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:47:46.267471 [info ] [MainThread]: 
[0m11:47:46.267837 [error] [MainThread]: [31mFailure in test not_null_dim_product_product_category_name (models/schema.yml)[0m
[0m11:47:46.268174 [error] [MainThread]:   Got 610 results, configured to fail if != 0
[0m11:47:46.268454 [info ] [MainThread]: 
[0m11:47:46.268766 [info ] [MainThread]:   compiled code at target/compiled/olist_dataset/models/schema.yml/not_null_dim_product_product_category_name.sql
[0m11:47:46.269039 [info ] [MainThread]: 
[0m11:47:46.269329 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:47:46.269908 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 9.446588, "process_in_blocks": "0", "process_kernel_time": 1.272234, "process_mem_max_rss": "258500", "process_out_blocks": "3472", "process_user_time": 3.92777}
[0m11:47:46.270305 [debug] [MainThread]: Command `dbt test` failed at 11:47:46.270217 after 9.45 seconds
[0m11:47:46.270690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ec7b1e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3bce075e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ec465840>]}
[0m11:47:46.271057 [debug] [MainThread]: Flushing usage events
[0m11:47:47.218705 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:01:14.847069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2778e79e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2777d89510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2777d894b0>]}


============================== 12:01:14.852209 | 71dd5f5b-b799-4d0d-a7d3-cc3c8b357ef5 ==============================
[0m12:01:14.852209 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:01:14.852802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'profiles_dir': '/home/kangh/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:01:16.830011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71dd5f5b-b799-4d0d-a7d3-cc3c8b357ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2778448160>]}
[0m12:01:16.907957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71dd5f5b-b799-4d0d-a7d3-cc3c8b357ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2777dc73d0>]}
[0m12:01:16.908724 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:01:17.027899 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:01:17.339807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:01:17.340548 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_product.sql
[0m12:01:17.808037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71dd5f5b-b799-4d0d-a7d3-cc3c8b357ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27496403d0>]}
[0m12:01:17.898083 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:01:17.900058 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:01:17.928731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71dd5f5b-b799-4d0d-a7d3-cc3c8b357ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27498f22c0>]}
[0m12:01:17.929333 [info ] [MainThread]: Found 6 models, 3 snapshots, 14 data tests, 9 sources, 491 macros
[0m12:01:17.929749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71dd5f5b-b799-4d0d-a7d3-cc3c8b357ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27793f5ae0>]}
[0m12:01:17.931717 [info ] [MainThread]: 
[0m12:01:17.932178 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:01:17.932498 [info ] [MainThread]: 
[0m12:01:17.933010 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:01:17.937661 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m12:01:17.938605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:19.609653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:19.970070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m12:01:19.971039 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:20.374214 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:01:20.376100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:20.747173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m12:01:20.748005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:21.123335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71dd5f5b-b799-4d0d-a7d3-cc3c8b357ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2779f39e70>]}
[0m12:01:21.124363 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:01:21.129186 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m12:01:21.130570 [info ] [Thread-1 (]: 1 of 6 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m12:01:21.133191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now model.olist_dataset.dim_customer)
[0m12:01:21.134050 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m12:01:21.156518 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m12:01:21.160657 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m12:01:21.191273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:21.885109 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m12:01:21.886406 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 


-- This is snapshot approach, refer to customer_snapshot.sql (Type 2 SCD)


SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:01:22.463553 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:f96092bb-1165-4713-bfe9-8d8e20301221&page=queryresults
[0m12:01:25.836493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71dd5f5b-b799-4d0d-a7d3-cc3c8b357ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2777d99b70>]}
[0m12:01:25.837332 [info ] [Thread-1 (]: 1 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_customer . [[32mCREATE TABLE (99.4k rows, 9.5 MiB processed)[0m in 4.70s]
[0m12:01:25.837967 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m12:01:25.838360 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m12:01:25.838810 [info ] [Thread-1 (]: 2 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m12:01:25.839528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_customer, now model.olist_dataset.dim_geolocation)
[0m12:01:25.840533 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m12:01:25.847150 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m12:01:25.848385 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m12:01:25.877216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:26.250976 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m12:01:26.251761 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation` as DBT_INTERNAL_DEST
        using (-- models/star/dim_geolocation.sql

-- This is incremental approach (Type 1 SCD)


WITH source AS (
    SELECT
        geolocation_zip_code_prefix,
        geolocation_city,
        geolocation_state,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source


  WHERE geolocation_zip_code_prefix NOT IN (
      SELECT geolocation_zip_code_prefix FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
  )

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.geolocation_zip_code_prefix = DBT_INTERNAL_DEST.geolocation_zip_code_prefix))

    
    when matched then update set
        `geolocation_zip_code_prefix` = DBT_INTERNAL_SOURCE.`geolocation_zip_code_prefix`,`geolocation_city` = DBT_INTERNAL_SOURCE.`geolocation_city`,`geolocation_state` = DBT_INTERNAL_SOURCE.`geolocation_state`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)
    values
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)


    
[0m12:01:26.870831 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:14988e1c-84c3-4ca8-b3ba-f7c5342621e0&page=queryresults
[0m12:01:51.049911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71dd5f5b-b799-4d0d-a7d3-cc3c8b357ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2749b6c5b0>]}
[0m12:01:51.051241 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[32mMERGE (0.0 rows, 62.1 MiB processed)[0m in 25.21s]
[0m12:01:51.052421 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m12:01:51.053152 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m12:01:51.054055 [info ] [Thread-1 (]: 3 of 6 START sql table model olist_data_ingestion_dim_tables.dim_product ....... [RUN]
[0m12:01:51.055017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_geolocation, now model.olist_dataset.dim_product)
[0m12:01:51.055764 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m12:01:51.065297 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m12:01:51.066478 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m12:01:51.069718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:51.423473 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m12:01:51.425033 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_product.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         product_id,
--         product_category_name,
--         product_name_lenght,
--         product_description_lenght,
--         product_photos_qty,
--         product_weight_g,
--         product_length_cm,
--         product_height_cm,
--         product_width_cm,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
-- )

-- SELECT * FROM source

-- 

-- This is snapshot approach, refer to product_snapshot (Type 2 SCD)


SELECT
    product_id,
    COALESCE(product_category_name, 'UNKNOWN') AS product_category_name
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:01:51.728009 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:6bb68463-80b1-4e98-bdb4-ac0fb16c1e3e&page=queryresults
[0m12:01:51.728990 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:6bb68463-80b1-4e98-bdb4-ac0fb16c1e3e&page=queryresults
[0m12:01:51.752130 [debug] [Thread-1 (]: Database Error in model dim_product (models/star/dim_product.sql)
  Syntax error: Expected ")" but got identifier "product_name_lenght" at [43:5]
  compiled code at target/run/olist_dataset/models/star/dim_product.sql
[0m12:01:51.753401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71dd5f5b-b799-4d0d-a7d3-cc3c8b357ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2777d99b70>]}
[0m12:01:51.754653 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model olist_data_ingestion_dim_tables.dim_product  [[31mERROR[0m in 0.70s]
[0m12:01:51.755645 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m12:01:51.756292 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_seller
[0m12:01:51.757023 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_product' to be skipped because of status 'error'.  Reason: Database Error in model dim_product (models/star/dim_product.sql)
  Syntax error: Expected ")" but got identifier "product_name_lenght" at [43:5]
  compiled code at target/run/olist_dataset/models/star/dim_product.sql.
[0m12:01:51.758039 [info ] [Thread-1 (]: 4 of 6 START sql table model olist_data_ingestion_dim_tables.dim_seller ........ [RUN]
[0m12:01:51.760067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_product, now model.olist_dataset.dim_seller)
[0m12:01:51.760799 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_seller
[0m12:01:51.767642 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_seller"
[0m12:01:51.768857 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_seller
[0m12:01:51.772419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:52.244331 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_seller"
[0m12:01:52.245243 [debug] [Thread-1 (]: On model.olist_dataset.dim_seller: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_seller"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_seller.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         seller_id,
--         seller_zip_code_prefix,
--         seller_city,
--         seller_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`
-- )

-- SELECT * FROM source

-- 


-- This is snapshot approach, refer to seller_snapshot (Type 2 SCD)


SELECT
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:01:52.785784 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:c41e3f60-c44b-4a45-afe5-52dd044fd9a3&page=queryresults
[0m12:01:55.394544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71dd5f5b-b799-4d0d-a7d3-cc3c8b357ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2777d99b70>]}
[0m12:01:55.395791 [info ] [Thread-1 (]: 4 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_seller ... [[32mCREATE TABLE (3.1k rows, 200.0 KiB processed)[0m in 3.63s]
[0m12:01:55.396474 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_seller
[0m12:01:55.396855 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m12:01:55.397270 [info ] [Thread-1 (]: 5 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m12:01:55.397753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_seller, now model.olist_dataset.fact_order_items)
[0m12:01:55.398117 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m12:01:55.402159 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m12:01:55.402944 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m12:01:55.405499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:55.773062 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m12:01:55.774529 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    LEFT JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order item id that already in fact_order_item table
-- which assume data already in table never change

-- 
--   WHERE order_id_item NOT IN (SELECT order_id_item FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id_item = DBT_INTERNAL_DEST.order_id_item))

    
    when matched then update set
        `customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_id` = DBT_INTERNAL_SOURCE.`order_id`,`order_item_id` = DBT_INTERNAL_SOURCE.`order_item_id`,`product_id` = DBT_INTERNAL_SOURCE.`product_id`,`seller_id` = DBT_INTERNAL_SOURCE.`seller_id`,`price` = DBT_INTERNAL_SOURCE.`price`,`freight_value` = DBT_INTERNAL_SOURCE.`freight_value`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`order_id_item` = DBT_INTERNAL_SOURCE.`order_id_item`
    

    when not matched then insert
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)
    values
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)


    
[0m12:01:56.307117 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:cf02bcac-bb24-487a-8280-6f6230edbf12&page=queryresults
[0m12:02:03.345794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71dd5f5b-b799-4d0d-a7d3-cc3c8b357ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f274854e410>]}
[0m12:02:03.347190 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mMERGE (112.7k rows, 57.9 MiB processed)[0m in 7.95s]
[0m12:02:03.348404 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m12:02:03.349231 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m12:02:03.350713 [info ] [Thread-1 (]: 6 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m12:02:03.351913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.fact_order_items, now model.olist_dataset.fact_orders)
[0m12:02:03.352777 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m12:02:03.360113 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m12:02:03.363284 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m12:02:03.366501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:03.729639 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m12:02:03.731142 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order id that already in fact_orders table
-- which assume data already in table never change

-- 
--   WHERE order_id NOT IN (SELECT order_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        `order_id` = DBT_INTERNAL_SOURCE.`order_id`,`customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_status` = DBT_INTERNAL_SOURCE.`order_status`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_carrier_date` = DBT_INTERNAL_SOURCE.`order_delivered_carrier_date`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`payment_value` = DBT_INTERNAL_SOURCE.`payment_value`
    

    when not matched then insert
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)
    values
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)


    
[0m12:02:04.287105 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:619476d9-dc5a-48b9-a878-fce968ff051a&page=queryresults
[0m12:02:10.628146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71dd5f5b-b799-4d0d-a7d3-cc3c8b357ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2777d99b70>]}
[0m12:02:10.629315 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mMERGE (99.4k rows, 39.6 MiB processed)[0m in 7.28s]
[0m12:02:10.630393 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m12:02:10.633743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:02:10.635228 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:10.635942 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m12:02:10.636819 [info ] [MainThread]: 
[0m12:02:10.637554 [info ] [MainThread]: Finished running 3 incremental models, 3 table models in 0 hours 0 minutes and 52.70 seconds (52.70s).
[0m12:02:10.640181 [debug] [MainThread]: Command end result
[0m12:02:10.675168 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:02:10.678651 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:02:10.684138 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:02:10.684482 [info ] [MainThread]: 
[0m12:02:10.684827 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:02:10.685181 [info ] [MainThread]: 
[0m12:02:10.685539 [error] [MainThread]:   Database Error in model dim_product (models/star/dim_product.sql)
  Syntax error: Expected ")" but got identifier "product_name_lenght" at [43:5]
  compiled code at target/run/olist_dataset/models/star/dim_product.sql
[0m12:02:10.685818 [info ] [MainThread]: 
[0m12:02:10.686105 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m12:02:10.686674 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 55.90092, "process_in_blocks": "123976", "process_kernel_time": 1.451274, "process_mem_max_rss": "266200", "process_out_blocks": "3600", "process_user_time": 4.384057}
[0m12:02:10.687046 [debug] [MainThread]: Command `dbt run` failed at 12:02:10.686958 after 55.90 seconds
[0m12:02:10.687400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2778e79e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27495d94b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2778b1d9f0>]}
[0m12:02:10.687739 [debug] [MainThread]: Flushing usage events
[0m12:02:11.912256 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:02:51.473732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4338b9ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4327e15a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4327e1540>]}


============================== 12:02:51.478003 | 7968c1db-d3b8-43ae-a431-edee0487898b ==============================
[0m12:02:51.478003 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:02:51.478541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'debug': 'False', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:02:53.052083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7968c1db-d3b8-43ae-a431-edee0487898b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4348f7760>]}
[0m12:02:53.119057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7968c1db-d3b8-43ae-a431-edee0487898b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4327f3430>]}
[0m12:02:53.119770 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:02:53.228454 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:02:53.511273 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:02:53.512218 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_product.sql
[0m12:02:53.969679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7968c1db-d3b8-43ae-a431-edee0487898b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4040a44f0>]}
[0m12:02:54.058587 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:02:54.060072 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:02:54.090392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7968c1db-d3b8-43ae-a431-edee0487898b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40447bc10>]}
[0m12:02:54.091093 [info ] [MainThread]: Found 6 models, 3 snapshots, 14 data tests, 9 sources, 491 macros
[0m12:02:54.091672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7968c1db-d3b8-43ae-a431-edee0487898b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40447bc40>]}
[0m12:02:54.093924 [info ] [MainThread]: 
[0m12:02:54.094481 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:02:54.094853 [info ] [MainThread]: 
[0m12:02:54.095444 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:02:54.101625 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m12:02:54.102637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:55.613542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:55.983969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m12:02:55.985240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:56.341458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:02:56.342290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:56.706316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m12:02:56.709084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:57.030190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7968c1db-d3b8-43ae-a431-edee0487898b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc43368cc70>]}
[0m12:02:57.031301 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:02:57.037227 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m12:02:57.038200 [info ] [Thread-1 (]: 1 of 6 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m12:02:57.040249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now model.olist_dataset.dim_customer)
[0m12:02:57.040904 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m12:02:57.056004 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m12:02:57.056772 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m12:02:57.068422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:57.458377 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m12:02:57.459250 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 


-- This is snapshot approach, refer to customer_snapshot.sql (Type 2 SCD)


SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:02:58.022946 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:459f7e28-59a8-4bc1-9f06-71dca17d32a6&page=queryresults
[0m12:03:01.872744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7968c1db-d3b8-43ae-a431-edee0487898b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40481ef50>]}
[0m12:03:01.873671 [info ] [Thread-1 (]: 1 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_customer . [[32mCREATE TABLE (99.4k rows, 9.5 MiB processed)[0m in 4.83s]
[0m12:03:01.874335 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m12:03:01.874728 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m12:03:01.875201 [info ] [Thread-1 (]: 2 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m12:03:01.876260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_customer, now model.olist_dataset.dim_geolocation)
[0m12:03:01.876663 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m12:03:01.882200 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m12:03:01.882822 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m12:03:01.909040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:02.364163 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m12:03:02.364928 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation` as DBT_INTERNAL_DEST
        using (-- models/star/dim_geolocation.sql

-- This is incremental approach (Type 1 SCD)


WITH source AS (
    SELECT
        geolocation_zip_code_prefix,
        geolocation_city,
        geolocation_state,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source


  WHERE geolocation_zip_code_prefix NOT IN (
      SELECT geolocation_zip_code_prefix FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
  )

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.geolocation_zip_code_prefix = DBT_INTERNAL_DEST.geolocation_zip_code_prefix))

    
    when matched then update set
        `geolocation_zip_code_prefix` = DBT_INTERNAL_SOURCE.`geolocation_zip_code_prefix`,`geolocation_city` = DBT_INTERNAL_SOURCE.`geolocation_city`,`geolocation_state` = DBT_INTERNAL_SOURCE.`geolocation_state`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)
    values
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)


    
[0m12:03:02.980653 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:f6d4c4ac-e506-43b4-ad0c-f7a507ea2572&page=queryresults
[0m12:03:24.416908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7968c1db-d3b8-43ae-a431-edee0487898b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40481ef50>]}
[0m12:03:24.418306 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[32mMERGE (0.0 rows, 62.1 MiB processed)[0m in 22.54s]
[0m12:03:24.419682 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m12:03:24.420518 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m12:03:24.421662 [info ] [Thread-1 (]: 3 of 6 START sql table model olist_data_ingestion_dim_tables.dim_product ....... [RUN]
[0m12:03:24.423907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_geolocation, now model.olist_dataset.dim_product)
[0m12:03:24.425070 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m12:03:24.434792 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m12:03:24.436198 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m12:03:24.441484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:24.886416 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m12:03:24.888163 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_product.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         product_id,
--         product_category_name,
--         product_name_lenght,
--         product_description_lenght,
--         product_photos_qty,
--         product_weight_g,
--         product_length_cm,
--         product_height_cm,
--         product_width_cm,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
-- )

-- SELECT * FROM source

-- 

-- This is snapshot approach, refer to product_snapshot (Type 2 SCD)


SELECT
    product_id,
    COALESCE(product_category_name, 'UNKNOWN') AS product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:03:25.410147 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:6127c940-0ca1-40ca-a39e-a8cba3ea8492&page=queryresults
[0m12:03:27.991973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7968c1db-d3b8-43ae-a431-edee0487898b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc433927df0>]}
[0m12:03:27.996440 [info ] [Thread-1 (]: 3 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_product .. [[32mCREATE TABLE (33.0k rows, 3.6 MiB processed)[0m in 3.57s]
[0m12:03:28.000706 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m12:03:28.002732 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_seller
[0m12:03:28.004625 [info ] [Thread-1 (]: 4 of 6 START sql table model olist_data_ingestion_dim_tables.dim_seller ........ [RUN]
[0m12:03:28.006260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_product, now model.olist_dataset.dim_seller)
[0m12:03:28.008834 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_seller
[0m12:03:28.018092 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_seller"
[0m12:03:28.018951 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_seller
[0m12:03:28.024157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:28.392634 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_seller"
[0m12:03:28.394708 [debug] [Thread-1 (]: On model.olist_dataset.dim_seller: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_seller"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_seller.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         seller_id,
--         seller_zip_code_prefix,
--         seller_city,
--         seller_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`
-- )

-- SELECT * FROM source

-- 


-- This is snapshot approach, refer to seller_snapshot (Type 2 SCD)


SELECT
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:03:28.932503 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:3faf77b3-6fab-4851-b8a9-3be846b5320a&page=queryresults
[0m12:03:31.223558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7968c1db-d3b8-43ae-a431-edee0487898b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4017a9f60>]}
[0m12:03:31.224984 [info ] [Thread-1 (]: 4 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_seller ... [[32mCREATE TABLE (3.1k rows, 200.0 KiB processed)[0m in 3.22s]
[0m12:03:31.226081 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_seller
[0m12:03:31.232039 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m12:03:31.233121 [info ] [Thread-1 (]: 5 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m12:03:31.234142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_seller, now model.olist_dataset.fact_order_items)
[0m12:03:31.234679 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m12:03:31.241424 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m12:03:31.245803 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m12:03:31.252330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:31.638656 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m12:03:31.642996 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    LEFT JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order item id that already in fact_order_item table
-- which assume data already in table never change

-- 
--   WHERE order_id_item NOT IN (SELECT order_id_item FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id_item = DBT_INTERNAL_DEST.order_id_item))

    
    when matched then update set
        `customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_id` = DBT_INTERNAL_SOURCE.`order_id`,`order_item_id` = DBT_INTERNAL_SOURCE.`order_item_id`,`product_id` = DBT_INTERNAL_SOURCE.`product_id`,`seller_id` = DBT_INTERNAL_SOURCE.`seller_id`,`price` = DBT_INTERNAL_SOURCE.`price`,`freight_value` = DBT_INTERNAL_SOURCE.`freight_value`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`order_id_item` = DBT_INTERNAL_SOURCE.`order_id_item`
    

    when not matched then insert
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)
    values
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)


    
[0m12:03:32.329982 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:51a7d018-b4a0-4e5f-8374-af888b9787da&page=queryresults
[0m12:03:38.622706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7968c1db-d3b8-43ae-a431-edee0487898b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4017d7ee0>]}
[0m12:03:38.624733 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mMERGE (112.7k rows, 57.9 MiB processed)[0m in 7.39s]
[0m12:03:38.626584 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m12:03:38.629574 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m12:03:38.631929 [info ] [Thread-1 (]: 6 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m12:03:38.633932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.fact_order_items, now model.olist_dataset.fact_orders)
[0m12:03:38.634902 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m12:03:38.645137 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m12:03:38.647160 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m12:03:38.655004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:39.054680 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m12:03:39.056266 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order id that already in fact_orders table
-- which assume data already in table never change

-- 
--   WHERE order_id NOT IN (SELECT order_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        `order_id` = DBT_INTERNAL_SOURCE.`order_id`,`customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_status` = DBT_INTERNAL_SOURCE.`order_status`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_carrier_date` = DBT_INTERNAL_SOURCE.`order_delivered_carrier_date`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`payment_value` = DBT_INTERNAL_SOURCE.`payment_value`
    

    when not matched then insert
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)
    values
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)


    
[0m12:03:39.677418 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:915161cd-9988-4374-bc8a-a49a60d43e6f&page=queryresults
[0m12:03:45.664349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7968c1db-d3b8-43ae-a431-edee0487898b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4017d7ee0>]}
[0m12:03:45.666233 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mMERGE (99.4k rows, 39.6 MiB processed)[0m in 7.03s]
[0m12:03:45.668985 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m12:03:45.673146 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:03:45.674853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:45.675662 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m12:03:45.676697 [info ] [MainThread]: 
[0m12:03:45.677760 [info ] [MainThread]: Finished running 3 incremental models, 3 table models in 0 hours 0 minutes and 51.58 seconds (51.58s).
[0m12:03:45.680780 [debug] [MainThread]: Command end result
[0m12:03:45.742361 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:03:45.748825 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:03:45.760994 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:03:45.761568 [info ] [MainThread]: 
[0m12:03:45.762129 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:03:45.762524 [info ] [MainThread]: 
[0m12:03:45.762957 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:03:45.763773 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 54.352844, "process_in_blocks": "112632", "process_kernel_time": 1.414103, "process_mem_max_rss": "264908", "process_out_blocks": "3592", "process_user_time": 4.566375}
[0m12:03:45.764381 [debug] [MainThread]: Command `dbt run` succeeded at 12:03:45.764254 after 54.35 seconds
[0m12:03:45.764898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4338b9ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4041d6aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4335647f0>]}
[0m12:03:45.765385 [debug] [MainThread]: Flushing usage events
[0m12:03:46.991353 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:03:50.150749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d828dde0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d71cd630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d71cd5d0>]}


============================== 12:03:50.155646 | d0395b38-a06a-455c-870e-f98104ec037c ==============================
[0m12:03:50.155646 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:03:50.156348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:03:52.165153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0395b38-a06a-455c-870e-f98104ec037c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a93b1210>]}
[0m12:03:52.241210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0395b38-a06a-455c-870e-f98104ec037c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d7f970a0>]}
[0m12:03:52.242150 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:03:52.365068 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:03:52.688877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:03:52.689482 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:03:52.759097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0395b38-a06a-455c-870e-f98104ec037c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a8eb8430>]}
[0m12:03:52.880011 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:03:52.881970 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:03:52.938516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0395b38-a06a-455c-870e-f98104ec037c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a8e59f90>]}
[0m12:03:52.939165 [info ] [MainThread]: Found 6 models, 3 snapshots, 14 data tests, 9 sources, 491 macros
[0m12:03:52.939566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0395b38-a06a-455c-870e-f98104ec037c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a9726d10>]}
[0m12:03:52.941643 [info ] [MainThread]: 
[0m12:03:52.942121 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:03:52.942450 [info ] [MainThread]: 
[0m12:03:52.942981 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:03:52.947759 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_ingestion_dim_tables'
[0m12:03:52.948315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:54.667893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m12:03:54.668988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:55.048266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m12:03:55.049045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:55.442358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0395b38-a06a-455c-870e-f98104ec037c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d934dd80>]}
[0m12:03:55.443601 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:03:55.450742 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m12:03:55.452171 [info ] [Thread-1 (]: 1 of 14 START test not_null_dim_customer_customer_city ......................... [RUN]
[0m12:03:55.453345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now test.olist_dataset.not_null_dim_customer_customer_city.98bef70201)
[0m12:03:55.454238 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m12:03:55.476657 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"
[0m12:03:55.480120 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m12:03:55.495457 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"
[0m12:03:55.496232 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_city.98bef70201: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_city
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_city is null



      
    ) dbt_internal_test
[0m12:03:55.496671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:56.116889 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:f317f19c-6903-4f96-90c7-00db064695e3&page=queryresults
[0m12:03:57.202201 [info ] [Thread-1 (]: 1 of 14 PASS not_null_dim_customer_customer_city ............................... [[32mPASS[0m in 1.75s]
[0m12:03:57.203407 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m12:03:57.204409 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m12:03:57.205148 [info ] [Thread-1 (]: 2 of 14 START test not_null_dim_customer_customer_id ........................... [RUN]
[0m12:03:57.206029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_city.98bef70201, now test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc)
[0m12:03:57.206685 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m12:03:57.213360 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"
[0m12:03:57.214126 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m12:03:57.216808 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"
[0m12:03:57.217385 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_id is null



      
    ) dbt_internal_test
[0m12:03:57.217776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:57.981758 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:0c29bc49-dc26-457c-aa80-847f5af65d90&page=queryresults
[0m12:03:58.945435 [info ] [Thread-1 (]: 2 of 14 PASS not_null_dim_customer_customer_id ................................. [[32mPASS[0m in 1.74s]
[0m12:03:58.946290 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m12:03:58.946755 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m12:03:58.947167 [info ] [Thread-1 (]: 3 of 14 START test not_null_dim_customer_customer_state ........................ [RUN]
[0m12:03:58.948081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc, now test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82)
[0m12:03:58.948475 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m12:03:58.952768 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"
[0m12:03:58.953486 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m12:03:58.955686 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"
[0m12:03:58.956315 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_state
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_state is null



      
    ) dbt_internal_test
[0m12:03:58.956790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:59.579725 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:12f17d4c-2854-45f4-aec3-092b205fa717&page=queryresults
[0m12:04:00.587621 [info ] [Thread-1 (]: 3 of 14 PASS not_null_dim_customer_customer_state .............................. [[32mPASS[0m in 1.64s]
[0m12:04:00.588563 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m12:04:00.589010 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m12:04:00.589569 [info ] [Thread-1 (]: 4 of 14 START test not_null_dim_customer_customer_unique_id .................... [RUN]
[0m12:04:00.590177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82, now test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4)
[0m12:04:00.590579 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m12:04:00.596954 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"
[0m12:04:00.598447 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m12:04:00.601517 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"
[0m12:04:00.602294 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_unique_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_unique_id is null



      
    ) dbt_internal_test
[0m12:04:00.602787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:01.181320 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:4b57bdfa-5dcf-4c27-abd5-c74bcdbb4d46&page=queryresults
[0m12:04:02.150706 [info ] [Thread-1 (]: 4 of 14 PASS not_null_dim_customer_customer_unique_id .......................... [[32mPASS[0m in 1.56s]
[0m12:04:02.152612 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m12:04:02.153537 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m12:04:02.155218 [info ] [Thread-1 (]: 5 of 14 START test not_null_dim_customer_customer_zip_code_prefix .............. [RUN]
[0m12:04:02.157836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4, now test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65)
[0m12:04:02.158886 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m12:04:02.171601 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"
[0m12:04:02.173376 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m12:04:02.178977 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"
[0m12:04:02.180361 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_zip_code_prefix
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_zip_code_prefix is null



      
    ) dbt_internal_test
[0m12:04:02.181296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:02.837246 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:0aec1d6f-3837-4bb8-b855-4db303ae22ce&page=queryresults
[0m12:04:03.802988 [info ] [Thread-1 (]: 5 of 14 PASS not_null_dim_customer_customer_zip_code_prefix .................... [[32mPASS[0m in 1.65s]
[0m12:04:03.804753 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m12:04:03.805875 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492
[0m12:04:03.807508 [info ] [Thread-1 (]: 6 of 14 START test not_null_dim_product_product_category_name .................. [RUN]
[0m12:04:03.809029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65, now test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492)
[0m12:04:03.810006 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492
[0m12:04:03.824994 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492"
[0m12:04:03.830125 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492
[0m12:04:03.838030 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492"
[0m12:04:03.839959 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_category_name
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
where product_category_name is null



      
    ) dbt_internal_test
[0m12:04:03.841152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:04.448421 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:f95d89bb-682d-43c6-8b73-efcaacc98a4e&page=queryresults
[0m12:04:05.340416 [info ] [Thread-1 (]: 6 of 14 PASS not_null_dim_product_product_category_name ........................ [[32mPASS[0m in 1.53s]
[0m12:04:05.341225 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492
[0m12:04:05.341708 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_product_product_id.02b1f06816
[0m12:04:05.342150 [info ] [Thread-1 (]: 7 of 14 START test not_null_dim_product_product_id ............................. [RUN]
[0m12:04:05.342850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492, now test.olist_dataset.not_null_dim_product_product_id.02b1f06816)
[0m12:04:05.343299 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_product_product_id.02b1f06816
[0m12:04:05.347395 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_product_product_id.02b1f06816"
[0m12:04:05.348140 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_product_product_id.02b1f06816
[0m12:04:05.350945 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_product_product_id.02b1f06816"
[0m12:04:05.352823 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_product_product_id.02b1f06816"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
where product_id is null



      
    ) dbt_internal_test
[0m12:04:05.353754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:06.122894 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:34a84e54-7ea3-4395-95de-69bb04e39438&page=queryresults
[0m12:04:07.073847 [info ] [Thread-1 (]: 7 of 14 PASS not_null_dim_product_product_id ................................... [[32mPASS[0m in 1.73s]
[0m12:04:07.074673 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_product_product_id.02b1f06816
[0m12:04:07.075125 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m12:04:07.075511 [info ] [Thread-1 (]: 8 of 14 START test not_null_dim_seller_seller_city ............................. [RUN]
[0m12:04:07.076459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_product_product_id.02b1f06816, now test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d)
[0m12:04:07.077604 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m12:04:07.083038 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d"
[0m12:04:07.083841 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m12:04:07.086684 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d"
[0m12:04:07.087562 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_city
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_city is null



      
    ) dbt_internal_test
[0m12:04:07.088112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:07.714456 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:095c54dc-7799-4b31-af16-3047e1cfbbd5&page=queryresults
[0m12:04:08.619119 [info ] [Thread-1 (]: 8 of 14 PASS not_null_dim_seller_seller_city ................................... [[32mPASS[0m in 1.54s]
[0m12:04:08.619931 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m12:04:08.620345 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m12:04:08.621026 [info ] [Thread-1 (]: 9 of 14 START test not_null_dim_seller_seller_id ............................... [RUN]
[0m12:04:08.621778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d, now test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2)
[0m12:04:08.622164 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m12:04:08.626310 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2"
[0m12:04:08.627040 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m12:04:08.629333 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2"
[0m12:04:08.629991 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_id is null



      
    ) dbt_internal_test
[0m12:04:08.630368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:09.456614 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:a7b7f706-fc19-4671-875b-91ac8d9d4f62&page=queryresults
[0m12:04:10.390718 [info ] [Thread-1 (]: 9 of 14 PASS not_null_dim_seller_seller_id ..................................... [[32mPASS[0m in 1.77s]
[0m12:04:10.392390 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m12:04:10.393402 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m12:04:10.395216 [info ] [Thread-1 (]: 10 of 14 START test not_null_dim_seller_seller_state ........................... [RUN]
[0m12:04:10.396672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2, now test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb)
[0m12:04:10.397828 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m12:04:10.406086 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb"
[0m12:04:10.406951 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m12:04:10.409389 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb"
[0m12:04:10.409885 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_state
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_state is null



      
    ) dbt_internal_test
[0m12:04:10.410231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:11.112091 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:107fa4f9-1237-4214-b3f2-c0ced5f11af2&page=queryresults
[0m12:04:12.131161 [info ] [Thread-1 (]: 10 of 14 PASS not_null_dim_seller_seller_state ................................. [[32mPASS[0m in 1.73s]
[0m12:04:12.132455 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m12:04:12.133129 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m12:04:12.134183 [info ] [Thread-1 (]: 11 of 14 START test not_null_dim_seller_seller_zip_code_prefix ................. [RUN]
[0m12:04:12.134927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb, now test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472)
[0m12:04:12.135680 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m12:04:12.140675 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472"
[0m12:04:12.141614 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m12:04:12.144280 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472"
[0m12:04:12.144955 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_zip_code_prefix
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_zip_code_prefix is null



      
    ) dbt_internal_test
[0m12:04:12.145373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:12.748790 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:019b103b-dad3-4d03-86a5-8046ec840732&page=queryresults
[0m12:04:13.644527 [info ] [Thread-1 (]: 11 of 14 PASS not_null_dim_seller_seller_zip_code_prefix ....................... [[32mPASS[0m in 1.51s]
[0m12:04:13.646026 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m12:04:13.647175 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m12:04:13.648134 [info ] [Thread-1 (]: 12 of 14 START test unique_dim_customer_customer_id ............................ [RUN]
[0m12:04:13.649652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472, now test.olist_dataset.unique_dim_customer_customer_id.b42affccd1)
[0m12:04:13.650882 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m12:04:13.668742 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"
[0m12:04:13.669961 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m12:04:13.672499 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"
[0m12:04:13.673690 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_customer_customer_id.b42affccd1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:04:13.674409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:14.395579 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:fa3b49e8-69a9-417f-8457-73d7e94defa5&page=queryresults
[0m12:04:15.338593 [info ] [Thread-1 (]: 12 of 14 PASS unique_dim_customer_customer_id .................................. [[32mPASS[0m in 1.69s]
[0m12:04:15.340224 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m12:04:15.341244 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_product_product_id.46495bf7fe
[0m12:04:15.342564 [info ] [Thread-1 (]: 13 of 14 START test unique_dim_product_product_id .............................. [RUN]
[0m12:04:15.343592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.unique_dim_customer_customer_id.b42affccd1, now test.olist_dataset.unique_dim_product_product_id.46495bf7fe)
[0m12:04:15.344444 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_product_product_id.46495bf7fe
[0m12:04:15.348995 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_product_product_id.46495bf7fe"
[0m12:04:15.349620 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_product_product_id.46495bf7fe
[0m12:04:15.351765 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_product_product_id.46495bf7fe"
[0m12:04:15.352348 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_product_product_id.46495bf7fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:04:15.352707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:16.069660 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:38fbf27b-5579-4340-ba18-0afbd2c8fb94&page=queryresults
[0m12:04:16.965046 [info ] [Thread-1 (]: 13 of 14 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 1.62s]
[0m12:04:16.965839 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_product_product_id.46495bf7fe
[0m12:04:16.966296 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m12:04:16.966877 [info ] [Thread-1 (]: 14 of 14 START test unique_dim_seller_seller_id ................................ [RUN]
[0m12:04:16.967523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.unique_dim_product_product_id.46495bf7fe, now test.olist_dataset.unique_dim_seller_seller_id.a1add5f830)
[0m12:04:16.967880 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m12:04:16.971912 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_seller_seller_id.a1add5f830"
[0m12:04:16.972593 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m12:04:16.974586 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_seller_seller_id.a1add5f830"
[0m12:04:16.975109 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_seller_seller_id.a1add5f830: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_seller_seller_id.a1add5f830"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select seller_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
  where seller_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:04:16.975488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:17.728904 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d1c83552-aaed-4186-853b-b4ea43b7529e&page=queryresults
[0m12:04:18.645182 [info ] [Thread-1 (]: 14 of 14 PASS unique_dim_seller_seller_id ...................................... [[32mPASS[0m in 1.68s]
[0m12:04:18.645972 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m12:04:18.649352 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:04:18.650318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:18.650855 [debug] [MainThread]: Connection 'test.olist_dataset.unique_dim_seller_seller_id.a1add5f830' was properly closed.
[0m12:04:18.651264 [info ] [MainThread]: 
[0m12:04:18.651760 [info ] [MainThread]: Finished running 14 data tests in 0 hours 0 minutes and 25.71 seconds (25.71s).
[0m12:04:18.653904 [debug] [MainThread]: Command end result
[0m12:04:18.676090 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:04:18.678085 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:04:18.685547 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:04:18.686092 [info ] [MainThread]: 
[0m12:04:18.686553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:04:18.686911 [info ] [MainThread]: 
[0m12:04:18.687291 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m12:04:18.687940 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 28.6051, "process_in_blocks": "113768", "process_kernel_time": 1.256321, "process_mem_max_rss": "263080", "process_out_blocks": "2632", "process_user_time": 4.777119}
[0m12:04:18.688369 [debug] [MainThread]: Command `dbt test` succeeded at 12:04:18.688276 after 28.61 seconds
[0m12:04:18.688776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d828dde0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a93b1210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a8ce5ed0>]}
[0m12:04:18.689197 [debug] [MainThread]: Flushing usage events
[0m12:04:19.672400 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:10:10.672870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c5ca5db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c4bbd420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c4bbd3c0>]}


============================== 12:10:10.677469 | cb6bdfc8-330e-4ef3-a7b1-4f60af2e2129 ==============================
[0m12:10:10.677469 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:10:10.678009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'profiles_dir': '/home/kangh/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:10:12.368810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb6bdfc8-330e-4ef3-a7b1-4f60af2e2129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb696d8e5f0>]}
[0m12:10:12.435468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb6bdfc8-330e-4ef3-a7b1-4f60af2e2129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c53cbaf0>]}
[0m12:10:12.436155 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:10:12.548648 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:10:12.835398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:10:12.836280 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/schema.yml
[0m12:10:13.311696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb6bdfc8-330e-4ef3-a7b1-4f60af2e2129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb696470e50>]}
[0m12:10:13.403771 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:10:13.407468 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:10:13.436372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb6bdfc8-330e-4ef3-a7b1-4f60af2e2129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb696838880>]}
[0m12:10:13.436954 [info ] [MainThread]: Found 6 models, 3 snapshots, 18 data tests, 9 sources, 491 macros
[0m12:10:13.437354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb6bdfc8-330e-4ef3-a7b1-4f60af2e2129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb696838e80>]}
[0m12:10:13.439629 [info ] [MainThread]: 
[0m12:10:13.440117 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:10:13.440465 [info ] [MainThread]: 
[0m12:10:13.441081 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:10:13.446057 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m12:10:13.446874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:15.003414 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:15.376438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m12:10:15.378151 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:15.753471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:10:15.755660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:16.120473 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m12:10:16.123655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:16.497745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb6bdfc8-330e-4ef3-a7b1-4f60af2e2129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c6d5dd20>]}
[0m12:10:16.498879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:10:16.505026 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m12:10:16.506050 [info ] [Thread-1 (]: 1 of 6 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m12:10:16.507283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now model.olist_dataset.dim_customer)
[0m12:10:16.507988 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m12:10:16.522308 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m12:10:16.525212 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m12:10:16.537363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:16.961163 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m12:10:16.963199 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 


-- This is snapshot approach, refer to customer_snapshot.sql (Type 2 SCD)


SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:10:17.549567 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:83a571fb-4ede-492b-a5c1-182e8e60fc45&page=queryresults
[0m12:10:21.057826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6bdfc8-330e-4ef3-a7b1-4f60af2e2129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c4d59d50>]}
[0m12:10:21.058777 [info ] [Thread-1 (]: 1 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_customer . [[32mCREATE TABLE (99.4k rows, 9.5 MiB processed)[0m in 4.55s]
[0m12:10:21.059382 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m12:10:21.059773 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m12:10:21.060550 [info ] [Thread-1 (]: 2 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m12:10:21.061087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_customer, now model.olist_dataset.dim_geolocation)
[0m12:10:21.061469 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m12:10:21.066825 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m12:10:21.067532 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m12:10:21.094914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:21.512802 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m12:10:21.513569 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation` as DBT_INTERNAL_DEST
        using (-- models/star/dim_geolocation.sql

-- This is incremental approach (Type 1 SCD)


WITH source AS (
    SELECT
        geolocation_zip_code_prefix,
        geolocation_city,
        geolocation_state,
        CAST(last_updated AS TIMESTAMP) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source


  WHERE geolocation_zip_code_prefix NOT IN (
      SELECT geolocation_zip_code_prefix FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
  )

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.geolocation_zip_code_prefix = DBT_INTERNAL_DEST.geolocation_zip_code_prefix))

    
    when matched then update set
        `geolocation_zip_code_prefix` = DBT_INTERNAL_SOURCE.`geolocation_zip_code_prefix`,`geolocation_city` = DBT_INTERNAL_SOURCE.`geolocation_city`,`geolocation_state` = DBT_INTERNAL_SOURCE.`geolocation_state`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)
    values
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)


    
[0m12:10:22.034710 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d499ea28-f376-4d4d-8401-bf2e84a4d79a&page=queryresults
[0m12:10:42.714088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6bdfc8-330e-4ef3-a7b1-4f60af2e2129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb696445840>]}
[0m12:10:42.718645 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[32mMERGE (0.0 rows, 62.1 MiB processed)[0m in 21.65s]
[0m12:10:42.721117 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m12:10:42.722652 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m12:10:42.724036 [info ] [Thread-1 (]: 3 of 6 START sql table model olist_data_ingestion_dim_tables.dim_product ....... [RUN]
[0m12:10:42.724956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_geolocation, now model.olist_dataset.dim_product)
[0m12:10:42.725767 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m12:10:42.738237 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m12:10:42.739828 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m12:10:42.743149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:43.340394 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m12:10:43.342564 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_product.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         product_id,
--         product_category_name,
--         product_name_lenght,
--         product_description_lenght,
--         product_photos_qty,
--         product_weight_g,
--         product_length_cm,
--         product_height_cm,
--         product_width_cm,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
-- )

-- SELECT * FROM source

-- 

-- This is snapshot approach, refer to product_snapshot (Type 2 SCD)


SELECT
    product_id,
    COALESCE(product_category_name, 'UNKNOWN') AS product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:10:43.823067 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:aa8ed0ba-1741-4959-8ebb-3d9fbda74093&page=queryresults
[0m12:10:46.110794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6bdfc8-330e-4ef3-a7b1-4f60af2e2129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb696445840>]}
[0m12:10:46.112298 [info ] [Thread-1 (]: 3 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_product .. [[32mCREATE TABLE (33.0k rows, 3.6 MiB processed)[0m in 3.39s]
[0m12:10:46.113608 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m12:10:46.114473 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_seller
[0m12:10:46.121323 [info ] [Thread-1 (]: 4 of 6 START sql table model olist_data_ingestion_dim_tables.dim_seller ........ [RUN]
[0m12:10:46.124106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_product, now model.olist_dataset.dim_seller)
[0m12:10:46.124694 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_seller
[0m12:10:46.134052 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_seller"
[0m12:10:46.136133 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_seller
[0m12:10:46.145082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:46.496268 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_seller"
[0m12:10:46.497959 [debug] [Thread-1 (]: On model.olist_dataset.dim_seller: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_seller"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_seller.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         seller_id,
--         seller_zip_code_prefix,
--         seller_city,
--         seller_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`
-- )

-- SELECT * FROM source

-- 


-- This is snapshot approach, refer to seller_snapshot (Type 2 SCD)


SELECT
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:10:47.059598 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:ba1420d1-31f8-4af4-8ca7-e73509363e47&page=queryresults
[0m12:10:49.370014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6bdfc8-330e-4ef3-a7b1-4f60af2e2129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c4d59d50>]}
[0m12:10:49.371847 [info ] [Thread-1 (]: 4 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_seller ... [[32mCREATE TABLE (3.1k rows, 200.0 KiB processed)[0m in 3.25s]
[0m12:10:49.373428 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_seller
[0m12:10:49.374453 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m12:10:49.376350 [info ] [Thread-1 (]: 5 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m12:10:49.379002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_seller, now model.olist_dataset.fact_order_items)
[0m12:10:49.380613 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m12:10:49.393404 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m12:10:49.397001 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m12:10:49.408424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:49.776362 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m12:10:49.778546 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    LEFT JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order item id that already in fact_order_item table
-- which assume data already in table never change

-- 
--   WHERE order_id_item NOT IN (SELECT order_id_item FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id_item = DBT_INTERNAL_DEST.order_id_item))

    
    when matched then update set
        `customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_id` = DBT_INTERNAL_SOURCE.`order_id`,`order_item_id` = DBT_INTERNAL_SOURCE.`order_item_id`,`product_id` = DBT_INTERNAL_SOURCE.`product_id`,`seller_id` = DBT_INTERNAL_SOURCE.`seller_id`,`price` = DBT_INTERNAL_SOURCE.`price`,`freight_value` = DBT_INTERNAL_SOURCE.`freight_value`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`order_id_item` = DBT_INTERNAL_SOURCE.`order_id_item`
    

    when not matched then insert
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)
    values
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)


    
[0m12:10:50.323451 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:25b8670e-8512-43db-ae57-8bd64b5651cd&page=queryresults
[0m12:10:55.961903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6bdfc8-330e-4ef3-a7b1-4f60af2e2129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb69438a530>]}
[0m12:10:55.963182 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mMERGE (112.7k rows, 57.9 MiB processed)[0m in 6.58s]
[0m12:10:55.964317 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m12:10:55.965023 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m12:10:55.966181 [info ] [Thread-1 (]: 6 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m12:10:55.967268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.fact_order_items, now model.olist_dataset.fact_orders)
[0m12:10:55.968236 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m12:10:55.979033 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m12:10:55.980480 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m12:10:55.986492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:56.371297 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m12:10:56.373630 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order id that already in fact_orders table
-- which assume data already in table never change

-- 
--   WHERE order_id NOT IN (SELECT order_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        `order_id` = DBT_INTERNAL_SOURCE.`order_id`,`customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_status` = DBT_INTERNAL_SOURCE.`order_status`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_carrier_date` = DBT_INTERNAL_SOURCE.`order_delivered_carrier_date`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`payment_value` = DBT_INTERNAL_SOURCE.`payment_value`
    

    when not matched then insert
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)
    values
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)


    
[0m12:10:57.071770 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:606927ee-8cb4-4446-8b40-3c931bffabfe&page=queryresults
[0m12:11:02.787978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6bdfc8-330e-4ef3-a7b1-4f60af2e2129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c4d59d50>]}
[0m12:11:02.790291 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mMERGE (99.4k rows, 39.6 MiB processed)[0m in 6.82s]
[0m12:11:02.792324 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m12:11:02.796942 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:11:02.798743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:02.799779 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m12:11:02.804512 [info ] [MainThread]: 
[0m12:11:02.806239 [info ] [MainThread]: Finished running 3 incremental models, 3 table models in 0 hours 0 minutes and 49.36 seconds (49.36s).
[0m12:11:02.810246 [debug] [MainThread]: Command end result
[0m12:11:02.861634 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:11:02.866826 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:11:02.877177 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:11:02.877713 [info ] [MainThread]: 
[0m12:11:02.878228 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:11:02.878619 [info ] [MainThread]: 
[0m12:11:02.879040 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:11:02.879754 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 52.269707, "process_in_blocks": "123136", "process_kernel_time": 1.448534, "process_mem_max_rss": "271936", "process_out_blocks": "3648", "process_user_time": 4.321172}
[0m12:11:02.880434 [debug] [MainThread]: Command `dbt run` succeeded at 12:11:02.880292 after 52.27 seconds
[0m12:11:02.880935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c5ca5db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb696d8e5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb696aced10>]}
[0m12:11:02.881439 [debug] [MainThread]: Flushing usage events
[0m12:11:04.094946 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:11:06.794373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ec3d31e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ec2c6d630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ec2c6d5d0>]}


============================== 12:11:06.798677 | 7d02276f-ed87-4def-acad-76337175ea4b ==============================
[0m12:11:06.798677 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:11:06.799270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/kangh/.dbt', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m12:11:08.434638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d02276f-ed87-4def-acad-76337175ea4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e94e5f430>]}
[0m12:11:08.502029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d02276f-ed87-4def-acad-76337175ea4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ec2c7b550>]}
[0m12:11:08.502746 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:11:08.624131 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:11:08.915073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:11:08.915636 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:11:08.970397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d02276f-ed87-4def-acad-76337175ea4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e947758d0>]}
[0m12:11:09.063377 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:11:09.065502 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:11:09.101728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d02276f-ed87-4def-acad-76337175ea4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e94781a20>]}
[0m12:11:09.102296 [info ] [MainThread]: Found 6 models, 3 snapshots, 18 data tests, 9 sources, 491 macros
[0m12:11:09.102695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d02276f-ed87-4def-acad-76337175ea4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e951e6dd0>]}
[0m12:11:09.104994 [info ] [MainThread]: 
[0m12:11:09.105570 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:11:09.105887 [info ] [MainThread]: 
[0m12:11:09.106562 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:11:09.111643 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_ingestion_fact_tables'
[0m12:11:09.112413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:10.636218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:11:10.638232 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:11.207866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m12:11:11.211116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:11.546930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d02276f-ed87-4def-acad-76337175ea4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e94cb18a0>]}
[0m12:11:11.548000 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:11:11.556387 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m12:11:11.557256 [info ] [Thread-1 (]: 1 of 18 START test not_null_dim_customer_customer_city ......................... [RUN]
[0m12:11:11.558212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now test.olist_dataset.not_null_dim_customer_customer_city.98bef70201)
[0m12:11:11.558898 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m12:11:11.579459 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"
[0m12:11:11.583455 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m12:11:11.599969 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"
[0m12:11:11.600766 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_city.98bef70201: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_city
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_city is null



      
    ) dbt_internal_test
[0m12:11:11.601206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:12.243460 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:c2546381-dec1-4cbc-90c7-9b9b9ae1f7f1&page=queryresults
[0m12:11:13.249939 [info ] [Thread-1 (]: 1 of 18 PASS not_null_dim_customer_customer_city ............................... [[32mPASS[0m in 1.69s]
[0m12:11:13.252451 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m12:11:13.254016 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m12:11:13.255895 [info ] [Thread-1 (]: 2 of 18 START test not_null_dim_customer_customer_id ........................... [RUN]
[0m12:11:13.258146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_city.98bef70201, now test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc)
[0m12:11:13.259252 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m12:11:13.270231 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"
[0m12:11:13.272141 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m12:11:13.279856 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"
[0m12:11:13.282045 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_id is null



      
    ) dbt_internal_test
[0m12:11:13.283711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:13.858865 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:4c82c24a-948a-4597-89ac-c93145b6c204&page=queryresults
[0m12:11:14.832632 [info ] [Thread-1 (]: 2 of 18 PASS not_null_dim_customer_customer_id ................................. [[32mPASS[0m in 1.57s]
[0m12:11:14.833940 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m12:11:14.834671 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m12:11:14.835331 [info ] [Thread-1 (]: 3 of 18 START test not_null_dim_customer_customer_state ........................ [RUN]
[0m12:11:14.836251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc, now test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82)
[0m12:11:14.836991 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m12:11:14.845966 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"
[0m12:11:14.847024 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m12:11:14.850392 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"
[0m12:11:14.851107 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_state
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_state is null



      
    ) dbt_internal_test
[0m12:11:14.851570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:15.464766 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:791ff88d-2fc8-4166-996a-ad22900facd7&page=queryresults
[0m12:11:16.389938 [info ] [Thread-1 (]: 3 of 18 PASS not_null_dim_customer_customer_state .............................. [[32mPASS[0m in 1.55s]
[0m12:11:16.391636 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m12:11:16.392584 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m12:11:16.393384 [info ] [Thread-1 (]: 4 of 18 START test not_null_dim_customer_customer_unique_id .................... [RUN]
[0m12:11:16.394813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82, now test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4)
[0m12:11:16.395729 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m12:11:16.406230 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"
[0m12:11:16.407834 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m12:11:16.412891 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"
[0m12:11:16.414053 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_unique_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_unique_id is null



      
    ) dbt_internal_test
[0m12:11:16.414715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:17.038675 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:a53f07ad-5f05-453d-85e4-1c64a750e8bf&page=queryresults
[0m12:11:17.995980 [info ] [Thread-1 (]: 4 of 18 PASS not_null_dim_customer_customer_unique_id .......................... [[32mPASS[0m in 1.60s]
[0m12:11:17.996889 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m12:11:17.997284 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m12:11:17.997624 [info ] [Thread-1 (]: 5 of 18 START test not_null_dim_customer_customer_zip_code_prefix .............. [RUN]
[0m12:11:17.998071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4, now test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65)
[0m12:11:17.998595 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m12:11:18.007780 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"
[0m12:11:18.009204 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m12:11:18.015707 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"
[0m12:11:18.016660 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_zip_code_prefix
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_zip_code_prefix is null



      
    ) dbt_internal_test
[0m12:11:18.017271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:18.864595 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:9ecf88fd-2e8a-46bb-a818-1c82031bff3b&page=queryresults
[0m12:11:19.824971 [info ] [Thread-1 (]: 5 of 18 PASS not_null_dim_customer_customer_zip_code_prefix .................... [[32mPASS[0m in 1.83s]
[0m12:11:19.826545 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m12:11:19.827385 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:11:19.828165 [info ] [Thread-1 (]: 6 of 18 START test not_null_dim_geolocation_geolocation_city ................... [RUN]
[0m12:11:19.829626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65, now test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207)
[0m12:11:19.830704 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:11:19.840773 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207"
[0m12:11:19.845070 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:11:19.851091 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207"
[0m12:11:19.854395 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geolocation_city
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
where geolocation_city is null



      
    ) dbt_internal_test
[0m12:11:19.855557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:20.493427 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:2450aadb-904e-4e94-a3c6-dce4ea24122d&page=queryresults
[0m12:11:21.491768 [info ] [Thread-1 (]: 6 of 18 PASS not_null_dim_geolocation_geolocation_city ......................... [[32mPASS[0m in 1.66s]
[0m12:11:21.492946 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:11:21.493670 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:11:21.494500 [info ] [Thread-1 (]: 7 of 18 START test not_null_dim_geolocation_geolocation_state .................. [RUN]
[0m12:11:21.495398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207, now test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954)
[0m12:11:21.496060 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:11:21.505087 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954"
[0m12:11:21.506617 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:11:21.511508 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954"
[0m12:11:21.512769 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geolocation_state
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
where geolocation_state is null



      
    ) dbt_internal_test
[0m12:11:21.513488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:22.205292 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:f6d79364-ed53-41c0-82f0-1777559c57b0&page=queryresults
[0m12:11:23.161489 [info ] [Thread-1 (]: 7 of 18 PASS not_null_dim_geolocation_geolocation_state ........................ [[32mPASS[0m in 1.67s]
[0m12:11:23.162813 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:11:23.163615 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:11:23.164327 [info ] [Thread-1 (]: 8 of 18 START test not_null_dim_geolocation_geolocation_zip_code_prefix ........ [RUN]
[0m12:11:23.165625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954, now test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c)
[0m12:11:23.166395 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:11:23.174607 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c"
[0m12:11:23.176143 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:11:23.182809 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c"
[0m12:11:23.184422 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geolocation_zip_code_prefix
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
where geolocation_zip_code_prefix is null



      
    ) dbt_internal_test
[0m12:11:23.185374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:23.783832 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:bc8b3e3f-e7ab-4b62-8a45-c03044db039c&page=queryresults
[0m12:11:24.701321 [info ] [Thread-1 (]: 8 of 18 PASS not_null_dim_geolocation_geolocation_zip_code_prefix .............. [[32mPASS[0m in 1.54s]
[0m12:11:24.703370 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:11:24.704378 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492
[0m12:11:24.705658 [info ] [Thread-1 (]: 9 of 18 START test not_null_dim_product_product_category_name .................. [RUN]
[0m12:11:24.707191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c, now test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492)
[0m12:11:24.708114 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492
[0m12:11:24.720963 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492"
[0m12:11:24.722366 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492
[0m12:11:24.725378 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492"
[0m12:11:24.726402 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_category_name
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
where product_category_name is null



      
    ) dbt_internal_test
[0m12:11:24.727248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:25.292286 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:70cacab4-1b16-4a93-97af-1c401cf7a590&page=queryresults
[0m12:11:26.200926 [info ] [Thread-1 (]: 9 of 18 PASS not_null_dim_product_product_category_name ........................ [[32mPASS[0m in 1.49s]
[0m12:11:26.202290 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492
[0m12:11:26.202991 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_product_product_id.02b1f06816
[0m12:11:26.204077 [info ] [Thread-1 (]: 10 of 18 START test not_null_dim_product_product_id ............................ [RUN]
[0m12:11:26.205003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492, now test.olist_dataset.not_null_dim_product_product_id.02b1f06816)
[0m12:11:26.205701 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_product_product_id.02b1f06816
[0m12:11:26.214073 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_product_product_id.02b1f06816"
[0m12:11:26.215062 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_product_product_id.02b1f06816
[0m12:11:26.221654 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_product_product_id.02b1f06816"
[0m12:11:26.223007 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_product_product_id.02b1f06816"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
where product_id is null



      
    ) dbt_internal_test
[0m12:11:26.223623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:26.807569 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:cfd233dd-0738-44be-89a9-78c197f163db&page=queryresults
[0m12:11:27.727243 [info ] [Thread-1 (]: 10 of 18 PASS not_null_dim_product_product_id .................................. [[32mPASS[0m in 1.52s]
[0m12:11:27.728473 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_product_product_id.02b1f06816
[0m12:11:27.729193 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m12:11:27.730157 [info ] [Thread-1 (]: 11 of 18 START test not_null_dim_seller_seller_city ............................ [RUN]
[0m12:11:27.730997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_product_product_id.02b1f06816, now test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d)
[0m12:11:27.731644 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m12:11:27.741932 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d"
[0m12:11:27.743291 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m12:11:27.747783 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d"
[0m12:11:27.748871 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_city
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_city is null



      
    ) dbt_internal_test
[0m12:11:27.749611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:28.420052 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:17d1b626-e3d3-4d2b-8bdd-6c9f5bcbe792&page=queryresults
[0m12:11:29.337157 [info ] [Thread-1 (]: 11 of 18 PASS not_null_dim_seller_seller_city .................................. [[32mPASS[0m in 1.61s]
[0m12:11:29.338457 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m12:11:29.339222 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m12:11:29.340252 [info ] [Thread-1 (]: 12 of 18 START test not_null_dim_seller_seller_id .............................. [RUN]
[0m12:11:29.341112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d, now test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2)
[0m12:11:29.341795 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m12:11:29.353757 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2"
[0m12:11:29.355145 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m12:11:29.361696 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2"
[0m12:11:29.364571 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_id is null



      
    ) dbt_internal_test
[0m12:11:29.365441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:30.023267 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d5a8c324-eff9-4a84-b5fe-b1760a1da1a8&page=queryresults
[0m12:11:30.894456 [info ] [Thread-1 (]: 12 of 18 PASS not_null_dim_seller_seller_id .................................... [[32mPASS[0m in 1.55s]
[0m12:11:30.896129 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m12:11:30.897194 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m12:11:30.898164 [info ] [Thread-1 (]: 13 of 18 START test not_null_dim_seller_seller_state ........................... [RUN]
[0m12:11:30.900382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2, now test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb)
[0m12:11:30.901648 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m12:11:30.916707 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb"
[0m12:11:30.918573 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m12:11:30.924851 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb"
[0m12:11:30.926779 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_state
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_state is null



      
    ) dbt_internal_test
[0m12:11:30.928091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:31.545403 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:cde56234-406d-4e49-b504-913a27d0c8a5&page=queryresults
[0m12:11:32.497234 [info ] [Thread-1 (]: 13 of 18 PASS not_null_dim_seller_seller_state ................................. [[32mPASS[0m in 1.60s]
[0m12:11:32.498961 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m12:11:32.500109 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m12:11:32.502110 [info ] [Thread-1 (]: 14 of 18 START test not_null_dim_seller_seller_zip_code_prefix ................. [RUN]
[0m12:11:32.503704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb, now test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472)
[0m12:11:32.504767 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m12:11:32.518204 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472"
[0m12:11:32.520203 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m12:11:32.526499 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472"
[0m12:11:32.529443 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_zip_code_prefix
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_zip_code_prefix is null



      
    ) dbt_internal_test
[0m12:11:32.531289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:33.243464 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:cab83a15-82ef-490d-96b4-5a0ffdd20fd0&page=queryresults
[0m12:11:34.176506 [info ] [Thread-1 (]: 14 of 18 PASS not_null_dim_seller_seller_zip_code_prefix ....................... [[32mPASS[0m in 1.67s]
[0m12:11:34.178450 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m12:11:34.179553 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m12:11:34.183604 [info ] [Thread-1 (]: 15 of 18 START test unique_dim_customer_customer_id ............................ [RUN]
[0m12:11:34.186280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472, now test.olist_dataset.unique_dim_customer_customer_id.b42affccd1)
[0m12:11:34.187680 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m12:11:34.204076 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"
[0m12:11:34.204959 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m12:11:34.209384 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"
[0m12:11:34.210289 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_customer_customer_id.b42affccd1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:11:34.210903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:35.139426 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:3838c23d-e1d8-441c-b5c0-64605e715d7d&page=queryresults
[0m12:11:36.187078 [info ] [Thread-1 (]: 15 of 18 PASS unique_dim_customer_customer_id .................................. [[32mPASS[0m in 2.00s]
[0m12:11:36.188423 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m12:11:36.189215 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:11:36.189930 [info ] [Thread-1 (]: 16 of 18 START test unique_dim_geolocation_geolocation_zip_code_prefix ......... [RUN]
[0m12:11:36.190917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.unique_dim_customer_customer_id.b42affccd1, now test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0)
[0m12:11:36.192389 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:11:36.202605 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0"
[0m12:11:36.203846 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:11:36.208411 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0"
[0m12:11:36.209584 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select geolocation_zip_code_prefix as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
  where geolocation_zip_code_prefix is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:11:36.210381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:37.026895 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:87469ab3-efd7-4cf7-8bb8-5dab9b436b55&page=queryresults
[0m12:11:38.020269 [error] [Thread-1 (]: 16 of 18 FAIL 17972 unique_dim_geolocation_geolocation_zip_code_prefix ......... [[31mFAIL 17972[0m in 1.83s]
[0m12:11:38.022359 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:11:38.024345 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_product_product_id.46495bf7fe
[0m12:11:38.025394 [info ] [Thread-1 (]: 17 of 18 START test unique_dim_product_product_id .............................. [RUN]
[0m12:11:38.026293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0, now test.olist_dataset.unique_dim_product_product_id.46495bf7fe)
[0m12:11:38.026990 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_product_product_id.46495bf7fe
[0m12:11:38.033668 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_product_product_id.46495bf7fe"
[0m12:11:38.034579 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_product_product_id.46495bf7fe
[0m12:11:38.037876 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_product_product_id.46495bf7fe"
[0m12:11:38.038601 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_product_product_id.46495bf7fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:11:38.039189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:38.811666 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:56ed0b80-9a96-4ba8-9be0-56593b868356&page=queryresults
[0m12:11:39.762996 [info ] [Thread-1 (]: 17 of 18 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 1.74s]
[0m12:11:39.765118 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_product_product_id.46495bf7fe
[0m12:11:39.766133 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m12:11:39.767565 [info ] [Thread-1 (]: 18 of 18 START test unique_dim_seller_seller_id ................................ [RUN]
[0m12:11:39.769089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.unique_dim_product_product_id.46495bf7fe, now test.olist_dataset.unique_dim_seller_seller_id.a1add5f830)
[0m12:11:39.770231 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m12:11:39.783490 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_seller_seller_id.a1add5f830"
[0m12:11:39.785060 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m12:11:39.791225 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_seller_seller_id.a1add5f830"
[0m12:11:39.793124 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_seller_seller_id.a1add5f830: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_seller_seller_id.a1add5f830"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select seller_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
  where seller_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:11:39.795629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:40.469365 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:823ee752-a8b6-4280-8ed4-9c02c471da1f&page=queryresults
[0m12:11:41.398161 [info ] [Thread-1 (]: 18 of 18 PASS unique_dim_seller_seller_id ...................................... [[32mPASS[0m in 1.63s]
[0m12:11:41.400015 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m12:11:41.409310 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:11:41.411137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:41.412108 [debug] [MainThread]: Connection 'test.olist_dataset.unique_dim_seller_seller_id.a1add5f830' was properly closed.
[0m12:11:41.413121 [info ] [MainThread]: 
[0m12:11:41.415179 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 32.31 seconds (32.31s).
[0m12:11:41.424495 [debug] [MainThread]: Command end result
[0m12:11:41.472856 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:11:41.475662 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:11:41.488643 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:11:41.489218 [info ] [MainThread]: 
[0m12:11:41.489791 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:11:41.490222 [info ] [MainThread]: 
[0m12:11:41.490845 [error] [MainThread]: [31mFailure in test unique_dim_geolocation_geolocation_zip_code_prefix (models/schema.yml)[0m
[0m12:11:41.491462 [error] [MainThread]:   Got 17972 results, configured to fail if != 0
[0m12:11:41.491873 [info ] [MainThread]: 
[0m12:11:41.492344 [info ] [MainThread]:   compiled code at target/compiled/olist_dataset/models/schema.yml/unique_dim_geolocation_geolocation_zip_code_prefix.sql
[0m12:11:41.492750 [info ] [MainThread]: 
[0m12:11:41.493197 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=1 SKIP=0 TOTAL=18
[0m12:11:41.493985 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 34.75925, "process_in_blocks": "113968", "process_kernel_time": 1.342222, "process_mem_max_rss": "259748", "process_out_blocks": "2776", "process_user_time": 4.634602}
[0m12:11:41.494591 [debug] [MainThread]: Command `dbt test` failed at 12:11:41.494464 after 34.76 seconds
[0m12:11:41.495187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ec3d31e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9494cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ec39dd9f0>]}
[0m12:11:41.495732 [debug] [MainThread]: Flushing usage events
[0m12:11:42.476859 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:20:36.323480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46830ade40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4681fe9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4681fe94b0>]}


============================== 12:20:36.328747 | 6767e66c-833a-4350-a4ab-241b9042e440 ==============================
[0m12:20:36.328747 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:20:36.329235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:20:38.149082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6767e66c-833a-4350-a4ab-241b9042e440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4681fd0b80>]}
[0m12:20:38.239991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6767e66c-833a-4350-a4ab-241b9042e440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4682630cd0>]}
[0m12:20:38.241009 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:20:38.367224 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:20:38.662981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:20:38.663861 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/schema.yml
[0m12:20:38.664232 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_geolocation.sql
[0m12:20:39.140388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6767e66c-833a-4350-a4ab-241b9042e440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4653895060>]}
[0m12:20:39.233346 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:20:39.236790 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:20:39.266871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6767e66c-833a-4350-a4ab-241b9042e440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4653df10f0>]}
[0m12:20:39.267494 [info ] [MainThread]: Found 6 models, 3 snapshots, 17 data tests, 9 sources, 491 macros
[0m12:20:39.267892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6767e66c-833a-4350-a4ab-241b9042e440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4653df0dc0>]}
[0m12:20:39.269943 [info ] [MainThread]: 
[0m12:20:39.270423 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:20:39.270738 [info ] [MainThread]: 
[0m12:20:39.271780 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:20:39.277052 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m12:20:39.277942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:40.809604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:20:41.187059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m12:20:41.188349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:20:41.527934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m12:20:41.530265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:20:41.921988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:20:41.924266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:20:42.320655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6767e66c-833a-4350-a4ab-241b9042e440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4684171e70>]}
[0m12:20:42.321618 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:20:42.327161 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m12:20:42.328078 [info ] [Thread-1 (]: 1 of 6 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m12:20:42.329162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now model.olist_dataset.dim_customer)
[0m12:20:42.329779 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m12:20:42.343186 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m12:20:42.346476 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m12:20:42.358562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:20:42.754920 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m12:20:42.757079 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 


-- This is snapshot approach, refer to customer_snapshot.sql (Type 2 SCD)


SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:20:43.256473 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:5a3e0921-9356-48f2-aaac-54d8266b600d&page=queryresults
[0m12:20:46.500948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6767e66c-833a-4350-a4ab-241b9042e440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4683deb730>]}
[0m12:20:46.501761 [info ] [Thread-1 (]: 1 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_customer . [[32mCREATE TABLE (99.4k rows, 9.5 MiB processed)[0m in 4.17s]
[0m12:20:46.502407 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m12:20:46.502817 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m12:20:46.503269 [info ] [Thread-1 (]: 2 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m12:20:46.503747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_customer, now model.olist_dataset.dim_geolocation)
[0m12:20:46.504339 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m12:20:46.510378 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m12:20:46.511186 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m12:20:46.538457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:20:46.987643 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m12:20:46.988509 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation` as DBT_INTERNAL_DEST
        using (-- models/star/dim_geolocation.sql

-- This is incremental approach (Type 1 SCD)


WITH source AS (
    SELECT
        geolocation_zip_code_prefix,
        geolocation_city,
        geolocation_state,
        CAST(last_updated AS TIMESTAMP) AS last_updated,
        ROW_NUMBER() OVER (
        PARTITION BY geolocation_zip_code_prefix
        ORDER BY last_updated DESC
    ) as rn        
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source WHERE rn = 1


  WHERE geolocation_zip_code_prefix NOT IN (
      SELECT geolocation_zip_code_prefix FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
  )

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.geolocation_zip_code_prefix = DBT_INTERNAL_DEST.geolocation_zip_code_prefix))

    
    when matched then update set
        `geolocation_zip_code_prefix` = DBT_INTERNAL_SOURCE.`geolocation_zip_code_prefix`,`geolocation_city` = DBT_INTERNAL_SOURCE.`geolocation_city`,`geolocation_state` = DBT_INTERNAL_SOURCE.`geolocation_state`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)
    values
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)


    
[0m12:20:47.330052 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:2bab182b-422f-4b11-a983-03ea5b349e6b&page=queryresults
[0m12:20:47.331166 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:2bab182b-422f-4b11-a983-03ea5b349e6b&page=queryresults
[0m12:20:47.358358 [debug] [Thread-1 (]: Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  Syntax error: Expected ")" but got keyword WHERE at [37:3]
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql
[0m12:20:47.360000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6767e66c-833a-4350-a4ab-241b9042e440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46510b93f0>]}
[0m12:20:47.361598 [error] [Thread-1 (]: 2 of 6 ERROR creating sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[31mERROR[0m in 0.86s]
[0m12:20:47.362779 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m12:20:47.363521 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m12:20:47.364676 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_geolocation' to be skipped because of status 'error'.  Reason: Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  Syntax error: Expected ")" but got keyword WHERE at [37:3]
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql.
[0m12:20:47.366116 [info ] [Thread-1 (]: 3 of 6 START sql table model olist_data_ingestion_dim_tables.dim_product ....... [RUN]
[0m12:20:47.369756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_geolocation, now model.olist_dataset.dim_product)
[0m12:20:47.370662 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m12:20:47.376626 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m12:20:47.377281 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m12:20:47.379416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:20:47.792688 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m12:20:47.794088 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_product.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         product_id,
--         product_category_name,
--         product_name_lenght,
--         product_description_lenght,
--         product_photos_qty,
--         product_weight_g,
--         product_length_cm,
--         product_height_cm,
--         product_width_cm,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
-- )

-- SELECT * FROM source

-- 

-- This is snapshot approach, refer to product_snapshot (Type 2 SCD)


SELECT
    product_id,
    COALESCE(product_category_name, 'UNKNOWN') AS product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:20:48.304637 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:f03ab573-a8d7-4299-94bb-94685a97b25f&page=queryresults
[0m12:20:50.571236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6767e66c-833a-4350-a4ab-241b9042e440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4682562890>]}
[0m12:20:50.572790 [info ] [Thread-1 (]: 3 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_product .. [[32mCREATE TABLE (33.0k rows, 3.6 MiB processed)[0m in 3.20s]
[0m12:20:50.573949 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m12:20:50.574753 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_seller
[0m12:20:50.575672 [info ] [Thread-1 (]: 4 of 6 START sql table model olist_data_ingestion_dim_tables.dim_seller ........ [RUN]
[0m12:20:50.577153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_product, now model.olist_dataset.dim_seller)
[0m12:20:50.578099 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_seller
[0m12:20:50.587004 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_seller"
[0m12:20:50.587917 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_seller
[0m12:20:50.591963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:20:50.940539 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_seller"
[0m12:20:50.942209 [debug] [Thread-1 (]: On model.olist_dataset.dim_seller: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_seller"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_seller.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         seller_id,
--         seller_zip_code_prefix,
--         seller_city,
--         seller_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`
-- )

-- SELECT * FROM source

-- 


-- This is snapshot approach, refer to seller_snapshot (Type 2 SCD)


SELECT
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:20:51.500882 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:18495db0-3cc8-43c5-a48f-1de3221d1e40&page=queryresults
[0m12:20:53.769818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6767e66c-833a-4350-a4ab-241b9042e440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4683deb730>]}
[0m12:20:53.771205 [info ] [Thread-1 (]: 4 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_seller ... [[32mCREATE TABLE (3.1k rows, 200.0 KiB processed)[0m in 3.19s]
[0m12:20:53.772349 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_seller
[0m12:20:53.773151 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m12:20:53.774053 [info ] [Thread-1 (]: 5 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m12:20:53.775368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_seller, now model.olist_dataset.fact_order_items)
[0m12:20:53.776160 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m12:20:53.784747 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m12:20:53.785847 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m12:20:53.790401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:20:54.177512 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m12:20:54.179368 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    LEFT JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order item id that already in fact_order_item table
-- which assume data already in table never change

-- 
--   WHERE order_id_item NOT IN (SELECT order_id_item FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id_item = DBT_INTERNAL_DEST.order_id_item))

    
    when matched then update set
        `customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_id` = DBT_INTERNAL_SOURCE.`order_id`,`order_item_id` = DBT_INTERNAL_SOURCE.`order_item_id`,`product_id` = DBT_INTERNAL_SOURCE.`product_id`,`seller_id` = DBT_INTERNAL_SOURCE.`seller_id`,`price` = DBT_INTERNAL_SOURCE.`price`,`freight_value` = DBT_INTERNAL_SOURCE.`freight_value`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`order_id_item` = DBT_INTERNAL_SOURCE.`order_id_item`
    

    when not matched then insert
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)
    values
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)


    
[0m12:20:54.772229 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:43c9dda7-cce9-436e-a236-6549e7121b9d&page=queryresults
[0m12:21:01.794131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6767e66c-833a-4350-a4ab-241b9042e440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46510a3fd0>]}
[0m12:21:01.795455 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mMERGE (112.7k rows, 57.9 MiB processed)[0m in 8.02s]
[0m12:21:01.796560 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m12:21:01.797299 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m12:21:01.798104 [info ] [Thread-1 (]: 6 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m12:21:01.798996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.fact_order_items, now model.olist_dataset.fact_orders)
[0m12:21:01.799693 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m12:21:01.806097 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m12:21:01.806831 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m12:21:01.809414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:02.155053 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m12:21:02.156576 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order id that already in fact_orders table
-- which assume data already in table never change

-- 
--   WHERE order_id NOT IN (SELECT order_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        `order_id` = DBT_INTERNAL_SOURCE.`order_id`,`customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_status` = DBT_INTERNAL_SOURCE.`order_status`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_carrier_date` = DBT_INTERNAL_SOURCE.`order_delivered_carrier_date`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`payment_value` = DBT_INTERNAL_SOURCE.`payment_value`
    

    when not matched then insert
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)
    values
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)


    
[0m12:21:02.716052 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:a7065c99-3972-4c99-a1bb-23af5f615993&page=queryresults
[0m12:21:08.273235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6767e66c-833a-4350-a4ab-241b9042e440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4683deb730>]}
[0m12:21:08.274690 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mMERGE (99.4k rows, 39.6 MiB processed)[0m in 6.47s]
[0m12:21:08.275945 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m12:21:08.280470 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:21:08.282304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:08.283083 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m12:21:08.283891 [info ] [MainThread]: 
[0m12:21:08.284671 [info ] [MainThread]: Finished running 3 incremental models, 3 table models in 0 hours 0 minutes and 29.01 seconds (29.01s).
[0m12:21:08.286752 [debug] [MainThread]: Command end result
[0m12:21:08.310438 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:21:08.312146 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:21:08.317463 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:21:08.317820 [info ] [MainThread]: 
[0m12:21:08.318188 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:21:08.318496 [info ] [MainThread]: 
[0m12:21:08.318831 [error] [MainThread]:   Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  Syntax error: Expected ")" but got keyword WHERE at [37:3]
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql
[0m12:21:08.319120 [info ] [MainThread]: 
[0m12:21:08.319412 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m12:21:08.319902 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 32.059834, "process_in_blocks": "123240", "process_kernel_time": 1.4869, "process_mem_max_rss": "267760", "process_out_blocks": "3640", "process_user_time": 4.370888}
[0m12:21:08.320275 [debug] [MainThread]: Command `dbt run` failed at 12:21:08.320191 after 32.06 seconds
[0m12:21:08.320611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46830ade40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f465394fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4682d559f0>]}
[0m12:21:08.320944 [debug] [MainThread]: Flushing usage events
[0m12:21:09.527069 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:21:17.526676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd42f5e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd3211540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd32114e0>]}


============================== 12:21:17.529095 | a8f879fd-cda0-478b-aa97-20ed2d894e83 ==============================
[0m12:21:17.529095 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:21:17.529616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:21:18.482319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8f879fd-cda0-478b-aa97-20ed2d894e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa541c760>]}
[0m12:21:18.550316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8f879fd-cda0-478b-aa97-20ed2d894e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa539a770>]}
[0m12:21:18.551096 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:21:18.652862 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:21:18.863436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:21:18.864324 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/schema.yml
[0m12:21:19.336711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8f879fd-cda0-478b-aa97-20ed2d894e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa4af93c0>]}
[0m12:21:19.430433 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:21:19.432283 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:21:19.448211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8f879fd-cda0-478b-aa97-20ed2d894e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa4acd960>]}
[0m12:21:19.448793 [info ] [MainThread]: Found 6 models, 3 snapshots, 18 data tests, 9 sources, 491 macros
[0m12:21:19.449173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8f879fd-cda0-478b-aa97-20ed2d894e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa4acd4b0>]}
[0m12:21:19.451041 [info ] [MainThread]: 
[0m12:21:19.451485 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:21:19.451812 [info ] [MainThread]: 
[0m12:21:19.452352 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:21:19.457037 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m12:21:19.457904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:20.424157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:20.784226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m12:21:20.785700 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:21.123701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m12:21:21.124643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:21.479479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:21:21.481878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:21.865691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8f879fd-cda0-478b-aa97-20ed2d894e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd53da0b0>]}
[0m12:21:21.866852 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:21:21.872439 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m12:21:21.873514 [info ] [Thread-1 (]: 1 of 6 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m12:21:21.874853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now model.olist_dataset.dim_customer)
[0m12:21:21.875513 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m12:21:21.889777 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m12:21:21.890681 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m12:21:21.902599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:22.351530 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m12:21:22.352673 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 


-- This is snapshot approach, refer to customer_snapshot.sql (Type 2 SCD)


SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:21:22.870965 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:74444ae1-8437-4666-a992-dd539e6ce4c5&page=queryresults
[0m12:21:25.754979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8f879fd-cda0-478b-aa97-20ed2d894e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa51abeb0>]}
[0m12:21:25.756016 [info ] [Thread-1 (]: 1 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_customer . [[32mCREATE TABLE (99.4k rows, 9.5 MiB processed)[0m in 3.88s]
[0m12:21:25.756832 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m12:21:25.757307 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m12:21:25.757821 [info ] [Thread-1 (]: 2 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m12:21:25.758456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_customer, now model.olist_dataset.dim_geolocation)
[0m12:21:25.758839 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m12:21:25.767183 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m12:21:25.768066 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m12:21:25.797698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:26.233246 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m12:21:26.234329 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation` as DBT_INTERNAL_DEST
        using (-- models/star/dim_geolocation.sql

-- This is incremental approach (Type 1 SCD)


WITH source AS (
    SELECT
        geolocation_zip_code_prefix,
        geolocation_city,
        geolocation_state,
        CAST(last_updated AS TIMESTAMP) AS last_updated,
        ROW_NUMBER() OVER (
        PARTITION BY geolocation_zip_code_prefix
        ORDER BY last_updated DESC
    ) as rn        
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source WHERE rn = 1


  WHERE geolocation_zip_code_prefix NOT IN (
      SELECT geolocation_zip_code_prefix FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
  )

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.geolocation_zip_code_prefix = DBT_INTERNAL_DEST.geolocation_zip_code_prefix))

    
    when matched then update set
        `geolocation_zip_code_prefix` = DBT_INTERNAL_SOURCE.`geolocation_zip_code_prefix`,`geolocation_city` = DBT_INTERNAL_SOURCE.`geolocation_city`,`geolocation_state` = DBT_INTERNAL_SOURCE.`geolocation_state`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)
    values
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)


    
[0m12:21:26.534515 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:b6a0ae01-e2c9-43dc-8376-ea72580a5b03&page=queryresults
[0m12:21:26.535920 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:b6a0ae01-e2c9-43dc-8376-ea72580a5b03&page=queryresults
[0m12:21:26.541768 [debug] [Thread-1 (]: Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  Syntax error: Expected ")" but got keyword WHERE at [37:3]
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql
[0m12:21:26.543376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8f879fd-cda0-478b-aa97-20ed2d894e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa22d3ee0>]}
[0m12:21:26.545128 [error] [Thread-1 (]: 2 of 6 ERROR creating sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[31mERROR[0m in 0.78s]
[0m12:21:26.546545 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m12:21:26.547589 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m12:21:26.548639 [info ] [Thread-1 (]: 3 of 6 START sql table model olist_data_ingestion_dim_tables.dim_product ....... [RUN]
[0m12:21:26.549881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_geolocation, now model.olist_dataset.dim_product)
[0m12:21:26.550637 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m12:21:26.556767 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_geolocation' to be skipped because of status 'error'.  Reason: Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  Syntax error: Expected ")" but got keyword WHERE at [37:3]
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql.
[0m12:21:26.558389 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m12:21:26.560485 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m12:21:26.563068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:26.934101 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m12:21:26.936049 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_product.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         product_id,
--         product_category_name,
--         product_name_lenght,
--         product_description_lenght,
--         product_photos_qty,
--         product_weight_g,
--         product_length_cm,
--         product_height_cm,
--         product_width_cm,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
-- )

-- SELECT * FROM source

-- 

-- This is snapshot approach, refer to product_snapshot (Type 2 SCD)


SELECT
    product_id,
    COALESCE(product_category_name, 'UNKNOWN') AS product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:21:27.396399 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:0bcf7d6b-9543-4de3-ba7d-de7c73e19e60&page=queryresults
[0m12:21:29.615642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8f879fd-cda0-478b-aa97-20ed2d894e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa22d0fa0>]}
[0m12:21:29.616407 [info ] [Thread-1 (]: 3 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_product .. [[32mCREATE TABLE (33.0k rows, 3.6 MiB processed)[0m in 3.07s]
[0m12:21:29.617066 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m12:21:29.617510 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_seller
[0m12:21:29.617945 [info ] [Thread-1 (]: 4 of 6 START sql table model olist_data_ingestion_dim_tables.dim_seller ........ [RUN]
[0m12:21:29.618460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_product, now model.olist_dataset.dim_seller)
[0m12:21:29.619264 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_seller
[0m12:21:29.629268 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_seller"
[0m12:21:29.630750 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_seller
[0m12:21:29.636461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:29.996557 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_seller"
[0m12:21:29.998035 [debug] [Thread-1 (]: On model.olist_dataset.dim_seller: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_seller"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_seller.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         seller_id,
--         seller_zip_code_prefix,
--         seller_city,
--         seller_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`
-- )

-- SELECT * FROM source

-- 


-- This is snapshot approach, refer to seller_snapshot (Type 2 SCD)


SELECT
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:21:30.495279 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:fe5a477e-ab65-444a-9678-00d0ce54f14b&page=queryresults
[0m12:21:32.780799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8f879fd-cda0-478b-aa97-20ed2d894e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa21ffd90>]}
[0m12:21:32.782146 [info ] [Thread-1 (]: 4 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_seller ... [[32mCREATE TABLE (3.1k rows, 200.0 KiB processed)[0m in 3.16s]
[0m12:21:32.783155 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_seller
[0m12:21:32.783836 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m12:21:32.784570 [info ] [Thread-1 (]: 5 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m12:21:32.785416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_seller, now model.olist_dataset.fact_order_items)
[0m12:21:32.786101 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m12:21:32.793879 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m12:21:32.794839 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m12:21:32.797932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:33.195899 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m12:21:33.197465 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    LEFT JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order item id that already in fact_order_item table
-- which assume data already in table never change

-- 
--   WHERE order_id_item NOT IN (SELECT order_id_item FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id_item = DBT_INTERNAL_DEST.order_id_item))

    
    when matched then update set
        `customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_id` = DBT_INTERNAL_SOURCE.`order_id`,`order_item_id` = DBT_INTERNAL_SOURCE.`order_item_id`,`product_id` = DBT_INTERNAL_SOURCE.`product_id`,`seller_id` = DBT_INTERNAL_SOURCE.`seller_id`,`price` = DBT_INTERNAL_SOURCE.`price`,`freight_value` = DBT_INTERNAL_SOURCE.`freight_value`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`order_id_item` = DBT_INTERNAL_SOURCE.`order_id_item`
    

    when not matched then insert
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)
    values
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)


    
[0m12:21:33.720196 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:421a40dd-b817-4de0-beaa-62fc54f8e5b2&page=queryresults
[0m12:21:40.005760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8f879fd-cda0-478b-aa97-20ed2d894e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa22dabc0>]}
[0m12:21:40.009860 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mMERGE (112.7k rows, 57.9 MiB processed)[0m in 7.22s]
[0m12:21:40.012503 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m12:21:40.017043 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m12:21:40.019381 [info ] [Thread-1 (]: 6 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m12:21:40.020945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.fact_order_items, now model.olist_dataset.fact_orders)
[0m12:21:40.021997 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m12:21:40.035070 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m12:21:40.036532 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m12:21:40.042463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:40.431159 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m12:21:40.432927 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order id that already in fact_orders table
-- which assume data already in table never change

-- 
--   WHERE order_id NOT IN (SELECT order_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        `order_id` = DBT_INTERNAL_SOURCE.`order_id`,`customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_status` = DBT_INTERNAL_SOURCE.`order_status`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_carrier_date` = DBT_INTERNAL_SOURCE.`order_delivered_carrier_date`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`payment_value` = DBT_INTERNAL_SOURCE.`payment_value`
    

    when not matched then insert
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)
    values
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)


    
[0m12:21:41.058437 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:6f53941f-1176-45b0-8d57-b9c17a1c19f9&page=queryresults
[0m12:21:46.283800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8f879fd-cda0-478b-aa97-20ed2d894e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa21ffd90>]}
[0m12:21:46.285420 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mMERGE (99.4k rows, 39.6 MiB processed)[0m in 6.26s]
[0m12:21:46.286985 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m12:21:46.297112 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:21:46.299203 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:46.300168 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m12:21:46.301859 [info ] [MainThread]: 
[0m12:21:46.302854 [info ] [MainThread]: Finished running 3 incremental models, 3 table models in 0 hours 0 minutes and 26.85 seconds (26.85s).
[0m12:21:46.305455 [debug] [MainThread]: Command end result
[0m12:21:46.359831 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:21:46.365889 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:21:46.376450 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:21:46.377028 [info ] [MainThread]: 
[0m12:21:46.377566 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:21:46.378069 [info ] [MainThread]: 
[0m12:21:46.378547 [error] [MainThread]:   Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  Syntax error: Expected ")" but got keyword WHERE at [37:3]
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql
[0m12:21:46.378941 [info ] [MainThread]: 
[0m12:21:46.379486 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m12:21:46.380689 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 28.91076, "process_in_blocks": "0", "process_kernel_time": 1.160283, "process_mem_max_rss": "260228", "process_out_blocks": "3640", "process_user_time": 4.111003}
[0m12:21:46.381546 [debug] [MainThread]: Command `dbt run` failed at 12:21:46.381353 after 28.91 seconds
[0m12:21:46.382170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd42f5e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfa4c34640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd3fa4c10>]}
[0m12:21:46.382693 [debug] [MainThread]: Flushing usage events
[0m12:21:47.596726 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:23:02.106271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b9eede10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b8e054b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b8e05450>]}


============================== 12:23:02.111283 | 43517774-8fee-48dc-9a1b-3154c2c0c75b ==============================
[0m12:23:02.111283 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:23:02.111826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:23:03.831208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43517774-8fee-48dc-9a1b-3154c2c0c75b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08afc26e0>]}
[0m12:23:03.899753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43517774-8fee-48dc-9a1b-3154c2c0c75b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08af3b5b0>]}
[0m12:23:03.900464 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:23:04.016822 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:23:04.304927 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:23:04.305813 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_geolocation.sql
[0m12:23:04.775943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43517774-8fee-48dc-9a1b-3154c2c0c75b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08a6ad3f0>]}
[0m12:23:04.866410 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:23:04.870521 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:23:04.898158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43517774-8fee-48dc-9a1b-3154c2c0c75b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08abf8670>]}
[0m12:23:04.898721 [info ] [MainThread]: Found 6 models, 3 snapshots, 18 data tests, 9 sources, 491 macros
[0m12:23:04.899111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43517774-8fee-48dc-9a1b-3154c2c0c75b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08abf8fa0>]}
[0m12:23:04.900898 [info ] [MainThread]: 
[0m12:23:04.901330 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:23:04.901676 [info ] [MainThread]: 
[0m12:23:04.902209 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:23:04.906864 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m12:23:04.907615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:06.533201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:06.911053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m12:23:06.912300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:07.276735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m12:23:07.278941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:07.701639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:23:07.702535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:08.098688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43517774-8fee-48dc-9a1b-3154c2c0c75b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0bafa5d80>]}
[0m12:23:08.100009 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:23:08.106885 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m12:23:08.108315 [info ] [Thread-1 (]: 1 of 6 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m12:23:08.109746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now model.olist_dataset.dim_customer)
[0m12:23:08.110602 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m12:23:08.130843 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m12:23:08.131837 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m12:23:08.156557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:08.548282 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m12:23:08.549035 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 


-- This is snapshot approach, refer to customer_snapshot.sql (Type 2 SCD)


SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:23:09.111010 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:96e774dd-092c-493c-8d7c-baab352a3949&page=queryresults
[0m12:23:12.326456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43517774-8fee-48dc-9a1b-3154c2c0c75b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b8ded8d0>]}
[0m12:23:12.327195 [info ] [Thread-1 (]: 1 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_customer . [[32mCREATE TABLE (99.4k rows, 9.5 MiB processed)[0m in 4.21s]
[0m12:23:12.327786 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m12:23:12.328172 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m12:23:12.328593 [info ] [Thread-1 (]: 2 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m12:23:12.329479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_customer, now model.olist_dataset.dim_geolocation)
[0m12:23:12.329872 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m12:23:12.335126 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m12:23:12.335834 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m12:23:12.362339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:12.823124 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m12:23:12.823958 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation` as DBT_INTERNAL_DEST
        using (-- models/star/dim_geolocation.sql

-- This is incremental approach (Type 1 SCD)


WITH source AS (
  SELECT
    geolocation_zip_code_prefix,
    geolocation_city,
    geolocation_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated,
    ROW_NUMBER() OVER (
      PARTITION BY geolocation_zip_code_prefix
      ORDER BY last_updated DESC
    ) as rn
  FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source
WHERE rn = 1


  WHERE geolocation_zip_code_prefix NOT IN (
      SELECT geolocation_zip_code_prefix FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
  )

        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.geolocation_zip_code_prefix = DBT_INTERNAL_DEST.geolocation_zip_code_prefix))

    
    when matched then update set
        `geolocation_zip_code_prefix` = DBT_INTERNAL_SOURCE.`geolocation_zip_code_prefix`,`geolocation_city` = DBT_INTERNAL_SOURCE.`geolocation_city`,`geolocation_state` = DBT_INTERNAL_SOURCE.`geolocation_state`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)
    values
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)


    
[0m12:23:13.264010 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:766a3cd1-b700-476f-ae55-978e7a2463b0&page=queryresults
[0m12:23:13.264968 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:766a3cd1-b700-476f-ae55-978e7a2463b0&page=queryresults
[0m12:23:13.280712 [debug] [Thread-1 (]: Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  Syntax error: Expected ")" but got keyword WHERE at [38:3]
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql
[0m12:23:13.281968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43517774-8fee-48dc-9a1b-3154c2c0c75b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff07bd75d80>]}
[0m12:23:13.282924 [error] [Thread-1 (]: 2 of 6 ERROR creating sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[31mERROR[0m in 0.95s]
[0m12:23:13.283693 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m12:23:13.284382 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m12:23:13.285268 [info ] [Thread-1 (]: 3 of 6 START sql table model olist_data_ingestion_dim_tables.dim_product ....... [RUN]
[0m12:23:13.286708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_geolocation, now model.olist_dataset.dim_product)
[0m12:23:13.287860 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m12:23:13.289713 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_geolocation' to be skipped because of status 'error'.  Reason: Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  Syntax error: Expected ")" but got keyword WHERE at [38:3]
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql.
[0m12:23:13.308274 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m12:23:13.311299 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m12:23:13.318356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:13.723400 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m12:23:13.724851 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_product.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         product_id,
--         product_category_name,
--         product_name_lenght,
--         product_description_lenght,
--         product_photos_qty,
--         product_weight_g,
--         product_length_cm,
--         product_height_cm,
--         product_width_cm,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
-- )

-- SELECT * FROM source

-- 

-- This is snapshot approach, refer to product_snapshot (Type 2 SCD)


SELECT
    product_id,
    COALESCE(product_category_name, 'UNKNOWN') AS product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:23:14.228492 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:ac298ff7-c6d8-4e89-8a09-b4029db7543b&page=queryresults
[0m12:23:17.054121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43517774-8fee-48dc-9a1b-3154c2c0c75b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff07bd74fd0>]}
[0m12:23:17.054860 [info ] [Thread-1 (]: 3 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_product .. [[32mCREATE TABLE (33.0k rows, 3.6 MiB processed)[0m in 3.77s]
[0m12:23:17.055423 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m12:23:17.055772 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_seller
[0m12:23:17.056196 [info ] [Thread-1 (]: 4 of 6 START sql table model olist_data_ingestion_dim_tables.dim_seller ........ [RUN]
[0m12:23:17.057047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_product, now model.olist_dataset.dim_seller)
[0m12:23:17.057603 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_seller
[0m12:23:17.065819 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_seller"
[0m12:23:17.066737 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_seller
[0m12:23:17.070884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:17.463544 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_seller"
[0m12:23:17.465137 [debug] [Thread-1 (]: On model.olist_dataset.dim_seller: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_seller"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_seller.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         seller_id,
--         seller_zip_code_prefix,
--         seller_city,
--         seller_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`
-- )

-- SELECT * FROM source

-- 


-- This is snapshot approach, refer to seller_snapshot (Type 2 SCD)


SELECT
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:23:18.186851 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:ac45d25b-ce39-4308-8b32-7e5a6f6fb081&page=queryresults
[0m12:23:20.482375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43517774-8fee-48dc-9a1b-3154c2c0c75b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b8ded8d0>]}
[0m12:23:20.484579 [info ] [Thread-1 (]: 4 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_seller ... [[32mCREATE TABLE (3.1k rows, 200.0 KiB processed)[0m in 3.43s]
[0m12:23:20.486329 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_seller
[0m12:23:20.488467 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m12:23:20.490968 [info ] [Thread-1 (]: 5 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m12:23:20.493520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_seller, now model.olist_dataset.fact_order_items)
[0m12:23:20.494932 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m12:23:20.504214 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m12:23:20.505280 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m12:23:20.512112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:20.925166 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m12:23:20.931221 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    LEFT JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order item id that already in fact_order_item table
-- which assume data already in table never change

-- 
--   WHERE order_id_item NOT IN (SELECT order_id_item FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id_item = DBT_INTERNAL_DEST.order_id_item))

    
    when matched then update set
        `customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_id` = DBT_INTERNAL_SOURCE.`order_id`,`order_item_id` = DBT_INTERNAL_SOURCE.`order_item_id`,`product_id` = DBT_INTERNAL_SOURCE.`product_id`,`seller_id` = DBT_INTERNAL_SOURCE.`seller_id`,`price` = DBT_INTERNAL_SOURCE.`price`,`freight_value` = DBT_INTERNAL_SOURCE.`freight_value`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`order_id_item` = DBT_INTERNAL_SOURCE.`order_id_item`
    

    when not matched then insert
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)
    values
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)


    
[0m12:23:21.479319 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:7c98286c-1c7c-42d2-82eb-1472691359ee&page=queryresults
[0m12:23:27.872849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43517774-8fee-48dc-9a1b-3154c2c0c75b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff07bc1ca30>]}
[0m12:23:27.874314 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mMERGE (112.7k rows, 57.9 MiB processed)[0m in 7.38s]
[0m12:23:27.875649 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m12:23:27.876459 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m12:23:27.878601 [info ] [Thread-1 (]: 6 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m12:23:27.880037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.fact_order_items, now model.olist_dataset.fact_orders)
[0m12:23:27.881062 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m12:23:27.892579 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m12:23:27.894519 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m12:23:27.900331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:28.254066 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m12:23:28.254970 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order id that already in fact_orders table
-- which assume data already in table never change

-- 
--   WHERE order_id NOT IN (SELECT order_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        `order_id` = DBT_INTERNAL_SOURCE.`order_id`,`customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_status` = DBT_INTERNAL_SOURCE.`order_status`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_carrier_date` = DBT_INTERNAL_SOURCE.`order_delivered_carrier_date`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`payment_value` = DBT_INTERNAL_SOURCE.`payment_value`
    

    when not matched then insert
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)
    values
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)


    
[0m12:23:28.801044 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:b8461291-19bc-4899-a856-a3ff884adfec&page=queryresults
[0m12:23:34.210441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43517774-8fee-48dc-9a1b-3154c2c0c75b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b8ded8d0>]}
[0m12:23:34.212029 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mMERGE (99.4k rows, 39.6 MiB processed)[0m in 6.33s]
[0m12:23:34.213190 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m12:23:34.217308 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:23:34.218903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:23:34.219669 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m12:23:34.220536 [info ] [MainThread]: 
[0m12:23:34.221283 [info ] [MainThread]: Finished running 3 incremental models, 3 table models in 0 hours 0 minutes and 29.32 seconds (29.32s).
[0m12:23:34.224270 [debug] [MainThread]: Command end result
[0m12:23:34.254902 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:23:34.256845 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:23:34.262841 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:23:34.263202 [info ] [MainThread]: 
[0m12:23:34.263586 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:23:34.263920 [info ] [MainThread]: 
[0m12:23:34.264297 [error] [MainThread]:   Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  Syntax error: Expected ")" but got keyword WHERE at [38:3]
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql
[0m12:23:34.264596 [info ] [MainThread]: 
[0m12:23:34.264919 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m12:23:34.265459 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 32.22169, "process_in_blocks": "123488", "process_kernel_time": 1.343998, "process_mem_max_rss": "263788", "process_out_blocks": "3648", "process_user_time": 4.407523}
[0m12:23:34.265863 [debug] [MainThread]: Command `dbt run` failed at 12:23:34.265767 after 32.22 seconds
[0m12:23:34.266227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b9eede10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08a9cadd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08a693d00>]}
[0m12:23:34.266615 [debug] [MainThread]: Flushing usage events
[0m12:23:35.448197 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:23:40.899590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d00f81e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfff914e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfff91480>]}


============================== 12:23:40.902724 | c898777e-f6f7-41c1-998d-d9a37ca8172b ==============================
[0m12:23:40.902724 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:23:40.903468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:23:41.794426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c898777e-f6f7-41c1-998d-d9a37ca8172b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d020b0f70>]}
[0m12:23:41.860212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c898777e-f6f7-41c1-998d-d9a37ca8172b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cd2101510>]}
[0m12:23:41.860961 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:23:41.959868 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:23:42.163472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:23:42.164141 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_geolocation.sql
[0m12:23:42.626944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c898777e-f6f7-41c1-998d-d9a37ca8172b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cd18392d0>]}
[0m12:23:42.720384 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:23:42.722860 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:23:42.737992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c898777e-f6f7-41c1-998d-d9a37ca8172b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cd1804e80>]}
[0m12:23:42.738661 [info ] [MainThread]: Found 6 models, 3 snapshots, 18 data tests, 9 sources, 491 macros
[0m12:23:42.739088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c898777e-f6f7-41c1-998d-d9a37ca8172b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cd1804df0>]}
[0m12:23:42.740963 [info ] [MainThread]: 
[0m12:23:42.741430 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:23:42.741760 [info ] [MainThread]: 
[0m12:23:42.742260 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:23:42.747079 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m12:23:42.747640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:43.685715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:44.092630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:23:44.093977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:44.426497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m12:23:44.429348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:44.812663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m12:23:44.814635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:45.163040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c898777e-f6f7-41c1-998d-d9a37ca8172b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d02135d80>]}
[0m12:23:45.164268 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:23:45.172474 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m12:23:45.173547 [info ] [Thread-1 (]: 1 of 6 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m12:23:45.174880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now model.olist_dataset.dim_customer)
[0m12:23:45.175693 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m12:23:45.189355 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m12:23:45.190231 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m12:23:45.202605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:45.603019 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m12:23:45.604884 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 


-- This is snapshot approach, refer to customer_snapshot.sql (Type 2 SCD)


SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:23:46.048657 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:1dae0e7f-9941-465c-8233-b7f31e3c5133&page=queryresults
[0m12:23:48.867122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c898777e-f6f7-41c1-998d-d9a37ca8172b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0012a740>]}
[0m12:23:48.867845 [info ] [Thread-1 (]: 1 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_customer . [[32mCREATE TABLE (99.4k rows, 9.5 MiB processed)[0m in 3.69s]
[0m12:23:48.868448 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m12:23:48.868820 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m12:23:48.869263 [info ] [Thread-1 (]: 2 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m12:23:48.870054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_customer, now model.olist_dataset.dim_geolocation)
[0m12:23:48.870504 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m12:23:48.876041 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m12:23:48.876812 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m12:23:48.904248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:49.271027 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m12:23:49.271923 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation` as DBT_INTERNAL_DEST
        using (-- models/star/dim_geolocation.sql

-- This is incremental approach (Type 1 SCD)


WITH source AS (
  SELECT
    geolocation_zip_code_prefix,
    geolocation_city,
    geolocation_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated,
    ROW_NUMBER() OVER (
      PARTITION BY geolocation_zip_code_prefix
      ORDER BY last_updated DESC
    ) as rn
  FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source
WHERE rn = 1

-- 
--   WHERE geolocation_zip_code_prefix NOT IN (
--       SELECT geolocation_zip_code_prefix FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
--   )
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.geolocation_zip_code_prefix = DBT_INTERNAL_DEST.geolocation_zip_code_prefix))

    
    when matched then update set
        `geolocation_zip_code_prefix` = DBT_INTERNAL_SOURCE.`geolocation_zip_code_prefix`,`geolocation_city` = DBT_INTERNAL_SOURCE.`geolocation_city`,`geolocation_state` = DBT_INTERNAL_SOURCE.`geolocation_state`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)
    values
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)


    
[0m12:23:49.829030 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d405b2d4-d407-42ab-b886-7a84863474ac&page=queryresults
[0m12:23:54.724972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c898777e-f6f7-41c1-998d-d9a37ca8172b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d010b6530>]}
[0m12:23:54.726328 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[32mMERGE (1.0m rows, 62.1 MiB processed)[0m in 5.85s]
[0m12:23:54.727504 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m12:23:54.728353 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m12:23:54.729382 [info ] [Thread-1 (]: 3 of 6 START sql table model olist_data_ingestion_dim_tables.dim_product ....... [RUN]
[0m12:23:54.730394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_geolocation, now model.olist_dataset.dim_product)
[0m12:23:54.731234 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m12:23:54.741091 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m12:23:54.742217 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m12:23:54.745331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:55.135630 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m12:23:55.137164 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_product.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         product_id,
--         product_category_name,
--         product_name_lenght,
--         product_description_lenght,
--         product_photos_qty,
--         product_weight_g,
--         product_length_cm,
--         product_height_cm,
--         product_width_cm,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
-- )

-- SELECT * FROM source

-- 

-- This is snapshot approach, refer to product_snapshot (Type 2 SCD)


SELECT
    product_id,
    COALESCE(product_category_name, 'UNKNOWN') AS product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:23:55.897329 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:87e9c1d2-e580-4c47-aa22-60a2f180145f&page=queryresults
[0m12:23:58.430904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c898777e-f6f7-41c1-998d-d9a37ca8172b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cd1d98a30>]}
[0m12:23:58.432963 [info ] [Thread-1 (]: 3 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_product .. [[32mCREATE TABLE (33.0k rows, 3.6 MiB processed)[0m in 3.70s]
[0m12:23:58.434325 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m12:23:58.435093 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_seller
[0m12:23:58.435925 [info ] [Thread-1 (]: 4 of 6 START sql table model olist_data_ingestion_dim_tables.dim_seller ........ [RUN]
[0m12:23:58.437002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_product, now model.olist_dataset.dim_seller)
[0m12:23:58.437628 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_seller
[0m12:23:58.443214 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_seller"
[0m12:23:58.444785 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_seller
[0m12:23:58.449026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:58.797611 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_seller"
[0m12:23:58.799801 [debug] [Thread-1 (]: On model.olist_dataset.dim_seller: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_seller"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_seller.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         seller_id,
--         seller_zip_code_prefix,
--         seller_city,
--         seller_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`
-- )

-- SELECT * FROM source

-- 


-- This is snapshot approach, refer to seller_snapshot (Type 2 SCD)


SELECT
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:23:59.272978 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:67153cb9-58bf-4f53-8a57-677473dc7ad4&page=queryresults
[0m12:24:01.307163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c898777e-f6f7-41c1-998d-d9a37ca8172b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d01288f10>]}
[0m12:24:01.309194 [info ] [Thread-1 (]: 4 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_seller ... [[32mCREATE TABLE (3.1k rows, 200.0 KiB processed)[0m in 2.87s]
[0m12:24:01.310824 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_seller
[0m12:24:01.318274 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m12:24:01.319605 [info ] [Thread-1 (]: 5 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m12:24:01.320688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_seller, now model.olist_dataset.fact_order_items)
[0m12:24:01.321520 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m12:24:01.329827 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m12:24:01.331484 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m12:24:01.338140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:01.727940 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m12:24:01.729791 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    LEFT JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order item id that already in fact_order_item table
-- which assume data already in table never change

-- 
--   WHERE order_id_item NOT IN (SELECT order_id_item FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id_item = DBT_INTERNAL_DEST.order_id_item))

    
    when matched then update set
        `customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_id` = DBT_INTERNAL_SOURCE.`order_id`,`order_item_id` = DBT_INTERNAL_SOURCE.`order_item_id`,`product_id` = DBT_INTERNAL_SOURCE.`product_id`,`seller_id` = DBT_INTERNAL_SOURCE.`seller_id`,`price` = DBT_INTERNAL_SOURCE.`price`,`freight_value` = DBT_INTERNAL_SOURCE.`freight_value`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`order_id_item` = DBT_INTERNAL_SOURCE.`order_id_item`
    

    when not matched then insert
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)
    values
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)


    
[0m12:24:02.248974 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:4bb69c17-1a58-4739-be57-7093bf8aace3&page=queryresults
[0m12:24:09.019004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c898777e-f6f7-41c1-998d-d9a37ca8172b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ccae7a530>]}
[0m12:24:09.020517 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mMERGE (112.7k rows, 57.9 MiB processed)[0m in 7.70s]
[0m12:24:09.022381 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m12:24:09.023717 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m12:24:09.024904 [info ] [Thread-1 (]: 6 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m12:24:09.026797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.fact_order_items, now model.olist_dataset.fact_orders)
[0m12:24:09.027712 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m12:24:09.036307 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m12:24:09.037832 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m12:24:09.043368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:09.436183 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m12:24:09.439849 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order id that already in fact_orders table
-- which assume data already in table never change

-- 
--   WHERE order_id NOT IN (SELECT order_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        `order_id` = DBT_INTERNAL_SOURCE.`order_id`,`customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_status` = DBT_INTERNAL_SOURCE.`order_status`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_carrier_date` = DBT_INTERNAL_SOURCE.`order_delivered_carrier_date`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`payment_value` = DBT_INTERNAL_SOURCE.`payment_value`
    

    when not matched then insert
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)
    values
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)


    
[0m12:24:09.935003 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:acf47a00-2c62-4191-abaf-980a79f6f5b4&page=queryresults
[0m12:24:15.100943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c898777e-f6f7-41c1-998d-d9a37ca8172b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d01288f10>]}
[0m12:24:15.102684 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mMERGE (99.4k rows, 39.6 MiB processed)[0m in 6.07s]
[0m12:24:15.104153 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m12:24:15.108683 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:24:15.112668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:15.113716 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m12:24:15.114700 [info ] [MainThread]: 
[0m12:24:15.115746 [info ] [MainThread]: Finished running 3 incremental models, 3 table models in 0 hours 0 minutes and 32.37 seconds (32.37s).
[0m12:24:15.119021 [debug] [MainThread]: Command end result
[0m12:24:15.175590 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:24:15.178701 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:24:15.189611 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:24:15.190396 [info ] [MainThread]: 
[0m12:24:15.191200 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:24:15.192078 [info ] [MainThread]: 
[0m12:24:15.192526 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:24:15.193371 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 34.37411, "process_in_blocks": "8", "process_kernel_time": 1.039633, "process_mem_max_rss": "266660", "process_out_blocks": "3640", "process_user_time": 4.574388}
[0m12:24:15.193950 [debug] [MainThread]: Command `dbt run` succeeded at 12:24:15.193816 after 34.37 seconds
[0m12:24:15.194448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d00f81e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d020b0f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cd17ce170>]}
[0m12:24:15.195081 [debug] [MainThread]: Flushing usage events
[0m12:24:16.644246 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:24:18.623120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967cde1db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967bd255a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967bd25540>]}


============================== 12:24:18.625415 | 45843950-d717-4caa-a61f-3687ef1ac8fe ==============================
[0m12:24:18.625415 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:24:18.625881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:24:19.568760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45843950-d717-4caa-a61f-3687ef1ac8fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967de20fd0>]}
[0m12:24:19.635378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45843950-d717-4caa-a61f-3687ef1ac8fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967cc3f1c0>]}
[0m12:24:19.636385 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:24:19.736869 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:24:19.953330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:24:19.953817 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:24:20.008757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45843950-d717-4caa-a61f-3687ef1ac8fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f964da15930>]}
[0m12:24:20.104944 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:24:20.106722 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:24:20.132671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45843950-d717-4caa-a61f-3687ef1ac8fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f964d9d1030>]}
[0m12:24:20.133314 [info ] [MainThread]: Found 6 models, 3 snapshots, 18 data tests, 9 sources, 491 macros
[0m12:24:20.133683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45843950-d717-4caa-a61f-3687ef1ac8fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f964e26eda0>]}
[0m12:24:20.136176 [info ] [MainThread]: 
[0m12:24:20.137042 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:24:20.137475 [info ] [MainThread]: 
[0m12:24:20.138113 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:24:20.143621 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_snapshots'
[0m12:24:20.144149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:21.122941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:24:21.125708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:21.507328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m12:24:21.509583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:21.852347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45843950-d717-4caa-a61f-3687ef1ac8fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967dea1d20>]}
[0m12:24:21.853513 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:24:21.863472 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m12:24:21.864333 [info ] [Thread-1 (]: 1 of 18 START test not_null_dim_customer_customer_city ......................... [RUN]
[0m12:24:21.865373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now test.olist_dataset.not_null_dim_customer_customer_city.98bef70201)
[0m12:24:21.866058 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m12:24:21.886276 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"
[0m12:24:21.889570 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m12:24:21.904918 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"
[0m12:24:21.905576 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_city.98bef70201: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_city
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_city is null



      
    ) dbt_internal_test
[0m12:24:21.906021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:22.593246 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:a3748ce4-3cdb-49e2-b902-1b5f8dec4570&page=queryresults
[0m12:24:23.565524 [info ] [Thread-1 (]: 1 of 18 PASS not_null_dim_customer_customer_city ............................... [[32mPASS[0m in 1.70s]
[0m12:24:23.566851 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m12:24:23.567626 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m12:24:23.568266 [info ] [Thread-1 (]: 2 of 18 START test not_null_dim_customer_customer_id ........................... [RUN]
[0m12:24:23.569572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_city.98bef70201, now test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc)
[0m12:24:23.570386 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m12:24:23.577302 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"
[0m12:24:23.577977 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m12:24:23.580756 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"
[0m12:24:23.581353 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_id is null



      
    ) dbt_internal_test
[0m12:24:23.581747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:24.262331 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:0a67707e-a9b3-4dd0-9802-a5497556b957&page=queryresults
[0m12:24:25.198764 [info ] [Thread-1 (]: 2 of 18 PASS not_null_dim_customer_customer_id ................................. [[32mPASS[0m in 1.63s]
[0m12:24:25.200161 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m12:24:25.200890 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m12:24:25.201303 [info ] [Thread-1 (]: 3 of 18 START test not_null_dim_customer_customer_state ........................ [RUN]
[0m12:24:25.202084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc, now test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82)
[0m12:24:25.202489 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m12:24:25.209904 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"
[0m12:24:25.213966 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m12:24:25.218941 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"
[0m12:24:25.219985 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_state
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_state is null



      
    ) dbt_internal_test
[0m12:24:25.220657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:25.786580 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:c78a5e08-9d1d-4054-97f9-0fdc0e6f3711&page=queryresults
[0m12:24:26.712636 [info ] [Thread-1 (]: 3 of 18 PASS not_null_dim_customer_customer_state .............................. [[32mPASS[0m in 1.51s]
[0m12:24:26.714120 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m12:24:26.715009 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m12:24:26.715921 [info ] [Thread-1 (]: 4 of 18 START test not_null_dim_customer_customer_unique_id .................... [RUN]
[0m12:24:26.717038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82, now test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4)
[0m12:24:26.717959 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m12:24:26.728062 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"
[0m12:24:26.729217 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m12:24:26.732576 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"
[0m12:24:26.733289 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_unique_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_unique_id is null



      
    ) dbt_internal_test
[0m12:24:26.733768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:27.382121 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:80bab356-8492-4ed7-a868-5fdc2ede8e33&page=queryresults
[0m12:24:28.428686 [info ] [Thread-1 (]: 4 of 18 PASS not_null_dim_customer_customer_unique_id .......................... [[32mPASS[0m in 1.71s]
[0m12:24:28.430074 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m12:24:28.431486 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m12:24:28.433969 [info ] [Thread-1 (]: 5 of 18 START test not_null_dim_customer_customer_zip_code_prefix .............. [RUN]
[0m12:24:28.436457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4, now test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65)
[0m12:24:28.437782 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m12:24:28.452476 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"
[0m12:24:28.455125 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m12:24:28.465535 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"
[0m12:24:28.467377 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_zip_code_prefix
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_zip_code_prefix is null



      
    ) dbt_internal_test
[0m12:24:28.468130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:29.106513 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:ae535117-ebfa-4931-8f90-5f4d9f7bc00e&page=queryresults
[0m12:24:30.143329 [info ] [Thread-1 (]: 5 of 18 PASS not_null_dim_customer_customer_zip_code_prefix .................... [[32mPASS[0m in 1.71s]
[0m12:24:30.145396 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m12:24:30.146493 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:24:30.147487 [info ] [Thread-1 (]: 6 of 18 START test not_null_dim_geolocation_geolocation_city ................... [RUN]
[0m12:24:30.150269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65, now test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207)
[0m12:24:30.151485 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:24:30.159683 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207"
[0m12:24:30.160632 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:24:30.163183 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207"
[0m12:24:30.163819 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geolocation_city
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
where geolocation_city is null



      
    ) dbt_internal_test
[0m12:24:30.164265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:30.831065 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:72bcd4a8-ce3b-4c25-8bb3-091a43088c9b&page=queryresults
[0m12:24:31.764110 [info ] [Thread-1 (]: 6 of 18 PASS not_null_dim_geolocation_geolocation_city ......................... [[32mPASS[0m in 1.61s]
[0m12:24:31.765950 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:24:31.766962 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:24:31.767741 [info ] [Thread-1 (]: 7 of 18 START test not_null_dim_geolocation_geolocation_state .................. [RUN]
[0m12:24:31.768739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207, now test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954)
[0m12:24:31.769548 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:24:31.778848 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954"
[0m12:24:31.779764 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:24:31.782588 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954"
[0m12:24:31.783177 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geolocation_state
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
where geolocation_state is null



      
    ) dbt_internal_test
[0m12:24:31.783564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:32.393485 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:a876f6e3-55f9-47a2-86ee-924e5c6cb728&page=queryresults
[0m12:24:33.259860 [info ] [Thread-1 (]: 7 of 18 PASS not_null_dim_geolocation_geolocation_state ........................ [[32mPASS[0m in 1.49s]
[0m12:24:33.261466 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:24:33.261904 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:24:33.262265 [info ] [Thread-1 (]: 8 of 18 START test not_null_dim_geolocation_geolocation_zip_code_prefix ........ [RUN]
[0m12:24:33.262730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954, now test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c)
[0m12:24:33.263098 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:24:33.270159 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c"
[0m12:24:33.271660 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:24:33.278176 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c"
[0m12:24:33.279022 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geolocation_zip_code_prefix
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
where geolocation_zip_code_prefix is null



      
    ) dbt_internal_test
[0m12:24:33.279607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:33.885778 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d424fdae-e786-4ede-9833-85a7408f3918&page=queryresults
[0m12:24:34.830244 [info ] [Thread-1 (]: 8 of 18 PASS not_null_dim_geolocation_geolocation_zip_code_prefix .............. [[32mPASS[0m in 1.57s]
[0m12:24:34.831237 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:24:34.831847 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492
[0m12:24:34.833101 [info ] [Thread-1 (]: 9 of 18 START test not_null_dim_product_product_category_name .................. [RUN]
[0m12:24:34.833753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c, now test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492)
[0m12:24:34.834312 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492
[0m12:24:34.841266 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492"
[0m12:24:34.844567 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492
[0m12:24:34.848826 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492"
[0m12:24:34.849604 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_category_name
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
where product_category_name is null



      
    ) dbt_internal_test
[0m12:24:34.850102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:35.509261 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:37b94cde-f82f-4d48-bb82-65dc7c738115&page=queryresults
[0m12:24:36.603063 [info ] [Thread-1 (]: 9 of 18 PASS not_null_dim_product_product_category_name ........................ [[32mPASS[0m in 1.77s]
[0m12:24:36.605386 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492
[0m12:24:36.608403 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_product_product_id.02b1f06816
[0m12:24:36.609727 [info ] [Thread-1 (]: 10 of 18 START test not_null_dim_product_product_id ............................ [RUN]
[0m12:24:36.611369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492, now test.olist_dataset.not_null_dim_product_product_id.02b1f06816)
[0m12:24:36.613511 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_product_product_id.02b1f06816
[0m12:24:36.625010 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_product_product_id.02b1f06816"
[0m12:24:36.626387 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_product_product_id.02b1f06816
[0m12:24:36.630286 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_product_product_id.02b1f06816"
[0m12:24:36.632105 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_product_product_id.02b1f06816"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
where product_id is null



      
    ) dbt_internal_test
[0m12:24:36.633136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:37.293600 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:564a1cae-c20a-4345-bb2f-ecbe5a04137a&page=queryresults
[0m12:24:38.249066 [info ] [Thread-1 (]: 10 of 18 PASS not_null_dim_product_product_id .................................. [[32mPASS[0m in 1.64s]
[0m12:24:38.250563 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_product_product_id.02b1f06816
[0m12:24:38.251497 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m12:24:38.252280 [info ] [Thread-1 (]: 11 of 18 START test not_null_dim_seller_seller_city ............................ [RUN]
[0m12:24:38.253268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_product_product_id.02b1f06816, now test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d)
[0m12:24:38.254957 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m12:24:38.264726 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d"
[0m12:24:38.265801 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m12:24:38.269790 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d"
[0m12:24:38.270898 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_city
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_city is null



      
    ) dbt_internal_test
[0m12:24:38.271647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:38.838808 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:c3ccbed3-fefe-4d33-ae1c-2d97961acb72&page=queryresults
[0m12:24:39.743686 [info ] [Thread-1 (]: 11 of 18 PASS not_null_dim_seller_seller_city .................................. [[32mPASS[0m in 1.49s]
[0m12:24:39.746054 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m12:24:39.747442 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m12:24:39.756230 [info ] [Thread-1 (]: 12 of 18 START test not_null_dim_seller_seller_id .............................. [RUN]
[0m12:24:39.758038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d, now test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2)
[0m12:24:39.759827 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m12:24:39.774010 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2"
[0m12:24:39.775796 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m12:24:39.782420 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2"
[0m12:24:39.784002 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_id is null



      
    ) dbt_internal_test
[0m12:24:39.785131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:40.360995 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:b472ddb2-cc9e-4967-8d1c-f83cf2cd6e4f&page=queryresults
[0m12:24:41.253584 [info ] [Thread-1 (]: 12 of 18 PASS not_null_dim_seller_seller_id .................................... [[32mPASS[0m in 1.50s]
[0m12:24:41.255025 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m12:24:41.255861 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m12:24:41.257364 [info ] [Thread-1 (]: 13 of 18 START test not_null_dim_seller_seller_state ........................... [RUN]
[0m12:24:41.258853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2, now test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb)
[0m12:24:41.259821 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m12:24:41.271087 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb"
[0m12:24:41.272477 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m12:24:41.277370 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb"
[0m12:24:41.278788 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_state
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_state is null



      
    ) dbt_internal_test
[0m12:24:41.279786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:41.962038 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:98664d88-d4af-467e-bbb1-f63f81f8e0c3&page=queryresults
[0m12:24:42.842827 [info ] [Thread-1 (]: 13 of 18 PASS not_null_dim_seller_seller_state ................................. [[32mPASS[0m in 1.58s]
[0m12:24:42.844813 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m12:24:42.845837 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m12:24:42.846725 [info ] [Thread-1 (]: 14 of 18 START test not_null_dim_seller_seller_zip_code_prefix ................. [RUN]
[0m12:24:42.847868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb, now test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472)
[0m12:24:42.848727 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m12:24:42.859283 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472"
[0m12:24:42.860479 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m12:24:42.864810 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472"
[0m12:24:42.865941 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_zip_code_prefix
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_zip_code_prefix is null



      
    ) dbt_internal_test
[0m12:24:42.866724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:43.449281 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:edc90377-801e-4184-a8d8-d1933e1f1ba5&page=queryresults
[0m12:24:44.404332 [info ] [Thread-1 (]: 14 of 18 PASS not_null_dim_seller_seller_zip_code_prefix ....................... [[32mPASS[0m in 1.56s]
[0m12:24:44.405887 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m12:24:44.406802 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m12:24:44.408066 [info ] [Thread-1 (]: 15 of 18 START test unique_dim_customer_customer_id ............................ [RUN]
[0m12:24:44.409403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472, now test.olist_dataset.unique_dim_customer_customer_id.b42affccd1)
[0m12:24:44.410382 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m12:24:44.427306 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"
[0m12:24:44.428788 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m12:24:44.433739 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"
[0m12:24:44.435999 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_customer_customer_id.b42affccd1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:24:44.437096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:45.186838 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:87bb877a-e457-41cc-be64-43f06949d44e&page=queryresults
[0m12:24:46.124224 [info ] [Thread-1 (]: 15 of 18 PASS unique_dim_customer_customer_id .................................. [[32mPASS[0m in 1.71s]
[0m12:24:46.125446 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m12:24:46.126176 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:24:46.127175 [info ] [Thread-1 (]: 16 of 18 START test unique_dim_geolocation_geolocation_zip_code_prefix ......... [RUN]
[0m12:24:46.128285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.unique_dim_customer_customer_id.b42affccd1, now test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0)
[0m12:24:46.129084 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:24:46.139683 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0"
[0m12:24:46.141300 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:24:46.146954 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0"
[0m12:24:46.148659 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select geolocation_zip_code_prefix as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
  where geolocation_zip_code_prefix is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:24:46.149742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:46.853592 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:f11576ca-151d-4195-9392-f5828d44fbc5&page=queryresults
[0m12:24:47.887210 [error] [Thread-1 (]: 16 of 18 FAIL 17972 unique_dim_geolocation_geolocation_zip_code_prefix ......... [[31mFAIL 17972[0m in 1.76s]
[0m12:24:47.888292 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:24:47.888771 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_product_product_id.46495bf7fe
[0m12:24:47.889536 [info ] [Thread-1 (]: 17 of 18 START test unique_dim_product_product_id .............................. [RUN]
[0m12:24:47.890339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0, now test.olist_dataset.unique_dim_product_product_id.46495bf7fe)
[0m12:24:47.890780 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_product_product_id.46495bf7fe
[0m12:24:47.895832 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_product_product_id.46495bf7fe"
[0m12:24:47.896623 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_product_product_id.46495bf7fe
[0m12:24:47.899897 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_product_product_id.46495bf7fe"
[0m12:24:47.901043 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_product_product_id.46495bf7fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:24:47.901805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:48.663293 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:5c1d9196-e135-4459-8495-4eb9d0670d75&page=queryresults
[0m12:24:49.567062 [info ] [Thread-1 (]: 17 of 18 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 1.68s]
[0m12:24:49.567865 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_product_product_id.46495bf7fe
[0m12:24:49.568361 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m12:24:49.568809 [info ] [Thread-1 (]: 18 of 18 START test unique_dim_seller_seller_id ................................ [RUN]
[0m12:24:49.569450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.unique_dim_product_product_id.46495bf7fe, now test.olist_dataset.unique_dim_seller_seller_id.a1add5f830)
[0m12:24:49.570402 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m12:24:49.577209 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_seller_seller_id.a1add5f830"
[0m12:24:49.578573 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m12:24:49.582961 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_seller_seller_id.a1add5f830"
[0m12:24:49.584322 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_seller_seller_id.a1add5f830: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_seller_seller_id.a1add5f830"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select seller_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
  where seller_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:24:49.585161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:50.214685 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:6320e119-dea9-415c-ba44-aefd23d5734b&page=queryresults
[0m12:24:51.135291 [info ] [Thread-1 (]: 18 of 18 PASS unique_dim_seller_seller_id ...................................... [[32mPASS[0m in 1.57s]
[0m12:24:51.136719 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m12:24:51.141085 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:24:51.143034 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:51.143850 [debug] [MainThread]: Connection 'test.olist_dataset.unique_dim_seller_seller_id.a1add5f830' was properly closed.
[0m12:24:51.144733 [info ] [MainThread]: 
[0m12:24:51.145749 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 31.01 seconds (31.01s).
[0m12:24:51.151701 [debug] [MainThread]: Command end result
[0m12:24:51.180167 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:24:51.182314 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:24:51.189817 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:24:51.190225 [info ] [MainThread]: 
[0m12:24:51.190634 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:24:51.190944 [info ] [MainThread]: 
[0m12:24:51.191341 [error] [MainThread]: [31mFailure in test unique_dim_geolocation_geolocation_zip_code_prefix (models/schema.yml)[0m
[0m12:24:51.191714 [error] [MainThread]:   Got 17972 results, configured to fail if != 0
[0m12:24:51.191959 [info ] [MainThread]: 
[0m12:24:51.192297 [info ] [MainThread]:   compiled code at target/compiled/olist_dataset/models/schema.yml/unique_dim_geolocation_geolocation_zip_code_prefix.sql
[0m12:24:51.192625 [info ] [MainThread]: 
[0m12:24:51.192946 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=1 SKIP=0 TOTAL=18
[0m12:24:51.193585 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 32.6267, "process_in_blocks": "1680", "process_kernel_time": 1.330669, "process_mem_max_rss": "252336", "process_out_blocks": "2768", "process_user_time": 4.119206}
[0m12:24:51.194037 [debug] [MainThread]: Command `dbt test` failed at 12:24:51.193932 after 32.63 seconds
[0m12:24:51.194482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967cde1db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f964decce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967ca8b880>]}
[0m12:24:51.194915 [debug] [MainThread]: Flushing usage events
[0m12:24:52.149005 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:27:52.878781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f757c35ddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f757b249420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f757b2493c0>]}


============================== 12:27:52.881172 | 2d57b35a-667c-4dd1-a57d-f69a6b56b717 ==============================
[0m12:27:52.881172 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:27:52.881708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/kangh/.dbt', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:27:53.900899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d57b35a-667c-4dd1-a57d-f69a6b56b717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f757d38cfd0>]}
[0m12:27:53.972121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d57b35a-667c-4dd1-a57d-f69a6b56b717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f757c2b3820>]}
[0m12:27:53.972961 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:27:54.080617 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:27:54.301661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:27:54.302487 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_geolocation.sql
[0m12:27:54.799498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d57b35a-667c-4dd1-a57d-f69a6b56b717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f754cb39360>]}
[0m12:27:54.896605 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:27:54.898556 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:27:54.914633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d57b35a-667c-4dd1-a57d-f69a6b56b717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f754d078f40>]}
[0m12:27:54.915245 [info ] [MainThread]: Found 6 models, 3 snapshots, 18 data tests, 9 sources, 491 macros
[0m12:27:54.915630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d57b35a-667c-4dd1-a57d-f69a6b56b717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f754d078f70>]}
[0m12:27:54.917752 [info ] [MainThread]: 
[0m12:27:54.918264 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:27:54.918600 [info ] [MainThread]: 
[0m12:27:54.919365 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:27:54.924383 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m12:27:54.925445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:55.964676 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:56.297393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m12:27:56.298834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:56.744205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m12:27:56.745091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:57.083019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:27:57.085516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:57.447017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d57b35a-667c-4dd1-a57d-f69a6b56b717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f754d1c1420>]}
[0m12:27:57.448143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:27:57.453880 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_customer
[0m12:27:57.454907 [info ] [Thread-1 (]: 1 of 6 START sql table model olist_data_ingestion_dim_tables.dim_customer ...... [RUN]
[0m12:27:57.456129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now model.olist_dataset.dim_customer)
[0m12:27:57.456894 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_customer
[0m12:27:57.472310 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_customer"
[0m12:27:57.473095 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_customer
[0m12:27:57.484997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:57.868867 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_customer"
[0m12:27:57.869666 [debug] [Thread-1 (]: On model.olist_dataset.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_customer"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_customer.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         customer_id,
--         customer_unique_id,
--         customer_zip_code_prefix,
--         customer_city,
--         customer_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     from `olist-ecommerce-454812`.`olist_data_staging`.`olist_customers_dataset`
-- )

-- SELECT * FROM source

-- 


-- This is snapshot approach, refer to customer_snapshot.sql (Type 2 SCD)


SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`customer_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:27:58.389665 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:6ab5fc85-d1ba-4379-9e10-7720ebb698fc&page=queryresults
[0m12:28:01.653682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d57b35a-667c-4dd1-a57d-f69a6b56b717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f757b25ba90>]}
[0m12:28:01.654430 [info ] [Thread-1 (]: 1 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_customer . [[32mCREATE TABLE (99.4k rows, 9.5 MiB processed)[0m in 4.20s]
[0m12:28:01.655034 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_customer
[0m12:28:01.655538 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m12:28:01.656234 [info ] [Thread-1 (]: 2 of 6 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m12:28:01.656844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_customer, now model.olist_dataset.dim_geolocation)
[0m12:28:01.657424 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m12:28:01.663859 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m12:28:01.664619 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m12:28:01.691309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:02.081546 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m12:28:02.082443 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation` as DBT_INTERNAL_DEST
        using (-- models/star/dim_geolocation.sql

-- This is incremental approach (Type 1 SCD)


WITH source AS (
  SELECT DISTINCT
    geolocation_zip_code_prefix,
    geolocation_city,
    geolocation_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated,
    -- ROW_NUMBER() OVER (
    --   PARTITION BY geolocation_zip_code_prefix
    --   ORDER BY last_updated DESC
    -- ) as rn
  FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source
-- WHERE rn = 1

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those geolocation_zip_code_prefix that already in dim_geolocation table
-- which assume data already in table never change

-- 
--   WHERE geolocation_zip_code_prefix NOT IN (
--       SELECT geolocation_zip_code_prefix FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
--   )
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.geolocation_zip_code_prefix = DBT_INTERNAL_DEST.geolocation_zip_code_prefix))

    
    when matched then update set
        `geolocation_zip_code_prefix` = DBT_INTERNAL_SOURCE.`geolocation_zip_code_prefix`,`geolocation_city` = DBT_INTERNAL_SOURCE.`geolocation_city`,`geolocation_state` = DBT_INTERNAL_SOURCE.`geolocation_state`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)
    values
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)


    
[0m12:28:02.620548 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:b4dc339b-2185-4ac2-af46-6404cea52fc1&page=queryresults
[0m12:28:04.243344 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:b4dc339b-2185-4ac2-af46-6404cea52fc1&page=queryresults
[0m12:28:04.265938 [debug] [Thread-1 (]: Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  UPDATE/MERGE must match at most one source row for each target row
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql
[0m12:28:04.267571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d57b35a-667c-4dd1-a57d-f69a6b56b717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f757b805a20>]}
[0m12:28:04.269071 [error] [Thread-1 (]: 2 of 6 ERROR creating sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[31mERROR[0m in 2.61s]
[0m12:28:04.270227 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m12:28:04.270946 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_product
[0m12:28:04.272217 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_geolocation' to be skipped because of status 'error'.  Reason: Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  UPDATE/MERGE must match at most one source row for each target row
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql.
[0m12:28:04.273497 [info ] [Thread-1 (]: 3 of 6 START sql table model olist_data_ingestion_dim_tables.dim_product ....... [RUN]
[0m12:28:04.275914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_geolocation, now model.olist_dataset.dim_product)
[0m12:28:04.276580 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_product
[0m12:28:04.281714 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_product"
[0m12:28:04.282344 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_product
[0m12:28:04.285475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:04.656790 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_product"
[0m12:28:04.658393 [debug] [Thread-1 (]: On model.olist_dataset.dim_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_product"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_product.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         product_id,
--         product_category_name,
--         product_name_lenght,
--         product_description_lenght,
--         product_photos_qty,
--         product_weight_g,
--         product_length_cm,
--         product_height_cm,
--         product_width_cm,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_products_dataset`
-- )

-- SELECT * FROM source

-- 

-- This is snapshot approach, refer to product_snapshot (Type 2 SCD)


SELECT
    product_id,
    COALESCE(product_category_name, 'UNKNOWN') AS product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`product_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:28:05.133871 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:48a2cb5b-6af7-490d-b9d7-6c03bc7f0f75&page=queryresults
[0m12:28:07.946695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d57b35a-667c-4dd1-a57d-f69a6b56b717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f754cf2b5b0>]}
[0m12:28:07.947994 [info ] [Thread-1 (]: 3 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_product .. [[32mCREATE TABLE (33.0k rows, 3.6 MiB processed)[0m in 3.67s]
[0m12:28:07.949133 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_product
[0m12:28:07.949843 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_seller
[0m12:28:07.950721 [info ] [Thread-1 (]: 4 of 6 START sql table model olist_data_ingestion_dim_tables.dim_seller ........ [RUN]
[0m12:28:07.951711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_product, now model.olist_dataset.dim_seller)
[0m12:28:07.952873 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_seller
[0m12:28:07.960683 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_seller"
[0m12:28:07.961613 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_seller
[0m12:28:07.966185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:08.360300 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_seller"
[0m12:28:08.361759 [debug] [Thread-1 (]: On model.olist_dataset.dim_seller: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_seller"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_seller.sql

-- This is incremental approach (Type 1 SCD)
-- 

-- WITH source AS (
--     SELECT
--         seller_id,
--         seller_zip_code_prefix,
--         seller_city,
--         seller_state,
--         CAST(last_updated AS TIMESTAMP) AS last_updated
--     FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_sellers_dataset`
-- )

-- SELECT * FROM source

-- 


-- This is snapshot approach, refer to seller_snapshot (Type 2 SCD)


SELECT
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state,
    dbt_valid_from,
    dbt_valid_to
FROM `olist-ecommerce-454812`.`olist_data_snapshots`.`seller_snapshot`
WHERE dbt_valid_to IS NULL
    );
  
[0m12:28:08.816633 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:fed4c325-8e04-4553-93ae-0fb2d72114cc&page=queryresults
[0m12:28:11.220862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d57b35a-667c-4dd1-a57d-f69a6b56b717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f754a14b160>]}
[0m12:28:11.222495 [info ] [Thread-1 (]: 4 of 6 OK created sql table model olist_data_ingestion_dim_tables.dim_seller ... [[32mCREATE TABLE (3.1k rows, 200.0 KiB processed)[0m in 3.27s]
[0m12:28:11.223611 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_seller
[0m12:28:11.224347 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m12:28:11.225761 [info ] [Thread-1 (]: 5 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m12:28:11.227629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.dim_seller, now model.olist_dataset.fact_order_items)
[0m12:28:11.228976 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m12:28:11.244405 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m12:28:11.246073 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m12:28:11.252580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:11.692061 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m12:28:11.693885 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    LEFT JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order item id that already in fact_order_item table
-- which assume data already in table never change

-- 
--   WHERE order_id_item NOT IN (SELECT order_id_item FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id_item = DBT_INTERNAL_DEST.order_id_item))

    
    when matched then update set
        `customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_id` = DBT_INTERNAL_SOURCE.`order_id`,`order_item_id` = DBT_INTERNAL_SOURCE.`order_item_id`,`product_id` = DBT_INTERNAL_SOURCE.`product_id`,`seller_id` = DBT_INTERNAL_SOURCE.`seller_id`,`price` = DBT_INTERNAL_SOURCE.`price`,`freight_value` = DBT_INTERNAL_SOURCE.`freight_value`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`order_id_item` = DBT_INTERNAL_SOURCE.`order_id_item`
    

    when not matched then insert
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)
    values
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)


    
[0m12:28:12.202696 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:4522441f-f852-4fe3-8b02-435791b57c62&page=queryresults
[0m12:28:18.594567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d57b35a-667c-4dd1-a57d-f69a6b56b717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f754a14a5c0>]}
[0m12:28:18.596112 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mMERGE (112.7k rows, 57.9 MiB processed)[0m in 7.37s]
[0m12:28:18.597505 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m12:28:18.598445 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m12:28:18.600005 [info ] [Thread-1 (]: 6 of 6 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m12:28:18.602205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_dataset.fact_order_items, now model.olist_dataset.fact_orders)
[0m12:28:18.602969 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m12:28:18.608827 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m12:28:18.609557 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m12:28:18.612298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:18.952767 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m12:28:18.954345 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order id that already in fact_orders table
-- which assume data already in table never change

-- 
--   WHERE order_id NOT IN (SELECT order_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        `order_id` = DBT_INTERNAL_SOURCE.`order_id`,`customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_status` = DBT_INTERNAL_SOURCE.`order_status`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_carrier_date` = DBT_INTERNAL_SOURCE.`order_delivered_carrier_date`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`payment_value` = DBT_INTERNAL_SOURCE.`payment_value`
    

    when not matched then insert
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)
    values
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)


    
[0m12:28:19.532104 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:9c1b277c-c2ca-402f-9078-0c070bd2d1a9&page=queryresults
[0m12:28:25.240280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d57b35a-667c-4dd1-a57d-f69a6b56b717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f757b25ba90>]}
[0m12:28:25.242376 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mMERGE (99.4k rows, 39.6 MiB processed)[0m in 6.64s]
[0m12:28:25.243924 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m12:28:25.249367 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:25.250991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:25.251901 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m12:28:25.253058 [info ] [MainThread]: 
[0m12:28:25.253977 [info ] [MainThread]: Finished running 3 incremental models, 3 table models in 0 hours 0 minutes and 30.33 seconds (30.33s).
[0m12:28:25.257210 [debug] [MainThread]: Command end result
[0m12:28:25.286545 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:28:25.288720 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:28:25.294681 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:28:25.295071 [info ] [MainThread]: 
[0m12:28:25.295463 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:28:25.295790 [info ] [MainThread]: 
[0m12:28:25.296181 [error] [MainThread]:   Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  UPDATE/MERGE must match at most one source row for each target row
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql
[0m12:28:25.296475 [info ] [MainThread]: 
[0m12:28:25.296798 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m12:28:25.297394 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 32.47948, "process_in_blocks": "712", "process_kernel_time": 1.128513, "process_mem_max_rss": "258316", "process_out_blocks": "3648", "process_user_time": 4.181545}
[0m12:28:25.297850 [debug] [MainThread]: Command `dbt run` failed at 12:28:25.297742 after 32.48 seconds
[0m12:28:25.298245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f757c35ddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f754cc5a980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f757bffb880>]}
[0m12:28:25.298597 [debug] [MainThread]: Flushing usage events
[0m12:28:26.489665 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:28:46.654896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d58cade40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d57bbd540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d57bbd4e0>]}


============================== 12:28:46.657282 | 55886d99-f5f6-4756-91a0-c1c24f0be564 ==============================
[0m12:28:46.657282 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:28:46.657886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'profiles_dir': '/home/kangh/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_geolocation', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:28:47.626806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55886d99-f5f6-4756-91a0-c1c24f0be564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d29d35d50>]}
[0m12:28:47.693619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55886d99-f5f6-4756-91a0-c1c24f0be564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d57bf73d0>]}
[0m12:28:47.694706 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:28:47.794733 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:28:48.003049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:28:48.003854 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_geolocation.sql
[0m12:28:48.469203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55886d99-f5f6-4756-91a0-c1c24f0be564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d294ad3c0>]}
[0m12:28:48.561001 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:28:48.562530 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:28:48.576979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55886d99-f5f6-4756-91a0-c1c24f0be564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d29488af0>]}
[0m12:28:48.577576 [info ] [MainThread]: Found 6 models, 3 snapshots, 18 data tests, 9 sources, 491 macros
[0m12:28:48.577980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55886d99-f5f6-4756-91a0-c1c24f0be564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d29488a30>]}
[0m12:28:48.579429 [info ] [MainThread]: 
[0m12:28:48.579848 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:28:48.580139 [info ] [MainThread]: 
[0m12:28:48.580685 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:28:48.582119 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m12:28:48.582638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:49.572320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:28:49.573611 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:49.923636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m12:28:49.926178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:50.269376 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m12:28:50.271668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:50.633687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55886d99-f5f6-4756-91a0-c1c24f0be564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2984cbb0>]}
[0m12:28:50.634736 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:50.640087 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m12:28:50.640999 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m12:28:50.641844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now model.olist_dataset.dim_geolocation)
[0m12:28:50.642341 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m12:28:50.652372 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m12:28:50.653206 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m12:28:50.682325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:51.103905 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m12:28:51.104886 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation` as DBT_INTERNAL_DEST
        using (-- models/star/dim_geolocation.sql

-- This is incremental approach (Type 1 SCD)


WITH source AS (
  SELECT DISTINCT
    geolocation_zip_code_prefix,
    geolocation_city,
    geolocation_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
    -- ROW_NUMBER() OVER (
    --   PARTITION BY geolocation_zip_code_prefix
    --   ORDER BY last_updated DESC
    -- ) as rn
  FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source
-- WHERE rn = 1

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those geolocation_zip_code_prefix that already in dim_geolocation table
-- which assume data already in table never change

-- 
--   WHERE geolocation_zip_code_prefix NOT IN (
--       SELECT geolocation_zip_code_prefix FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
--   )
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.geolocation_zip_code_prefix = DBT_INTERNAL_DEST.geolocation_zip_code_prefix))

    
    when matched then update set
        `geolocation_zip_code_prefix` = DBT_INTERNAL_SOURCE.`geolocation_zip_code_prefix`,`geolocation_city` = DBT_INTERNAL_SOURCE.`geolocation_city`,`geolocation_state` = DBT_INTERNAL_SOURCE.`geolocation_state`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)
    values
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)


    
[0m12:28:51.744758 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:acada4ef-7d86-49ff-95f2-fe0fe828e957&page=queryresults
[0m12:28:53.136654 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:acada4ef-7d86-49ff-95f2-fe0fe828e957&page=queryresults
[0m12:28:53.142231 [debug] [Thread-1 (]: Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  UPDATE/MERGE must match at most one source row for each target row
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql
[0m12:28:53.144377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55886d99-f5f6-4756-91a0-c1c24f0be564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d58cf1f60>]}
[0m12:28:53.145162 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[31mERROR[0m in 2.50s]
[0m12:28:53.145725 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m12:28:53.146512 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_geolocation' to be skipped because of status 'error'.  Reason: Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  UPDATE/MERGE must match at most one source row for each target row
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql.
[0m12:28:53.149556 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:53.150354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:53.150747 [debug] [MainThread]: Connection 'model.olist_dataset.dim_geolocation' was properly closed.
[0m12:28:53.151184 [info ] [MainThread]: 
[0m12:28:53.152065 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m12:28:53.153221 [debug] [MainThread]: Command end result
[0m12:28:53.178634 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:28:53.180329 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:28:53.185555 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:28:53.185944 [info ] [MainThread]: 
[0m12:28:53.186333 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:28:53.186653 [info ] [MainThread]: 
[0m12:28:53.187004 [error] [MainThread]:   Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  UPDATE/MERGE must match at most one source row for each target row
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql
[0m12:28:53.187293 [info ] [MainThread]: 
[0m12:28:53.187602 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:28:53.188118 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.592324, "process_in_blocks": "0", "process_kernel_time": 1.192587, "process_mem_max_rss": "258232", "process_out_blocks": "3488", "process_user_time": 3.708045}
[0m12:28:53.188490 [debug] [MainThread]: Command `dbt run` failed at 12:28:53.188403 after 6.59 seconds
[0m12:28:53.188822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d58cade40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d295edd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d29b34f40>]}
[0m12:28:53.189173 [debug] [MainThread]: Flushing usage events
[0m12:28:54.158305 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:31:09.516844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17b2ade40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17a2bd540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17a2bd4e0>]}


============================== 12:31:09.519576 | c40a7371-f601-4696-89f4-b92da1414af0 ==============================
[0m12:31:09.519576 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:31:09.520117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'profiles_dir': '/home/kangh/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_geolocation', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:31:10.508337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c40a7371-f601-4696-89f4-b92da1414af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17c3e30d0>]}
[0m12:31:10.573855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c40a7371-f601-4696-89f4-b92da1414af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17a904cd0>]}
[0m12:31:10.574569 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:31:10.674703 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:31:10.885632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:31:10.886432 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_geolocation.sql
[0m12:31:11.378292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c40a7371-f601-4696-89f4-b92da1414af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14ba9d3f0>]}
[0m12:31:11.471964 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:31:11.473702 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:31:11.488418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c40a7371-f601-4696-89f4-b92da1414af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14bffd6f0>]}
[0m12:31:11.489012 [info ] [MainThread]: Found 6 models, 3 snapshots, 18 data tests, 9 sources, 491 macros
[0m12:31:11.489551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c40a7371-f601-4696-89f4-b92da1414af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17a925d80>]}
[0m12:31:11.491149 [info ] [MainThread]: 
[0m12:31:11.491871 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:31:11.492245 [info ] [MainThread]: 
[0m12:31:11.493105 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:31:11.494703 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m12:31:11.495093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:12.480349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m12:31:12.482014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:12.883117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:31:12.885226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:13.235596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m12:31:13.238029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:13.597260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c40a7371-f601-4696-89f4-b92da1414af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17c461e70>]}
[0m12:31:13.598460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:31:13.604352 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m12:31:13.605422 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m12:31:13.606386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now model.olist_dataset.dim_geolocation)
[0m12:31:13.607018 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m12:31:13.623640 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m12:31:13.624359 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m12:31:13.652580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:14.015956 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m12:31:14.016856 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation` as DBT_INTERNAL_DEST
        using (-- models/star/dim_geolocation.sql

-- This is incremental approach (Type 1 SCD)


WITH source AS (
  SELECT
    geolocation_zip_code_prefix,
    geolocation_city,
    geolocation_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated,
    ROW_NUMBER() OVER (
      PARTITION BY geolocation_zip_code_prefix
      ORDER BY last_updated DESC
    ) as rn
  FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT DISITNCT * FROM source
WHERE rn = 1

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those geolocation_zip_code_prefix that already in dim_geolocation table
-- which assume data already in table never change

-- 
--   WHERE geolocation_zip_code_prefix NOT IN (
--       SELECT geolocation_zip_code_prefix FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
--   )
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.geolocation_zip_code_prefix = DBT_INTERNAL_DEST.geolocation_zip_code_prefix))

    
    when matched then update set
        `geolocation_zip_code_prefix` = DBT_INTERNAL_SOURCE.`geolocation_zip_code_prefix`,`geolocation_city` = DBT_INTERNAL_SOURCE.`geolocation_city`,`geolocation_state` = DBT_INTERNAL_SOURCE.`geolocation_state`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)
    values
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)


    
[0m12:31:14.343824 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:b9b7a831-339e-451d-b7ad-fa4509f69144&page=queryresults
[0m12:31:14.345431 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:b9b7a831-339e-451d-b7ad-fa4509f69144&page=queryresults
[0m12:31:14.352116 [debug] [Thread-1 (]: Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  Syntax error: Unexpected keyword FROM at [34:19]
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql
[0m12:31:14.356792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c40a7371-f601-4696-89f4-b92da1414af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17b3e2710>]}
[0m12:31:14.358448 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[31mERROR[0m in 0.75s]
[0m12:31:14.359837 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m12:31:14.361355 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_geolocation' to be skipped because of status 'error'.  Reason: Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  Syntax error: Unexpected keyword FROM at [34:19]
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql.
[0m12:31:14.365260 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:31:14.366263 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:14.366741 [debug] [MainThread]: Connection 'model.olist_dataset.dim_geolocation' was properly closed.
[0m12:31:14.367169 [info ] [MainThread]: 
[0m12:31:14.367602 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m12:31:14.368412 [debug] [MainThread]: Command end result
[0m12:31:14.391909 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:31:14.393689 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:31:14.398772 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:31:14.399089 [info ] [MainThread]: 
[0m12:31:14.399456 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:31:14.399767 [info ] [MainThread]: 
[0m12:31:14.400104 [error] [MainThread]:   Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  Syntax error: Unexpected keyword FROM at [34:19]
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql
[0m12:31:14.400373 [info ] [MainThread]: 
[0m12:31:14.400668 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:31:14.401197 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.944093, "process_in_blocks": "0", "process_kernel_time": 1.105453, "process_mem_max_rss": "261248", "process_out_blocks": "3496", "process_user_time": 3.748493}
[0m12:31:14.401678 [debug] [MainThread]: Command `dbt run` failed at 12:31:14.401578 after 4.94 seconds
[0m12:31:14.402064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17b2ade40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14bdf3df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14be557b0>]}
[0m12:31:14.402426 [debug] [MainThread]: Flushing usage events
[0m12:31:15.355874 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:31:40.246820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc14ac35e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc149b254b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc149b25450>]}


============================== 12:31:40.249313 | 19f4c3d8-2bd4-482d-bbf7-b1cf8e62bf2d ==============================
[0m12:31:40.249313 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:31:40.249792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'version_check': 'True', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_geolocation', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:31:41.252141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19f4c3d8-2bd4-482d-bbf7-b1cf8e62bf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc14a8a7a00>]}
[0m12:31:41.318177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19f4c3d8-2bd4-482d-bbf7-b1cf8e62bf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc149b5f3d0>]}
[0m12:31:41.318915 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:31:41.418719 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:31:41.622564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:31:41.623236 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_geolocation.sql
[0m12:31:42.083679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19f4c3d8-2bd4-482d-bbf7-b1cf8e62bf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11b3913c0>]}
[0m12:31:42.175088 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:31:42.176781 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:31:42.191170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19f4c3d8-2bd4-482d-bbf7-b1cf8e62bf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11b8f0850>]}
[0m12:31:42.191781 [info ] [MainThread]: Found 6 models, 3 snapshots, 18 data tests, 9 sources, 491 macros
[0m12:31:42.192153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19f4c3d8-2bd4-482d-bbf7-b1cf8e62bf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11b8f08b0>]}
[0m12:31:42.193525 [info ] [MainThread]: 
[0m12:31:42.193918 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:31:42.194212 [info ] [MainThread]: 
[0m12:31:42.194706 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:31:42.195980 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m12:31:42.197011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:43.153892 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:31:43.155485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:43.469911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m12:31:43.470677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:43.853605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m12:31:43.855834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:44.216783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19f4c3d8-2bd4-482d-bbf7-b1cf8e62bf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11b748bb0>]}
[0m12:31:44.217488 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:31:44.220361 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m12:31:44.220953 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m12:31:44.221501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now model.olist_dataset.dim_geolocation)
[0m12:31:44.221841 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m12:31:44.231445 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m12:31:44.232205 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m12:31:44.260904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:44.672783 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m12:31:44.673602 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation` as DBT_INTERNAL_DEST
        using (-- models/star/dim_geolocation.sql

-- This is incremental approach (Type 1 SCD)


WITH source AS (
  SELECT
    geolocation_zip_code_prefix,
    geolocation_city,
    geolocation_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated,
    ROW_NUMBER() OVER (
      PARTITION BY geolocation_zip_code_prefix
      ORDER BY last_updated DESC
    ) as rn
  FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT
    geolocation_zip_code_prefix,
    geolocation_city,
    geolocation_state,
    last_updated
FROM ranked
WHERE rn = 1

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those geolocation_zip_code_prefix that already in dim_geolocation table
-- which assume data already in table never change

-- 
--   WHERE geolocation_zip_code_prefix NOT IN (
--       SELECT geolocation_zip_code_prefix FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
--   )
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.geolocation_zip_code_prefix = DBT_INTERNAL_DEST.geolocation_zip_code_prefix))

    
    when matched then update set
        `geolocation_zip_code_prefix` = DBT_INTERNAL_SOURCE.`geolocation_zip_code_prefix`,`geolocation_city` = DBT_INTERNAL_SOURCE.`geolocation_city`,`geolocation_state` = DBT_INTERNAL_SOURCE.`geolocation_state`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)
    values
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)


    
[0m12:31:45.158236 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:29cb73c8-f272-4815-98cf-7910cc454af3&page=queryresults
[0m12:31:45.159612 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:29cb73c8-f272-4815-98cf-7910cc454af3&page=queryresults
[0m12:31:45.165398 [debug] [Thread-1 (]: Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  Table "ranked" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql
[0m12:31:45.169087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19f4c3d8-2bd4-482d-bbf7-b1cf8e62bf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11b783880>]}
[0m12:31:45.171006 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[31mERROR[0m in 0.94s]
[0m12:31:45.172382 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m12:31:45.173926 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_geolocation' to be skipped because of status 'error'.  Reason: Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  Table "ranked" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql.
[0m12:31:45.179071 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:31:45.180620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:45.181326 [debug] [MainThread]: Connection 'model.olist_dataset.dim_geolocation' was properly closed.
[0m12:31:45.182226 [info ] [MainThread]: 
[0m12:31:45.183220 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m12:31:45.184549 [debug] [MainThread]: Command end result
[0m12:31:45.212663 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:31:45.214400 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:31:45.219550 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:31:45.219876 [info ] [MainThread]: 
[0m12:31:45.220275 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:31:45.220580 [info ] [MainThread]: 
[0m12:31:45.220948 [error] [MainThread]:   Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  Table "ranked" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql
[0m12:31:45.221220 [info ] [MainThread]: 
[0m12:31:45.221538 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:31:45.222142 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.0354896, "process_in_blocks": "0", "process_kernel_time": 1.254065, "process_mem_max_rss": "263448", "process_out_blocks": "3496", "process_user_time": 3.561545}
[0m12:31:45.222510 [debug] [MainThread]: Command `dbt run` failed at 12:31:45.222425 after 5.04 seconds
[0m12:31:45.222902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc14ac35e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11b333df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc14aa57b50>]}
[0m12:31:45.223259 [debug] [MainThread]: Flushing usage events
[0m12:31:46.272697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:32:31.101014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9064c9db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9053d5450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9053d53f0>]}


============================== 12:32:31.103455 | 33a89ecd-55d7-451a-b6e5-fae3e58882d5 ==============================
[0m12:32:31.103455 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:32:31.104012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_geolocation', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:32:32.072113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33a89ecd-55d7-451a-b6e5-fae3e58882d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc906322050>]}
[0m12:32:32.136838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33a89ecd-55d7-451a-b6e5-fae3e58882d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9063201f0>]}
[0m12:32:32.137499 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:32:32.236105 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:32:32.437197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:32:32.437865 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_geolocation.sql
[0m12:32:32.900169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33a89ecd-55d7-451a-b6e5-fae3e58882d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d6cc5390>]}
[0m12:32:32.989448 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:32:32.990890 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:32:33.005088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33a89ecd-55d7-451a-b6e5-fae3e58882d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d720d030>]}
[0m12:32:33.005662 [info ] [MainThread]: Found 6 models, 3 snapshots, 18 data tests, 9 sources, 491 macros
[0m12:32:33.006037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33a89ecd-55d7-451a-b6e5-fae3e58882d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d720cd00>]}
[0m12:32:33.007485 [info ] [MainThread]: 
[0m12:32:33.007964 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:32:33.008263 [info ] [MainThread]: 
[0m12:32:33.008779 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:32:33.010203 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m12:32:33.010806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:34.014733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:32:34.015872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:34.393288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m12:32:34.394100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:35.006298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m12:32:35.006851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:35.362131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33a89ecd-55d7-451a-b6e5-fae3e58882d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc907585d20>]}
[0m12:32:35.363197 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:32:35.368631 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m12:32:35.369796 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m12:32:35.370771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now model.olist_dataset.dim_geolocation)
[0m12:32:35.371484 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m12:32:35.387893 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m12:32:35.388591 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m12:32:35.416802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:35.822235 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m12:32:35.823241 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation` as DBT_INTERNAL_DEST
        using (-- models/star/dim_geolocation.sql

-- This is incremental approach (Type 1 SCD)


WITH source AS (
  SELECT
    geolocation_zip_code_prefix,
    geolocation_city,
    geolocation_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated,
    ROW_NUMBER() OVER (
      PARTITION BY geolocation_zip_code_prefix
      ORDER BY last_updated DESC
    ) as rn
  FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source
WHERE rn = 1

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those geolocation_zip_code_prefix that already in dim_geolocation table
-- which assume data already in table never change

-- 
--   WHERE geolocation_zip_code_prefix NOT IN (
--       SELECT geolocation_zip_code_prefix FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
--   )
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.geolocation_zip_code_prefix = DBT_INTERNAL_DEST.geolocation_zip_code_prefix))

    
    when matched then update set
        `geolocation_zip_code_prefix` = DBT_INTERNAL_SOURCE.`geolocation_zip_code_prefix`,`geolocation_city` = DBT_INTERNAL_SOURCE.`geolocation_city`,`geolocation_state` = DBT_INTERNAL_SOURCE.`geolocation_state`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)
    values
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)


    
[0m12:32:36.435726 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:546dfeaa-4397-4d12-a91a-d66aeb29774b&page=queryresults
[0m12:32:41.714274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33a89ecd-55d7-451a-b6e5-fae3e58882d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc906571480>]}
[0m12:32:41.715049 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[32mMERGE (1.0m rows, 62.1 MiB processed)[0m in 6.34s]
[0m12:32:41.715656 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m12:32:41.718040 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:32:41.718827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:41.719174 [debug] [MainThread]: Connection 'model.olist_dataset.dim_geolocation' was properly closed.
[0m12:32:41.719536 [info ] [MainThread]: 
[0m12:32:41.719871 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.71 seconds (8.71s).
[0m12:32:41.720461 [debug] [MainThread]: Command end result
[0m12:32:41.742948 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:32:41.744596 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:32:41.749735 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:32:41.750062 [info ] [MainThread]: 
[0m12:32:41.750440 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:32:41.750719 [info ] [MainThread]: 
[0m12:32:41.751018 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:32:41.751556 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.708227, "process_in_blocks": "0", "process_kernel_time": 1.208779, "process_mem_max_rss": "258272", "process_out_blocks": "3488", "process_user_time": 3.587154}
[0m12:32:41.751915 [debug] [MainThread]: Command `dbt run` succeeded at 12:32:41.751833 after 10.71 seconds
[0m12:32:41.752274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9064c9db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d6d78f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9063201f0>]}
[0m12:32:41.752630 [debug] [MainThread]: Flushing usage events
[0m12:32:42.730130 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:32:44.296981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f146ffe9e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f146ef29630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f146ef295d0>]}


============================== 12:32:44.299318 | 12823825-9b48-41dc-939f-9ce56c5e7901 ==============================
[0m12:32:44.299318 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:32:44.299824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m12:32:45.195207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12823825-9b48-41dc-939f-9ce56c5e7901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14411049d0>]}
[0m12:32:45.261223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12823825-9b48-41dc-939f-9ce56c5e7901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144108bb20>]}
[0m12:32:45.261976 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:32:45.364843 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:32:45.566087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:32:45.566499 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:32:45.621098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12823825-9b48-41dc-939f-9ce56c5e7901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1440c25930>]}
[0m12:32:45.713831 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:32:45.715456 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:32:45.738631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12823825-9b48-41dc-939f-9ce56c5e7901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1440bc5e10>]}
[0m12:32:45.739195 [info ] [MainThread]: Found 6 models, 3 snapshots, 18 data tests, 9 sources, 491 macros
[0m12:32:45.739606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12823825-9b48-41dc-939f-9ce56c5e7901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14414a2d70>]}
[0m12:32:45.741779 [info ] [MainThread]: 
[0m12:32:45.742205 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:32:45.742507 [info ] [MainThread]: 
[0m12:32:45.743025 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:32:45.747961 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_ingestion_fact_tables'
[0m12:32:45.748858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:47.034400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m12:32:47.036756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:47.397999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:32:47.400057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:47.735120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12823825-9b48-41dc-939f-9ce56c5e7901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14710a9e70>]}
[0m12:32:47.736277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:32:47.744754 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m12:32:47.745708 [info ] [Thread-1 (]: 1 of 18 START test not_null_dim_customer_customer_city ......................... [RUN]
[0m12:32:47.746664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now test.olist_dataset.not_null_dim_customer_customer_city.98bef70201)
[0m12:32:47.747340 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m12:32:47.769383 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"
[0m12:32:47.770162 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m12:32:47.784893 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"
[0m12:32:47.785610 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_city.98bef70201: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_city.98bef70201"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_city
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_city is null



      
    ) dbt_internal_test
[0m12:32:47.785999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:48.427606 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:497527cc-07fd-4a17-9692-1758fcc426c2&page=queryresults
[0m12:32:49.488367 [info ] [Thread-1 (]: 1 of 18 PASS not_null_dim_customer_customer_city ............................... [[32mPASS[0m in 1.74s]
[0m12:32:49.491701 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_city.98bef70201
[0m12:32:49.493076 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m12:32:49.495118 [info ] [Thread-1 (]: 2 of 18 START test not_null_dim_customer_customer_id ........................... [RUN]
[0m12:32:49.497006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_city.98bef70201, now test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc)
[0m12:32:49.498268 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m12:32:49.510913 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"
[0m12:32:49.511703 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m12:32:49.516839 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"
[0m12:32:49.517636 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_id is null



      
    ) dbt_internal_test
[0m12:32:49.518084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:50.134757 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:5ccd98c0-974f-47c0-87a1-1a7344082e8d&page=queryresults
[0m12:32:51.061834 [info ] [Thread-1 (]: 2 of 18 PASS not_null_dim_customer_customer_id ................................. [[32mPASS[0m in 1.56s]
[0m12:32:51.063236 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc
[0m12:32:51.064042 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m12:32:51.064809 [info ] [Thread-1 (]: 3 of 18 START test not_null_dim_customer_customer_state ........................ [RUN]
[0m12:32:51.066291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_id.9775012dfc, now test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82)
[0m12:32:51.067247 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m12:32:51.077218 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"
[0m12:32:51.078398 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m12:32:51.082144 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"
[0m12:32:51.082948 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_state
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_state is null



      
    ) dbt_internal_test
[0m12:32:51.083459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:51.675706 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d567784c-5d33-4628-b80f-e65e4414483e&page=queryresults
[0m12:32:52.613528 [info ] [Thread-1 (]: 3 of 18 PASS not_null_dim_customer_customer_state .............................. [[32mPASS[0m in 1.55s]
[0m12:32:52.616328 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82
[0m12:32:52.617959 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m12:32:52.619742 [info ] [Thread-1 (]: 4 of 18 START test not_null_dim_customer_customer_unique_id .................... [RUN]
[0m12:32:52.621100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_state.4dc0500c82, now test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4)
[0m12:32:52.621951 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m12:32:52.629224 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"
[0m12:32:52.630525 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m12:32:52.635187 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"
[0m12:32:52.635831 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_unique_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_unique_id is null



      
    ) dbt_internal_test
[0m12:32:52.636357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:53.234089 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:9ef2a91d-faae-444e-840e-d862d65075ff&page=queryresults
[0m12:32:54.203354 [info ] [Thread-1 (]: 4 of 18 PASS not_null_dim_customer_customer_unique_id .......................... [[32mPASS[0m in 1.58s]
[0m12:32:54.204715 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4
[0m12:32:54.205486 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m12:32:54.206221 [info ] [Thread-1 (]: 5 of 18 START test not_null_dim_customer_customer_zip_code_prefix .............. [RUN]
[0m12:32:54.207630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_unique_id.0020205ea4, now test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65)
[0m12:32:54.208470 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m12:32:54.216631 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"
[0m12:32:54.217725 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m12:32:54.222517 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"
[0m12:32:54.223249 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_zip_code_prefix
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
where customer_zip_code_prefix is null



      
    ) dbt_internal_test
[0m12:32:54.223708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:54.913362 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:55bfc91e-da1d-4fa2-b437-ae9a5e19a8df&page=queryresults
[0m12:32:55.841939 [info ] [Thread-1 (]: 5 of 18 PASS not_null_dim_customer_customer_zip_code_prefix .................... [[32mPASS[0m in 1.63s]
[0m12:32:55.843734 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65
[0m12:32:55.844763 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:32:55.846072 [info ] [Thread-1 (]: 6 of 18 START test not_null_dim_geolocation_geolocation_city ................... [RUN]
[0m12:32:55.847271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_customer_customer_zip_code_prefix.09a71b4a65, now test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207)
[0m12:32:55.848043 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:32:55.852432 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207"
[0m12:32:55.853100 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:32:55.855834 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207"
[0m12:32:55.856661 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geolocation_city
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
where geolocation_city is null



      
    ) dbt_internal_test
[0m12:32:55.857192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:56.898590 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:6c2350ab-cebd-4076-9116-f1f3c5a11936&page=queryresults
[0m12:32:57.879534 [info ] [Thread-1 (]: 6 of 18 PASS not_null_dim_geolocation_geolocation_city ......................... [[32mPASS[0m in 2.03s]
[0m12:32:57.881293 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:32:57.882620 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:32:57.884391 [info ] [Thread-1 (]: 7 of 18 START test not_null_dim_geolocation_geolocation_state .................. [RUN]
[0m12:32:57.885855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207, now test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954)
[0m12:32:57.887130 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:32:57.896220 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954"
[0m12:32:57.897220 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:32:57.900140 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954"
[0m12:32:57.901334 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geolocation_state
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
where geolocation_state is null



      
    ) dbt_internal_test
[0m12:32:57.902513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:58.668570 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:2e4d69e0-0367-4664-ae9d-9b372e92eb7c&page=queryresults
[0m12:32:59.581492 [info ] [Thread-1 (]: 7 of 18 PASS not_null_dim_geolocation_geolocation_state ........................ [[32mPASS[0m in 1.70s]
[0m12:32:59.582848 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:32:59.583597 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:32:59.584280 [info ] [Thread-1 (]: 8 of 18 START test not_null_dim_geolocation_geolocation_zip_code_prefix ........ [RUN]
[0m12:32:59.585162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954, now test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c)
[0m12:32:59.585843 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:32:59.594882 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c"
[0m12:32:59.596100 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:32:59.600929 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c"
[0m12:32:59.601631 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geolocation_zip_code_prefix
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
where geolocation_zip_code_prefix is null



      
    ) dbt_internal_test
[0m12:32:59.602102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:00.219285 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:24e06416-1465-40e0-9bfc-2cfce4af1bae&page=queryresults
[0m12:33:01.227011 [info ] [Thread-1 (]: 8 of 18 PASS not_null_dim_geolocation_geolocation_zip_code_prefix .............. [[32mPASS[0m in 1.64s]
[0m12:33:01.229314 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:33:01.230458 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492
[0m12:33:01.231668 [info ] [Thread-1 (]: 9 of 18 START test not_null_dim_product_product_category_name .................. [RUN]
[0m12:33:01.232569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c, now test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492)
[0m12:33:01.233354 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492
[0m12:33:01.245136 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492"
[0m12:33:01.247341 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492
[0m12:33:01.254582 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492"
[0m12:33:01.256813 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_category_name
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
where product_category_name is null



      
    ) dbt_internal_test
[0m12:33:01.257861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:01.801837 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:0bfd55b3-2226-4092-8521-fd6b9c9532d4&page=queryresults
[0m12:33:02.723282 [info ] [Thread-1 (]: 9 of 18 PASS not_null_dim_product_product_category_name ........................ [[32mPASS[0m in 1.49s]
[0m12:33:02.724657 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492
[0m12:33:02.725483 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_product_product_id.02b1f06816
[0m12:33:02.726272 [info ] [Thread-1 (]: 10 of 18 START test not_null_dim_product_product_id ............................ [RUN]
[0m12:33:02.727403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_product_product_category_name.e964a6b492, now test.olist_dataset.not_null_dim_product_product_id.02b1f06816)
[0m12:33:02.728207 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_product_product_id.02b1f06816
[0m12:33:02.738050 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_product_product_id.02b1f06816"
[0m12:33:02.739264 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_product_product_id.02b1f06816
[0m12:33:02.743264 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_product_product_id.02b1f06816"
[0m12:33:02.744069 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_product_product_id.02b1f06816"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
where product_id is null



      
    ) dbt_internal_test
[0m12:33:02.744633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:03.283046 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:b39117ea-6910-48b2-aabd-6daced5f827f&page=queryresults
[0m12:33:04.224367 [info ] [Thread-1 (]: 10 of 18 PASS not_null_dim_product_product_id .................................. [[32mPASS[0m in 1.50s]
[0m12:33:04.225466 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_product_product_id.02b1f06816
[0m12:33:04.226291 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m12:33:04.227010 [info ] [Thread-1 (]: 11 of 18 START test not_null_dim_seller_seller_city ............................ [RUN]
[0m12:33:04.228242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_product_product_id.02b1f06816, now test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d)
[0m12:33:04.228654 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m12:33:04.233277 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d"
[0m12:33:04.233994 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m12:33:04.236208 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d"
[0m12:33:04.236767 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_city
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_city is null



      
    ) dbt_internal_test
[0m12:33:04.237148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:04.809477 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:b5a73d24-1b19-439c-aef9-e5b7be3aad4c&page=queryresults
[0m12:33:05.822323 [info ] [Thread-1 (]: 11 of 18 PASS not_null_dim_seller_seller_city .................................. [[32mPASS[0m in 1.59s]
[0m12:33:05.823804 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d
[0m12:33:05.824666 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m12:33:05.825833 [info ] [Thread-1 (]: 12 of 18 START test not_null_dim_seller_seller_id .............................. [RUN]
[0m12:33:05.826992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_city.9affaaf52d, now test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2)
[0m12:33:05.827869 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m12:33:05.835239 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2"
[0m12:33:05.836008 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m12:33:05.838270 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2"
[0m12:33:05.838765 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_id
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_id is null



      
    ) dbt_internal_test
[0m12:33:05.839094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:06.507451 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:b9fd331c-90bd-4d64-b61f-92676abf8247&page=queryresults
[0m12:33:07.413742 [info ] [Thread-1 (]: 12 of 18 PASS not_null_dim_seller_seller_id .................................... [[32mPASS[0m in 1.59s]
[0m12:33:07.415463 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2
[0m12:33:07.416448 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m12:33:07.417300 [info ] [Thread-1 (]: 13 of 18 START test not_null_dim_seller_seller_state ........................... [RUN]
[0m12:33:07.418421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_id.3da5c751a2, now test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb)
[0m12:33:07.419072 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m12:33:07.424002 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb"
[0m12:33:07.424816 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m12:33:07.426885 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb"
[0m12:33:07.427387 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_state
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_state is null



      
    ) dbt_internal_test
[0m12:33:07.427766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:08.088081 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:32fcee45-4bfa-4c7e-94be-4bdbb67424eb&page=queryresults
[0m12:33:09.082873 [info ] [Thread-1 (]: 13 of 18 PASS not_null_dim_seller_seller_state ................................. [[32mPASS[0m in 1.66s]
[0m12:33:09.083765 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb
[0m12:33:09.084242 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m12:33:09.084728 [info ] [Thread-1 (]: 14 of 18 START test not_null_dim_seller_seller_zip_code_prefix ................. [RUN]
[0m12:33:09.086026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_state.6a5663c3bb, now test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472)
[0m12:33:09.087325 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m12:33:09.100788 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472"
[0m12:33:09.102934 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m12:33:09.107639 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472"
[0m12:33:09.108723 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_zip_code_prefix
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
where seller_zip_code_prefix is null



      
    ) dbt_internal_test
[0m12:33:09.109327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:09.733961 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:ef7f3cf4-0592-402e-b8e9-c15babc942f5&page=queryresults
[0m12:33:10.599892 [info ] [Thread-1 (]: 14 of 18 PASS not_null_dim_seller_seller_zip_code_prefix ....................... [[32mPASS[0m in 1.51s]
[0m12:33:10.600732 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472
[0m12:33:10.601155 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m12:33:10.602180 [info ] [Thread-1 (]: 15 of 18 START test unique_dim_customer_customer_id ............................ [RUN]
[0m12:33:10.602771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_seller_seller_zip_code_prefix.78e26fc472, now test.olist_dataset.unique_dim_customer_customer_id.b42affccd1)
[0m12:33:10.603130 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m12:33:10.609788 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"
[0m12:33:10.610588 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m12:33:10.612897 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"
[0m12:33:10.613430 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_customer_customer_id.b42affccd1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_customer_customer_id.b42affccd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:33:10.613790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:11.445227 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d4ff5ba4-d06b-481f-9801-1a3105b638ba&page=queryresults
[0m12:33:12.457481 [info ] [Thread-1 (]: 15 of 18 PASS unique_dim_customer_customer_id .................................. [[32mPASS[0m in 1.85s]
[0m12:33:12.459384 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_customer_customer_id.b42affccd1
[0m12:33:12.460389 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:33:12.461719 [info ] [Thread-1 (]: 16 of 18 START test unique_dim_geolocation_geolocation_zip_code_prefix ......... [RUN]
[0m12:33:12.462757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.unique_dim_customer_customer_id.b42affccd1, now test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0)
[0m12:33:12.463587 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:33:12.471773 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0"
[0m12:33:12.472743 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:33:12.475783 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0"
[0m12:33:12.476437 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select geolocation_zip_code_prefix as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
  where geolocation_zip_code_prefix is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:33:12.476849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:13.227210 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:36d401cd-d5fb-4ea0-bb39-2067fc085811&page=queryresults
[0m12:33:14.188564 [error] [Thread-1 (]: 16 of 18 FAIL 17972 unique_dim_geolocation_geolocation_zip_code_prefix ......... [[31mFAIL 17972[0m in 1.73s]
[0m12:33:14.190269 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:33:14.191350 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_product_product_id.46495bf7fe
[0m12:33:14.193083 [info ] [Thread-1 (]: 17 of 18 START test unique_dim_product_product_id .............................. [RUN]
[0m12:33:14.194638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0, now test.olist_dataset.unique_dim_product_product_id.46495bf7fe)
[0m12:33:14.195838 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_product_product_id.46495bf7fe
[0m12:33:14.207414 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_product_product_id.46495bf7fe"
[0m12:33:14.208818 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_product_product_id.46495bf7fe
[0m12:33:14.212862 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_product_product_id.46495bf7fe"
[0m12:33:14.213644 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_product_product_id.46495bf7fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:33:14.214132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:14.894760 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:7088c6ff-5db0-4a91-be22-c20d0b1876b6&page=queryresults
[0m12:33:16.111625 [info ] [Thread-1 (]: 17 of 18 PASS unique_dim_product_product_id .................................... [[32mPASS[0m in 1.92s]
[0m12:33:16.113175 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_product_product_id.46495bf7fe
[0m12:33:16.113982 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m12:33:16.114722 [info ] [Thread-1 (]: 18 of 18 START test unique_dim_seller_seller_id ................................ [RUN]
[0m12:33:16.116198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.unique_dim_product_product_id.46495bf7fe, now test.olist_dataset.unique_dim_seller_seller_id.a1add5f830)
[0m12:33:16.117506 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m12:33:16.129094 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_seller_seller_id.a1add5f830"
[0m12:33:16.130461 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m12:33:16.135459 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_seller_seller_id.a1add5f830"
[0m12:33:16.137557 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_seller_seller_id.a1add5f830: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_seller_seller_id.a1add5f830"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select seller_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
  where seller_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:33:16.139354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:16.828365 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d2961716-16b7-42d4-bac3-e4feb5b4e977&page=queryresults
[0m12:33:17.834910 [info ] [Thread-1 (]: 18 of 18 PASS unique_dim_seller_seller_id ...................................... [[32mPASS[0m in 1.72s]
[0m12:33:17.836391 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_seller_seller_id.a1add5f830
[0m12:33:17.851227 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:33:17.853002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:17.853669 [debug] [MainThread]: Connection 'test.olist_dataset.unique_dim_seller_seller_id.a1add5f830' was properly closed.
[0m12:33:17.854267 [info ] [MainThread]: 
[0m12:33:17.854862 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 32.11 seconds (32.11s).
[0m12:33:17.866530 [debug] [MainThread]: Command end result
[0m12:33:17.966650 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:33:17.985165 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:33:18.013428 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:33:18.014416 [info ] [MainThread]: 
[0m12:33:18.015409 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:33:18.016282 [info ] [MainThread]: 
[0m12:33:18.017290 [error] [MainThread]: [31mFailure in test unique_dim_geolocation_geolocation_zip_code_prefix (models/schema.yml)[0m
[0m12:33:18.017905 [error] [MainThread]:   Got 17972 results, configured to fail if != 0
[0m12:33:18.018331 [info ] [MainThread]: 
[0m12:33:18.018771 [info ] [MainThread]:   compiled code at target/compiled/olist_dataset/models/schema.yml/unique_dim_geolocation_geolocation_zip_code_prefix.sql
[0m12:33:18.019190 [info ] [MainThread]: 
[0m12:33:18.019606 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=1 SKIP=0 TOTAL=18
[0m12:33:18.020742 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 33.78059, "process_in_blocks": "0", "process_kernel_time": 1.14772, "process_mem_max_rss": "256888", "process_out_blocks": "2768", "process_user_time": 4.02709}
[0m12:33:18.021577 [debug] [MainThread]: Command `dbt test` failed at 12:33:18.021340 after 33.78 seconds
[0m12:33:18.022125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f146ffe9e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1440bfcfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f146fc919f0>]}
[0m12:33:18.023169 [debug] [MainThread]: Flushing usage events
[0m12:33:19.014787 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:37:26.919191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafe9ad1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafe89e94b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafe89e9450>]}


============================== 12:37:26.921616 | 775de194-f9bf-4fc3-8470-7bc8ae316a5d ==============================
[0m12:37:26.921616 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:37:26.922146 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_geolocation', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:37:27.944986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '775de194-f9bf-4fc3-8470-7bc8ae316a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafeab04f70>]}
[0m12:37:28.013560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '775de194-f9bf-4fc3-8470-7bc8ae316a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafe89ff3d0>]}
[0m12:37:28.014334 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:37:28.115754 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:37:28.326864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:37:28.327574 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_geolocation.sql
[0m12:37:28.805667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '775de194-f9bf-4fc3-8470-7bc8ae316a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafba2b5420>]}
[0m12:37:28.898581 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:37:28.900222 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:37:28.914423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '775de194-f9bf-4fc3-8470-7bc8ae316a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafba7f8af0>]}
[0m12:37:28.915005 [info ] [MainThread]: Found 6 models, 3 snapshots, 18 data tests, 9 sources, 491 macros
[0m12:37:28.915384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '775de194-f9bf-4fc3-8470-7bc8ae316a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafba7f8970>]}
[0m12:37:28.916792 [info ] [MainThread]: 
[0m12:37:28.917205 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:37:28.917536 [info ] [MainThread]: 
[0m12:37:28.918030 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:37:28.919329 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m12:37:28.919722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:29.939074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m12:37:29.940438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:30.610504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:37:30.612548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:30.977502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m12:37:30.980420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:31.340532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '775de194-f9bf-4fc3-8470-7bc8ae316a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafeab89d80>]}
[0m12:37:31.341835 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:37:31.349728 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m12:37:31.350990 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m12:37:31.352262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now model.olist_dataset.dim_geolocation)
[0m12:37:31.353078 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m12:37:31.371333 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m12:37:31.372706 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m12:37:31.402725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:31.837742 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m12:37:31.838579 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation` as DBT_INTERNAL_DEST
        using (-- models/star/dim_geolocation.sql

-- This is incremental approach (Type 1 SCD)


WITH source AS (
    SELECT
        geolocation_zip_code_prefix,
        ANY_VALUE(geolocation_city) AS geolocation_city,
        ANY_VALUE(geolocation_state) AS geolocation_state,
        MAX(CAST(last_updated AS TIMESTAMP)) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
    GROUP BY geolocation_zip_code_prefix
)

SELECT *
FROM source

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those geolocation_zip_code_prefix that already in dim_geolocation table
-- which assume data already in table never change

-- 
--   WHERE geolocation_zip_code_prefix NOT IN (
--       SELECT geolocation_zip_code_prefix FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
--   )
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.geolocation_zip_code_prefix = DBT_INTERNAL_DEST.geolocation_zip_code_prefix))

    
    when matched then update set
        `geolocation_zip_code_prefix` = DBT_INTERNAL_SOURCE.`geolocation_zip_code_prefix`,`geolocation_city` = DBT_INTERNAL_SOURCE.`geolocation_city`,`geolocation_state` = DBT_INTERNAL_SOURCE.`geolocation_state`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)
    values
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)


    
[0m12:37:32.419978 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:058b820b-5af6-4057-8f98-6b4fb117c982&page=queryresults
[0m12:37:40.219912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '775de194-f9bf-4fc3-8470-7bc8ae316a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafe89d3f40>]}
[0m12:37:40.220684 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[32mMERGE (1.0m rows, 62.1 MiB processed)[0m in 8.87s]
[0m12:37:40.221335 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m12:37:40.224360 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:37:40.225191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:40.225554 [debug] [MainThread]: Connection 'model.olist_dataset.dim_geolocation' was properly closed.
[0m12:37:40.225875 [info ] [MainThread]: 
[0m12:37:40.226250 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 11.31 seconds (11.31s).
[0m12:37:40.226861 [debug] [MainThread]: Command end result
[0m12:37:40.249993 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:37:40.251790 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:37:40.257347 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:37:40.257773 [info ] [MainThread]: 
[0m12:37:40.258167 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:37:40.258469 [info ] [MainThread]: 
[0m12:37:40.258744 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:37:40.259265 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.398923, "process_in_blocks": "0", "process_kernel_time": 1.252783, "process_mem_max_rss": "260568", "process_out_blocks": "3496", "process_user_time": 3.657321}
[0m12:37:40.259668 [debug] [MainThread]: Command `dbt run` succeeded at 12:37:40.259578 after 13.40 seconds
[0m12:37:40.260008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafe9ad1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafeab04f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafba24f550>]}
[0m12:37:40.260358 [debug] [MainThread]: Flushing usage events
[0m12:37:41.231271 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:37:42.784079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ef011ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0edf59720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0edf596c0>]}


============================== 12:37:42.786384 | 77c2f4e8-df2b-407c-8a10-5faa5dfbf67e ==============================
[0m12:37:42.786384 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:37:42.786867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --models dim_geolocation', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:37:43.760074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77c2f4e8-df2b-407c-8a10-5faa5dfbf67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f029b760>]}
[0m12:37:43.827332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77c2f4e8-df2b-407c-8a10-5faa5dfbf67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0c4087f40>]}
[0m12:37:43.828079 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:37:43.927391 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:37:44.121601 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:37:44.122080 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:37:44.178447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77c2f4e8-df2b-407c-8a10-5faa5dfbf67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0bfbe59c0>]}
[0m12:37:44.275012 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:37:44.276621 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:37:44.299466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77c2f4e8-df2b-407c-8a10-5faa5dfbf67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0bfcdcf70>]}
[0m12:37:44.300127 [info ] [MainThread]: Found 6 models, 3 snapshots, 18 data tests, 9 sources, 491 macros
[0m12:37:44.300507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77c2f4e8-df2b-407c-8a10-5faa5dfbf67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0c44d6e30>]}
[0m12:37:44.302153 [info ] [MainThread]: 
[0m12:37:44.302598 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:37:44.302903 [info ] [MainThread]: 
[0m12:37:44.303396 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:37:44.308285 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_snapshots'
[0m12:37:44.309350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:45.273329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m12:37:45.275587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:45.652874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:37:45.654752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:46.033724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77c2f4e8-df2b-407c-8a10-5faa5dfbf67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f00bb820>]}
[0m12:37:46.034905 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:37:46.041644 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:37:46.042561 [info ] [Thread-1 (]: 1 of 4 START test not_null_dim_geolocation_geolocation_city .................... [RUN]
[0m12:37:46.043534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207)
[0m12:37:46.044449 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:37:46.068266 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207"
[0m12:37:46.068930 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:37:46.084005 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207"
[0m12:37:46.084716 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geolocation_city
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
where geolocation_city is null



      
    ) dbt_internal_test
[0m12:37:46.085144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:46.713523 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:cd06451f-aeff-4f3e-9eb5-e2efec4b05ea&page=queryresults
[0m12:37:47.724910 [info ] [Thread-1 (]: 1 of 4 PASS not_null_dim_geolocation_geolocation_city .......................... [[32mPASS[0m in 1.68s]
[0m12:37:47.726255 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:37:47.727034 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:37:47.727733 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_geolocation_geolocation_state ................... [RUN]
[0m12:37:47.728667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207, now test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954)
[0m12:37:47.729384 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:37:47.738438 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954"
[0m12:37:47.739536 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:37:47.744539 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954"
[0m12:37:47.745531 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geolocation_state
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
where geolocation_state is null



      
    ) dbt_internal_test
[0m12:37:47.746188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:48.308018 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:7e28c600-0956-4750-8b72-4de4d8609036&page=queryresults
[0m12:37:49.228037 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_geolocation_geolocation_state ......................... [[32mPASS[0m in 1.50s]
[0m12:37:49.229806 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:37:49.230712 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:37:49.231633 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_geolocation_geolocation_zip_code_prefix ......... [RUN]
[0m12:37:49.233112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954, now test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c)
[0m12:37:49.234034 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:37:49.242601 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c"
[0m12:37:49.243555 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:37:49.246719 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c"
[0m12:37:49.247499 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geolocation_zip_code_prefix
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
where geolocation_zip_code_prefix is null



      
    ) dbt_internal_test
[0m12:37:49.248053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:50.209517 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:3af5aea0-d814-4605-afd1-18fcf62e2e39&page=queryresults
[0m12:37:51.217996 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_geolocation_geolocation_zip_code_prefix ............... [[32mPASS[0m in 1.98s]
[0m12:37:51.219115 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:37:51.220092 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:37:51.221927 [info ] [Thread-1 (]: 4 of 4 START test unique_dim_geolocation_geolocation_zip_code_prefix ........... [RUN]
[0m12:37:51.222956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c, now test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0)
[0m12:37:51.223912 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:37:51.231626 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0"
[0m12:37:51.232395 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:37:51.234731 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0"
[0m12:37:51.235351 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select geolocation_zip_code_prefix as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
  where geolocation_zip_code_prefix is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:37:51.235752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:51.960812 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:421ddc05-989a-45d8-88d7-149768da5bf7&page=queryresults
[0m12:37:52.889549 [error] [Thread-1 (]: 4 of 4 FAIL 17972 unique_dim_geolocation_geolocation_zip_code_prefix ........... [[31mFAIL 17972[0m in 1.67s]
[0m12:37:52.890969 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:37:52.894186 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:37:52.895803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:52.896505 [debug] [MainThread]: Connection 'test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0' was properly closed.
[0m12:37:52.897202 [info ] [MainThread]: 
[0m12:37:52.897868 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 8.59 seconds (8.59s).
[0m12:37:52.899728 [debug] [MainThread]: Command end result
[0m12:37:52.930111 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:37:52.931733 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:37:52.938233 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:37:52.938618 [info ] [MainThread]: 
[0m12:37:52.938986 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:37:52.939284 [info ] [MainThread]: 
[0m12:37:52.939625 [error] [MainThread]: [31mFailure in test unique_dim_geolocation_geolocation_zip_code_prefix (models/schema.yml)[0m
[0m12:37:52.939941 [error] [MainThread]:   Got 17972 results, configured to fail if != 0
[0m12:37:52.940188 [info ] [MainThread]: 
[0m12:37:52.940502 [info ] [MainThread]:   compiled code at target/compiled/olist_dataset/models/schema.yml/unique_dim_geolocation_geolocation_zip_code_prefix.sql
[0m12:37:52.940763 [info ] [MainThread]: 
[0m12:37:52.941055 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:37:52.941594 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 10.214634, "process_in_blocks": "0", "process_kernel_time": 1.233005, "process_mem_max_rss": "254072", "process_out_blocks": "2440", "process_user_time": 3.244219}
[0m12:37:52.941983 [debug] [MainThread]: Command `dbt test` failed at 12:37:52.941893 after 10.22 seconds
[0m12:37:52.942380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ef011ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0bfa3c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ef083df0>]}
[0m12:37:52.942736 [debug] [MainThread]: Flushing usage events
[0m12:37:53.918805 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:38:31.915733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa027ebde10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa026ded4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa026ded450>]}


============================== 12:38:31.918360 | cb8aebe0-0a26-46cd-b589-6b9cdbc1ac77 ==============================
[0m12:38:31.918360 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:38:31.918903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'profiles_dir': '/home/kangh/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_geolocation', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:38:32.900162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb8aebe0-0a26-46cd-b589-6b9cdbc1ac77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0274900d0>]}
[0m12:38:32.968540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb8aebe0-0a26-46cd-b589-6b9cdbc1ac77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ff8f0e6b0>]}
[0m12:38:32.969340 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:38:33.068434 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:38:33.261569 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:38:33.262011 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:38:33.316952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb8aebe0-0a26-46cd-b589-6b9cdbc1ac77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ff8ab5720>]}
[0m12:38:33.411838 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:38:33.413430 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:38:33.424406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb8aebe0-0a26-46cd-b589-6b9cdbc1ac77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ff8ab78e0>]}
[0m12:38:33.424962 [info ] [MainThread]: Found 6 models, 3 snapshots, 18 data tests, 9 sources, 491 macros
[0m12:38:33.425342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb8aebe0-0a26-46cd-b589-6b9cdbc1ac77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ff8ab7a00>]}
[0m12:38:33.426698 [info ] [MainThread]: 
[0m12:38:33.427084 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:38:33.427367 [info ] [MainThread]: 
[0m12:38:33.427836 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:38:33.429135 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m12:38:33.429855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:34.566622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m12:38:34.568372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:34.964285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m12:38:34.965328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:35.343488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:38:35.346253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:35.698609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb8aebe0-0a26-46cd-b589-6b9cdbc1ac77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa028f75d80>]}
[0m12:38:35.700228 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:35.705348 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m12:38:35.706445 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m12:38:35.707541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now model.olist_dataset.dim_geolocation)
[0m12:38:35.708272 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m12:38:35.738640 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m12:38:35.740033 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m12:38:35.828797 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m12:38:35.829882 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_geolocation.sql

-- This is incremental approach (Type 1 SCD)


WITH source AS (
    SELECT
        geolocation_zip_code_prefix,
        ANY_VALUE(geolocation_city) AS geolocation_city,
        ANY_VALUE(geolocation_state) AS geolocation_state,
        MAX(CAST(last_updated AS TIMESTAMP)) AS last_updated
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
    GROUP BY geolocation_zip_code_prefix
)

SELECT *
FROM source

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those geolocation_zip_code_prefix that already in dim_geolocation table
-- which assume data already in table never change

-- 
    );
  
[0m12:38:35.830505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:38:36.372817 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:7c799275-f5bf-4979-aee4-9340767ecd96&page=queryresults
[0m12:38:38.967079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb8aebe0-0a26-46cd-b589-6b9cdbc1ac77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa026dd7f40>]}
[0m12:38:38.967899 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[32mCREATE TABLE (19.0k rows, 31.0 MiB processed)[0m in 3.26s]
[0m12:38:38.968498 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m12:38:38.971662 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:38:38.972585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:38.972968 [debug] [MainThread]: Connection 'model.olist_dataset.dim_geolocation' was properly closed.
[0m12:38:38.973345 [info ] [MainThread]: 
[0m12:38:38.973706 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.55 seconds (5.55s).
[0m12:38:38.974538 [debug] [MainThread]: Command end result
[0m12:38:39.000590 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:38:39.002381 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:38:39.008017 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:38:39.008404 [info ] [MainThread]: 
[0m12:38:39.008805 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:38:39.009082 [info ] [MainThread]: 
[0m12:38:39.009371 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:38:39.009957 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.1536937, "process_in_blocks": "0", "process_kernel_time": 1.104, "process_mem_max_rss": "253060", "process_out_blocks": "2384", "process_user_time": 3.381}
[0m12:38:39.010329 [debug] [MainThread]: Command `dbt run` succeeded at 12:38:39.010245 after 7.15 seconds
[0m12:38:39.010670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa027ebde10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0274900d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ff8a93af0>]}
[0m12:38:39.011015 [debug] [MainThread]: Flushing usage events
[0m12:38:39.959592 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:38:41.473799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8acb74dde0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aca761600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aca7615a0>]}


============================== 12:38:41.476660 | fb66fa9a-af45-4603-9a31-f7de43ad5ff4 ==============================
[0m12:38:41.476660 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:38:41.477181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/kangh/.dbt', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --models dim_geolocation', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:38:42.419370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb66fa9a-af45-4603-9a31-f7de43ad5ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8acc883070>]}
[0m12:38:42.487111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb66fa9a-af45-4603-9a31-f7de43ad5ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aca777520>]}
[0m12:38:42.488226 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:38:42.591649 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:38:42.791717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:38:42.792194 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:38:42.848610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb66fa9a-af45-4603-9a31-f7de43ad5ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9c43d930>]}
[0m12:38:42.944028 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:38:42.945698 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:38:42.968455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb66fa9a-af45-4603-9a31-f7de43ad5ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9c3e1e10>]}
[0m12:38:42.969033 [info ] [MainThread]: Found 6 models, 3 snapshots, 18 data tests, 9 sources, 491 macros
[0m12:38:42.969418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb66fa9a-af45-4603-9a31-f7de43ad5ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9cf72da0>]}
[0m12:38:42.970814 [info ] [MainThread]: 
[0m12:38:42.971191 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:38:42.971506 [info ] [MainThread]: 
[0m12:38:42.971987 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:38:42.976890 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_ingestion_fact_tables'
[0m12:38:42.977823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:43.943674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:38:43.946725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:44.272653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m12:38:44.273519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:44.645060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb66fa9a-af45-4603-9a31-f7de43ad5ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aca775a80>]}
[0m12:38:44.646090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:44.651285 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:38:44.652213 [info ] [Thread-1 (]: 1 of 4 START test not_null_dim_geolocation_geolocation_city .................... [RUN]
[0m12:38:44.653103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207)
[0m12:38:44.653732 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:38:44.675742 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207"
[0m12:38:44.676427 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:38:44.690938 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207"
[0m12:38:44.691656 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geolocation_city
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
where geolocation_city is null



      
    ) dbt_internal_test
[0m12:38:44.692143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:38:45.427610 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:cbcd0c34-d7c6-4376-b1f9-6a269ef339bd&page=queryresults
[0m12:38:46.430837 [info ] [Thread-1 (]: 1 of 4 PASS not_null_dim_geolocation_geolocation_city .......................... [[32mPASS[0m in 1.78s]
[0m12:38:46.431640 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:38:46.432067 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:38:46.432418 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_geolocation_geolocation_state ................... [RUN]
[0m12:38:46.433244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207, now test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954)
[0m12:38:46.433670 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:38:46.437785 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954"
[0m12:38:46.438374 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:38:46.440986 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954"
[0m12:38:46.441577 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geolocation_state
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
where geolocation_state is null



      
    ) dbt_internal_test
[0m12:38:46.441961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:38:47.012495 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:8594accb-ac97-414b-8844-79505161f442&page=queryresults
[0m12:38:47.982278 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_geolocation_geolocation_state ......................... [[32mPASS[0m in 1.55s]
[0m12:38:47.983653 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:38:47.984395 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:38:47.985081 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_geolocation_geolocation_zip_code_prefix ......... [RUN]
[0m12:38:47.986233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954, now test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c)
[0m12:38:47.986942 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:38:47.995713 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c"
[0m12:38:47.997031 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:38:48.000579 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c"
[0m12:38:48.001340 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geolocation_zip_code_prefix
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
where geolocation_zip_code_prefix is null



      
    ) dbt_internal_test
[0m12:38:48.002008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:38:48.543596 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:de66820f-bb39-47db-bb00-0ffb23150ca3&page=queryresults
[0m12:38:49.515364 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_geolocation_geolocation_zip_code_prefix ............... [[32mPASS[0m in 1.53s]
[0m12:38:49.516732 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:38:49.517522 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:38:49.518835 [info ] [Thread-1 (]: 4 of 4 START test unique_dim_geolocation_geolocation_zip_code_prefix ........... [RUN]
[0m12:38:49.520058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c, now test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0)
[0m12:38:49.520971 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:38:49.534568 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0"
[0m12:38:49.535676 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:38:49.538856 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0"
[0m12:38:49.539603 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select geolocation_zip_code_prefix as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
  where geolocation_zip_code_prefix is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:38:49.540052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:38:50.104889 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:977a606b-58e1-4859-a01f-bdd7ef43646e&page=queryresults
[0m12:38:51.067708 [info ] [Thread-1 (]: 4 of 4 PASS unique_dim_geolocation_geolocation_zip_code_prefix ................. [[32mPASS[0m in 1.55s]
[0m12:38:51.069310 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:38:51.075221 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:38:51.077195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:51.078190 [debug] [MainThread]: Connection 'test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0' was properly closed.
[0m12:38:51.079304 [info ] [MainThread]: 
[0m12:38:51.080600 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 8.11 seconds (8.11s).
[0m12:38:51.084630 [debug] [MainThread]: Command end result
[0m12:38:51.142863 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:38:51.147855 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:38:51.164879 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:38:51.165456 [info ] [MainThread]: 
[0m12:38:51.166070 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:38:51.166653 [info ] [MainThread]: 
[0m12:38:51.167230 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:38:51.168115 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 9.751039, "process_in_blocks": "0", "process_kernel_time": 1.061928, "process_mem_max_rss": "255396", "process_out_blocks": "2440", "process_user_time": 3.41405}
[0m12:38:51.168703 [debug] [MainThread]: Command `dbt test` succeeded at 12:38:51.168567 after 9.75 seconds
[0m12:38:51.169199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8acb74dde0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8acc883070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9c414dc0>]}
[0m12:38:51.169617 [debug] [MainThread]: Flushing usage events
[0m12:38:52.141362 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:02.751955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811185de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81107794b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8110779450>]}


============================== 12:43:02.759147 | 9b236fbe-7581-416f-a53b-e805be7f86fc ==============================
[0m12:43:02.759147 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:43:02.759668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'debug': 'False', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_geolocation', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:43:04.693532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b236fbe-7581-416f-a53b-e805be7f86fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e2903520>]}
[0m12:43:04.764542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b236fbe-7581-416f-a53b-e805be7f86fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811078b3d0>]}
[0m12:43:04.765379 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:43:04.880914 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:43:05.172609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:43:05.173952 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/schema.yml
[0m12:43:05.174592 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_geolocation.sql
[0m12:43:05.650437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b236fbe-7581-416f-a53b-e805be7f86fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e20250c0>]}
[0m12:43:05.742310 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:43:05.745842 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:43:05.774848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b236fbe-7581-416f-a53b-e805be7f86fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e2024250>]}
[0m12:43:05.775456 [info ] [MainThread]: Found 6 models, 3 snapshots, 17 data tests, 9 sources, 491 macros
[0m12:43:05.775878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b236fbe-7581-416f-a53b-e805be7f86fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e20242e0>]}
[0m12:43:05.777322 [info ] [MainThread]: 
[0m12:43:05.777744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:43:05.778069 [info ] [MainThread]: 
[0m12:43:05.778606 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:43:05.780020 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m12:43:05.780809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:07.279025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m12:43:07.280232 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:07.608032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:43:07.609135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:07.986889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m12:43:07.989151 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:08.366413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b236fbe-7581-416f-a53b-e805be7f86fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8112915d80>]}
[0m12:43:08.367528 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:08.374204 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m12:43:08.375314 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m12:43:08.376282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now model.olist_dataset.dim_geolocation)
[0m12:43:08.376923 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m12:43:08.389777 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m12:43:08.393295 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m12:43:08.422976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:08.781195 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m12:43:08.782101 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation` as DBT_INTERNAL_DEST
        using (-- models/star/dim_geolocation.sql

-- This is incremental approach (Type 1 SCD)


WITH source AS (
  SELECT
    geolocation_zip_code_prefix,
    geolocation_lat,
    geolocation_lng,
    geolocation_city,
    geolocation_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
  FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those geolocation_zip_code_prefix that already in dim_geolocation table
-- which assume data already in table never change

-- 
--   WHERE geolocation_zip_code_prefix NOT IN (
--       SELECT geolocation_zip_code_prefix FROM `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
--   )
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.geolocation_zip_code_prefix = DBT_INTERNAL_DEST.geolocation_zip_code_prefix))

    
    when matched then update set
        `geolocation_zip_code_prefix` = DBT_INTERNAL_SOURCE.`geolocation_zip_code_prefix`,`geolocation_city` = DBT_INTERNAL_SOURCE.`geolocation_city`,`geolocation_state` = DBT_INTERNAL_SOURCE.`geolocation_state`,`last_updated` = DBT_INTERNAL_SOURCE.`last_updated`
    

    when not matched then insert
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)
    values
        (`geolocation_zip_code_prefix`, `geolocation_city`, `geolocation_state`, `last_updated`)


    
[0m12:43:09.332076 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d2dae9aa-3146-42b3-b792-1c4208877f15&page=queryresults
[0m12:43:09.911264 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d2dae9aa-3146-42b3-b792-1c4208877f15&page=queryresults
[0m12:43:09.943395 [debug] [Thread-1 (]: Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  UPDATE/MERGE must match at most one source row for each target row
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql
[0m12:43:09.949510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b236fbe-7581-416f-a53b-e805be7f86fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8111894f10>]}
[0m12:43:09.951511 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[31mERROR[0m in 1.57s]
[0m12:43:09.953243 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m12:43:09.955158 [debug] [Thread-4 (]: Marking all children of 'model.olist_dataset.dim_geolocation' to be skipped because of status 'error'.  Reason: Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  UPDATE/MERGE must match at most one source row for each target row
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql.
[0m12:43:09.960372 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:09.961887 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:09.962726 [debug] [MainThread]: Connection 'model.olist_dataset.dim_geolocation' was properly closed.
[0m12:43:09.963484 [info ] [MainThread]: 
[0m12:43:09.964599 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.19 seconds (4.19s).
[0m12:43:09.966233 [debug] [MainThread]: Command end result
[0m12:43:10.007529 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:43:10.009923 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:43:10.016763 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:43:10.017315 [info ] [MainThread]: 
[0m12:43:10.017886 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:43:10.018422 [info ] [MainThread]: 
[0m12:43:10.018989 [error] [MainThread]:   Database Error in model dim_geolocation (models/star/dim_geolocation.sql)
  UPDATE/MERGE must match at most one source row for each target row
  compiled code at target/run/olist_dataset/models/star/dim_geolocation.sql
[0m12:43:10.019493 [info ] [MainThread]: 
[0m12:43:10.019923 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:43:10.020681 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.330786, "process_in_blocks": "122616", "process_kernel_time": 1.340542, "process_mem_max_rss": "261720", "process_out_blocks": "3480", "process_user_time": 4.228622}
[0m12:43:10.021157 [debug] [MainThread]: Command `dbt run` failed at 12:43:10.021041 after 7.33 seconds
[0m12:43:10.021615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811185de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8111bff8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811167fb50>]}
[0m12:43:10.022060 [debug] [MainThread]: Flushing usage events
[0m12:43:11.012042 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:40.831540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a618de40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a50c1540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a50c14e0>]}


============================== 12:43:40.833866 | 5b3cf353-db6a-42fb-b06f-b1324417c5fc ==============================
[0m12:43:40.833866 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:43:40.834326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'version_check': 'True', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_geolocation', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:43:41.826010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b3cf353-db6a-42fb-b06f-b1324417c5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a5e38d90>]}
[0m12:43:41.892653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b3cf353-db6a-42fb-b06f-b1324417c5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a50d3400>]}
[0m12:43:41.893504 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:43:41.994462 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:43:42.186080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:42.186481 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:42.240183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b3cf353-db6a-42fb-b06f-b1324417c5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8576d99510>]}
[0m12:43:42.332001 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:43:42.334303 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:43:42.344980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b3cf353-db6a-42fb-b06f-b1324417c5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8576d9b4c0>]}
[0m12:43:42.345512 [info ] [MainThread]: Found 6 models, 3 snapshots, 17 data tests, 9 sources, 491 macros
[0m12:43:42.345885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b3cf353-db6a-42fb-b06f-b1324417c5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8576d9b490>]}
[0m12:43:42.347221 [info ] [MainThread]: 
[0m12:43:42.347595 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:43:42.347873 [info ] [MainThread]: 
[0m12:43:42.348328 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:43:42.349577 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m12:43:42.350370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:43.337970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m12:43:43.338831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:43.685799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m12:43:43.687841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:44.035579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:43:44.036410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:44.434314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b3cf353-db6a-42fb-b06f-b1324417c5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a7249e70>]}
[0m12:43:44.435429 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:44.440551 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m12:43:44.441726 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m12:43:44.442686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now model.olist_dataset.dim_geolocation)
[0m12:43:44.443373 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m12:43:44.462302 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m12:43:44.463021 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m12:43:44.516230 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m12:43:44.517057 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_geolocation.sql

-- This is incremental approach (Type 1 SCD)


WITH source AS (
  SELECT
    geolocation_zip_code_prefix,
    geolocation_lat,
    geolocation_lng,
    geolocation_city,
    geolocation_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated
  FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those geolocation_zip_code_prefix that already in dim_geolocation table
-- which assume data already in table never change

-- 
    );
  
[0m12:43:44.517507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:45.073430 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:42d7d49f-11f4-4828-8e52-6005ca9cfa3a&page=queryresults
[0m12:43:49.191019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b3cf353-db6a-42fb-b06f-b1324417c5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a50aae00>]}
[0m12:43:49.191758 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[32mCREATE TABLE (1.0m rows, 46.3 MiB processed)[0m in 4.75s]
[0m12:43:49.192347 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m12:43:49.194841 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:49.195849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:49.196229 [debug] [MainThread]: Connection 'model.olist_dataset.dim_geolocation' was properly closed.
[0m12:43:49.196558 [info ] [MainThread]: 
[0m12:43:49.196886 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.85 seconds (6.85s).
[0m12:43:49.197535 [debug] [MainThread]: Command end result
[0m12:43:49.221479 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:43:49.223085 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:43:49.228637 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:43:49.229033 [info ] [MainThread]: 
[0m12:43:49.229402 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:49.229746 [info ] [MainThread]: 
[0m12:43:49.230053 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:43:49.230571 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.458118, "process_in_blocks": "1656", "process_kernel_time": 1.168885, "process_mem_max_rss": "254176", "process_out_blocks": "2368", "process_user_time": 3.25255}
[0m12:43:49.230951 [debug] [MainThread]: Command `dbt run` succeeded at 12:43:49.230864 after 8.46 seconds
[0m12:43:49.231276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a618de40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8576d74220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a5e38d90>]}
[0m12:43:49.231692 [debug] [MainThread]: Flushing usage events
[0m12:43:50.183248 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:51.714560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa96106dea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa95ffb5720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa95ffb56c0>]}


============================== 12:43:51.716972 | 6e4ea282-5ff1-4aa9-ab00-4a08993bdd17 ==============================
[0m12:43:51.716972 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:43:51.717478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'profiles_dir': '/home/kangh/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --models dim_geolocation', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:43:52.662310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e4ea282-5ff1-4aa9-ab00-4a08993bdd17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9622f7760>]}
[0m12:43:52.729538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e4ea282-5ff1-4aa9-ab00-4a08993bdd17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9322bbf40>]}
[0m12:43:52.730275 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:43:52.833287 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:43:53.040671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:53.041153 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:53.096097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e4ea282-5ff1-4aa9-ab00-4a08993bdd17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa931c99720>]}
[0m12:43:53.190244 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:43:53.191888 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:43:53.218342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e4ea282-5ff1-4aa9-ab00-4a08993bdd17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa931c38af0>]}
[0m12:43:53.218913 [info ] [MainThread]: Found 6 models, 3 snapshots, 17 data tests, 9 sources, 491 macros
[0m12:43:53.219298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e4ea282-5ff1-4aa9-ab00-4a08993bdd17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9324eee30>]}
[0m12:43:53.220722 [info ] [MainThread]: 
[0m12:43:53.221114 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:43:53.221426 [info ] [MainThread]: 
[0m12:43:53.221909 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:43:53.226644 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_ingestion_fact_tables'
[0m12:43:53.227722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:54.781669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m12:43:54.783730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:55.141568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:43:55.142165 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:55.499727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e4ea282-5ff1-4aa9-ab00-4a08993bdd17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa931e721a0>]}
[0m12:43:55.500791 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:55.506424 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:43:55.507250 [info ] [Thread-1 (]: 1 of 3 START test not_null_dim_geolocation_geolocation_city .................... [RUN]
[0m12:43:55.508156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207)
[0m12:43:55.508784 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:43:55.532064 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207"
[0m12:43:55.535562 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:43:55.551857 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207"
[0m12:43:55.552623 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geolocation_city
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
where geolocation_city is null



      
    ) dbt_internal_test
[0m12:43:55.553072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:56.226413 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:0fc28178-8df8-40e0-a4a2-cd2c936c786e&page=queryresults
[0m12:43:57.179564 [info ] [Thread-1 (]: 1 of 3 PASS not_null_dim_geolocation_geolocation_city .......................... [[32mPASS[0m in 1.67s]
[0m12:43:57.181069 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:43:57.182108 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:43:57.183542 [info ] [Thread-1 (]: 2 of 3 START test not_null_dim_geolocation_geolocation_state ................... [RUN]
[0m12:43:57.184612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207, now test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954)
[0m12:43:57.185284 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:43:57.193788 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954"
[0m12:43:57.194942 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:43:57.199562 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954"
[0m12:43:57.200467 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geolocation_state
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
where geolocation_state is null



      
    ) dbt_internal_test
[0m12:43:57.201156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:57.826833 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:bb8a658e-e948-46ee-945f-b61fd821e6ab&page=queryresults
[0m12:43:58.757785 [info ] [Thread-1 (]: 2 of 3 PASS not_null_dim_geolocation_geolocation_state ......................... [[32mPASS[0m in 1.57s]
[0m12:43:58.759252 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:43:58.760111 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:43:58.761599 [info ] [Thread-1 (]: 3 of 3 START test not_null_dim_geolocation_geolocation_zip_code_prefix ......... [RUN]
[0m12:43:58.762688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954, now test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c)
[0m12:43:58.763509 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:43:58.773850 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c"
[0m12:43:58.775549 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:43:58.779746 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c"
[0m12:43:58.780521 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geolocation_zip_code_prefix
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
where geolocation_zip_code_prefix is null



      
    ) dbt_internal_test
[0m12:43:58.781126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:59.381987 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:4ddce468-024e-4dab-b432-6f7c604115aa&page=queryresults
[0m12:44:00.444381 [info ] [Thread-1 (]: 3 of 3 PASS not_null_dim_geolocation_geolocation_zip_code_prefix ............... [[32mPASS[0m in 1.68s]
[0m12:44:00.446238 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:44:00.450317 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:44:00.451461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:44:00.451845 [debug] [MainThread]: Connection 'test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c' was properly closed.
[0m12:44:00.452207 [info ] [MainThread]: 
[0m12:44:00.452612 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 7.23 seconds (7.23s).
[0m12:44:00.454063 [debug] [MainThread]: Command end result
[0m12:44:00.501689 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:44:00.505021 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:44:00.512070 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:44:00.512745 [info ] [MainThread]: 
[0m12:44:00.513607 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:44:00.514264 [info ] [MainThread]: 
[0m12:44:00.514893 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:44:00.515835 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 8.859523, "process_in_blocks": "1680", "process_kernel_time": 1.190551, "process_mem_max_rss": "252732", "process_out_blocks": "2408", "process_user_time": 3.248793}
[0m12:44:00.516751 [debug] [MainThread]: Command `dbt test` succeeded at 12:44:00.516537 after 8.86 seconds
[0m12:44:00.517363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa96106dea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9622f7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa931c6c190>]}
[0m12:44:00.517950 [debug] [MainThread]: Flushing usage events
[0m12:44:01.500892 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:47.432270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0591b1e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0581cd5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0581cd540>]}


============================== 12:45:47.434779 | 0ee25a6b-9b62-40b0-b19c-f779f89e8884 ==============================
[0m12:45:47.434779 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:45:47.435286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'profiles_dir': '/home/kangh/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_geolocation', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:45:48.444128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ee25a6b-9b62-40b0-b19c-f779f89e8884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05a2ecf10>]}
[0m12:45:48.509461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ee25a6b-9b62-40b0-b19c-f779f89e8884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0581e3430>]}
[0m12:45:48.510204 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:45:48.610228 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:45:48.821811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:45:48.822721 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/schema.yml
[0m12:45:48.823104 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/star/dim_geolocation.sql
[0m12:45:49.306797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ee25a6b-9b62-40b0-b19c-f779f89e8884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb029a79390>]}
[0m12:45:49.400796 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:45:49.402701 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:45:49.418570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ee25a6b-9b62-40b0-b19c-f779f89e8884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb02a0ecfd0>]}
[0m12:45:49.419169 [info ] [MainThread]: Found 6 models, 3 snapshots, 18 data tests, 9 sources, 491 macros
[0m12:45:49.419570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ee25a6b-9b62-40b0-b19c-f779f89e8884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb02a0ecbb0>]}
[0m12:45:49.421199 [info ] [MainThread]: 
[0m12:45:49.421636 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:45:49.421961 [info ] [MainThread]: 
[0m12:45:49.422556 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:45:49.423813 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m12:45:49.424201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:50.447950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:45:50.449878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:50.824752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m12:45:50.825277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:51.200825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m12:45:51.203357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:51.542016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ee25a6b-9b62-40b0-b19c-f779f89e8884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05a38a0b0>]}
[0m12:45:51.543380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:45:51.550296 [debug] [Thread-1 (]: Began running node model.olist_dataset.dim_geolocation
[0m12:45:51.551885 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [RUN]
[0m12:45:51.553163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now model.olist_dataset.dim_geolocation)
[0m12:45:51.554144 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.dim_geolocation
[0m12:45:51.570405 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.dim_geolocation"
[0m12:45:51.571237 [debug] [Thread-1 (]: Began executing node model.olist_dataset.dim_geolocation
[0m12:45:51.632002 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.dim_geolocation"
[0m12:45:51.632972 [debug] [Thread-1 (]: On model.olist_dataset.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.dim_geolocation"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
      
    
    

    OPTIONS()
    as (
      -- models/star/dim_geolocation.sql

-- This is incremental approach (Type 1 SCD)


WITH source AS (
  SELECT
    geolocation_zip_code_prefix,
    geolocation_city,
    geolocation_state,
    CAST(last_updated AS TIMESTAMP) AS last_updated,
    ROW_NUMBER() OVER (
      PARTITION BY geolocation_zip_code_prefix
      ORDER BY last_updated DESC
    ) as rn
  FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_geolocation_dataset`
)

SELECT * FROM source
WHERE rn = 1

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those geolocation_zip_code_prefix that already in dim_geolocation table
-- which assume data already in table never change

-- 
    );
  
[0m12:45:51.633546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:52.217242 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:1a061fe8-d88e-499f-a1ef-6aa14e7ce354&page=queryresults
[0m12:45:55.205330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ee25a6b-9b62-40b0-b19c-f779f89e8884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0583655a0>]}
[0m12:45:55.206252 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model olist_data_ingestion_dim_tables.dim_geolocation  [[32mCREATE TABLE (19.0k rows, 31.0 MiB processed)[0m in 3.65s]
[0m12:45:55.206882 [debug] [Thread-1 (]: Finished running node model.olist_dataset.dim_geolocation
[0m12:45:55.209446 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:45:55.210261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:55.210622 [debug] [MainThread]: Connection 'model.olist_dataset.dim_geolocation' was properly closed.
[0m12:45:55.211030 [info ] [MainThread]: 
[0m12:45:55.211483 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.79 seconds (5.79s).
[0m12:45:55.212231 [debug] [MainThread]: Command end result
[0m12:45:55.237421 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:45:55.239372 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:45:55.244893 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:45:55.245228 [info ] [MainThread]: 
[0m12:45:55.245595 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:45:55.245888 [info ] [MainThread]: 
[0m12:45:55.246174 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:45:55.246753 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.881017, "process_in_blocks": "0", "process_kernel_time": 1.324923, "process_mem_max_rss": "259816", "process_out_blocks": "3488", "process_user_time": 3.653576}
[0m12:45:55.247156 [debug] [MainThread]: Command `dbt run` succeeded at 12:45:55.247065 after 7.88 seconds
[0m12:45:55.247505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0591b1e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05a2ecf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb029a9eb30>]}
[0m12:45:55.247860 [debug] [MainThread]: Flushing usage events
[0m12:45:56.197685 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:57.784106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78391ade10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78380e9660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78380e9600>]}


============================== 12:45:57.786576 | ebe03e42-5efa-4da5-9cab-d3ed1989838b ==============================
[0m12:45:57.786576 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:45:57.787138 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'version_check': 'True', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --models dim_geolocation', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:45:58.839341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebe03e42-5efa-4da5-9cab-d3ed1989838b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f783a1f30a0>]}
[0m12:45:58.908323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebe03e42-5efa-4da5-9cab-d3ed1989838b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78380ff550>]}
[0m12:45:58.909205 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:45:59.014658 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:45:59.239415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:45:59.239958 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:45:59.298394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebe03e42-5efa-4da5-9cab-d3ed1989838b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7809df9960>]}
[0m12:45:59.398594 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:45:59.400248 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:45:59.422957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebe03e42-5efa-4da5-9cab-d3ed1989838b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7809da3310>]}
[0m12:45:59.423516 [info ] [MainThread]: Found 6 models, 3 snapshots, 18 data tests, 9 sources, 491 macros
[0m12:45:59.423889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebe03e42-5efa-4da5-9cab-d3ed1989838b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f780a65add0>]}
[0m12:45:59.425408 [info ] [MainThread]: 
[0m12:45:59.425823 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:45:59.426124 [info ] [MainThread]: 
[0m12:45:59.426614 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:45:59.431852 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_snapshots'
[0m12:45:59.432386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:00.412017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m12:46:00.413186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:00.819073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m12:46:00.821660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:01.177029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebe03e42-5efa-4da5-9cab-d3ed1989838b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7839ee62f0>]}
[0m12:46:01.178448 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:46:01.186704 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:46:01.187731 [info ] [Thread-1 (]: 1 of 4 START test not_null_dim_geolocation_geolocation_city .................... [RUN]
[0m12:46:01.188929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207)
[0m12:46:01.189695 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:46:01.212393 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207"
[0m12:46:01.213236 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:46:01.228189 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207"
[0m12:46:01.228958 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geolocation_city
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
where geolocation_city is null



      
    ) dbt_internal_test
[0m12:46:01.229389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:46:01.829549 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d26d5056-7adf-4e91-ba3d-26b07f94ddc3&page=queryresults
[0m12:46:02.850415 [info ] [Thread-1 (]: 1 of 4 PASS not_null_dim_geolocation_geolocation_city .......................... [[32mPASS[0m in 1.66s]
[0m12:46:02.851805 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207
[0m12:46:02.852551 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:46:02.853242 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_geolocation_geolocation_state ................... [RUN]
[0m12:46:02.854211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_geolocation_geolocation_city.4aa1093207, now test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954)
[0m12:46:02.854895 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:46:02.860896 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954"
[0m12:46:02.861505 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:46:02.864145 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954"
[0m12:46:02.864682 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geolocation_state
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
where geolocation_state is null



      
    ) dbt_internal_test
[0m12:46:02.865074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:46:03.521594 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:c46aaf1b-7ec9-4069-b27f-fce52949877a&page=queryresults
[0m12:46:04.475362 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_geolocation_geolocation_state ......................... [[32mPASS[0m in 1.62s]
[0m12:46:04.477124 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954
[0m12:46:04.478131 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:46:04.479471 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_geolocation_geolocation_zip_code_prefix ......... [RUN]
[0m12:46:04.480770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_geolocation_geolocation_state.0eca699954, now test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c)
[0m12:46:04.481886 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:46:04.490861 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c"
[0m12:46:04.492118 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:46:04.495364 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c"
[0m12:46:04.496534 [debug] [Thread-1 (]: On test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geolocation_zip_code_prefix
from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
where geolocation_zip_code_prefix is null



      
    ) dbt_internal_test
[0m12:46:04.497754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:46:05.196166 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:51afb497-45ff-447d-9cd5-23d2ea564051&page=queryresults
[0m12:46:06.152666 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_geolocation_geolocation_zip_code_prefix ............... [[32mPASS[0m in 1.67s]
[0m12:46:06.154148 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c
[0m12:46:06.154949 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:46:06.155675 [info ] [Thread-1 (]: 4 of 4 START test unique_dim_geolocation_geolocation_zip_code_prefix ........... [RUN]
[0m12:46:06.156731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_dim_geolocation_geolocation_zip_code_prefix.df598c671c, now test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0)
[0m12:46:06.157560 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:46:06.170565 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0"
[0m12:46:06.171532 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:46:06.175486 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0"
[0m12:46:06.176701 [debug] [Thread-1 (]: On test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select geolocation_zip_code_prefix as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_geolocation`
  where geolocation_zip_code_prefix is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:46:06.177475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:46:06.933625 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:aa059c42-f72e-446e-926d-27e55b132b90&page=queryresults
[0m12:46:08.030254 [info ] [Thread-1 (]: 4 of 4 PASS unique_dim_geolocation_geolocation_zip_code_prefix ................. [[32mPASS[0m in 1.87s]
[0m12:46:08.032178 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0
[0m12:46:08.037678 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:46:08.039741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:08.040562 [debug] [MainThread]: Connection 'test.olist_dataset.unique_dim_geolocation_geolocation_zip_code_prefix.d54b798bd0' was properly closed.
[0m12:46:08.041524 [info ] [MainThread]: 
[0m12:46:08.042580 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 8.61 seconds (8.61s).
[0m12:46:08.045245 [debug] [MainThread]: Command end result
[0m12:46:08.073722 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m12:46:08.075842 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m12:46:08.083313 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m12:46:08.083716 [info ] [MainThread]: 
[0m12:46:08.084111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:46:08.084410 [info ] [MainThread]: 
[0m12:46:08.084719 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:46:08.085376 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.358919, "process_in_blocks": "0", "process_kernel_time": 1.266759, "process_mem_max_rss": "253972", "process_out_blocks": "2440", "process_user_time": 3.370751}
[0m12:46:08.085852 [debug] [MainThread]: Command `dbt test` succeeded at 12:46:08.085756 after 10.36 seconds
[0m12:46:08.086268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78391ade10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f783a1f30a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7809dd3100>]}
[0m12:46:08.086713 [debug] [MainThread]: Flushing usage events
[0m12:46:09.066302 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:11.094316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff55e2a9e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff55d1cd5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff55d1cd540>]}


============================== 13:21:11.101941 | b377c5e1-699a-459e-a82d-e29ce65c8544 ==============================
[0m13:21:11.101941 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:21:11.102994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_orders', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:21:13.288348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b377c5e1-699a-459e-a82d-e29ce65c8544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff55f2e8f10>]}
[0m13:21:13.356106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b377c5e1-699a-459e-a82d-e29ce65c8544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff55d1e7430>]}
[0m13:21:13.356806 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:21:13.469103 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:21:13.746183 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:21:13.747409 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/schema.yml
[0m13:21:14.231590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b377c5e1-699a-459e-a82d-e29ce65c8544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff52eaa8100>]}
[0m13:21:14.323734 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:21:14.326892 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:21:14.357276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b377c5e1-699a-459e-a82d-e29ce65c8544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff52eaaa830>]}
[0m13:21:14.357854 [info ] [MainThread]: Found 6 models, 3 snapshots, 24 data tests, 9 sources, 491 macros
[0m13:21:14.358227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b377c5e1-699a-459e-a82d-e29ce65c8544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff52edc5d80>]}
[0m13:21:14.359636 [info ] [MainThread]: 
[0m13:21:14.360050 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:21:14.360341 [info ] [MainThread]: 
[0m13:21:14.360863 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:21:14.362261 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m13:21:14.362735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:16.027705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m13:21:16.029256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:16.403905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m13:21:16.405027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:16.797478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:21:16.799725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:17.195973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b377c5e1-699a-459e-a82d-e29ce65c8544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff55e07c490>]}
[0m13:21:17.197050 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:17.202253 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m13:21:17.203486 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m13:21:17.204442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now model.olist_dataset.fact_orders)
[0m13:21:17.205107 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m13:21:17.216617 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m13:21:17.219761 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m13:21:17.250237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:17.690593 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m13:21:17.691681 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order id that already in fact_orders table
-- which assume data already in table never change

-- 
--   WHERE order_id NOT IN (SELECT order_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        `order_id` = DBT_INTERNAL_SOURCE.`order_id`,`customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_status` = DBT_INTERNAL_SOURCE.`order_status`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_carrier_date` = DBT_INTERNAL_SOURCE.`order_delivered_carrier_date`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`payment_value` = DBT_INTERNAL_SOURCE.`payment_value`
    

    when not matched then insert
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)
    values
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)


    
[0m13:21:18.275669 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:5ef89c32-0ed6-4ae6-99fb-c22c7affd179&page=queryresults
[0m13:21:24.044777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b377c5e1-699a-459e-a82d-e29ce65c8544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff55d3655a0>]}
[0m13:21:24.045539 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mMERGE (99.4k rows, 39.6 MiB processed)[0m in 6.84s]
[0m13:21:24.046140 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m13:21:24.048303 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:24.049445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:24.049860 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m13:21:24.050205 [info ] [MainThread]: 
[0m13:21:24.050519 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.69 seconds (9.69s).
[0m13:21:24.051097 [debug] [MainThread]: Command end result
[0m13:21:24.074493 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:21:24.076095 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:21:24.081118 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:21:24.081474 [info ] [MainThread]: 
[0m13:21:24.081858 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:24.082134 [info ] [MainThread]: 
[0m13:21:24.082418 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:21:24.082908 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.081423, "process_in_blocks": "122656", "process_kernel_time": 1.697163, "process_mem_max_rss": "254884", "process_out_blocks": "3592", "process_user_time": 4.777563}
[0m13:21:24.083279 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:24.083193 after 13.08 seconds
[0m13:21:24.083594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff55e2a9e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff55f2e8f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff52ebcf400>]}
[0m13:21:24.083922 [debug] [MainThread]: Flushing usage events
[0m13:21:25.094317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:26.655564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7570ce1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f756fc15660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f756fc15600>]}


============================== 13:21:26.658060 | d93576cf-c102-4440-b258-f4b4f97e2cf7 ==============================
[0m13:21:26.658060 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:21:26.658559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/kangh/.dbt', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --models fact_orders', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:27.580189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd93576cf-c102-4440-b258-f4b4f97e2cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7541dfd630>]}
[0m13:21:27.646788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd93576cf-c102-4440-b258-f4b4f97e2cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f756fc2b550>]}
[0m13:21:27.647595 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:21:27.752348 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:21:27.963641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:27.964116 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:28.018917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd93576cf-c102-4440-b258-f4b4f97e2cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7541720130>]}
[0m13:21:28.112317 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:21:28.114615 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:21:28.140805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd93576cf-c102-4440-b258-f4b4f97e2cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7541722e30>]}
[0m13:21:28.141405 [info ] [MainThread]: Found 6 models, 3 snapshots, 24 data tests, 9 sources, 491 macros
[0m13:21:28.141784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd93576cf-c102-4440-b258-f4b4f97e2cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f754218ad70>]}
[0m13:21:28.143414 [info ] [MainThread]: 
[0m13:21:28.143836 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:21:28.144130 [info ] [MainThread]: 
[0m13:21:28.144598 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:21:28.150707 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_ingestion_dim_tables'
[0m13:21:28.151298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:29.103839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m13:21:29.105964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:29.460704 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:21:29.462602 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:29.852390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd93576cf-c102-4440-b258-f4b4f97e2cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7571d99d80>]}
[0m13:21:29.853569 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:29.860881 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:21:29.861865 [info ] [Thread-1 (]: 1 of 6 START test not_null_fact_orders_customer_id ............................. [RUN]
[0m13:21:29.862890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc)
[0m13:21:29.863561 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:21:29.884273 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc"
[0m13:21:29.884981 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:21:29.899952 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc"
[0m13:21:29.900708 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where customer_id is null



      
    ) dbt_internal_test
[0m13:21:29.901121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:30.575185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:a9813f60-8991-4b63-90ff-280535dd90ac&page=queryresults
[0m13:21:31.661198 [info ] [Thread-1 (]: 1 of 6 PASS not_null_fact_orders_customer_id ................................... [[32mPASS[0m in 1.80s]
[0m13:21:31.662705 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:21:31.663459 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:21:31.664155 [info ] [Thread-1 (]: 2 of 6 START test not_null_fact_orders_order_id ................................ [RUN]
[0m13:21:31.665115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc, now test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0)
[0m13:21:31.666122 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:21:31.675224 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0"
[0m13:21:31.676516 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:21:31.680854 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0"
[0m13:21:31.682314 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where order_id is null



      
    ) dbt_internal_test
[0m13:21:31.682932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:32.270443 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:356caa39-ce5c-4f14-92a9-9c85afd4b907&page=queryresults
[0m13:21:33.237206 [info ] [Thread-1 (]: 2 of 6 PASS not_null_fact_orders_order_id ...................................... [[32mPASS[0m in 1.57s]
[0m13:21:33.238673 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:21:33.239558 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:21:33.240313 [info ] [Thread-1 (]: 3 of 6 START test not_null_fact_orders_order_purchase_timestamp ................ [RUN]
[0m13:21:33.241331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0, now test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434)
[0m13:21:33.242206 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:21:33.251628 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434"
[0m13:21:33.252975 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:21:33.256182 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434"
[0m13:21:33.256990 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_purchase_timestamp
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where order_purchase_timestamp is null



      
    ) dbt_internal_test
[0m13:21:33.257456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:33.901743 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:5afcbdbe-a350-414d-a3b9-ad7988973b83&page=queryresults
[0m13:21:34.882261 [info ] [Thread-1 (]: 3 of 6 PASS not_null_fact_orders_order_purchase_timestamp ...................... [[32mPASS[0m in 1.64s]
[0m13:21:34.883047 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:21:34.883452 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:21:34.883836 [info ] [Thread-1 (]: 4 of 6 START test not_null_fact_orders_order_status ............................ [RUN]
[0m13:21:34.884339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434, now test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1)
[0m13:21:34.885125 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:21:34.889682 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1"
[0m13:21:34.891248 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:21:34.895985 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1"
[0m13:21:34.898386 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_status
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where order_status is null



      
    ) dbt_internal_test
[0m13:21:34.899714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:35.486144 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:8071a8a1-e5b6-48b8-bfa3-11a94fc8fe0e&page=queryresults
[0m13:21:36.487195 [info ] [Thread-1 (]: 4 of 6 PASS not_null_fact_orders_order_status .................................. [[32mPASS[0m in 1.60s]
[0m13:21:36.488917 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:21:36.489953 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:21:36.490803 [info ] [Thread-1 (]: 5 of 6 START test relationships_fact_orders_customer_id__customer_id__ref_dim_customer_  [RUN]
[0m13:21:36.492504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1, now test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba)
[0m13:21:36.493560 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:21:36.509698 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba"
[0m13:21:36.510539 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:21:36.512792 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba"
[0m13:21:36.513390 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:21:36.513783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:37.391177 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:767fe978-a222-4c21-a277-cb5f437aa87b&page=queryresults
[0m13:21:38.395448 [info ] [Thread-1 (]: 5 of 6 PASS relationships_fact_orders_customer_id__customer_id__ref_dim_customer_  [[32mPASS[0m in 1.90s]
[0m13:21:38.396797 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:21:38.397645 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:21:38.398348 [info ] [Thread-1 (]: 6 of 6 START test unique_fact_orders_order_id .................................. [RUN]
[0m13:21:38.399352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba, now test.olist_dataset.unique_fact_orders_order_id.93a68b4064)
[0m13:21:38.400122 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:21:38.413072 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_fact_orders_order_id.93a68b4064"
[0m13:21:38.413965 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:21:38.416369 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_fact_orders_order_id.93a68b4064"
[0m13:21:38.416982 [debug] [Thread-1 (]: On test.olist_dataset.unique_fact_orders_order_id.93a68b4064: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_fact_orders_order_id.93a68b4064"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:21:38.417418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:39.212605 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:1e071acf-7328-44a7-848e-f7bcfe695f8a&page=queryresults
[0m13:21:40.119439 [info ] [Thread-1 (]: 6 of 6 PASS unique_fact_orders_order_id ........................................ [[32mPASS[0m in 1.72s]
[0m13:21:40.121032 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:21:40.126058 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:40.127850 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:40.128684 [debug] [MainThread]: Connection 'test.olist_dataset.unique_fact_orders_order_id.93a68b4064' was properly closed.
[0m13:21:40.129526 [info ] [MainThread]: 
[0m13:21:40.130298 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 11.98 seconds (11.98s).
[0m13:21:40.133189 [debug] [MainThread]: Command end result
[0m13:21:40.163556 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:21:40.165298 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:21:40.172018 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:21:40.172430 [info ] [MainThread]: 
[0m13:21:40.172824 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:40.173161 [info ] [MainThread]: 
[0m13:21:40.173478 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:21:40.174042 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 13.575255, "process_in_blocks": "1440", "process_kernel_time": 1.10191, "process_mem_max_rss": "254692", "process_out_blocks": "2568", "process_user_time": 3.422749}
[0m13:21:40.174456 [debug] [MainThread]: Command `dbt test` succeeded at 13:21:40.174365 after 13.58 seconds
[0m13:21:40.174812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7570ce1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7541dfd630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7541a0f0d0>]}
[0m13:21:40.175163 [debug] [MainThread]: Flushing usage events
[0m13:21:41.128723 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:33:28.056617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369bbc5de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369aaf54e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369aaf5480>]}


============================== 13:33:28.061652 | 1efecdbd-3e17-4dd3-95ae-2ee096fcd3d6 ==============================
[0m13:33:28.061652 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:33:28.062185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/kangh/.dbt', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_orders', 'send_anonymous_usage_stats': 'True'}
[0m13:33:29.913436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1efecdbd-3e17-4dd3-95ae-2ee096fcd3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369aadf7c0>]}
[0m13:33:29.979697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1efecdbd-3e17-4dd3-95ae-2ee096fcd3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f366cde8a60>]}
[0m13:33:29.980384 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:33:30.096137 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:33:30.415247 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:33:30.416909 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/schema.yml
[0m13:33:30.417663 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/fact/fact_orders.sql
[0m13:33:31.148218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1efecdbd-3e17-4dd3-95ae-2ee096fcd3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f366c3b0130>]}
[0m13:33:31.273942 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:33:31.276885 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:33:31.327357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1efecdbd-3e17-4dd3-95ae-2ee096fcd3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f366c3b16c0>]}
[0m13:33:31.328329 [info ] [MainThread]: Found 6 models, 3 snapshots, 25 data tests, 9 sources, 491 macros
[0m13:33:31.328992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1efecdbd-3e17-4dd3-95ae-2ee096fcd3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f366c6e5f00>]}
[0m13:33:31.331581 [info ] [MainThread]: 
[0m13:33:31.332240 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:33:31.332728 [info ] [MainThread]: 
[0m13:33:31.333443 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:33:31.335402 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m13:33:31.336338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:33.893491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:33:33.894833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:34.254941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m13:33:34.256927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:34.635515 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m13:33:34.637592 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:35.014978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1efecdbd-3e17-4dd3-95ae-2ee096fcd3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369ab092a0>]}
[0m13:33:35.016010 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:33:35.022058 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m13:33:35.023119 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m13:33:35.024107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now model.olist_dataset.fact_orders)
[0m13:33:35.024798 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m13:33:35.037748 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m13:33:35.038401 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m13:33:35.066834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:35.455520 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m13:33:35.456354 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
    WHERE order_status IN ('delivered', 'canceled')   -- Only include delivered or canceled
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order id that already in fact_orders table
-- which assume data already in table never change

-- 
--   WHERE order_id NOT IN (SELECT order_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        `order_id` = DBT_INTERNAL_SOURCE.`order_id`,`customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_status` = DBT_INTERNAL_SOURCE.`order_status`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_carrier_date` = DBT_INTERNAL_SOURCE.`order_delivered_carrier_date`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`payment_value` = DBT_INTERNAL_SOURCE.`payment_value`
    

    when not matched then insert
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)
    values
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)


    
[0m13:33:36.160396 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:22c54e30-342c-4bb1-8ee4-1408ce80c0dc&page=queryresults
[0m13:33:41.215422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1efecdbd-3e17-4dd3-95ae-2ee096fcd3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369aadfee0>]}
[0m13:33:41.216149 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mMERGE (97.1k rows, 39.6 MiB processed)[0m in 6.19s]
[0m13:33:41.216736 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m13:33:41.218493 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:33:41.219197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:33:41.219513 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m13:33:41.219827 [info ] [MainThread]: 
[0m13:33:41.220161 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.89 seconds (9.89s).
[0m13:33:41.220775 [debug] [MainThread]: Command end result
[0m13:33:41.244708 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:33:41.246443 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:33:41.251402 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:33:41.251717 [info ] [MainThread]: 
[0m13:33:41.252112 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:33:41.252408 [info ] [MainThread]: 
[0m13:33:41.252692 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:33:41.253199 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.258886, "process_in_blocks": "122648", "process_kernel_time": 1.435744, "process_mem_max_rss": "258532", "process_out_blocks": "3608", "process_user_time": 4.386446}
[0m13:33:41.253577 [debug] [MainThread]: Command `dbt run` succeeded at 13:33:41.253488 after 13.26 seconds
[0m13:33:41.253907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369bbc5de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f366c4e7790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369b86ebc0>]}
[0m13:33:41.254268 [debug] [MainThread]: Flushing usage events
[0m13:33:42.216474 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:33:43.785433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaea015db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae90295d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae9029570>]}


============================== 13:33:43.787819 | e5d6faee-b33c-4f89-b103-c3c9dc21d85c ==============================
[0m13:33:43.787819 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:33:43.788328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'profiles_dir': '/home/kangh/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --models fact_orders', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:33:44.732895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5d6faee-b33c-4f89-b103-c3c9dc21d85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaeb14b040>]}
[0m13:33:44.798854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5d6faee-b33c-4f89-b103-c3c9dc21d85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faabb19c310>]}
[0m13:33:44.799595 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:33:44.896717 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:33:45.103904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:33:45.104324 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:33:45.158692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5d6faee-b33c-4f89-b103-c3c9dc21d85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faabb221720>]}
[0m13:33:45.252925 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:33:45.254625 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:33:45.280150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5d6faee-b33c-4f89-b103-c3c9dc21d85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faabacb2b90>]}
[0m13:33:45.280730 [info ] [MainThread]: Found 6 models, 3 snapshots, 25 data tests, 9 sources, 491 macros
[0m13:33:45.281115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5d6faee-b33c-4f89-b103-c3c9dc21d85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faabb54ece0>]}
[0m13:33:45.282749 [info ] [MainThread]: 
[0m13:33:45.283143 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:33:45.283438 [info ] [MainThread]: 
[0m13:33:45.283912 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:33:45.289941 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_ingestion_fact_tables'
[0m13:33:45.290928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:46.246838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m13:33:46.247995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:46.619912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m13:33:46.621648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:46.968198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5d6faee-b33c-4f89-b103-c3c9dc21d85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae903da50>]}
[0m13:33:46.969435 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:33:46.975311 [debug] [Thread-1 (]: Began running node test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab
[0m13:33:46.977097 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_fact_orders_order_status__delivered__canceled  [RUN]
[0m13:33:46.977994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab)
[0m13:33:46.979006 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab
[0m13:33:46.997922 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab"
[0m13:33:46.998573 [debug] [Thread-1 (]: Began executing node test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab
[0m13:33:47.014520 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab"
[0m13:33:47.015261 [debug] [Thread-1 (]: On test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','canceled'
)



      
    ) dbt_internal_test
[0m13:33:47.015672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:47.703497 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:b036f6a8-acca-4319-9546-2f8dcae51f98&page=queryresults
[0m13:33:48.714855 [error] [Thread-1 (]: 1 of 7 FAIL 6 accepted_values_fact_orders_order_status__delivered__canceled .... [[31mFAIL 6[0m in 1.74s]
[0m13:33:48.716473 [debug] [Thread-1 (]: Finished running node test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab
[0m13:33:48.717408 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:33:48.718242 [info ] [Thread-1 (]: 2 of 7 START test not_null_fact_orders_customer_id ............................. [RUN]
[0m13:33:48.719410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab, now test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc)
[0m13:33:48.720852 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:33:48.734385 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc"
[0m13:33:48.735327 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:33:48.738993 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc"
[0m13:33:48.739734 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where customer_id is null



      
    ) dbt_internal_test
[0m13:33:48.740143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:49.364606 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:abb552d4-ac15-46b9-b749-4145b83e8015&page=queryresults
[0m13:33:50.404519 [info ] [Thread-1 (]: 2 of 7 PASS not_null_fact_orders_customer_id ................................... [[32mPASS[0m in 1.69s]
[0m13:33:50.405514 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:33:50.406237 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:33:50.406996 [info ] [Thread-1 (]: 3 of 7 START test not_null_fact_orders_order_id ................................ [RUN]
[0m13:33:50.407665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc, now test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0)
[0m13:33:50.408054 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:33:50.412425 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0"
[0m13:33:50.413118 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:33:50.415294 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0"
[0m13:33:50.415877 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where order_id is null



      
    ) dbt_internal_test
[0m13:33:50.416254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:51.041720 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:91f22f33-b4b5-4f4a-9232-5c987ab28dd3&page=queryresults
[0m13:33:51.994967 [info ] [Thread-1 (]: 3 of 7 PASS not_null_fact_orders_order_id ...................................... [[32mPASS[0m in 1.59s]
[0m13:33:51.996783 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:33:51.997853 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:33:51.998836 [info ] [Thread-1 (]: 4 of 7 START test not_null_fact_orders_order_purchase_timestamp ................ [RUN]
[0m13:33:51.999893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0, now test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434)
[0m13:33:52.001746 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:33:52.010624 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434"
[0m13:33:52.012235 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:33:52.019914 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434"
[0m13:33:52.020928 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_purchase_timestamp
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where order_purchase_timestamp is null



      
    ) dbt_internal_test
[0m13:33:52.021594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:52.883591 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:e899f466-7f84-4c83-a2c7-cfbede93ac7a&page=queryresults
[0m13:33:53.839408 [info ] [Thread-1 (]: 4 of 7 PASS not_null_fact_orders_order_purchase_timestamp ...................... [[32mPASS[0m in 1.84s]
[0m13:33:53.840273 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:33:53.840709 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:33:53.841319 [info ] [Thread-1 (]: 5 of 7 START test not_null_fact_orders_order_status ............................ [RUN]
[0m13:33:53.841881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434, now test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1)
[0m13:33:53.842251 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:33:53.846888 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1"
[0m13:33:53.847615 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:33:53.849763 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1"
[0m13:33:53.850369 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_status
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where order_status is null



      
    ) dbt_internal_test
[0m13:33:53.850794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:54.531861 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:94b79544-31bf-4815-9832-d3d93d95d7e0&page=queryresults
[0m13:33:55.562175 [info ] [Thread-1 (]: 5 of 7 PASS not_null_fact_orders_order_status .................................. [[32mPASS[0m in 1.72s]
[0m13:33:55.563557 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:33:55.564023 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:33:55.564369 [info ] [Thread-1 (]: 6 of 7 START test relationships_fact_orders_customer_id__customer_id__ref_dim_customer_  [RUN]
[0m13:33:55.564823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1, now test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba)
[0m13:33:55.565160 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:33:55.573101 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba"
[0m13:33:55.573760 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:33:55.575880 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba"
[0m13:33:55.576457 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:33:55.576914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:56.498309 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:501d76be-c88c-4880-9687-36bfd1833707&page=queryresults
[0m13:33:57.439106 [info ] [Thread-1 (]: 6 of 7 PASS relationships_fact_orders_customer_id__customer_id__ref_dim_customer_  [[32mPASS[0m in 1.87s]
[0m13:33:57.440743 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:33:57.442551 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:33:57.445128 [info ] [Thread-1 (]: 7 of 7 START test unique_fact_orders_order_id .................................. [RUN]
[0m13:33:57.446383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba, now test.olist_dataset.unique_fact_orders_order_id.93a68b4064)
[0m13:33:57.447948 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:33:57.458757 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_fact_orders_order_id.93a68b4064"
[0m13:33:57.460329 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:33:57.469582 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_fact_orders_order_id.93a68b4064"
[0m13:33:57.471868 [debug] [Thread-1 (]: On test.olist_dataset.unique_fact_orders_order_id.93a68b4064: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_fact_orders_order_id.93a68b4064"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:33:57.473172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:58.297970 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:8129840a-2ac6-4381-af6c-6cda39b91bb3&page=queryresults
[0m13:33:59.247667 [info ] [Thread-1 (]: 7 of 7 PASS unique_fact_orders_order_id ........................................ [[32mPASS[0m in 1.80s]
[0m13:33:59.249244 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:33:59.254156 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:33:59.256472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:33:59.257456 [debug] [MainThread]: Connection 'test.olist_dataset.unique_fact_orders_order_id.93a68b4064' was properly closed.
[0m13:33:59.258354 [info ] [MainThread]: 
[0m13:33:59.259219 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 13.97 seconds (13.97s).
[0m13:33:59.262702 [debug] [MainThread]: Command end result
[0m13:33:59.292518 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:33:59.294586 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:33:59.302074 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:33:59.302535 [info ] [MainThread]: 
[0m13:33:59.302974 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:33:59.303345 [info ] [MainThread]: 
[0m13:33:59.303812 [error] [MainThread]: [31mFailure in test accepted_values_fact_orders_order_status__delivered__canceled (models/schema.yml)[0m
[0m13:33:59.304203 [error] [MainThread]:   Got 6 results, configured to fail if != 0
[0m13:33:59.304470 [info ] [MainThread]: 
[0m13:33:59.304827 [info ] [MainThread]:   compiled code at target/compiled/olist_dataset/models/schema.yml/accepted_values_fact_orders_order_status__delivered__canceled.sql
[0m13:33:59.305119 [info ] [MainThread]: 
[0m13:33:59.305480 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m13:33:59.306068 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 15.577462, "process_in_blocks": "1432", "process_kernel_time": 1.235723, "process_mem_max_rss": "253748", "process_out_blocks": "2600", "process_user_time": 3.315817}
[0m13:33:59.306458 [debug] [MainThread]: Command `dbt test` failed at 13:33:59.306366 after 15.58 seconds
[0m13:33:59.306853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaea015db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaea191480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae965b370>]}
[0m13:33:59.307227 [debug] [MainThread]: Flushing usage events
[0m13:34:00.303813 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:20.953884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aa66b5ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aa55f15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aa55f1570>]}


============================== 13:34:20.956389 | 95976910-8234-4d27-8ea2-b7c45c48dfaf ==============================
[0m13:34:20.956389 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:34:20.956915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'version_check': 'True', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_orders', 'send_anonymous_usage_stats': 'True'}
[0m13:34:21.883568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95976910-8234-4d27-8ea2-b7c45c48dfaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aa76f3760>]}
[0m13:34:21.948259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95976910-8234-4d27-8ea2-b7c45c48dfaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aa5c96ce0>]}
[0m13:34:21.949027 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:34:22.055698 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:34:22.269272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:34:22.269724 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:34:22.328609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95976910-8234-4d27-8ea2-b7c45c48dfaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a772f80a0>]}
[0m13:34:22.431055 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:34:22.432665 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:34:22.444274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95976910-8234-4d27-8ea2-b7c45c48dfaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a772fa2f0>]}
[0m13:34:22.444826 [info ] [MainThread]: Found 6 models, 3 snapshots, 25 data tests, 9 sources, 491 macros
[0m13:34:22.445218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95976910-8234-4d27-8ea2-b7c45c48dfaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a772fa2c0>]}
[0m13:34:22.446788 [info ] [MainThread]: 
[0m13:34:22.447175 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:34:22.447481 [info ] [MainThread]: 
[0m13:34:22.447970 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:34:22.449273 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m13:34:22.450166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:23.418437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m13:34:23.419367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:23.767548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m13:34:23.768435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:24.144981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:34:24.146880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:24.497650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95976910-8234-4d27-8ea2-b7c45c48dfaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aa7757820>]}
[0m13:34:24.498927 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:34:24.507505 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m13:34:24.509048 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m13:34:24.510767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now model.olist_dataset.fact_orders)
[0m13:34:24.512315 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m13:34:24.541209 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m13:34:24.543586 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m13:34:24.601775 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m13:34:24.602668 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
      
    
    

    OPTIONS()
    as (
      -- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
    WHERE order_status IN ('delivered', 'canceled')   -- Only include delivered or canceled
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order id that already in fact_orders table
-- which assume data already in table never change

-- 
    );
  
[0m13:34:24.603141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:25.191942 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:1fd7160a-9182-4d47-9cd5-1b8b2218280b&page=queryresults
[0m13:34:28.985364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95976910-8234-4d27-8ea2-b7c45c48dfaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a772b9cc0>]}
[0m13:34:28.986106 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mCREATE TABLE (97.1k rows, 21.5 MiB processed)[0m in 4.47s]
[0m13:34:28.986705 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m13:34:28.989624 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:34:28.990459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:34:28.990814 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m13:34:28.991162 [info ] [MainThread]: 
[0m13:34:28.991639 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.54 seconds (6.54s).
[0m13:34:28.992421 [debug] [MainThread]: Command end result
[0m13:34:29.017256 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:34:29.018934 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:34:29.024581 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:34:29.025016 [info ] [MainThread]: 
[0m13:34:29.025412 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:34:29.025708 [info ] [MainThread]: 
[0m13:34:29.026015 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:34:29.026518 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.129749, "process_in_blocks": "8", "process_kernel_time": 1.177364, "process_mem_max_rss": "250916", "process_out_blocks": "2464", "process_user_time": 3.21008}
[0m13:34:29.026951 [debug] [MainThread]: Command `dbt run` succeeded at 13:34:29.026863 after 8.13 seconds
[0m13:34:29.027284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aa66b5ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aa76f3760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a772d54b0>]}
[0m13:34:29.027625 [debug] [MainThread]: Flushing usage events
[0m13:34:29.993911 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:31.538550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6028875e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60277b5630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60277b55d0>]}


============================== 13:34:31.541117 | 300680a4-4387-4406-83fe-275245f68bee ==============================
[0m13:34:31.541117 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:34:31.541723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --models fact_orders', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:34:32.475119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '300680a4-4387-4406-83fe-275245f68bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ff997b430>]}
[0m13:34:32.542961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '300680a4-4387-4406-83fe-275245f68bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60277cb550>]}
[0m13:34:32.543739 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:34:32.643382 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:34:32.852229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:34:32.852668 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:34:32.907799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '300680a4-4387-4406-83fe-275245f68bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ff94a4100>]}
[0m13:34:33.002371 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:34:33.004101 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:34:33.026829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '300680a4-4387-4406-83fe-275245f68bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ff947beb0>]}
[0m13:34:33.027450 [info ] [MainThread]: Found 6 models, 3 snapshots, 25 data tests, 9 sources, 491 macros
[0m13:34:33.027829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '300680a4-4387-4406-83fe-275245f68bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ff9cf6dd0>]}
[0m13:34:33.029436 [info ] [MainThread]: 
[0m13:34:33.029832 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:34:33.030121 [info ] [MainThread]: 
[0m13:34:33.030587 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:34:33.036483 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_snapshots'
[0m13:34:33.037477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:34.008458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m13:34:34.011358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:34.348823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:34:34.351817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:34.729975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '300680a4-4387-4406-83fe-275245f68bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ff98bb2e0>]}
[0m13:34:34.731267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:34:34.737493 [debug] [Thread-1 (]: Began running node test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab
[0m13:34:34.738400 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_fact_orders_order_status__delivered__canceled  [RUN]
[0m13:34:34.739351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab)
[0m13:34:34.740115 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab
[0m13:34:34.761984 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab"
[0m13:34:34.762877 [debug] [Thread-1 (]: Began executing node test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab
[0m13:34:34.780119 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab"
[0m13:34:34.781003 [debug] [Thread-1 (]: On test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','canceled'
)



      
    ) dbt_internal_test
[0m13:34:34.781502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:35.532832 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:17c7c966-ff6c-4952-af09-2cecfeb0ebec&page=queryresults
[0m13:34:36.503121 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_fact_orders_order_status__delivered__canceled ...... [[32mPASS[0m in 1.76s]
[0m13:34:36.504424 [debug] [Thread-1 (]: Finished running node test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab
[0m13:34:36.505157 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:34:36.505811 [info ] [Thread-1 (]: 2 of 7 START test not_null_fact_orders_customer_id ............................. [RUN]
[0m13:34:36.506709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab, now test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc)
[0m13:34:36.507369 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:34:36.516981 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc"
[0m13:34:36.517749 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:34:36.519966 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc"
[0m13:34:36.520503 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where customer_id is null



      
    ) dbt_internal_test
[0m13:34:36.520864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:37.171897 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:409195ee-0c78-4a83-b4a5-8895d376d3ce&page=queryresults
[0m13:34:38.188169 [info ] [Thread-1 (]: 2 of 7 PASS not_null_fact_orders_customer_id ................................... [[32mPASS[0m in 1.68s]
[0m13:34:38.189610 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:34:38.190475 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:34:38.191769 [info ] [Thread-1 (]: 3 of 7 START test not_null_fact_orders_order_id ................................ [RUN]
[0m13:34:38.192882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc, now test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0)
[0m13:34:38.193733 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:34:38.201713 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0"
[0m13:34:38.202575 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:34:38.205352 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0"
[0m13:34:38.205944 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where order_id is null



      
    ) dbt_internal_test
[0m13:34:38.206337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:38.795554 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:eaf83efd-7579-4bbc-81f7-3d2727b0c5ee&page=queryresults
[0m13:34:39.739737 [info ] [Thread-1 (]: 3 of 7 PASS not_null_fact_orders_order_id ...................................... [[32mPASS[0m in 1.55s]
[0m13:34:39.741602 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:34:39.742598 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:34:39.743532 [info ] [Thread-1 (]: 4 of 7 START test not_null_fact_orders_order_purchase_timestamp ................ [RUN]
[0m13:34:39.744659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0, now test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434)
[0m13:34:39.746020 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:34:39.756030 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434"
[0m13:34:39.757146 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:34:39.761659 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434"
[0m13:34:39.762302 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_purchase_timestamp
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where order_purchase_timestamp is null



      
    ) dbt_internal_test
[0m13:34:39.762700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:40.355535 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:44be6583-cf3f-4832-920a-36a610621f1f&page=queryresults
[0m13:34:41.357940 [info ] [Thread-1 (]: 4 of 7 PASS not_null_fact_orders_order_purchase_timestamp ...................... [[32mPASS[0m in 1.61s]
[0m13:34:41.359534 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:34:41.360492 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:34:41.361282 [info ] [Thread-1 (]: 5 of 7 START test not_null_fact_orders_order_status ............................ [RUN]
[0m13:34:41.362463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434, now test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1)
[0m13:34:41.364142 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:34:41.374833 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1"
[0m13:34:41.376911 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:34:41.383170 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1"
[0m13:34:41.385262 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_status
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where order_status is null



      
    ) dbt_internal_test
[0m13:34:41.386115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:41.945393 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:66eef5fa-7944-41f6-9c6b-3d153fc0aac6&page=queryresults
[0m13:34:42.870588 [info ] [Thread-1 (]: 5 of 7 PASS not_null_fact_orders_order_status .................................. [[32mPASS[0m in 1.51s]
[0m13:34:42.872232 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:34:42.873133 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:34:42.874586 [info ] [Thread-1 (]: 6 of 7 START test relationships_fact_orders_customer_id__customer_id__ref_dim_customer_  [RUN]
[0m13:34:42.875660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1, now test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba)
[0m13:34:42.876497 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:34:42.890587 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba"
[0m13:34:42.891294 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:34:42.893462 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba"
[0m13:34:42.893999 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:34:42.894398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:43.856195 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:ee89ded7-dcdc-4358-9947-177498f22b90&page=queryresults
[0m13:34:44.817610 [info ] [Thread-1 (]: 6 of 7 PASS relationships_fact_orders_customer_id__customer_id__ref_dim_customer_  [[32mPASS[0m in 1.94s]
[0m13:34:44.819144 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:34:44.820054 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:34:44.820943 [info ] [Thread-1 (]: 7 of 7 START test unique_fact_orders_order_id .................................. [RUN]
[0m13:34:44.822707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba, now test.olist_dataset.unique_fact_orders_order_id.93a68b4064)
[0m13:34:44.823810 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:34:44.837981 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_fact_orders_order_id.93a68b4064"
[0m13:34:44.838951 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:34:44.842945 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_fact_orders_order_id.93a68b4064"
[0m13:34:44.843596 [debug] [Thread-1 (]: On test.olist_dataset.unique_fact_orders_order_id.93a68b4064: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_fact_orders_order_id.93a68b4064"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:34:44.845512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:45.682407 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:141e6a30-14b2-41dc-90c7-f96f0622c381&page=queryresults
[0m13:34:46.648435 [info ] [Thread-1 (]: 7 of 7 PASS unique_fact_orders_order_id ........................................ [[32mPASS[0m in 1.83s]
[0m13:34:46.650094 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:34:46.654736 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:34:46.657043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:34:46.658099 [debug] [MainThread]: Connection 'test.olist_dataset.unique_fact_orders_order_id.93a68b4064' was properly closed.
[0m13:34:46.658925 [info ] [MainThread]: 
[0m13:34:46.659695 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 13.63 seconds (13.63s).
[0m13:34:46.662893 [debug] [MainThread]: Command end result
[0m13:34:46.692417 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:34:46.694154 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:34:46.700458 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:34:46.700775 [info ] [MainThread]: 
[0m13:34:46.701138 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:34:46.701453 [info ] [MainThread]: 
[0m13:34:46.701761 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:34:46.702271 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 15.221465, "process_in_blocks": "0", "process_kernel_time": 1.103228, "process_mem_max_rss": "255768", "process_out_blocks": "2600", "process_user_time": 3.451385}
[0m13:34:46.702628 [debug] [MainThread]: Command `dbt test` succeeded at 13:34:46.702541 after 15.22 seconds
[0m13:34:46.702962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6028875e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f602851ea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6027c0d060>]}
[0m13:34:46.703307 [debug] [MainThread]: Flushing usage events
[0m13:34:47.689297 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:37:55.911862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c71061db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c70045450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c700453f0>]}


============================== 13:37:55.916131 | 21d0e9be-8c68-4d11-9c62-64d599f9fba0 ==============================
[0m13:37:55.916131 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:37:55.916641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/kangh/.dbt', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_order_items', 'send_anonymous_usage_stats': 'True'}
[0m13:37:57.779561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21d0e9be-8c68-4d11-9c62-64d599f9fba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c70f7b160>]}
[0m13:37:57.885016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21d0e9be-8c68-4d11-9c62-64d599f9fba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c70ddb7c0>]}
[0m13:37:57.885891 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:37:58.022916 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:37:58.319463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:37:58.320534 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/schema.yml
[0m13:37:58.820897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21d0e9be-8c68-4d11-9c62-64d599f9fba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c41964e50>]}
[0m13:37:58.915271 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:37:58.918752 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:37:58.946848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21d0e9be-8c68-4d11-9c62-64d599f9fba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c41965180>]}
[0m13:37:58.947456 [info ] [MainThread]: Found 3 snapshots, 6 models, 33 data tests, 9 sources, 491 macros
[0m13:37:58.947899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21d0e9be-8c68-4d11-9c62-64d599f9fba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c419651b0>]}
[0m13:37:58.949939 [info ] [MainThread]: 
[0m13:37:58.950382 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:37:58.950689 [info ] [MainThread]: 
[0m13:37:58.951309 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:37:58.952781 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m13:37:58.953592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:00.864261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m13:38:00.865580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:01.236884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:38:01.239485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:01.604474 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m13:38:01.606937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:01.952676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21d0e9be-8c68-4d11-9c62-64d599f9fba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c7007d270>]}
[0m13:38:01.954267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:01.963762 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m13:38:01.965488 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m13:38:01.967238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now model.olist_dataset.fact_order_items)
[0m13:38:01.968278 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m13:38:01.978502 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m13:38:01.981394 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m13:38:02.011415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:02.428419 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m13:38:02.429273 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    LEFT JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order item id that already in fact_order_item table
-- which assume data already in table never change

-- 
--   WHERE order_id_item NOT IN (SELECT order_id_item FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id_item = DBT_INTERNAL_DEST.order_id_item))

    
    when matched then update set
        `customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_id` = DBT_INTERNAL_SOURCE.`order_id`,`order_item_id` = DBT_INTERNAL_SOURCE.`order_item_id`,`product_id` = DBT_INTERNAL_SOURCE.`product_id`,`seller_id` = DBT_INTERNAL_SOURCE.`seller_id`,`price` = DBT_INTERNAL_SOURCE.`price`,`freight_value` = DBT_INTERNAL_SOURCE.`freight_value`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`order_id_item` = DBT_INTERNAL_SOURCE.`order_id_item`
    

    when not matched then insert
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)
    values
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)


    
[0m13:38:03.025444 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:dfe9bc0b-e5a4-4ce4-b8b0-73f2f304679d&page=queryresults
[0m13:38:09.823803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21d0e9be-8c68-4d11-9c62-64d599f9fba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c700569b0>]}
[0m13:38:09.824562 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mMERGE (112.7k rows, 57.9 MiB processed)[0m in 7.85s]
[0m13:38:09.825241 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m13:38:09.827078 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:38:09.828219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:09.828672 [debug] [MainThread]: Connection 'model.olist_dataset.fact_order_items' was properly closed.
[0m13:38:09.828993 [info ] [MainThread]: 
[0m13:38:09.829344 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.88 seconds (10.88s).
[0m13:38:09.829927 [debug] [MainThread]: Command end result
[0m13:38:09.854651 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:38:09.856420 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:38:09.861649 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:38:09.861983 [info ] [MainThread]: 
[0m13:38:09.862358 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:38:09.862658 [info ] [MainThread]: 
[0m13:38:09.862948 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:38:09.863475 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.013758, "process_in_blocks": "122696", "process_kernel_time": 1.435839, "process_mem_max_rss": "262396", "process_out_blocks": "3728", "process_user_time": 4.452134}
[0m13:38:09.863854 [debug] [MainThread]: Command `dbt run` succeeded at 13:38:09.863772 after 14.01 seconds
[0m13:38:09.864170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c71061db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c70f7b160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c41d2ac50>]}
[0m13:38:09.864513 [debug] [MainThread]: Flushing usage events
[0m13:38:10.824039 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:38:12.446321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe54f0b1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe54dfe5660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe54dfe5600>]}


============================== 13:38:12.448829 | c35f6584-a6e4-4a19-a3b3-dd12123bb03c ==============================
[0m13:38:12.448829 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:38:12.449340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --models fact_order_items', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:38:13.376795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c35f6584-a6e4-4a19-a3b3-dd12123bb03c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe54ed2ba00>]}
[0m13:38:13.441511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c35f6584-a6e4-4a19-a3b3-dd12123bb03c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe54e7f7730>]}
[0m13:38:13.442263 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:38:13.551036 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:38:13.753458 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:38:13.753896 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:38:13.808637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c35f6584-a6e4-4a19-a3b3-dd12123bb03c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51fa14d30>]}
[0m13:38:13.907268 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:38:13.909487 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:38:13.937794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c35f6584-a6e4-4a19-a3b3-dd12123bb03c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51fba3550>]}
[0m13:38:13.938415 [info ] [MainThread]: Found 3 snapshots, 6 models, 33 data tests, 9 sources, 491 macros
[0m13:38:13.938819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c35f6584-a6e4-4a19-a3b3-dd12123bb03c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe524556e00>]}
[0m13:38:13.940587 [info ] [MainThread]: 
[0m13:38:13.941054 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:38:13.941358 [info ] [MainThread]: 
[0m13:38:13.941931 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:38:13.946760 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_snapshots'
[0m13:38:13.947726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:14.878629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m13:38:14.881999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:15.242549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:38:15.243297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:15.603034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c35f6584-a6e4-4a19-a3b3-dd12123bb03c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe550169d80>]}
[0m13:38:15.604135 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:15.609482 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:38:15.610284 [info ] [Thread-1 (]: 1 of 8 START test not_null_fact_order_items_order_id ........................... [RUN]
[0m13:38:15.611183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e)
[0m13:38:15.611941 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:38:15.634122 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e"
[0m13:38:15.634777 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:38:15.650106 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e"
[0m13:38:15.650992 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where order_id is null



      
    ) dbt_internal_test
[0m13:38:15.651459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:16.237760 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:6b877d52-2882-4d86-a633-fd99f1a896ef&page=queryresults
[0m13:38:17.246634 [info ] [Thread-1 (]: 1 of 8 PASS not_null_fact_order_items_order_id ................................. [[32mPASS[0m in 1.64s]
[0m13:38:17.248049 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:38:17.248878 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:38:17.249603 [info ] [Thread-1 (]: 2 of 8 START test not_null_fact_order_items_order_id_item ...................... [RUN]
[0m13:38:17.250575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e, now test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8)
[0m13:38:17.251412 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:38:17.258538 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8"
[0m13:38:17.259528 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:38:17.261964 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8"
[0m13:38:17.262594 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id_item
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where order_id_item is null



      
    ) dbt_internal_test
[0m13:38:17.262993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:17.985828 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:1a9be839-4e24-40c6-88cc-a2d35196f59c&page=queryresults
[0m13:38:19.170096 [info ] [Thread-1 (]: 2 of 8 PASS not_null_fact_order_items_order_id_item ............................ [[32mPASS[0m in 1.92s]
[0m13:38:19.170960 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:38:19.171507 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:38:19.172417 [info ] [Thread-1 (]: 3 of 8 START test not_null_fact_order_items_product_id ......................... [RUN]
[0m13:38:19.173019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8, now test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9)
[0m13:38:19.173385 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:38:19.178787 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9"
[0m13:38:19.179563 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:38:19.181964 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9"
[0m13:38:19.182792 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where product_id is null



      
    ) dbt_internal_test
[0m13:38:19.183296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:20.045846 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:5b26d15a-4c33-4fa5-a20c-66c7a83638c4&page=queryresults
[0m13:38:21.000848 [info ] [Thread-1 (]: 3 of 8 PASS not_null_fact_order_items_product_id ............................... [[32mPASS[0m in 1.83s]
[0m13:38:21.002383 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:38:21.003187 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:38:21.003960 [info ] [Thread-1 (]: 4 of 8 START test not_null_fact_order_items_seller_id .......................... [RUN]
[0m13:38:21.005017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9, now test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883)
[0m13:38:21.005864 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:38:21.015260 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883"
[0m13:38:21.016631 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:38:21.021484 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883"
[0m13:38:21.022234 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where seller_id is null



      
    ) dbt_internal_test
[0m13:38:21.022666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:21.574179 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:2951a567-b3e8-4ceb-9e8d-dc8baeb3fdeb&page=queryresults
[0m13:38:22.560635 [info ] [Thread-1 (]: 4 of 8 PASS not_null_fact_order_items_seller_id ................................ [[32mPASS[0m in 1.56s]
[0m13:38:22.562281 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:38:22.563198 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:38:22.564057 [info ] [Thread-1 (]: 5 of 8 START test relationships_fact_order_items_order_id__order_id__ref_fact_orders_  [RUN]
[0m13:38:22.565142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883, now test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74)
[0m13:38:22.566618 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:38:22.582021 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"
[0m13:38:22.582886 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:38:22.585153 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"
[0m13:38:22.585954 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:38:22.586376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:23.469073 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:b30a5341-1c2f-49e9-8ed8-df063df4e7d3&page=queryresults
[0m13:38:24.448101 [error] [Thread-1 (]: 5 of 8 FAIL 1911 relationships_fact_order_items_order_id__order_id__ref_fact_orders_  [[31mFAIL 1911[0m in 1.88s]
[0m13:38:24.449649 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:38:24.450540 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:38:24.452055 [info ] [Thread-1 (]: 6 of 8 START test relationships_fact_order_items_product_id__product_id__ref_dim_product_  [RUN]
[0m13:38:24.453187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74, now test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428)
[0m13:38:24.454101 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:38:24.465329 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"
[0m13:38:24.466356 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:38:24.469063 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"
[0m13:38:24.469723 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:38:24.470142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:25.205896 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:91eeedee-3626-4adc-b7c9-b843ce4b2be1&page=queryresults
[0m13:38:26.116175 [info ] [Thread-1 (]: 6 of 8 PASS relationships_fact_order_items_product_id__product_id__ref_dim_product_  [[32mPASS[0m in 1.66s]
[0m13:38:26.117411 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:38:26.117857 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:38:26.118235 [info ] [Thread-1 (]: 7 of 8 START test relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_  [RUN]
[0m13:38:26.119103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428, now test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1)
[0m13:38:26.119849 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:38:26.132402 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1"
[0m13:38:26.133478 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:38:26.137789 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1"
[0m13:38:26.138602 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select seller_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
    where seller_id is not null
),

parent as (
    select seller_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:38:26.139046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:26.904403 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:5b568b85-4218-4abf-8e6f-9987be251004&page=queryresults
[0m13:38:28.308746 [info ] [Thread-1 (]: 7 of 8 PASS relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_  [[32mPASS[0m in 2.19s]
[0m13:38:28.310304 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:38:28.311086 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:38:28.312202 [info ] [Thread-1 (]: 8 of 8 START test unique_fact_order_items_order_id_item ........................ [RUN]
[0m13:38:28.313280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1, now test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c)
[0m13:38:28.314075 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:38:28.327496 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c"
[0m13:38:28.328419 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:38:28.331365 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c"
[0m13:38:28.332225 [debug] [Thread-1 (]: On test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id_item as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
  where order_id_item is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:38:28.332761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:29.073088 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:7ab6cef0-13ef-4902-979d-23ec0be50d15&page=queryresults
[0m13:38:30.175401 [info ] [Thread-1 (]: 8 of 8 PASS unique_fact_order_items_order_id_item .............................. [[32mPASS[0m in 1.86s]
[0m13:38:30.177030 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:38:30.181660 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:38:30.183652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:30.184493 [debug] [MainThread]: Connection 'test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c' was properly closed.
[0m13:38:30.185369 [info ] [MainThread]: 
[0m13:38:30.186274 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 16.24 seconds (16.24s).
[0m13:38:30.189647 [debug] [MainThread]: Command end result
[0m13:38:30.243283 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:38:30.246058 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:38:30.257562 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:38:30.258139 [info ] [MainThread]: 
[0m13:38:30.258692 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:38:30.259718 [info ] [MainThread]: 
[0m13:38:30.261458 [error] [MainThread]: [31mFailure in test relationships_fact_order_items_order_id__order_id__ref_fact_orders_ (models/schema.yml)[0m
[0m13:38:30.262124 [error] [MainThread]:   Got 1911 results, configured to fail if != 0
[0m13:38:30.262523 [info ] [MainThread]: 
[0m13:38:30.262957 [info ] [MainThread]:   compiled code at target/compiled/olist_dataset/models/schema.yml/relationships_fact_order_items_40f3126aaf69b9319cf8a1bfc6dfca58.sql
[0m13:38:30.263362 [info ] [MainThread]: 
[0m13:38:30.263750 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m13:38:30.264441 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 17.87619, "process_in_blocks": "1440", "process_kernel_time": 1.179774, "process_mem_max_rss": "254488", "process_out_blocks": "2728", "process_user_time": 3.506942}
[0m13:38:30.264933 [debug] [MainThread]: Command `dbt test` failed at 13:38:30.264821 after 17.88 seconds
[0m13:38:30.265415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe54f0b1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe54f0e8f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51d0e0ca0>]}
[0m13:38:30.265875 [debug] [MainThread]: Flushing usage events
[0m13:38:31.231813 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:45.075935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a36c39de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a35b514e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a35b51480>]}


============================== 13:39:45.078409 | 0b026008-8946-4091-80ac-6eefe458bf04 ==============================
[0m13:39:45.078409 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:39:45.078887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_order_items', 'send_anonymous_usage_stats': 'True'}
[0m13:39:46.087831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b026008-8946-4091-80ac-6eefe458bf04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a07cc63e0>]}
[0m13:39:46.162721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b026008-8946-4091-80ac-6eefe458bf04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a35b673a0>]}
[0m13:39:46.163575 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:39:46.296934 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:39:46.527018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:39:46.527565 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:39:46.594998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b026008-8946-4091-80ac-6eefe458bf04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a077fcb50>]}
[0m13:39:46.697408 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:39:46.698946 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:39:46.710421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b026008-8946-4091-80ac-6eefe458bf04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0778f3d0>]}
[0m13:39:46.711019 [info ] [MainThread]: Found 3 snapshots, 6 models, 33 data tests, 9 sources, 491 macros
[0m13:39:46.711406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b026008-8946-4091-80ac-6eefe458bf04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0778eb60>]}
[0m13:39:46.712971 [info ] [MainThread]: 
[0m13:39:46.713393 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:39:46.713679 [info ] [MainThread]: 
[0m13:39:46.714152 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:39:46.716216 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m13:39:46.716909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:47.883074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m13:39:47.884319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:48.224663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m13:39:48.225720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:48.671106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:39:48.673363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:49.026983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b026008-8946-4091-80ac-6eefe458bf04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a35b652a0>]}
[0m13:39:49.028224 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:39:49.034421 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m13:39:49.035671 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m13:39:49.036797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now model.olist_dataset.fact_order_items)
[0m13:39:49.037612 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m13:39:49.063065 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m13:39:49.063823 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m13:39:49.116509 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m13:39:49.117322 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
      
    
    

    OPTIONS()
    as (
      -- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    LEFT JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order item id that already in fact_order_item table
-- which assume data already in table never change

-- 
    );
  
[0m13:39:49.117792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:49.670778 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:8e940734-5479-464b-bf19-1fcb811850a8&page=queryresults
[0m13:39:53.998548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b026008-8946-4091-80ac-6eefe458bf04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a077fda50>]}
[0m13:39:53.999333 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mCREATE TABLE (112.7k rows, 27.9 MiB processed)[0m in 4.96s]
[0m13:39:53.999921 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m13:39:54.002713 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:39:54.003481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:54.003839 [debug] [MainThread]: Connection 'model.olist_dataset.fact_order_items' was properly closed.
[0m13:39:54.004187 [info ] [MainThread]: 
[0m13:39:54.004539 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.29 seconds (7.29s).
[0m13:39:54.005186 [debug] [MainThread]: Command end result
[0m13:39:54.030882 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:39:54.032631 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:39:54.038076 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:39:54.038398 [info ] [MainThread]: 
[0m13:39:54.038804 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:39:54.039090 [info ] [MainThread]: 
[0m13:39:54.039404 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:39:54.039882 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.020747, "process_in_blocks": "0", "process_kernel_time": 1.172939, "process_mem_max_rss": "255052", "process_out_blocks": "2584", "process_user_time": 3.398517}
[0m13:39:54.040239 [debug] [MainThread]: Command `dbt run` succeeded at 13:39:54.040155 after 9.02 seconds
[0m13:39:54.040559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a36c39de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a07cc63e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a077c3730>]}
[0m13:39:54.040924 [debug] [MainThread]: Flushing usage events
[0m13:39:54.979641 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:56.584133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce87321e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce86259660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce86259600>]}


============================== 13:39:56.586467 | a2ce2acc-cf25-493e-8f4a-9f387bd897b4 ==============================
[0m13:39:56.586467 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:39:56.586946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'debug': 'False', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --models fact_order_items', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:39:57.493392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2ce2acc-cf25-493e-8f4a-9f387bd897b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5c28c280>]}
[0m13:39:57.560427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2ce2acc-cf25-493e-8f4a-9f387bd897b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5c3860b0>]}
[0m13:39:57.561214 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:39:57.661123 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:39:57.859196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:39:57.859683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:39:57.914904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2ce2acc-cf25-493e-8f4a-9f387bd897b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce57d1cd00>]}
[0m13:39:58.010817 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:39:58.013428 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:39:58.037353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2ce2acc-cf25-493e-8f4a-9f387bd897b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce57d1c850>]}
[0m13:39:58.037962 [info ] [MainThread]: Found 3 snapshots, 6 models, 33 data tests, 9 sources, 491 macros
[0m13:39:58.038387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2ce2acc-cf25-493e-8f4a-9f387bd897b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5c7d6dd0>]}
[0m13:39:58.040147 [info ] [MainThread]: 
[0m13:39:58.040555 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:39:58.040875 [info ] [MainThread]: 
[0m13:39:58.041455 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:39:58.046532 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_ingestion_fact_tables'
[0m13:39:58.047325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:58.964714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m13:39:58.966914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:00.000132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m13:40:00.002580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:00.380163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2ce2acc-cf25-493e-8f4a-9f387bd897b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce883dde70>]}
[0m13:40:00.381327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:40:00.387262 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:40:00.388065 [info ] [Thread-1 (]: 1 of 8 START test not_null_fact_order_items_order_id ........................... [RUN]
[0m13:40:00.388984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e)
[0m13:40:00.389624 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:40:00.410963 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e"
[0m13:40:00.411754 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:40:00.426700 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e"
[0m13:40:00.427562 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where order_id is null



      
    ) dbt_internal_test
[0m13:40:00.428015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:01.033814 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:6d6538c5-71f3-4997-bc9b-7c15afc79cce&page=queryresults
[0m13:40:02.107703 [info ] [Thread-1 (]: 1 of 8 PASS not_null_fact_order_items_order_id ................................. [[32mPASS[0m in 1.72s]
[0m13:40:02.109565 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:40:02.110644 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:40:02.112642 [info ] [Thread-1 (]: 2 of 8 START test not_null_fact_order_items_order_id_item ...................... [RUN]
[0m13:40:02.114689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e, now test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8)
[0m13:40:02.115927 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:40:02.122586 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8"
[0m13:40:02.123421 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:40:02.125719 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8"
[0m13:40:02.126264 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id_item
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where order_id_item is null



      
    ) dbt_internal_test
[0m13:40:02.126644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:02.827780 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:9d52111d-ece3-49dc-bad0-1eab636da351&page=queryresults
[0m13:40:03.790771 [info ] [Thread-1 (]: 2 of 8 PASS not_null_fact_order_items_order_id_item ............................ [[32mPASS[0m in 1.68s]
[0m13:40:03.792345 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:40:03.793258 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:40:03.794078 [info ] [Thread-1 (]: 3 of 8 START test not_null_fact_order_items_product_id ......................... [RUN]
[0m13:40:03.795221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8, now test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9)
[0m13:40:03.796075 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:40:03.805439 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9"
[0m13:40:03.806418 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:40:03.809390 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9"
[0m13:40:03.810075 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where product_id is null



      
    ) dbt_internal_test
[0m13:40:03.810498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:04.464193 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:78c73f0b-7bde-4f5c-b769-0e8e2e44543e&page=queryresults
[0m13:40:05.402252 [info ] [Thread-1 (]: 3 of 8 PASS not_null_fact_order_items_product_id ............................... [[32mPASS[0m in 1.61s]
[0m13:40:05.404078 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:40:05.405875 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:40:05.407876 [info ] [Thread-1 (]: 4 of 8 START test not_null_fact_order_items_seller_id .......................... [RUN]
[0m13:40:05.409741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9, now test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883)
[0m13:40:05.410928 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:40:05.420779 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883"
[0m13:40:05.421950 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:40:05.427722 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883"
[0m13:40:05.428656 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where seller_id is null



      
    ) dbt_internal_test
[0m13:40:05.429192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:06.003659 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:f787c52f-ba37-459b-9b19-1a9fab071f1b&page=queryresults
[0m13:40:06.998077 [info ] [Thread-1 (]: 4 of 8 PASS not_null_fact_order_items_seller_id ................................ [[32mPASS[0m in 1.59s]
[0m13:40:06.999699 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:40:07.000549 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:40:07.001285 [info ] [Thread-1 (]: 5 of 8 START test relationships_fact_order_items_order_id__order_id__ref_fact_orders_  [RUN]
[0m13:40:07.002398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883, now test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74)
[0m13:40:07.003820 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:40:07.019565 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"
[0m13:40:07.020534 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:40:07.023079 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"
[0m13:40:07.023663 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:40:07.024047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:08.207410 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:edd51bf7-fc2b-487d-94df-c2a521cafa3a&page=queryresults
[0m13:40:09.165810 [error] [Thread-1 (]: 5 of 8 FAIL 1911 relationships_fact_order_items_order_id__order_id__ref_fact_orders_  [[31mFAIL 1911[0m in 2.16s]
[0m13:40:09.167148 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:40:09.167942 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:40:09.168677 [info ] [Thread-1 (]: 6 of 8 START test relationships_fact_order_items_product_id__product_id__ref_dim_product_  [RUN]
[0m13:40:09.169624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74, now test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428)
[0m13:40:09.170930 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:40:09.183270 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"
[0m13:40:09.184368 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:40:09.188796 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"
[0m13:40:09.189767 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:40:09.190425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:10.047319 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d69a0401-84cc-46f2-968b-c653fb5cc053&page=queryresults
[0m13:40:10.990002 [info ] [Thread-1 (]: 6 of 8 PASS relationships_fact_order_items_product_id__product_id__ref_dim_product_  [[32mPASS[0m in 1.82s]
[0m13:40:10.991527 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:40:10.991972 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:40:10.992356 [info ] [Thread-1 (]: 7 of 8 START test relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_  [RUN]
[0m13:40:10.992952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428, now test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1)
[0m13:40:10.993343 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:40:10.998838 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1"
[0m13:40:10.999653 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:40:11.002922 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1"
[0m13:40:11.003552 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select seller_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
    where seller_id is not null
),

parent as (
    select seller_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:40:11.003944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:11.660439 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:9b57e551-c944-40e4-9dac-2f10c68d52a3&page=queryresults
[0m13:40:12.598507 [info ] [Thread-1 (]: 7 of 8 PASS relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_  [[32mPASS[0m in 1.61s]
[0m13:40:12.599901 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:40:12.600667 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:40:12.601469 [info ] [Thread-1 (]: 8 of 8 START test unique_fact_order_items_order_id_item ........................ [RUN]
[0m13:40:12.602382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1, now test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c)
[0m13:40:12.603682 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:40:12.616209 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c"
[0m13:40:12.617365 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:40:12.621280 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c"
[0m13:40:12.622388 [debug] [Thread-1 (]: On test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id_item as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
  where order_id_item is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:40:12.623114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:13.386380 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:7603aa06-8823-42fa-a5e7-1cb0f1b5d3fd&page=queryresults
[0m13:40:14.351876 [info ] [Thread-1 (]: 8 of 8 PASS unique_fact_order_items_order_id_item .............................. [[32mPASS[0m in 1.75s]
[0m13:40:14.354360 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:40:14.362840 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:40:14.365249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:14.366192 [debug] [MainThread]: Connection 'test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c' was properly closed.
[0m13:40:14.367041 [info ] [MainThread]: 
[0m13:40:14.367996 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 16.33 seconds (16.33s).
[0m13:40:14.371893 [debug] [MainThread]: Command end result
[0m13:40:14.427143 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:40:14.429463 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:40:14.445677 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:40:14.446354 [info ] [MainThread]: 
[0m13:40:14.446988 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:40:14.447545 [info ] [MainThread]: 
[0m13:40:14.448219 [error] [MainThread]: [31mFailure in test relationships_fact_order_items_order_id__order_id__ref_fact_orders_ (models/schema.yml)[0m
[0m13:40:14.448779 [error] [MainThread]:   Got 1911 results, configured to fail if != 0
[0m13:40:14.449189 [info ] [MainThread]: 
[0m13:40:14.451067 [info ] [MainThread]:   compiled code at target/compiled/olist_dataset/models/schema.yml/relationships_fact_order_items_40f3126aaf69b9319cf8a1bfc6dfca58.sql
[0m13:40:14.451733 [info ] [MainThread]: 
[0m13:40:14.453020 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m13:40:14.453843 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 17.925634, "process_in_blocks": "8", "process_kernel_time": 1.077961, "process_mem_max_rss": "254648", "process_out_blocks": "2720", "process_user_time": 3.588633}
[0m13:40:14.454377 [debug] [MainThread]: Command `dbt test` failed at 13:40:14.454245 after 17.93 seconds
[0m13:40:14.454904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce87321e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce86fc2a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce55319270>]}
[0m13:40:14.455391 [debug] [MainThread]: Flushing usage events
[0m13:40:15.413756 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:43:09.761985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bb121e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ba1115a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ba111540>]}


============================== 13:43:09.764410 | f40f3246-b398-4387-8d6e-e31458df26d6 ==============================
[0m13:43:09.764410 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:43:09.764890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_order_items', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:43:10.752670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f40f3246-b398-4387-8d6e-e31458df26d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa790346770>]}
[0m13:43:10.820564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f40f3246-b398-4387-8d6e-e31458df26d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7902bf640>]}
[0m13:43:10.821355 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:43:10.921137 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:43:11.127359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:43:11.128073 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/fact/fact_order_items.sql
[0m13:43:11.611528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f40f3246-b398-4387-8d6e-e31458df26d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78b9d0fa0>]}
[0m13:43:11.703313 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:43:11.704827 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:43:11.720395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f40f3246-b398-4387-8d6e-e31458df26d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78b9d3f10>]}
[0m13:43:11.720976 [info ] [MainThread]: Found 3 snapshots, 6 models, 33 data tests, 9 sources, 491 macros
[0m13:43:11.721356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f40f3246-b398-4387-8d6e-e31458df26d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78b9d2500>]}
[0m13:43:11.722912 [info ] [MainThread]: 
[0m13:43:11.723308 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:43:11.723623 [info ] [MainThread]: 
[0m13:43:11.724097 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:43:11.725398 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m13:43:11.726336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:12.733026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m13:43:12.734563 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:13.070382 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m13:43:13.073034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:13.417687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:43:13.419669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:13.801454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f40f3246-b398-4387-8d6e-e31458df26d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bc2f60b0>]}
[0m13:43:13.802788 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:13.809642 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m13:43:13.810924 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m13:43:13.812477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now model.olist_dataset.fact_order_items)
[0m13:43:13.813650 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m13:43:13.836404 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m13:43:13.837291 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m13:43:13.867858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:14.282333 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m13:43:14.283199 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
    WHERE order_status IN ('delivered', 'canceled')  -- Only include order that has finalized, delivered or cancelled
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    LEFT JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order item id that already in fact_order_item table
-- which assume data already in table never change

-- 
--   WHERE order_id_item NOT IN (SELECT order_id_item FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id_item = DBT_INTERNAL_DEST.order_id_item))

    
    when matched then update set
        `customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_id` = DBT_INTERNAL_SOURCE.`order_id`,`order_item_id` = DBT_INTERNAL_SOURCE.`order_item_id`,`product_id` = DBT_INTERNAL_SOURCE.`product_id`,`seller_id` = DBT_INTERNAL_SOURCE.`seller_id`,`price` = DBT_INTERNAL_SOURCE.`price`,`freight_value` = DBT_INTERNAL_SOURCE.`freight_value`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`order_id_item` = DBT_INTERNAL_SOURCE.`order_id_item`
    

    when not matched then insert
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)
    values
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)


    
[0m13:43:15.011501 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:fd45f937-c4b2-436b-9d21-71de5902f870&page=queryresults
[0m13:43:21.679957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f40f3246-b398-4387-8d6e-e31458df26d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bb79d660>]}
[0m13:43:21.680684 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mMERGE (112.7k rows, 59.0 MiB processed)[0m in 7.87s]
[0m13:43:21.681258 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m13:43:21.683644 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:43:21.684366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:21.684696 [debug] [MainThread]: Connection 'model.olist_dataset.fact_order_items' was properly closed.
[0m13:43:21.685004 [info ] [MainThread]: 
[0m13:43:21.685341 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.96 seconds (9.96s).
[0m13:43:21.685907 [debug] [MainThread]: Command end result
[0m13:43:21.710355 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:43:21.711924 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:43:21.717092 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:43:21.717497 [info ] [MainThread]: 
[0m13:43:21.717877 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:43:21.718194 [info ] [MainThread]: 
[0m13:43:21.718483 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:43:21.718971 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.014825, "process_in_blocks": "0", "process_kernel_time": 1.195972, "process_mem_max_rss": "258592", "process_out_blocks": "3736", "process_user_time": 3.632708}
[0m13:43:21.719350 [debug] [MainThread]: Command `dbt run` succeeded at 13:43:21.719264 after 12.02 seconds
[0m13:43:21.719678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bb121e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78ba1e8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7baea1840>]}
[0m13:43:21.720022 [debug] [MainThread]: Flushing usage events
[0m13:43:22.751917 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:43:24.328384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a95b31de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a94a65600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a94a655a0>]}


============================== 13:43:24.330601 | 0f8f2a34-d3c8-426b-b9e3-4fe262dc6ff2 ==============================
[0m13:43:24.330601 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:43:24.331054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'profiles_dir': '/home/kangh/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --models fact_order_items', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:43:25.220583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f8f2a34-d3c8-426b-b9e3-4fe262dc6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a66c630a0>]}
[0m13:43:25.285458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f8f2a34-d3c8-426b-b9e3-4fe262dc6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a66aa0f10>]}
[0m13:43:25.286194 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:43:25.387969 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:43:25.592496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:43:25.592947 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:43:25.647753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f8f2a34-d3c8-426b-b9e3-4fe262dc6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a665acc70>]}
[0m13:43:25.743181 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:43:25.744752 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:43:25.770194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f8f2a34-d3c8-426b-b9e3-4fe262dc6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a665ae3b0>]}
[0m13:43:25.770817 [info ] [MainThread]: Found 3 snapshots, 6 models, 33 data tests, 9 sources, 491 macros
[0m13:43:25.771215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f8f2a34-d3c8-426b-b9e3-4fe262dc6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a66fe6d40>]}
[0m13:43:25.773227 [info ] [MainThread]: 
[0m13:43:25.774109 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:43:25.775084 [info ] [MainThread]: 
[0m13:43:25.775654 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:43:25.780729 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_ingestion_dim_tables'
[0m13:43:25.781593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:26.817317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:43:26.819889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:27.188361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m13:43:27.190516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:27.594233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f8f2a34-d3c8-426b-b9e3-4fe262dc6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a96be9d80>]}
[0m13:43:27.595541 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:27.602532 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:43:27.603533 [info ] [Thread-1 (]: 1 of 8 START test not_null_fact_order_items_order_id ........................... [RUN]
[0m13:43:27.604647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e)
[0m13:43:27.605427 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:43:27.628666 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e"
[0m13:43:27.629314 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:43:27.644226 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e"
[0m13:43:27.645022 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where order_id is null



      
    ) dbt_internal_test
[0m13:43:27.645451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:28.235922 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:c34b0b50-512b-472b-811e-b7b93c1ca714&page=queryresults
[0m13:43:29.219192 [info ] [Thread-1 (]: 1 of 8 PASS not_null_fact_order_items_order_id ................................. [[32mPASS[0m in 1.61s]
[0m13:43:29.220509 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:43:29.221286 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:43:29.222435 [info ] [Thread-1 (]: 2 of 8 START test not_null_fact_order_items_order_id_item ...................... [RUN]
[0m13:43:29.223367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e, now test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8)
[0m13:43:29.224072 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:43:29.230994 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8"
[0m13:43:29.231718 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:43:29.234022 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8"
[0m13:43:29.234580 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id_item
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where order_id_item is null



      
    ) dbt_internal_test
[0m13:43:29.235102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:29.893566 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:1306debb-70ed-44f7-bd11-63645b5acda9&page=queryresults
[0m13:43:31.031121 [info ] [Thread-1 (]: 2 of 8 PASS not_null_fact_order_items_order_id_item ............................ [[32mPASS[0m in 1.81s]
[0m13:43:31.032516 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:43:31.033291 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:43:31.033990 [info ] [Thread-1 (]: 3 of 8 START test not_null_fact_order_items_product_id ......................... [RUN]
[0m13:43:31.035315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8, now test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9)
[0m13:43:31.036217 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:43:31.046249 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9"
[0m13:43:31.048281 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:43:31.053498 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9"
[0m13:43:31.054619 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where product_id is null



      
    ) dbt_internal_test
[0m13:43:31.055246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:31.689728 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:1bf1acd9-4152-4d37-af22-ea310200f3bb&page=queryresults
[0m13:43:32.656435 [info ] [Thread-1 (]: 3 of 8 PASS not_null_fact_order_items_product_id ............................... [[32mPASS[0m in 1.62s]
[0m13:43:32.658017 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:43:32.658926 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:43:32.659724 [info ] [Thread-1 (]: 4 of 8 START test not_null_fact_order_items_seller_id .......................... [RUN]
[0m13:43:32.661603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9, now test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883)
[0m13:43:32.662683 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:43:32.672577 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883"
[0m13:43:32.673434 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:43:32.677522 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883"
[0m13:43:32.678167 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where seller_id is null



      
    ) dbt_internal_test
[0m13:43:32.678561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:33.235771 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:979ae981-de0d-4a0d-ac95-d62ecb03c653&page=queryresults
[0m13:43:34.190292 [info ] [Thread-1 (]: 4 of 8 PASS not_null_fact_order_items_seller_id ................................ [[32mPASS[0m in 1.53s]
[0m13:43:34.192186 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:43:34.193205 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:43:34.193841 [info ] [Thread-1 (]: 5 of 8 START test relationships_fact_order_items_order_id__order_id__ref_fact_orders_  [RUN]
[0m13:43:34.194829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883, now test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74)
[0m13:43:34.195422 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:43:34.215522 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"
[0m13:43:34.217699 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:43:34.222816 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"
[0m13:43:34.224056 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:43:34.225258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:35.156630 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:e8730dbe-ebc3-4956-983a-da2068c50dd8&page=queryresults
[0m13:43:36.094001 [error] [Thread-1 (]: 5 of 8 FAIL 1911 relationships_fact_order_items_order_id__order_id__ref_fact_orders_  [[31mFAIL 1911[0m in 1.90s]
[0m13:43:36.095535 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:43:36.096337 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:43:36.097172 [info ] [Thread-1 (]: 6 of 8 START test relationships_fact_order_items_product_id__product_id__ref_dim_product_  [RUN]
[0m13:43:36.098146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74, now test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428)
[0m13:43:36.098961 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:43:36.111578 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"
[0m13:43:36.112589 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:43:36.115909 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"
[0m13:43:36.116933 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:43:36.117602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:36.983675 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:d03666bf-8a94-458a-ac3b-9287b474f12f&page=queryresults
[0m13:43:37.920433 [info ] [Thread-1 (]: 6 of 8 PASS relationships_fact_order_items_product_id__product_id__ref_dim_product_  [[32mPASS[0m in 1.82s]
[0m13:43:37.922242 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:43:37.923331 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:43:37.927161 [info ] [Thread-1 (]: 7 of 8 START test relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_  [RUN]
[0m13:43:37.928886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428, now test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1)
[0m13:43:37.930159 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:43:37.942866 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1"
[0m13:43:37.943768 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:43:37.947820 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1"
[0m13:43:37.948509 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select seller_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
    where seller_id is not null
),

parent as (
    select seller_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:43:37.948950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:38.637719 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:f8313fd8-fdd8-4913-b177-5269365925c3&page=queryresults
[0m13:43:39.546366 [info ] [Thread-1 (]: 7 of 8 PASS relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_  [[32mPASS[0m in 1.62s]
[0m13:43:39.547887 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:43:39.548711 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:43:39.549510 [info ] [Thread-1 (]: 8 of 8 START test unique_fact_order_items_order_id_item ........................ [RUN]
[0m13:43:39.550488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1, now test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c)
[0m13:43:39.551313 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:43:39.564172 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c"
[0m13:43:39.565075 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:43:39.567683 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c"
[0m13:43:39.568295 [debug] [Thread-1 (]: On test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id_item as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
  where order_id_item is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:43:39.568685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:40.378138 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:bcded576-a425-4506-b567-82d1d9200942&page=queryresults
[0m13:43:41.336461 [info ] [Thread-1 (]: 8 of 8 PASS unique_fact_order_items_order_id_item .............................. [[32mPASS[0m in 1.79s]
[0m13:43:41.338340 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:43:41.342732 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:43:41.344268 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:41.344976 [debug] [MainThread]: Connection 'test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c' was properly closed.
[0m13:43:41.345686 [info ] [MainThread]: 
[0m13:43:41.346468 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 15.57 seconds (15.57s).
[0m13:43:41.349311 [debug] [MainThread]: Command end result
[0m13:43:41.399425 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:43:41.402499 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:43:41.413478 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:43:41.413946 [info ] [MainThread]: 
[0m13:43:41.414426 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:43:41.414860 [info ] [MainThread]: 
[0m13:43:41.415338 [error] [MainThread]: [31mFailure in test relationships_fact_order_items_order_id__order_id__ref_fact_orders_ (models/schema.yml)[0m
[0m13:43:41.415923 [error] [MainThread]:   Got 1911 results, configured to fail if != 0
[0m13:43:41.417383 [info ] [MainThread]: 
[0m13:43:41.418351 [info ] [MainThread]:   compiled code at target/compiled/olist_dataset/models/schema.yml/relationships_fact_order_items_40f3126aaf69b9319cf8a1bfc6dfca58.sql
[0m13:43:41.418794 [info ] [MainThread]: 
[0m13:43:41.420071 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m13:43:41.420910 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 17.151598, "process_in_blocks": "0", "process_kernel_time": 1.012989, "process_mem_max_rss": "255836", "process_out_blocks": "2728", "process_user_time": 3.606242}
[0m13:43:41.421466 [debug] [MainThread]: Command `dbt test` failed at 13:43:41.421315 after 17.15 seconds
[0m13:43:41.421983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a95b31de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a957dabf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a6427db40>]}
[0m13:43:41.422457 [debug] [MainThread]: Flushing usage events
[0m13:43:42.392746 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:17.544178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7509a51e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7508969540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75089694e0>]}


============================== 13:44:17.546492 | 9bf42b6f-b661-46f6-8b15-429781be1f8f ==============================
[0m13:44:17.546492 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:44:17.546959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'profiles_dir': '/home/kangh/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_order_items', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:44:18.542043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bf42b6f-b661-46f6-8b15-429781be1f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750aa84f40>]}
[0m13:44:18.608976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bf42b6f-b661-46f6-8b15-429781be1f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7508fb0cd0>]}
[0m13:44:18.609722 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:44:18.710029 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:44:18.908258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:18.908743 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:18.963734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bf42b6f-b661-46f6-8b15-429781be1f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74da4a8b80>]}
[0m13:44:19.060532 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:44:19.062311 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:44:19.074021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bf42b6f-b661-46f6-8b15-429781be1f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74da4a8610>]}
[0m13:44:19.074597 [info ] [MainThread]: Found 3 snapshots, 6 models, 33 data tests, 9 sources, 491 macros
[0m13:44:19.074979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bf42b6f-b661-46f6-8b15-429781be1f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750a001ae0>]}
[0m13:44:19.076447 [info ] [MainThread]: 
[0m13:44:19.076874 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:44:19.077205 [info ] [MainThread]: 
[0m13:44:19.077694 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:44:19.079046 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m13:44:19.079711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:20.117421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m13:44:20.119200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:20.502891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:44:20.505547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:20.887806 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m13:44:20.889527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:21.360035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bf42b6f-b661-46f6-8b15-429781be1f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7508979870>]}
[0m13:44:21.361637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:21.368877 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m13:44:21.370309 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m13:44:21.371635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now model.olist_dataset.fact_order_items)
[0m13:44:21.372542 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m13:44:21.396666 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m13:44:21.397506 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m13:44:21.450527 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m13:44:21.451429 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
      
    
    

    OPTIONS()
    as (
      -- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
    WHERE order_status IN ('delivered', 'canceled')  -- Only include order that has finalized, delivered or cancelled
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    LEFT JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order item id that already in fact_order_item table
-- which assume data already in table never change

-- 
    );
  
[0m13:44:21.452003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:22.043021 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:5d228443-ccdc-42cd-8a75-8aa4ceb50c66&page=queryresults
[0m13:44:27.333787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf42b6f-b661-46f6-8b15-429781be1f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74da66ad70>]}
[0m13:44:27.334572 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mCREATE TABLE (112.7k rows, 28.9 MiB processed)[0m in 5.96s]
[0m13:44:27.335258 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m13:44:27.337520 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:44:27.338691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:27.339087 [debug] [MainThread]: Connection 'model.olist_dataset.fact_order_items' was properly closed.
[0m13:44:27.339432 [info ] [MainThread]: 
[0m13:44:27.339764 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.26 seconds (8.26s).
[0m13:44:27.340410 [debug] [MainThread]: Command end result
[0m13:44:27.365249 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:44:27.367067 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:44:27.373134 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:44:27.373540 [info ] [MainThread]: 
[0m13:44:27.373948 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:44:27.374266 [info ] [MainThread]: 
[0m13:44:27.374562 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:44:27.375144 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.890099, "process_in_blocks": "0", "process_kernel_time": 1.126502, "process_mem_max_rss": "247824", "process_out_blocks": "2592", "process_user_time": 3.329216}
[0m13:44:27.375572 [debug] [MainThread]: Command `dbt run` succeeded at 13:44:27.375479 after 9.89 seconds
[0m13:44:27.375959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7509a51e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750aa84f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74da4a8700>]}
[0m13:44:27.376316 [debug] [MainThread]: Flushing usage events
[0m13:44:28.317764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:29.824720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff91efd5e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff91df1d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff91df1d630>]}


============================== 13:44:29.826952 | bde308b2-eecf-4f0c-bf73-99e2c6693fe1 ==============================
[0m13:44:29.826952 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:44:29.827446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --models fact_order_items', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:44:30.779595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bde308b2-eecf-4f0c-bf73-99e2c6693fe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff920020f10>]}
[0m13:44:30.844990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bde308b2-eecf-4f0c-bf73-99e2c6693fe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff91df335b0>]}
[0m13:44:30.845718 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:44:30.945135 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:44:31.150576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:31.151024 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:31.205417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bde308b2-eecf-4f0c-bf73-99e2c6693fe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8efa00d30>]}
[0m13:44:31.299436 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:44:31.301015 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:44:31.323997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bde308b2-eecf-4f0c-bf73-99e2c6693fe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8efb8efb0>]}
[0m13:44:31.324627 [info ] [MainThread]: Found 3 snapshots, 6 models, 33 data tests, 9 sources, 491 macros
[0m13:44:31.325029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bde308b2-eecf-4f0c-bf73-99e2c6693fe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f445edd0>]}
[0m13:44:31.326842 [info ] [MainThread]: 
[0m13:44:31.327339 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:44:31.327651 [info ] [MainThread]: 
[0m13:44:31.328195 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:44:31.333122 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_ingestion_dim_tables'
[0m13:44:31.334200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:32.270879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:44:32.271823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:32.598228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m13:44:32.600133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:32.906577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bde308b2-eecf-4f0c-bf73-99e2c6693fe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff91ee001c0>]}
[0m13:44:32.907685 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:32.913595 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:44:32.914482 [info ] [Thread-1 (]: 1 of 8 START test not_null_fact_order_items_order_id ........................... [RUN]
[0m13:44:32.915435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e)
[0m13:44:32.916128 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:44:32.938459 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e"
[0m13:44:32.939144 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:44:32.954240 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e"
[0m13:44:32.955047 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where order_id is null



      
    ) dbt_internal_test
[0m13:44:32.955502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:33.714025 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:2098788d-5692-4956-8a40-8524de10beec&page=queryresults
[0m13:44:34.671941 [info ] [Thread-1 (]: 1 of 8 PASS not_null_fact_order_items_order_id ................................. [[32mPASS[0m in 1.76s]
[0m13:44:34.673250 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:44:34.674912 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:44:34.676499 [info ] [Thread-1 (]: 2 of 8 START test not_null_fact_order_items_order_id_item ...................... [RUN]
[0m13:44:34.678030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e, now test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8)
[0m13:44:34.678886 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:44:34.685371 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8"
[0m13:44:34.686078 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:44:34.688329 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8"
[0m13:44:34.689017 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id_item
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where order_id_item is null



      
    ) dbt_internal_test
[0m13:44:34.689401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:35.299532 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:f1f625f0-517e-471b-b4a5-8e45595585e4&page=queryresults
[0m13:44:36.273313 [info ] [Thread-1 (]: 2 of 8 PASS not_null_fact_order_items_order_id_item ............................ [[32mPASS[0m in 1.60s]
[0m13:44:36.274678 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:44:36.275473 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:44:36.276239 [info ] [Thread-1 (]: 3 of 8 START test not_null_fact_order_items_product_id ......................... [RUN]
[0m13:44:36.277598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8, now test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9)
[0m13:44:36.278479 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:44:36.287364 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9"
[0m13:44:36.288362 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:44:36.291703 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9"
[0m13:44:36.292413 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where product_id is null



      
    ) dbt_internal_test
[0m13:44:36.292903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:36.923540 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:ba2af35c-3e45-4d6c-8322-623cb00e8361&page=queryresults
[0m13:44:37.832924 [info ] [Thread-1 (]: 3 of 8 PASS not_null_fact_order_items_product_id ............................... [[32mPASS[0m in 1.56s]
[0m13:44:37.834824 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:44:37.835931 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:44:37.837598 [info ] [Thread-1 (]: 4 of 8 START test not_null_fact_order_items_seller_id .......................... [RUN]
[0m13:44:37.839250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9, now test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883)
[0m13:44:37.840312 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:44:37.847518 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883"
[0m13:44:37.848823 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:44:37.853120 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883"
[0m13:44:37.853860 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where seller_id is null



      
    ) dbt_internal_test
[0m13:44:37.854327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:38.444133 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:68906dae-da8d-4342-ad51-d3343a933bc5&page=queryresults
[0m13:44:39.343890 [info ] [Thread-1 (]: 4 of 8 PASS not_null_fact_order_items_seller_id ................................ [[32mPASS[0m in 1.50s]
[0m13:44:39.345525 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:44:39.346471 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:44:39.347623 [info ] [Thread-1 (]: 5 of 8 START test relationships_fact_order_items_order_id__order_id__ref_fact_orders_  [RUN]
[0m13:44:39.348809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883, now test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74)
[0m13:44:39.349727 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:44:39.366999 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"
[0m13:44:39.369469 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:44:39.376386 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"
[0m13:44:39.377731 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:44:39.378700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:40.316869 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:bab56879-c6b5-44bd-b574-1e0fb42712a4&page=queryresults
[0m13:44:41.307190 [error] [Thread-1 (]: 5 of 8 FAIL 1911 relationships_fact_order_items_order_id__order_id__ref_fact_orders_  [[31mFAIL 1911[0m in 1.96s]
[0m13:44:41.308752 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:44:41.309623 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:44:41.310433 [info ] [Thread-1 (]: 6 of 8 START test relationships_fact_order_items_product_id__product_id__ref_dim_product_  [RUN]
[0m13:44:41.311541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74, now test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428)
[0m13:44:41.313021 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:44:41.324971 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"
[0m13:44:41.325822 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:44:41.328457 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"
[0m13:44:41.329070 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:44:41.329511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:42.128222 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:44a42810-7667-4fe3-a494-80fd8194844b&page=queryresults
[0m13:44:43.039451 [info ] [Thread-1 (]: 6 of 8 PASS relationships_fact_order_items_product_id__product_id__ref_dim_product_  [[32mPASS[0m in 1.73s]
[0m13:44:43.040714 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:44:43.041408 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:44:43.042069 [info ] [Thread-1 (]: 7 of 8 START test relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_  [RUN]
[0m13:44:43.043535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428, now test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1)
[0m13:44:43.044157 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:44:43.049952 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1"
[0m13:44:43.050615 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:44:43.053908 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1"
[0m13:44:43.054468 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select seller_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
    where seller_id is not null
),

parent as (
    select seller_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:44:43.054851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:43.788494 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:de56a27a-3035-4446-a3ce-786b37d8dcd4&page=queryresults
[0m13:44:44.739713 [info ] [Thread-1 (]: 7 of 8 PASS relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_  [[32mPASS[0m in 1.70s]
[0m13:44:44.741056 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:44:44.741862 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:44:44.742585 [info ] [Thread-1 (]: 8 of 8 START test unique_fact_order_items_order_id_item ........................ [RUN]
[0m13:44:44.743478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1, now test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c)
[0m13:44:44.744202 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:44:44.757758 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c"
[0m13:44:44.758909 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:44:44.762445 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c"
[0m13:44:44.763192 [debug] [Thread-1 (]: On test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id_item as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
  where order_id_item is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:44:44.763617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:45.462162 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:32f500c1-7c4f-469a-a750-becd7360d5b0&page=queryresults
[0m13:44:46.424962 [info ] [Thread-1 (]: 8 of 8 PASS unique_fact_order_items_order_id_item .............................. [[32mPASS[0m in 1.68s]
[0m13:44:46.426651 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:44:46.430991 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:44:46.433300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:46.434171 [debug] [MainThread]: Connection 'test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c' was properly closed.
[0m13:44:46.435207 [info ] [MainThread]: 
[0m13:44:46.436041 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 15.11 seconds (15.11s).
[0m13:44:46.439577 [debug] [MainThread]: Command end result
[0m13:44:46.490351 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:44:46.493019 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:44:46.502635 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:44:46.503390 [info ] [MainThread]: 
[0m13:44:46.503958 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:44:46.504842 [info ] [MainThread]: 
[0m13:44:46.507200 [error] [MainThread]: [31mFailure in test relationships_fact_order_items_order_id__order_id__ref_fact_orders_ (models/schema.yml)[0m
[0m13:44:46.508347 [error] [MainThread]:   Got 1911 results, configured to fail if != 0
[0m13:44:46.509372 [info ] [MainThread]: 
[0m13:44:46.510285 [info ] [MainThread]:   compiled code at target/compiled/olist_dataset/models/schema.yml/relationships_fact_order_items_40f3126aaf69b9319cf8a1bfc6dfca58.sql
[0m13:44:46.511315 [info ] [MainThread]: 
[0m13:44:46.512188 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m13:44:46.513252 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 16.74541, "process_in_blocks": "0", "process_kernel_time": 1.258483, "process_mem_max_rss": "252512", "process_out_blocks": "2728", "process_user_time": 3.400225}
[0m13:44:46.513758 [debug] [MainThread]: Command `dbt test` failed at 13:44:46.513638 after 16.75 seconds
[0m13:44:46.514237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff91efd5e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff91ec85840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ed141bd0>]}
[0m13:44:46.514725 [debug] [MainThread]: Flushing usage events
[0m13:44:47.489439 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:48:11.763009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f0c99db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70efbad450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70efbad3f0>]}


============================== 13:48:11.765294 | 9d6d5f07-4064-4e3d-b1b3-07b39d753eea ==============================
[0m13:48:11.765294 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:48:11.765764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/kangh/.dbt', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fact_order_items', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:48:12.767757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d6d5f07-4064-4e3d-b1b3-07b39d753eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f08f2050>]}
[0m13:48:12.834321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d6d5f07-4064-4e3d-b1b3-07b39d753eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f08f01f0>]}
[0m13:48:12.835000 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:48:12.933947 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:48:13.135390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:48:13.136361 [debug] [MainThread]: Partial parsing: updated file: olist_dataset://models/fact/fact_order_items.sql
[0m13:48:13.623232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d6d5f07-4064-4e3d-b1b3-07b39d753eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c1498eb0>]}
[0m13:48:13.715386 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:48:13.717039 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:48:13.731834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d6d5f07-4064-4e3d-b1b3-07b39d753eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c1498550>]}
[0m13:48:13.732406 [info ] [MainThread]: Found 3 snapshots, 6 models, 33 data tests, 9 sources, 491 macros
[0m13:48:13.732810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d6d5f07-4064-4e3d-b1b3-07b39d753eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f0cf65c0>]}
[0m13:48:13.734288 [info ] [MainThread]: 
[0m13:48:13.734702 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:48:13.735005 [info ] [MainThread]: 
[0m13:48:13.735507 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:48:13.736896 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m13:48:13.737739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:14.767991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m13:48:14.769982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:15.158443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m13:48:15.160941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:15.558447 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:48:15.560705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:15.934948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d6d5f07-4064-4e3d-b1b3-07b39d753eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70efbbd270>]}
[0m13:48:15.935903 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:48:15.940998 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m13:48:15.942046 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m13:48:15.942679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now model.olist_dataset.fact_order_items)
[0m13:48:15.943061 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m13:48:15.956840 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m13:48:15.958605 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m13:48:15.997506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:16.420548 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m13:48:16.421485 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
    WHERE order_status IN ('delivered', 'canceled')  -- Only include order that has finalized, delivered or cancelled
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    INNER JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order item id that already in fact_order_item table
-- which assume data already in table never change

-- 
--   WHERE order_id_item NOT IN (SELECT order_id_item FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id_item = DBT_INTERNAL_DEST.order_id_item))

    
    when matched then update set
        `customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_id` = DBT_INTERNAL_SOURCE.`order_id`,`order_item_id` = DBT_INTERNAL_SOURCE.`order_item_id`,`product_id` = DBT_INTERNAL_SOURCE.`product_id`,`seller_id` = DBT_INTERNAL_SOURCE.`seller_id`,`price` = DBT_INTERNAL_SOURCE.`price`,`freight_value` = DBT_INTERNAL_SOURCE.`freight_value`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`order_id_item` = DBT_INTERNAL_SOURCE.`order_id_item`
    

    when not matched then insert
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)
    values
        (`customer_id`, `order_id`, `order_item_id`, `product_id`, `seller_id`, `price`, `freight_value`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `order_id_item`)


    
[0m13:48:17.006933 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:30beb746-e012-41ce-a0dd-eef98ae17278&page=queryresults
[0m13:48:23.390353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d6d5f07-4064-4e3d-b1b3-07b39d753eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c14980d0>]}
[0m13:48:23.391097 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mMERGE (110.7k rows, 58.8 MiB processed)[0m in 7.45s]
[0m13:48:23.391739 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m13:48:23.394217 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:48:23.395058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:48:23.395419 [debug] [MainThread]: Connection 'model.olist_dataset.fact_order_items' was properly closed.
[0m13:48:23.395770 [info ] [MainThread]: 
[0m13:48:23.396127 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.66 seconds (9.66s).
[0m13:48:23.396779 [debug] [MainThread]: Command end result
[0m13:48:23.422808 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:48:23.424678 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:48:23.430014 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:48:23.430452 [info ] [MainThread]: 
[0m13:48:23.430852 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:48:23.431158 [info ] [MainThread]: 
[0m13:48:23.431491 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:48:23.432033 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.726385, "process_in_blocks": "22440", "process_kernel_time": 1.146698, "process_mem_max_rss": "269372", "process_out_blocks": "3736", "process_user_time": 3.729263}
[0m13:48:23.432443 [debug] [MainThread]: Command `dbt run` succeeded at 13:48:23.432353 after 11.73 seconds
[0m13:48:23.432795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f0c99db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f0937190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c140d240>]}
[0m13:48:23.433161 [debug] [MainThread]: Flushing usage events
[0m13:48:24.391765 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:48:25.878748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0248d99ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0247db56f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0247db5690>]}


============================== 13:48:25.880979 | e321058e-4b59-4eb5-8a82-4972c41d176c ==============================
[0m13:48:25.880979 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:48:25.881496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'profiles_dir': '/home/kangh/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --models fact_order_items', 'send_anonymous_usage_stats': 'True'}
[0m13:48:26.809889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e321058e-4b59-4eb5-8a82-4972c41d176c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0219fa3280>]}
[0m13:48:26.874944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e321058e-4b59-4eb5-8a82-4972c41d176c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02485aff10>]}
[0m13:48:26.875706 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:48:26.978314 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:48:27.186950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:48:27.187370 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:48:27.241795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e321058e-4b59-4eb5-8a82-4972c41d176c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02198f4e20>]}
[0m13:48:27.336488 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:48:27.338128 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:48:27.361243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e321058e-4b59-4eb5-8a82-4972c41d176c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02198f4880>]}
[0m13:48:27.361856 [info ] [MainThread]: Found 3 snapshots, 6 models, 33 data tests, 9 sources, 491 macros
[0m13:48:27.362254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e321058e-4b59-4eb5-8a82-4972c41d176c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02490aaec0>]}
[0m13:48:27.364012 [info ] [MainThread]: 
[0m13:48:27.364441 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:48:27.364728 [info ] [MainThread]: 
[0m13:48:27.365227 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:48:27.369972 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_ingestion_dim_tables'
[0m13:48:27.370601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:28.796861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:48:28.799304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:29.216113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m13:48:29.218006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:29.602004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e321058e-4b59-4eb5-8a82-4972c41d176c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0249f30dc0>]}
[0m13:48:29.603250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:48:29.611664 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:48:29.612661 [info ] [Thread-1 (]: 1 of 8 START test not_null_fact_order_items_order_id ........................... [RUN]
[0m13:48:29.613798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e)
[0m13:48:29.614540 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:48:29.637399 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e"
[0m13:48:29.638181 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:48:29.652878 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e"
[0m13:48:29.653674 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where order_id is null



      
    ) dbt_internal_test
[0m13:48:29.654103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:30.244686 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:8f973646-837e-4a38-94f3-6daed374dd81&page=queryresults
[0m13:48:31.256277 [info ] [Thread-1 (]: 1 of 8 PASS not_null_fact_order_items_order_id ................................. [[32mPASS[0m in 1.64s]
[0m13:48:31.258533 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:48:31.260192 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:48:31.261754 [info ] [Thread-1 (]: 2 of 8 START test not_null_fact_order_items_order_id_item ...................... [RUN]
[0m13:48:31.262865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e, now test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8)
[0m13:48:31.263730 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:48:31.272847 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8"
[0m13:48:31.273783 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:48:31.277929 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8"
[0m13:48:31.279361 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id_item
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where order_id_item is null



      
    ) dbt_internal_test
[0m13:48:31.279821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:31.821590 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:b050b85e-55a6-4c7c-af9f-8e5e72bd2a6f&page=queryresults
[0m13:48:32.956259 [info ] [Thread-1 (]: 2 of 8 PASS not_null_fact_order_items_order_id_item ............................ [[32mPASS[0m in 1.69s]
[0m13:48:32.957721 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:48:32.958518 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:48:32.959295 [info ] [Thread-1 (]: 3 of 8 START test not_null_fact_order_items_product_id ......................... [RUN]
[0m13:48:32.960743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8, now test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9)
[0m13:48:32.961724 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:48:32.970816 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9"
[0m13:48:32.972040 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:48:32.975727 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9"
[0m13:48:32.976505 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where product_id is null



      
    ) dbt_internal_test
[0m13:48:32.977006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:33.548848 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:093d7abc-25ae-43b1-89b3-feca4ce12be5&page=queryresults
[0m13:48:34.527446 [info ] [Thread-1 (]: 3 of 8 PASS not_null_fact_order_items_product_id ............................... [[32mPASS[0m in 1.57s]
[0m13:48:34.529297 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:48:34.530381 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:48:34.531659 [info ] [Thread-1 (]: 4 of 8 START test not_null_fact_order_items_seller_id .......................... [RUN]
[0m13:48:34.532996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9, now test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883)
[0m13:48:34.533440 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:48:34.539163 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883"
[0m13:48:34.540555 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:48:34.548633 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883"
[0m13:48:34.550545 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where seller_id is null



      
    ) dbt_internal_test
[0m13:48:34.551851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:35.148765 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:e9fefb56-2bd2-4eef-805d-092fb0fca23f&page=queryresults
[0m13:48:36.109812 [info ] [Thread-1 (]: 4 of 8 PASS not_null_fact_order_items_seller_id ................................ [[32mPASS[0m in 1.58s]
[0m13:48:36.111196 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:48:36.112064 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:48:36.113553 [info ] [Thread-1 (]: 5 of 8 START test relationships_fact_order_items_order_id__order_id__ref_fact_orders_  [RUN]
[0m13:48:36.114750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883, now test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74)
[0m13:48:36.115707 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:48:36.132758 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"
[0m13:48:36.133854 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:48:36.136389 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"
[0m13:48:36.136982 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:48:36.137408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:37.068317 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:6cb85568-631e-456b-9be0-25bd95396d32&page=queryresults
[0m13:48:38.029059 [error] [Thread-1 (]: 5 of 8 FAIL 1911 relationships_fact_order_items_order_id__order_id__ref_fact_orders_  [[31mFAIL 1911[0m in 1.91s]
[0m13:48:38.030406 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:48:38.031162 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:48:38.031900 [info ] [Thread-1 (]: 6 of 8 START test relationships_fact_order_items_product_id__product_id__ref_dim_product_  [RUN]
[0m13:48:38.032614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74, now test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428)
[0m13:48:38.033107 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:48:38.044409 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"
[0m13:48:38.045449 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:48:38.048564 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"
[0m13:48:38.049403 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:48:38.049872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:38.863211 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:1a12d405-e479-45c3-8b56-8a857417a720&page=queryresults
[0m13:48:39.846760 [info ] [Thread-1 (]: 6 of 8 PASS relationships_fact_order_items_product_id__product_id__ref_dim_product_  [[32mPASS[0m in 1.81s]
[0m13:48:39.848436 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:48:39.849323 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:48:39.850596 [info ] [Thread-1 (]: 7 of 8 START test relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_  [RUN]
[0m13:48:39.851832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428, now test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1)
[0m13:48:39.852819 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:48:39.865149 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1"
[0m13:48:39.866176 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:48:39.869875 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1"
[0m13:48:39.870479 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select seller_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
    where seller_id is not null
),

parent as (
    select seller_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:48:39.870882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:40.533262 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:ad445db7-4a60-43d0-8053-f1efe1eee3dd&page=queryresults
[0m13:48:41.523989 [info ] [Thread-1 (]: 7 of 8 PASS relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_  [[32mPASS[0m in 1.67s]
[0m13:48:41.525851 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:48:41.526952 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:48:41.527943 [info ] [Thread-1 (]: 8 of 8 START test unique_fact_order_items_order_id_item ........................ [RUN]
[0m13:48:41.529296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1, now test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c)
[0m13:48:41.531290 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:48:41.546931 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c"
[0m13:48:41.548726 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:48:41.554797 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c"
[0m13:48:41.556315 [debug] [Thread-1 (]: On test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id_item as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
  where order_id_item is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:48:41.557448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:42.481584 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:bc836a56-33df-4ce5-a953-af29df0f9f2b&page=queryresults
[0m13:48:43.518765 [info ] [Thread-1 (]: 8 of 8 PASS unique_fact_order_items_order_id_item .............................. [[32mPASS[0m in 1.99s]
[0m13:48:43.520257 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:48:43.524704 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:48:43.526996 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:48:43.527992 [debug] [MainThread]: Connection 'test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c' was properly closed.
[0m13:48:43.528818 [info ] [MainThread]: 
[0m13:48:43.529588 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 16.16 seconds (16.16s).
[0m13:48:43.532978 [debug] [MainThread]: Command end result
[0m13:48:43.562360 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:48:43.564207 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:48:43.570640 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:48:43.570990 [info ] [MainThread]: 
[0m13:48:43.571404 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:48:43.571749 [info ] [MainThread]: 
[0m13:48:43.572118 [error] [MainThread]: [31mFailure in test relationships_fact_order_items_order_id__order_id__ref_fact_orders_ (models/schema.yml)[0m
[0m13:48:43.572459 [error] [MainThread]:   Got 1911 results, configured to fail if != 0
[0m13:48:43.572726 [info ] [MainThread]: 
[0m13:48:43.573086 [info ] [MainThread]:   compiled code at target/compiled/olist_dataset/models/schema.yml/relationships_fact_order_items_40f3126aaf69b9319cf8a1bfc6dfca58.sql
[0m13:48:43.573394 [info ] [MainThread]: 
[0m13:48:43.573694 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m13:48:43.574320 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 17.751852, "process_in_blocks": "0", "process_kernel_time": 1.105214, "process_mem_max_rss": "254980", "process_out_blocks": "2720", "process_user_time": 3.528573}
[0m13:48:43.574880 [debug] [MainThread]: Command `dbt test` failed at 13:48:43.574747 after 17.75 seconds
[0m13:48:43.575448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0248d99ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0248b18c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0212e211e0>]}
[0m13:48:43.575946 [debug] [MainThread]: Flushing usage events
[0m13:48:44.557790 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:38.630350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d9ac15e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d99c254b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d99c25450>]}


============================== 13:49:38.632831 | 93304c1c-c083-450b-aff4-7758ec107f3a ==============================
[0m13:49:38.632831 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:49:38.633328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/kangh/.dbt', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fact_orders', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:49:39.620564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93304c1c-c083-450b-aff4-7758ec107f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d9bd44f70>]}
[0m13:49:39.686985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93304c1c-c083-450b-aff4-7758ec107f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d99c3b3d0>]}
[0m13:49:39.687707 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:49:39.787204 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:49:39.978750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:49:39.979169 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:49:40.033618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93304c1c-c083-450b-aff4-7758ec107f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d6b8f4bb0>]}
[0m13:49:40.128049 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:49:40.129656 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:49:40.140864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93304c1c-c083-450b-aff4-7758ec107f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d6b885870>]}
[0m13:49:40.141466 [info ] [MainThread]: Found 3 snapshots, 6 models, 33 data tests, 9 sources, 491 macros
[0m13:49:40.141842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93304c1c-c083-450b-aff4-7758ec107f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d6b8859f0>]}
[0m13:49:40.143578 [info ] [MainThread]: 
[0m13:49:40.144051 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:49:40.144333 [info ] [MainThread]: 
[0m13:49:40.144791 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:49:40.145998 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m13:49:40.146981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:41.084404 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now create_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:49:41.086038 [debug] [ThreadPool]: Creating schema "database: "olist-ecommerce-454812"
schema: "olist_data_ingestion_fact_tables"
"
[0m13:49:41.106017 [debug] [ThreadPool]: On create_olist-ecommerce-454812_olist_data_ingestion_fact_tables: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "connection_name": "create_olist-ecommerce-454812_olist_data_ingestion_fact_tables"} */
create schema if not exists `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`
  
[0m13:49:41.106524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:41.524773 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:490faac9-6b3e-4b83-b55c-8f54eed52fb2&page=queryresults
[0m13:49:42.448623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:49:42.449927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:42.847515 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m13:49:42.849177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:43.240837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m13:49:43.241358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:43.663528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93304c1c-c083-450b-aff4-7758ec107f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d99c39840>]}
[0m13:49:43.664665 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:43.671780 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m13:49:43.672809 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m13:49:43.673718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now model.olist_dataset.fact_orders)
[0m13:49:43.674342 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m13:49:43.690766 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m13:49:43.691422 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m13:49:43.745170 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m13:49:43.746027 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
      
    
    

    OPTIONS()
    as (
      -- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
    WHERE order_status IN ('delivered', 'canceled')   -- Only include delivered or canceled
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order id that already in fact_orders table
-- which assume data already in table never change

-- 
    );
  
[0m13:49:43.746510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:44.510478 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:9e34971c-4c9c-4644-a5d8-cc25c3a8ce76&page=queryresults
[0m13:49:48.877375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93304c1c-c083-450b-aff4-7758ec107f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d99c0ff40>]}
[0m13:49:48.878130 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mCREATE TABLE (97.1k rows, 21.5 MiB processed)[0m in 5.20s]
[0m13:49:48.878717 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m13:49:48.882017 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:49:48.883055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:48.883443 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m13:49:48.883859 [info ] [MainThread]: 
[0m13:49:48.884269 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.74 seconds (8.74s).
[0m13:49:48.885100 [debug] [MainThread]: Command end result
[0m13:49:48.911166 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:49:48.912938 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:49:48.918449 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:49:48.918785 [info ] [MainThread]: 
[0m13:49:48.919193 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:49:48.919484 [info ] [MainThread]: 
[0m13:49:48.919787 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:49:48.920312 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.348355, "process_in_blocks": "0", "process_kernel_time": 1.080608, "process_mem_max_rss": "255992", "process_out_blocks": "2568", "process_user_time": 3.371897}
[0m13:49:48.920718 [debug] [MainThread]: Command `dbt run` succeeded at 13:49:48.920625 after 10.35 seconds
[0m13:49:48.921051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d9ac15e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d9bd44f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d6b8bb940>]}
[0m13:49:48.921409 [debug] [MainThread]: Flushing usage events
[0m13:49:49.879382 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:51.408969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40cc9d5e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40cb915690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40cb915630>]}


============================== 13:49:51.411503 | 7dc78815-33ab-4b4f-bf41-82b609961254 ==============================
[0m13:49:51.411503 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:49:51.412051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --models fact_orders', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:49:52.456202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dc78815-33ab-4b4f-bf41-82b609961254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40cda14f10>]}
[0m13:49:52.529682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dc78815-33ab-4b4f-bf41-82b609961254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40cb92b5b0>]}
[0m13:49:52.530960 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:49:52.640736 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:49:52.840491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:49:52.841012 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:49:52.897798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dc78815-33ab-4b4f-bf41-82b609961254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f409d618d30>]}
[0m13:49:52.997963 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:49:52.999796 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:49:53.024918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dc78815-33ab-4b4f-bf41-82b609961254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f409d5a6fb0>]}
[0m13:49:53.025603 [info ] [MainThread]: Found 3 snapshots, 6 models, 33 data tests, 9 sources, 491 macros
[0m13:49:53.026078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dc78815-33ab-4b4f-bf41-82b609961254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f409de32dd0>]}
[0m13:49:53.028065 [info ] [MainThread]: 
[0m13:49:53.028642 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:49:53.029076 [info ] [MainThread]: 
[0m13:49:53.029762 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:49:53.034784 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_ingestion_dim_tables'
[0m13:49:53.035370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:54.014013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:49:54.016471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:54.402153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m13:49:54.403771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:54.773008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dc78815-33ab-4b4f-bf41-82b609961254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40cc8041c0>]}
[0m13:49:54.774214 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:54.780379 [debug] [Thread-1 (]: Began running node test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab
[0m13:49:54.781255 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_fact_orders_order_status__delivered__canceled  [RUN]
[0m13:49:54.782405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab)
[0m13:49:54.783111 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab
[0m13:49:54.804715 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab"
[0m13:49:54.805525 [debug] [Thread-1 (]: Began executing node test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab
[0m13:49:54.821817 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab"
[0m13:49:54.822601 [debug] [Thread-1 (]: On test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','canceled'
)



      
    ) dbt_internal_test
[0m13:49:54.823029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:55.557838 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:2be44725-63b4-4835-8fc2-e4dded32c47e&page=queryresults
[0m13:49:56.563438 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_fact_orders_order_status__delivered__canceled ...... [[32mPASS[0m in 1.78s]
[0m13:49:56.564473 [debug] [Thread-1 (]: Finished running node test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab
[0m13:49:56.564889 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:49:56.565256 [info ] [Thread-1 (]: 2 of 8 START test not_null_fact_orders_customer_id ............................. [RUN]
[0m13:49:56.565778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab, now test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc)
[0m13:49:56.566333 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:49:56.573260 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc"
[0m13:49:56.573886 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:49:56.575993 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc"
[0m13:49:56.576590 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where customer_id is null



      
    ) dbt_internal_test
[0m13:49:56.576957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:57.240628 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:909a9f13-19fb-462a-86e6-6dfee0311a7c&page=queryresults
[0m13:49:58.242605 [info ] [Thread-1 (]: 2 of 8 PASS not_null_fact_orders_customer_id ................................... [[32mPASS[0m in 1.68s]
[0m13:49:58.243574 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:49:58.244250 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:49:58.244945 [info ] [Thread-1 (]: 3 of 8 START test not_null_fact_orders_order_id ................................ [RUN]
[0m13:49:58.245504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc, now test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0)
[0m13:49:58.245843 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:49:58.250644 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0"
[0m13:49:58.252106 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:49:58.254770 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0"
[0m13:49:58.255342 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where order_id is null



      
    ) dbt_internal_test
[0m13:49:58.255722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:58.870106 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:50b8c322-3f45-473d-a028-9dd84b588fe1&page=queryresults
[0m13:49:59.819077 [info ] [Thread-1 (]: 3 of 8 PASS not_null_fact_orders_order_id ...................................... [[32mPASS[0m in 1.57s]
[0m13:49:59.820458 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:49:59.821264 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:49:59.822650 [info ] [Thread-1 (]: 4 of 8 START test not_null_fact_orders_order_purchase_timestamp ................ [RUN]
[0m13:49:59.823850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0, now test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434)
[0m13:49:59.824717 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:49:59.836233 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434"
[0m13:49:59.837538 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:49:59.841338 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434"
[0m13:49:59.842183 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_purchase_timestamp
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where order_purchase_timestamp is null



      
    ) dbt_internal_test
[0m13:49:59.842754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:00.428684 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:bb81db7f-fb9d-4248-a7bb-6e17e728ecbb&page=queryresults
[0m13:50:01.525373 [info ] [Thread-1 (]: 4 of 8 PASS not_null_fact_orders_order_purchase_timestamp ...................... [[32mPASS[0m in 1.70s]
[0m13:50:01.527180 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:50:01.528223 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:50:01.529651 [info ] [Thread-1 (]: 5 of 8 START test not_null_fact_orders_order_status ............................ [RUN]
[0m13:50:01.530852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434, now test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1)
[0m13:50:01.531301 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:50:01.539992 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1"
[0m13:50:01.540978 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:50:01.546222 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1"
[0m13:50:01.548032 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_status
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where order_status is null



      
    ) dbt_internal_test
[0m13:50:01.549439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:02.124107 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:50583f08-49cc-4f5f-8e98-6d16ec021656&page=queryresults
[0m13:50:03.284745 [info ] [Thread-1 (]: 5 of 8 PASS not_null_fact_orders_order_status .................................. [[32mPASS[0m in 1.75s]
[0m13:50:03.286084 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:50:03.286826 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:50:03.287961 [info ] [Thread-1 (]: 6 of 8 START test relationships_fact_order_items_order_id__order_id__ref_fact_orders_  [RUN]
[0m13:50:03.289007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1, now test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74)
[0m13:50:03.289781 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:50:03.305204 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"
[0m13:50:03.306427 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:50:03.309415 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"
[0m13:50:03.310084 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:50:03.310503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:03.919439 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:0ddb1744-d636-4a6f-8d85-f05c1c24e67d&page=queryresults
[0m13:50:03.920836 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:0ddb1744-d636-4a6f-8d85-f05c1c24e67d&page=queryresults
[0m13:50:03.954931 [debug] [Thread-1 (]: Database Error in test relationships_fact_order_items_order_id__order_id__ref_fact_orders_ (models/schema.yml)
  Not found: Table olist-ecommerce-454812:olist_data_ingestion_fact_tables.fact_order_items was not found in location US
  compiled code at target/run/olist_dataset/models/schema.yml/relationships_fact_order_items_40f3126aaf69b9319cf8a1bfc6dfca58.sql
[0m13:50:03.956509 [error] [Thread-1 (]: 6 of 8 ERROR relationships_fact_order_items_order_id__order_id__ref_fact_orders_  [[31mERROR[0m in 0.67s]
[0m13:50:03.957833 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:50:03.958624 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:50:03.959408 [info ] [Thread-1 (]: 7 of 8 START test relationships_fact_orders_customer_id__customer_id__ref_dim_customer_  [RUN]
[0m13:50:03.960492 [debug] [Thread-4 (]: Marking all children of 'test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74' to be skipped because of status 'error'.  Reason: Database Error in test relationships_fact_order_items_order_id__order_id__ref_fact_orders_ (models/schema.yml)
  Not found: Table olist-ecommerce-454812:olist_data_ingestion_fact_tables.fact_order_items was not found in location US
  compiled code at target/run/olist_dataset/models/schema.yml/relationships_fact_order_items_40f3126aaf69b9319cf8a1bfc6dfca58.sql.
[0m13:50:03.961597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74, now test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba)
[0m13:50:03.963738 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:50:03.972913 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba"
[0m13:50:03.973670 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:50:03.975919 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba"
[0m13:50:03.976485 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:50:03.976904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:04.886931 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:e6399a2e-8129-47a7-a6a3-841c018a1117&page=queryresults
[0m13:50:05.814226 [info ] [Thread-1 (]: 7 of 8 PASS relationships_fact_orders_customer_id__customer_id__ref_dim_customer_  [[32mPASS[0m in 1.85s]
[0m13:50:05.816027 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:50:05.816999 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:50:05.818391 [info ] [Thread-1 (]: 8 of 8 START test unique_fact_orders_order_id .................................. [RUN]
[0m13:50:05.819798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba, now test.olist_dataset.unique_fact_orders_order_id.93a68b4064)
[0m13:50:05.820980 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:50:05.834566 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_fact_orders_order_id.93a68b4064"
[0m13:50:05.836209 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:50:05.843090 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_fact_orders_order_id.93a68b4064"
[0m13:50:05.845017 [debug] [Thread-1 (]: On test.olist_dataset.unique_fact_orders_order_id.93a68b4064: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_fact_orders_order_id.93a68b4064"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:50:05.846304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:06.612344 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:3d7fae80-7afe-4a39-89d8-f9b9b307f5e4&page=queryresults
[0m13:50:07.548916 [info ] [Thread-1 (]: 8 of 8 PASS unique_fact_orders_order_id ........................................ [[32mPASS[0m in 1.73s]
[0m13:50:07.550285 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:50:07.556428 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:50:07.557784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:07.558525 [debug] [MainThread]: Connection 'test.olist_dataset.unique_fact_orders_order_id.93a68b4064' was properly closed.
[0m13:50:07.559202 [info ] [MainThread]: 
[0m13:50:07.559883 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 14.53 seconds (14.53s).
[0m13:50:07.562637 [debug] [MainThread]: Command end result
[0m13:50:07.607061 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:50:07.609358 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:50:07.618224 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:50:07.618714 [info ] [MainThread]: 
[0m13:50:07.619338 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:50:07.621586 [info ] [MainThread]: 
[0m13:50:07.623046 [error] [MainThread]:   Database Error in test relationships_fact_order_items_order_id__order_id__ref_fact_orders_ (models/schema.yml)
  Not found: Table olist-ecommerce-454812:olist_data_ingestion_fact_tables.fact_order_items was not found in location US
  compiled code at target/run/olist_dataset/models/schema.yml/relationships_fact_order_items_40f3126aaf69b9319cf8a1bfc6dfca58.sql
[0m13:50:07.623635 [info ] [MainThread]: 
[0m13:50:07.624317 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m13:50:07.625255 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 16.273994, "process_in_blocks": "544", "process_kernel_time": 1.164826, "process_mem_max_rss": "259652", "process_out_blocks": "2728", "process_user_time": 3.622808}
[0m13:50:07.626000 [debug] [MainThread]: Command `dbt test` failed at 13:50:07.625791 after 16.27 seconds
[0m13:50:07.626524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40cc9d5e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f409d47ed40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40cc689840>]}
[0m13:50:07.627062 [debug] [MainThread]: Flushing usage events
[0m13:50:08.573474 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:54:47.646059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b562adde0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b5519d4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b5519d480>]}


============================== 13:54:47.650663 | 91d99979-1855-4223-8b89-d4aea58906e3 ==============================
[0m13:54:47.650663 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:54:47.651197 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'profiles_dir': '/home/kangh/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_order_items', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:54:49.439586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91d99979-1855-4223-8b89-d4aea58906e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b27358e20>]}
[0m13:54:49.508435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91d99979-1855-4223-8b89-d4aea58906e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b559d3730>]}
[0m13:54:49.509166 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:54:49.622592 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:54:49.915271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:54:49.915803 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:54:49.972950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91d99979-1855-4223-8b89-d4aea58906e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b26ee0b20>]}
[0m13:54:50.071295 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:54:50.075469 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:54:50.099726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91d99979-1855-4223-8b89-d4aea58906e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b26ee0f10>]}
[0m13:54:50.100306 [info ] [MainThread]: Found 3 snapshots, 6 models, 33 data tests, 9 sources, 491 macros
[0m13:54:50.100684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91d99979-1855-4223-8b89-d4aea58906e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b26ee0fa0>]}
[0m13:54:50.102219 [info ] [MainThread]: 
[0m13:54:50.102636 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:50.102941 [info ] [MainThread]: 
[0m13:54:50.103451 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:54:50.104772 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m13:54:50.105352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:51.688166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m13:54:51.690159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:52.065276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:54:52.067817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:52.464555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m13:54:52.467051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:52.865983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91d99979-1855-4223-8b89-d4aea58906e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b57365d80>]}
[0m13:54:52.867004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:52.872197 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m13:54:52.873180 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m13:54:52.874113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now model.olist_dataset.fact_order_items)
[0m13:54:52.874767 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m13:54:52.891107 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m13:54:52.894720 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m13:54:52.951033 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m13:54:52.953202 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
      
    
    

    OPTIONS()
    as (
      -- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
    WHERE order_status IN ('delivered', 'canceled')  -- Only include order that has finalized, delivered or cancelled
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    INNER JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order item id that already in fact_order_item table
-- which assume data already in table never change

-- 
    );
  
[0m13:54:52.953745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:53.524517 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:438e4618-86d6-4d68-aa1e-01955ed29929&page=queryresults
[0m13:54:57.959104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91d99979-1855-4223-8b89-d4aea58906e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b26d09480>]}
[0m13:54:57.959885 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mCREATE TABLE (110.7k rows, 28.9 MiB processed)[0m in 5.08s]
[0m13:54:57.960485 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m13:54:57.963199 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:57.964230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:57.964671 [debug] [MainThread]: Connection 'model.olist_dataset.fact_order_items' was properly closed.
[0m13:54:57.965074 [info ] [MainThread]: 
[0m13:54:57.965445 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.86 seconds (7.86s).
[0m13:54:57.966068 [debug] [MainThread]: Command end result
[0m13:54:57.991642 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:54:57.993422 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:54:57.999225 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:54:57.999641 [info ] [MainThread]: 
[0m13:54:58.000055 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:54:58.000343 [info ] [MainThread]: 
[0m13:54:58.000630 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:54:58.001111 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.417653, "process_in_blocks": "122768", "process_kernel_time": 1.394208, "process_mem_max_rss": "256472", "process_out_blocks": "2592", "process_user_time": 3.55968}
[0m13:54:58.001486 [debug] [MainThread]: Command `dbt run` succeeded at 13:54:58.001396 after 10.42 seconds
[0m13:54:58.001848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b562adde0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b26ea7130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b26ea7820>]}
[0m13:54:58.002194 [debug] [MainThread]: Flushing usage events
[0m13:54:59.016189 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:43.154935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9200839e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91ff8214b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91ff821450>]}


============================== 13:55:43.160057 | f02cd439-9666-46e6-8a03-58cb8abf08fd ==============================
[0m13:55:43.160057 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:55:43.160617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_orders', 'send_anonymous_usage_stats': 'True'}
[0m13:55:44.889965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f02cd439-9666-46e6-8a03-58cb8abf08fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920196f0a0>]}
[0m13:55:44.959085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f02cd439-9666-46e6-8a03-58cb8abf08fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91ff85b3d0>]}
[0m13:55:44.959818 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:55:45.071706 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:55:45.356669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:45.357270 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:45.415231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f02cd439-9666-46e6-8a03-58cb8abf08fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d1558bb0>]}
[0m13:55:45.511624 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:55:45.514559 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:55:45.539065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f02cd439-9666-46e6-8a03-58cb8abf08fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d14e9870>]}
[0m13:55:45.539626 [info ] [MainThread]: Found 3 snapshots, 6 models, 33 data tests, 9 sources, 491 macros
[0m13:55:45.539997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f02cd439-9666-46e6-8a03-58cb8abf08fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d14e99f0>]}
[0m13:55:45.541514 [info ] [MainThread]: 
[0m13:55:45.541929 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:45.542211 [info ] [MainThread]: 
[0m13:55:45.542771 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:55:45.543918 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m13:55:45.544373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:47.051451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now create_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:55:47.052628 [debug] [ThreadPool]: Creating schema "database: "olist-ecommerce-454812"
schema: "olist_data_ingestion_fact_tables"
"
[0m13:55:47.070426 [debug] [ThreadPool]: On create_olist-ecommerce-454812_olist_data_ingestion_fact_tables: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "connection_name": "create_olist-ecommerce-454812_olist_data_ingestion_fact_tables"} */
create schema if not exists `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`
  
[0m13:55:47.070987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:47.438306 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:311cf57c-cf43-40c6-8f6a-561671d1d999&page=queryresults
[0m13:55:48.370468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:55:48.371489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:48.859632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m13:55:48.861104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:49.267368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m13:55:49.269845 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:49.675895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f02cd439-9666-46e6-8a03-58cb8abf08fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d13cd480>]}
[0m13:55:49.676976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:49.683467 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m13:55:49.684498 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m13:55:49.685510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now model.olist_dataset.fact_orders)
[0m13:55:49.686299 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m13:55:49.703816 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m13:55:49.707002 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m13:55:49.763412 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m13:55:49.764305 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
      
    
    

    OPTIONS()
    as (
      -- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
    WHERE order_status IN ('delivered', 'canceled')   -- Only include delivered or canceled
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order id that already in fact_orders table
-- which assume data already in table never change

-- 
    );
  
[0m13:55:49.764786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:50.513043 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:2a223f2a-7e6e-4ab1-815a-6efbf78a0ee9&page=queryresults
[0m13:55:54.729408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f02cd439-9666-46e6-8a03-58cb8abf08fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91ff833f40>]}
[0m13:55:54.730204 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mCREATE TABLE (97.1k rows, 21.5 MiB processed)[0m in 5.04s]
[0m13:55:54.730807 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m13:55:54.733761 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:54.734978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:54.735404 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m13:55:54.735739 [info ] [MainThread]: 
[0m13:55:54.736068 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.19 seconds (9.19s).
[0m13:55:54.736734 [debug] [MainThread]: Command end result
[0m13:55:54.761343 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:55:54.763065 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:55:54.768901 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:55:54.769330 [info ] [MainThread]: 
[0m13:55:54.769740 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:54.770066 [info ] [MainThread]: 
[0m13:55:54.770383 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:55:54.770920 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.678043, "process_in_blocks": "122488", "process_kernel_time": 1.29534, "process_mem_max_rss": "256792", "process_out_blocks": "2576", "process_user_time": 3.765523}
[0m13:55:54.771292 [debug] [MainThread]: Command `dbt run` succeeded at 13:55:54.771205 after 11.68 seconds
[0m13:55:54.771655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9200839e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920196f0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d151f940>]}
[0m13:55:54.772016 [debug] [MainThread]: Flushing usage events
[0m13:55:55.743762 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:57.299417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd12efa1e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd12debd660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd12debd600>]}


============================== 13:55:57.301889 | 63df609f-ea43-435a-af2d-6e0f2ad33b56 ==============================
[0m13:55:57.301889 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:55:57.302384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kangh/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --models fact_orders', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:55:58.301394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63df609f-ea43-435a-af2d-6e0f2ad33b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0ffe18280>]}
[0m13:55:58.371396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63df609f-ea43-435a-af2d-6e0f2ad33b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0fff0a0b0>]}
[0m13:55:58.372226 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:55:58.478053 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:55:58.699600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:58.700150 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:58.759824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63df609f-ea43-435a-af2d-6e0f2ad33b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0ff90cd00>]}
[0m13:55:58.861789 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:55:58.864429 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:55:58.891448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63df609f-ea43-435a-af2d-6e0f2ad33b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0ff90c850>]}
[0m13:55:58.892083 [info ] [MainThread]: Found 3 snapshots, 6 models, 33 data tests, 9 sources, 491 macros
[0m13:55:58.892532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63df609f-ea43-435a-af2d-6e0f2ad33b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd10443ada0>]}
[0m13:55:58.894376 [info ] [MainThread]: 
[0m13:55:58.894799 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:58.895126 [info ] [MainThread]: 
[0m13:55:58.895677 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:55:58.901283 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_ingestion_fact_tables'
[0m13:55:58.902459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:59.943639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m13:55:59.944687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:00.323605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m13:56:00.327578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:00.725714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63df609f-ea43-435a-af2d-6e0f2ad33b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd130059e70>]}
[0m13:56:00.726803 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:00.732000 [debug] [Thread-1 (]: Began running node test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab
[0m13:56:00.732933 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_fact_orders_order_status__delivered__canceled  [RUN]
[0m13:56:00.733985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab)
[0m13:56:00.734684 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab
[0m13:56:00.756374 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab"
[0m13:56:00.759735 [debug] [Thread-1 (]: Began executing node test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab
[0m13:56:00.776017 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab"
[0m13:56:00.776744 [debug] [Thread-1 (]: On test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','canceled'
)



      
    ) dbt_internal_test
[0m13:56:00.777182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:01.499302 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:c1565ff3-8381-44ac-9b81-83767c20e34b&page=queryresults
[0m13:56:02.597646 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_fact_orders_order_status__delivered__canceled ...... [[32mPASS[0m in 1.86s]
[0m13:56:02.600008 [debug] [Thread-1 (]: Finished running node test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab
[0m13:56:02.602108 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:56:02.604167 [info ] [Thread-1 (]: 2 of 8 START test not_null_fact_orders_customer_id ............................. [RUN]
[0m13:56:02.605849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab, now test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc)
[0m13:56:02.606930 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:56:02.623899 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc"
[0m13:56:02.624774 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:56:02.627238 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc"
[0m13:56:02.627812 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where customer_id is null



      
    ) dbt_internal_test
[0m13:56:02.628199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:03.227682 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:fba22faf-0ae7-4181-a47a-72c6791c2172&page=queryresults
[0m13:56:04.221892 [info ] [Thread-1 (]: 2 of 8 PASS not_null_fact_orders_customer_id ................................... [[32mPASS[0m in 1.62s]
[0m13:56:04.223214 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:56:04.224207 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:56:04.224941 [info ] [Thread-1 (]: 3 of 8 START test not_null_fact_orders_order_id ................................ [RUN]
[0m13:56:04.225937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc, now test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0)
[0m13:56:04.226665 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:56:04.235654 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0"
[0m13:56:04.236881 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:56:04.240559 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0"
[0m13:56:04.241275 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where order_id is null



      
    ) dbt_internal_test
[0m13:56:04.241772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:04.811637 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:03e2ca15-1711-462e-a125-02a0cc851d91&page=queryresults
[0m13:56:05.775463 [info ] [Thread-1 (]: 3 of 8 PASS not_null_fact_orders_order_id ...................................... [[32mPASS[0m in 1.55s]
[0m13:56:05.777820 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:56:05.779073 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:56:05.781309 [info ] [Thread-1 (]: 4 of 8 START test not_null_fact_orders_order_purchase_timestamp ................ [RUN]
[0m13:56:05.783265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0, now test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434)
[0m13:56:05.784517 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:56:05.797936 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434"
[0m13:56:05.799187 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:56:05.803774 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434"
[0m13:56:05.804702 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_purchase_timestamp
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where order_purchase_timestamp is null



      
    ) dbt_internal_test
[0m13:56:05.805244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:06.406600 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:96854e43-3b70-406a-b89f-1783dc708404&page=queryresults
[0m13:56:07.335829 [info ] [Thread-1 (]: 4 of 8 PASS not_null_fact_orders_order_purchase_timestamp ...................... [[32mPASS[0m in 1.55s]
[0m13:56:07.337376 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:56:07.338169 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:56:07.338927 [info ] [Thread-1 (]: 5 of 8 START test not_null_fact_orders_order_status ............................ [RUN]
[0m13:56:07.339874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434, now test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1)
[0m13:56:07.340654 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:56:07.350686 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1"
[0m13:56:07.351719 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:56:07.354608 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1"
[0m13:56:07.355258 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_status
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where order_status is null



      
    ) dbt_internal_test
[0m13:56:07.355665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:07.938839 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:f17f3a96-3319-48f6-b4d2-42ce008ccb8d&page=queryresults
[0m13:56:08.841111 [info ] [Thread-1 (]: 5 of 8 PASS not_null_fact_orders_order_status .................................. [[32mPASS[0m in 1.50s]
[0m13:56:08.844269 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:56:08.845609 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:56:08.848005 [info ] [Thread-1 (]: 6 of 8 START test relationships_fact_order_items_order_id__order_id__ref_fact_orders_  [RUN]
[0m13:56:08.849758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1, now test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74)
[0m13:56:08.850476 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:56:08.874156 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"
[0m13:56:08.877912 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:56:08.887427 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"
[0m13:56:08.888680 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:56:08.889245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:09.407431 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:7854f9ce-edec-41e6-95e6-1e865bbdc6d3&page=queryresults
[0m13:56:09.409112 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:7854f9ce-edec-41e6-95e6-1e865bbdc6d3&page=queryresults
[0m13:56:09.431226 [debug] [Thread-1 (]: Database Error in test relationships_fact_order_items_order_id__order_id__ref_fact_orders_ (models/schema.yml)
  Not found: Table olist-ecommerce-454812:olist_data_ingestion_fact_tables.fact_order_items was not found in location US
  compiled code at target/run/olist_dataset/models/schema.yml/relationships_fact_order_items_40f3126aaf69b9319cf8a1bfc6dfca58.sql
[0m13:56:09.433078 [error] [Thread-1 (]: 6 of 8 ERROR relationships_fact_order_items_order_id__order_id__ref_fact_orders_  [[31mERROR[0m in 0.58s]
[0m13:56:09.434559 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:56:09.435588 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:56:09.436562 [info ] [Thread-1 (]: 7 of 8 START test relationships_fact_orders_customer_id__customer_id__ref_dim_customer_  [RUN]
[0m13:56:09.437689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74, now test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba)
[0m13:56:09.438616 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:56:09.445049 [debug] [Thread-4 (]: Marking all children of 'test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74' to be skipped because of status 'error'.  Reason: Database Error in test relationships_fact_order_items_order_id__order_id__ref_fact_orders_ (models/schema.yml)
  Not found: Table olist-ecommerce-454812:olist_data_ingestion_fact_tables.fact_order_items was not found in location US
  compiled code at target/run/olist_dataset/models/schema.yml/relationships_fact_order_items_40f3126aaf69b9319cf8a1bfc6dfca58.sql.
[0m13:56:09.449477 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba"
[0m13:56:09.451667 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:56:09.454302 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba"
[0m13:56:09.454954 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:56:09.455426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:10.295275 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:558fb21e-cd38-44da-8091-5f43dadf21a3&page=queryresults
[0m13:56:11.241707 [info ] [Thread-1 (]: 7 of 8 PASS relationships_fact_orders_customer_id__customer_id__ref_dim_customer_  [[32mPASS[0m in 1.80s]
[0m13:56:11.242560 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:56:11.243056 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:56:11.243444 [info ] [Thread-1 (]: 8 of 8 START test unique_fact_orders_order_id .................................. [RUN]
[0m13:56:11.244086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba, now test.olist_dataset.unique_fact_orders_order_id.93a68b4064)
[0m13:56:11.244501 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:56:11.252012 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_fact_orders_order_id.93a68b4064"
[0m13:56:11.252838 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:56:11.255464 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_fact_orders_order_id.93a68b4064"
[0m13:56:11.256164 [debug] [Thread-1 (]: On test.olist_dataset.unique_fact_orders_order_id.93a68b4064: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_fact_orders_order_id.93a68b4064"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:56:11.256616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:12.076973 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:e5328f35-0ed1-413c-9c27-346b83620b3c&page=queryresults
[0m13:56:12.992393 [info ] [Thread-1 (]: 8 of 8 PASS unique_fact_orders_order_id ........................................ [[32mPASS[0m in 1.75s]
[0m13:56:12.993795 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:56:12.997747 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:56:12.999388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:13.000234 [debug] [MainThread]: Connection 'test.olist_dataset.unique_fact_orders_order_id.93a68b4064' was properly closed.
[0m13:56:13.001146 [info ] [MainThread]: 
[0m13:56:13.002097 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 14.11 seconds (14.11s).
[0m13:56:13.005833 [debug] [MainThread]: Command end result
[0m13:56:13.035150 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:56:13.037414 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:56:13.044237 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:56:13.044606 [info ] [MainThread]: 
[0m13:56:13.044992 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:56:13.045305 [info ] [MainThread]: 
[0m13:56:13.045700 [error] [MainThread]:   Database Error in test relationships_fact_order_items_order_id__order_id__ref_fact_orders_ (models/schema.yml)
  Not found: Table olist-ecommerce-454812:olist_data_ingestion_fact_tables.fact_order_items was not found in location US
  compiled code at target/run/olist_dataset/models/schema.yml/relationships_fact_order_items_40f3126aaf69b9319cf8a1bfc6dfca58.sql
[0m13:56:13.045980 [info ] [MainThread]: 
[0m13:56:13.046273 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m13:56:13.046946 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 15.804061, "process_in_blocks": "2240", "process_kernel_time": 1.214786, "process_mem_max_rss": "254080", "process_out_blocks": "2728", "process_user_time": 3.440274}
[0m13:56:13.047410 [debug] [MainThread]: Command `dbt test` failed at 13:56:13.047312 after 15.80 seconds
[0m13:56:13.047838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd12efa1e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd12ec42a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0fce6ab90>]}
[0m13:56:13.048236 [debug] [MainThread]: Flushing usage events
[0m13:56:14.026986 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:56:28.875948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccdef95e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccddec94b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccddec9450>]}


============================== 13:56:28.878447 | 8710097d-0f9a-4001-88b8-841bd4aa12f1 ==============================
[0m13:56:28.878447 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:56:28.878920 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select fact_order_items', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:56:29.802280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8710097d-0f9a-4001-88b8-841bd4aa12f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccdffd0f70>]}
[0m13:56:29.867323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8710097d-0f9a-4001-88b8-841bd4aa12f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccddedf3d0>]}
[0m13:56:29.868082 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:56:29.967658 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:56:30.175183 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:30.175603 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:30.230291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8710097d-0f9a-4001-88b8-841bd4aa12f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaf90cb80>]}
[0m13:56:30.324686 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:56:30.327024 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:56:30.339194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8710097d-0f9a-4001-88b8-841bd4aa12f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaf90cd60>]}
[0m13:56:30.339765 [info ] [MainThread]: Found 3 snapshots, 6 models, 33 data tests, 9 sources, 491 macros
[0m13:56:30.340136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8710097d-0f9a-4001-88b8-841bd4aa12f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaf90cd30>]}
[0m13:56:30.341614 [info ] [MainThread]: 
[0m13:56:30.342037 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:56:30.342319 [info ] [MainThread]: 
[0m13:56:30.342796 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:56:30.344731 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m13:56:30.345152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:31.299615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m13:56:31.301113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:31.658298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m13:56:31.660516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:31.985136 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:56:31.987724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:32.456016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8710097d-0f9a-4001-88b8-841bd4aa12f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce0051d80>]}
[0m13:56:32.457202 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:32.462775 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_order_items
[0m13:56:32.463839 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [RUN]
[0m13:56:32.464795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now model.olist_dataset.fact_order_items)
[0m13:56:32.465437 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_order_items
[0m13:56:32.484016 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_order_items"
[0m13:56:32.484782 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_order_items
[0m13:56:32.537272 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_order_items"
[0m13:56:32.538121 [debug] [Thread-1 (]: On model.olist_dataset.fact_order_items: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_order_items"} */

  
    

    create or replace table `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
      
    
    

    OPTIONS()
    as (
      -- models/fact/fact_order_items.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
    WHERE order_status IN ('delivered', 'canceled')  -- Only include order that has finalized, delivered or cancelled
),

order_items AS (
    SELECT
        order_id,
        order_item_id,
        product_id,
        seller_id,
        price,
        freight_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_items_dataset`
),

joined AS (
    SELECT
        o.customer_id,
        oi.order_id,
        oi.order_item_id,
        oi.product_id,
        oi.seller_id,
        oi.price,
        oi.freight_value,
        o.order_purchase_timestamp,
        o.order_approved_at,
        o.order_delivered_customer_date,
        o.order_estimated_delivery_date,
        CONCAT(oi.order_id, '_', CAST(oi.order_item_id AS STRING)) AS order_id_item
    FROM order_items oi
    INNER JOIN orders o USING (order_id)
)

SELECT
    customer_id,
    order_id,
    order_item_id,
    product_id,
    seller_id,
    price,
    freight_value,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_customer_date,
    order_estimated_delivery_date,
    order_id_item
FROM joined

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order item id that already in fact_order_item table
-- which assume data already in table never change

-- 
    );
  
[0m13:56:32.538641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:33.317266 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:f3b970a3-98d8-449b-9245-ef6d9c94f9fa&page=queryresults
[0m13:56:38.098338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8710097d-0f9a-4001-88b8-841bd4aa12f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaf90e5c0>]}
[0m13:56:38.099062 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model olist_data_ingestion_fact_tables.fact_order_items  [[32mCREATE TABLE (110.7k rows, 28.9 MiB processed)[0m in 5.63s]
[0m13:56:38.099665 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_order_items
[0m13:56:38.102710 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:56:38.103933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:38.104361 [debug] [MainThread]: Connection 'model.olist_dataset.fact_order_items' was properly closed.
[0m13:56:38.104685 [info ] [MainThread]: 
[0m13:56:38.105017 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.76 seconds (7.76s).
[0m13:56:38.105627 [debug] [MainThread]: Command end result
[0m13:56:38.132754 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:56:38.134515 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:56:38.140010 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:56:38.140345 [info ] [MainThread]: 
[0m13:56:38.140695 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:56:38.140973 [info ] [MainThread]: 
[0m13:56:38.141255 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:56:38.141782 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.322905, "process_in_blocks": "8", "process_kernel_time": 1.048575, "process_mem_max_rss": "250804", "process_out_blocks": "2584", "process_user_time": 3.549026}
[0m13:56:38.142152 [debug] [MainThread]: Command `dbt run` succeeded at 13:56:38.142062 after 9.32 seconds
[0m13:56:38.142507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccdef95e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccdffd0f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccafad2ce0>]}
[0m13:56:38.142863 [debug] [MainThread]: Flushing usage events
[0m13:56:39.116033 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:56:40.608035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa76f649e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa76e591690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa76e591630>]}


============================== 13:56:40.610443 | a3fd46fe-7ac0-4338-b54d-d5b3ad786df7 ==============================
[0m13:56:40.610443 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:56:40.610944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/kangh/.dbt', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --models fact_order_items', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:56:41.517943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3fd46fe-7ac0-4338-b54d-d5b3ad786df7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74072e080>]}
[0m13:56:41.583882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3fd46fe-7ac0-4338-b54d-d5b3ad786df7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa76ebfa410>]}
[0m13:56:41.584982 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:56:41.684349 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:56:41.879375 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:41.879836 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:41.934372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3fd46fe-7ac0-4338-b54d-d5b3ad786df7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa740278d00>]}
[0m13:56:42.027716 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:56:42.029497 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:56:42.052631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3fd46fe-7ac0-4338-b54d-d5b3ad786df7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74027be50>]}
[0m13:56:42.053236 [info ] [MainThread]: Found 3 snapshots, 6 models, 33 data tests, 9 sources, 491 macros
[0m13:56:42.053635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3fd46fe-7ac0-4338-b54d-d5b3ad786df7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa740d86dd0>]}
[0m13:56:42.055326 [info ] [MainThread]: 
[0m13:56:42.055752 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:56:42.056047 [info ] [MainThread]: 
[0m13:56:42.056549 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:56:42.061231 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_snapshots'
[0m13:56:42.062245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:43.024086 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:56:43.025737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:43.408317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m13:56:43.410430 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:43.794605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3fd46fe-7ac0-4338-b54d-d5b3ad786df7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa76e5a1b40>]}
[0m13:56:43.795669 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:43.801952 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:56:43.802799 [info ] [Thread-1 (]: 1 of 8 START test not_null_fact_order_items_order_id ........................... [RUN]
[0m13:56:43.803777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e)
[0m13:56:43.804481 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:56:43.826494 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e"
[0m13:56:43.827225 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:56:43.842165 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e"
[0m13:56:43.842944 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where order_id is null



      
    ) dbt_internal_test
[0m13:56:43.843414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:44.430997 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:4894e156-7328-4d0f-ab52-c1007d105c17&page=queryresults
[0m13:56:45.446164 [info ] [Thread-1 (]: 1 of 8 PASS not_null_fact_order_items_order_id ................................. [[32mPASS[0m in 1.64s]
[0m13:56:45.447474 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e
[0m13:56:45.448242 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:56:45.448902 [info ] [Thread-1 (]: 2 of 8 START test not_null_fact_order_items_order_id_item ...................... [RUN]
[0m13:56:45.449828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_order_id.ce02dc1e7e, now test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8)
[0m13:56:45.451017 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:56:45.459352 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8"
[0m13:56:45.460419 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:56:45.464608 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8"
[0m13:56:45.465791 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id_item
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where order_id_item is null



      
    ) dbt_internal_test
[0m13:56:45.466487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:46.032490 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:f155ff1c-5b5d-41cc-98be-287c8ec172dc&page=queryresults
[0m13:56:46.966217 [info ] [Thread-1 (]: 2 of 8 PASS not_null_fact_order_items_order_id_item ............................ [[32mPASS[0m in 1.52s]
[0m13:56:46.967802 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8
[0m13:56:46.968771 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:56:46.969591 [info ] [Thread-1 (]: 3 of 8 START test not_null_fact_order_items_product_id ......................... [RUN]
[0m13:56:46.971217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_order_id_item.c18503c6c8, now test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9)
[0m13:56:46.972210 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:56:46.981559 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9"
[0m13:56:46.982682 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:56:46.986074 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9"
[0m13:56:46.986830 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where product_id is null



      
    ) dbt_internal_test
[0m13:56:46.987279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:47.535917 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:e7ba865a-d76a-4932-948d-0dd004ca19cb&page=queryresults
[0m13:56:48.482797 [info ] [Thread-1 (]: 3 of 8 PASS not_null_fact_order_items_product_id ............................... [[32mPASS[0m in 1.51s]
[0m13:56:48.484424 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9
[0m13:56:48.485402 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:56:48.486803 [info ] [Thread-1 (]: 4 of 8 START test not_null_fact_order_items_seller_id .......................... [RUN]
[0m13:56:48.488064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_product_id.54f1977fe9, now test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883)
[0m13:56:48.489115 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:56:48.499998 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883"
[0m13:56:48.501319 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:56:48.505780 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883"
[0m13:56:48.506365 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
where seller_id is null



      
    ) dbt_internal_test
[0m13:56:48.506745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:49.028225 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:fdcb2e42-9a7a-4a3c-8cb9-63142ec9d6f4&page=queryresults
[0m13:56:49.966420 [info ] [Thread-1 (]: 4 of 8 PASS not_null_fact_order_items_seller_id ................................ [[32mPASS[0m in 1.48s]
[0m13:56:49.967923 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883
[0m13:56:49.968828 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:56:49.969591 [info ] [Thread-1 (]: 5 of 8 START test relationships_fact_order_items_order_id__order_id__ref_fact_orders_  [RUN]
[0m13:56:49.970875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_order_items_seller_id.5febc4b883, now test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74)
[0m13:56:49.971857 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:56:49.987404 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"
[0m13:56:49.988159 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:56:49.990704 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"
[0m13:56:49.991358 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:56:49.991896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:50.841965 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:2e56f720-60b1-4478-a8af-5237daec7543&page=queryresults
[0m13:56:51.777431 [info ] [Thread-1 (]: 5 of 8 PASS relationships_fact_order_items_order_id__order_id__ref_fact_orders_  [[32mPASS[0m in 1.81s]
[0m13:56:51.779058 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:56:51.780098 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:56:51.781022 [info ] [Thread-1 (]: 6 of 8 START test relationships_fact_order_items_product_id__product_id__ref_dim_product_  [RUN]
[0m13:56:51.782447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74, now test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428)
[0m13:56:51.783583 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:56:51.795951 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"
[0m13:56:51.796847 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:56:51.799275 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"
[0m13:56:51.799845 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_product`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:56:51.800244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:52.592739 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:21cf6519-252b-433a-9414-9c3a2adaeef0&page=queryresults
[0m13:56:53.553540 [info ] [Thread-1 (]: 6 of 8 PASS relationships_fact_order_items_product_id__product_id__ref_dim_product_  [[32mPASS[0m in 1.77s]
[0m13:56:53.555145 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428
[0m13:56:53.556142 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:56:53.557021 [info ] [Thread-1 (]: 7 of 8 START test relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_  [RUN]
[0m13:56:53.558634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_order_items_product_id__product_id__ref_dim_product_.90d3f8c428, now test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1)
[0m13:56:53.559685 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:56:53.569994 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1"
[0m13:56:53.570967 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:56:53.574564 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1"
[0m13:56:53.575222 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select seller_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
    where seller_id is not null
),

parent as (
    select seller_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_seller`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:56:53.575649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:54.266408 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:37b2ff28-ba6a-495a-a244-d1cfcfb49628&page=queryresults
[0m13:56:55.144042 [info ] [Thread-1 (]: 7 of 8 PASS relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_  [[32mPASS[0m in 1.59s]
[0m13:56:55.145568 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1
[0m13:56:55.145970 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:56:55.146338 [info ] [Thread-1 (]: 8 of 8 START test unique_fact_order_items_order_id_item ........................ [RUN]
[0m13:56:55.146810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_order_items_seller_id__seller_id__ref_dim_seller_.47fac820e1, now test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c)
[0m13:56:55.147161 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:56:55.153270 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c"
[0m13:56:55.153891 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:56:55.155903 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c"
[0m13:56:55.156466 [debug] [Thread-1 (]: On test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id_item as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
  where order_id_item is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:56:55.156856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:55.913345 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:96e8502f-9be4-42c5-b598-69b7e9a0fd4f&page=queryresults
[0m13:56:56.865862 [info ] [Thread-1 (]: 8 of 8 PASS unique_fact_order_items_order_id_item .............................. [[32mPASS[0m in 1.72s]
[0m13:56:56.867513 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c
[0m13:56:56.873180 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:56:56.875029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:56.875900 [debug] [MainThread]: Connection 'test.olist_dataset.unique_fact_order_items_order_id_item.74b0d4528c' was properly closed.
[0m13:56:56.876810 [info ] [MainThread]: 
[0m13:56:56.877669 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 14.82 seconds (14.82s).
[0m13:56:56.881342 [debug] [MainThread]: Command end result
[0m13:56:56.931991 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:56:56.935406 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:56:56.946113 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:56:56.946826 [info ] [MainThread]: 
[0m13:56:56.947687 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:56:56.948407 [info ] [MainThread]: 
[0m13:56:56.949290 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m13:56:56.950848 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 16.399584, "process_in_blocks": "16", "process_kernel_time": 1.219491, "process_mem_max_rss": "254168", "process_out_blocks": "2728", "process_user_time": 3.384088}
[0m13:56:56.952260 [debug] [MainThread]: Command `dbt test` succeeded at 13:56:56.951879 after 16.40 seconds
[0m13:56:56.953363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa76f649e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74072e080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa76f2f8c10>]}
[0m13:56:56.954075 [debug] [MainThread]: Flushing usage events
[0m13:56:57.904458 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:57:03.821810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc8a9e1de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc899114e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc89911480>]}


============================== 13:57:03.824134 | ddb63a98-aaaa-4c48-bebe-aefe842adc07 ==============================
[0m13:57:03.824134 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:57:03.824595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_orders', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:57:04.757840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddb63a98-aaaa-4c48-bebe-aefe842adc07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc898fb7c0>]}
[0m13:57:04.822985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddb63a98-aaaa-4c48-bebe-aefe842adc07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc5ba28a60>]}
[0m13:57:04.823716 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:57:04.927356 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:57:05.121022 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:57:05.121472 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:57:05.175246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddb63a98-aaaa-4c48-bebe-aefe842adc07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc5b43caf0>]}
[0m13:57:05.269756 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:57:05.271601 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:57:05.283096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddb63a98-aaaa-4c48-bebe-aefe842adc07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc5b43fe50>]}
[0m13:57:05.283649 [info ] [MainThread]: Found 3 snapshots, 6 models, 33 data tests, 9 sources, 491 macros
[0m13:57:05.284017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddb63a98-aaaa-4c48-bebe-aefe842adc07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc5b43fe80>]}
[0m13:57:05.285716 [info ] [MainThread]: 
[0m13:57:05.286207 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:57:05.286531 [info ] [MainThread]: 
[0m13:57:05.287035 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:57:05.288329 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812'
[0m13:57:05.289344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:06.294625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m13:57:06.296212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:06.647652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m13:57:06.650297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:07.015985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_fact_tables)
[0m13:57:07.018462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:07.373552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddb63a98-aaaa-4c48-bebe-aefe842adc07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc899252a0>]}
[0m13:57:07.374779 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:57:07.380823 [debug] [Thread-1 (]: Began running node model.olist_dataset.fact_orders
[0m13:57:07.382243 [info ] [Thread-1 (]: 1 of 1 START sql incremental model olist_data_ingestion_fact_tables.fact_orders  [RUN]
[0m13:57:07.383294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now model.olist_dataset.fact_orders)
[0m13:57:07.383989 [debug] [Thread-1 (]: Began compiling node model.olist_dataset.fact_orders
[0m13:57:07.405848 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_dataset.fact_orders"
[0m13:57:07.406586 [debug] [Thread-1 (]: Began executing node model.olist_dataset.fact_orders
[0m13:57:07.435135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:07.848358 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_dataset.fact_orders"
[0m13:57:07.849276 [debug] [Thread-1 (]: On model.olist_dataset.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "model.olist_dataset.fact_orders"} */
-- back compat for old kwarg name
  
  
        
            
	    
	    
            
        
    

    

    merge into `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders` as DBT_INTERNAL_DEST
        using (-- models/fact/fact_orders.sql



WITH orders AS (
    SELECT
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp,
        order_approved_at,
        order_delivered_carrier_date,
        order_delivered_customer_date,
        order_estimated_delivery_date
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_orders_dataset`
    WHERE order_status IN ('delivered', 'canceled')   -- Only include delivered or canceled
),

payments AS (
    SELECT
        order_id,
        ROUND(SUM(ifnull(payment_value, 0.0)), 2) AS payment_value
    FROM `olist-ecommerce-454812`.`olist_data_staging`.`olist_order_payments_dataset`
    GROUP BY order_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    p.payment_value
FROM orders o
LEFT JOIN payments p USING (order_id)

-- Comment out this part as incremental_strategy='merge' add to config
-- The logic of this part is it filter out those order id that already in fact_orders table
-- which assume data already in table never change

-- 
--   WHERE order_id NOT IN (SELECT order_id FROM `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`)
-- 
        ) as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        `order_id` = DBT_INTERNAL_SOURCE.`order_id`,`customer_id` = DBT_INTERNAL_SOURCE.`customer_id`,`order_status` = DBT_INTERNAL_SOURCE.`order_status`,`order_purchase_timestamp` = DBT_INTERNAL_SOURCE.`order_purchase_timestamp`,`order_approved_at` = DBT_INTERNAL_SOURCE.`order_approved_at`,`order_delivered_carrier_date` = DBT_INTERNAL_SOURCE.`order_delivered_carrier_date`,`order_delivered_customer_date` = DBT_INTERNAL_SOURCE.`order_delivered_customer_date`,`order_estimated_delivery_date` = DBT_INTERNAL_SOURCE.`order_estimated_delivery_date`,`payment_value` = DBT_INTERNAL_SOURCE.`payment_value`
    

    when not matched then insert
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)
    values
        (`order_id`, `customer_id`, `order_status`, `order_purchase_timestamp`, `order_approved_at`, `order_delivered_carrier_date`, `order_delivered_customer_date`, `order_estimated_delivery_date`, `payment_value`)


    
[0m13:57:08.351091 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:9822a6c8-8add-4608-87b8-6a22a16ea185&page=queryresults
[0m13:57:13.971247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb63a98-aaaa-4c48-bebe-aefe842adc07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc5b43d810>]}
[0m13:57:13.972230 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model olist_data_ingestion_fact_tables.fact_orders  [[32mMERGE (97.1k rows, 39.3 MiB processed)[0m in 6.59s]
[0m13:57:13.973157 [debug] [Thread-1 (]: Finished running node model.olist_dataset.fact_orders
[0m13:57:13.976297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:57:13.978121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:13.978658 [debug] [MainThread]: Connection 'model.olist_dataset.fact_orders' was properly closed.
[0m13:57:13.979080 [info ] [MainThread]: 
[0m13:57:13.979464 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.69 seconds (8.69s).
[0m13:57:13.980326 [debug] [MainThread]: Command end result
[0m13:57:14.012493 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:57:14.014628 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:57:14.021135 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:57:14.021877 [info ] [MainThread]: 
[0m13:57:14.022423 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:57:14.022850 [info ] [MainThread]: 
[0m13:57:14.023315 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:57:14.023959 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.258334, "process_in_blocks": "0", "process_kernel_time": 1.17764, "process_mem_max_rss": "254284", "process_out_blocks": "2576", "process_user_time": 3.492313}
[0m13:57:14.024385 [debug] [MainThread]: Command `dbt run` succeeded at 13:57:14.024288 after 10.26 seconds
[0m13:57:14.024754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc8a9e1de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc898fb7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc5b5ff910>]}
[0m13:57:14.025134 [debug] [MainThread]: Flushing usage events
[0m13:57:14.969130 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:57:16.652521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a5d65e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a4c81660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a4c81600>]}


============================== 13:57:16.654894 | 7b7b1293-063d-44c5-ba05-41679d659d66 ==============================
[0m13:57:16.654894 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:57:16.655385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kangh/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/kangh/dsai-module-2-project/olist_dataset/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --models fact_orders', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:57:17.695205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b7b1293-063d-44c5-ba05-41679d659d66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe676e2abc0>]}
[0m13:57:17.762903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b7b1293-063d-44c5-ba05-41679d659d66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a4ec3f10>]}
[0m13:57:17.763644 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:57:17.867944 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:57:18.080984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:57:18.081437 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:57:18.137826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b7b1293-063d-44c5-ba05-41679d659d66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe676978d30>]}
[0m13:57:18.237391 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:57:18.239103 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:57:18.263640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b7b1293-063d-44c5-ba05-41679d659d66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe67697a920>]}
[0m13:57:18.264272 [info ] [MainThread]: Found 3 snapshots, 6 models, 33 data tests, 9 sources, 491 macros
[0m13:57:18.264709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b7b1293-063d-44c5-ba05-41679d659d66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a6a96ce0>]}
[0m13:57:18.266557 [info ] [MainThread]: 
[0m13:57:18.267030 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:57:18.267367 [info ] [MainThread]: 
[0m13:57:18.267892 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:57:18.273044 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_olist-ecommerce-454812_olist_data_ingestion_fact_tables'
[0m13:57:18.273462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:19.252001 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_fact_tables, now list_olist-ecommerce-454812_olist_data_snapshots)
[0m13:57:19.254062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:19.592212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_snapshots, now list_olist-ecommerce-454812_olist_data_ingestion_dim_tables)
[0m13:57:19.595335 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:19.985228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b7b1293-063d-44c5-ba05-41679d659d66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a4c95b10>]}
[0m13:57:19.986533 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:57:19.992981 [debug] [Thread-1 (]: Began running node test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab
[0m13:57:19.993892 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_fact_orders_order_status__delivered__canceled  [RUN]
[0m13:57:19.994886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist-ecommerce-454812_olist_data_ingestion_dim_tables, now test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab)
[0m13:57:19.995594 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab
[0m13:57:20.016922 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab"
[0m13:57:20.017647 [debug] [Thread-1 (]: Began executing node test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab
[0m13:57:20.033971 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab"
[0m13:57:20.034658 [debug] [Thread-1 (]: On test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','canceled'
)



      
    ) dbt_internal_test
[0m13:57:20.035094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:20.802914 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:72ef59ce-39d8-4ab4-9c0b-baad058497ef&page=queryresults
[0m13:57:21.801729 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_fact_orders_order_status__delivered__canceled ...... [[32mPASS[0m in 1.81s]
[0m13:57:21.803497 [debug] [Thread-1 (]: Finished running node test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab
[0m13:57:21.804481 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:57:21.805438 [info ] [Thread-1 (]: 2 of 8 START test not_null_fact_orders_customer_id ............................. [RUN]
[0m13:57:21.806661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.accepted_values_fact_orders_order_status__delivered__canceled.7315f000ab, now test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc)
[0m13:57:21.807760 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:57:21.817458 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc"
[0m13:57:21.818173 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:57:21.821781 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc"
[0m13:57:21.822529 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where customer_id is null



      
    ) dbt_internal_test
[0m13:57:21.822955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:22.422333 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:bc9b4341-b69d-49e2-af22-e55daf47c2d7&page=queryresults
[0m13:57:23.437678 [info ] [Thread-1 (]: 2 of 8 PASS not_null_fact_orders_customer_id ................................... [[32mPASS[0m in 1.63s]
[0m13:57:23.439268 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc
[0m13:57:23.440174 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:57:23.441733 [info ] [Thread-1 (]: 3 of 8 START test not_null_fact_orders_order_id ................................ [RUN]
[0m13:57:23.442894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_customer_id.9c2270d0dc, now test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0)
[0m13:57:23.443774 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:57:23.451819 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0"
[0m13:57:23.452670 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:57:23.455162 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0"
[0m13:57:23.455696 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where order_id is null



      
    ) dbt_internal_test
[0m13:57:23.456059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:24.029857 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:3b05ca83-79d8-4bee-8796-206b3986c4b7&page=queryresults
[0m13:57:25.162610 [info ] [Thread-1 (]: 3 of 8 PASS not_null_fact_orders_order_id ...................................... [[32mPASS[0m in 1.72s]
[0m13:57:25.164156 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0
[0m13:57:25.165104 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:57:25.165956 [info ] [Thread-1 (]: 4 of 8 START test not_null_fact_orders_order_purchase_timestamp ................ [RUN]
[0m13:57:25.167480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_order_id.6ba6d3f0a0, now test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434)
[0m13:57:25.168374 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:57:25.178644 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434"
[0m13:57:25.179491 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:57:25.182652 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434"
[0m13:57:25.183417 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_purchase_timestamp
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where order_purchase_timestamp is null



      
    ) dbt_internal_test
[0m13:57:25.183843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:25.714898 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:7201facb-d7a6-4e13-b4f5-dccf7dbcf063&page=queryresults
[0m13:57:26.724401 [info ] [Thread-1 (]: 4 of 8 PASS not_null_fact_orders_order_purchase_timestamp ...................... [[32mPASS[0m in 1.56s]
[0m13:57:26.726435 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434
[0m13:57:26.727840 [debug] [Thread-1 (]: Began running node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:57:26.729500 [info ] [Thread-1 (]: 5 of 8 START test not_null_fact_orders_order_status ............................ [RUN]
[0m13:57:26.731078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_order_purchase_timestamp.a8f5dc0434, now test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1)
[0m13:57:26.732210 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:57:26.738336 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1"
[0m13:57:26.739015 [debug] [Thread-1 (]: Began executing node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:57:26.741298 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1"
[0m13:57:26.741943 [debug] [Thread-1 (]: On test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_status
from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
where order_status is null



      
    ) dbt_internal_test
[0m13:57:26.742375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:27.308622 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:378fd963-bfb3-4ab3-bf20-af29d2504813&page=queryresults
[0m13:57:28.258186 [info ] [Thread-1 (]: 5 of 8 PASS not_null_fact_orders_order_status .................................. [[32mPASS[0m in 1.53s]
[0m13:57:28.259606 [debug] [Thread-1 (]: Finished running node test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1
[0m13:57:28.260438 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:57:28.261217 [info ] [Thread-1 (]: 6 of 8 START test relationships_fact_order_items_order_id__order_id__ref_fact_orders_  [RUN]
[0m13:57:28.262718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.not_null_fact_orders_order_status.6a291ae0c1, now test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74)
[0m13:57:28.263598 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:57:28.277776 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"
[0m13:57:28.278434 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:57:28.280527 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"
[0m13:57:28.281150 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:57:28.281556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:29.181287 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:b5c46b81-c269-4fe8-a7f1-769316034fa3&page=queryresults
[0m13:57:30.100094 [info ] [Thread-1 (]: 6 of 8 PASS relationships_fact_order_items_order_id__order_id__ref_fact_orders_  [[32mPASS[0m in 1.84s]
[0m13:57:30.102064 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74
[0m13:57:30.103062 [debug] [Thread-1 (]: Began running node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:57:30.103906 [info ] [Thread-1 (]: 7 of 8 START test relationships_fact_orders_customer_id__customer_id__ref_dim_customer_  [RUN]
[0m13:57:30.105091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_order_items_order_id__order_id__ref_fact_orders_.499cb32e74, now test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba)
[0m13:57:30.105968 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:57:30.119565 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba"
[0m13:57:30.120355 [debug] [Thread-1 (]: Began executing node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:57:30.122671 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba"
[0m13:57:30.123344 [debug] [Thread-1 (]: On test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `olist-ecommerce-454812`.`olist_data_ingestion_dim_tables`.`dim_customer`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:57:30.123785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:31.153481 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:0189bdbd-7d84-43b1-bd4b-d39e5de303b4&page=queryresults
[0m13:57:32.092406 [info ] [Thread-1 (]: 7 of 8 PASS relationships_fact_orders_customer_id__customer_id__ref_dim_customer_  [[32mPASS[0m in 1.99s]
[0m13:57:32.093748 [debug] [Thread-1 (]: Finished running node test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba
[0m13:57:32.094540 [debug] [Thread-1 (]: Began running node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:57:32.095645 [info ] [Thread-1 (]: 8 of 8 START test unique_fact_orders_order_id .................................. [RUN]
[0m13:57:32.096746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_dataset.relationships_fact_orders_customer_id__customer_id__ref_dim_customer_.d14414efba, now test.olist_dataset.unique_fact_orders_order_id.93a68b4064)
[0m13:57:32.097489 [debug] [Thread-1 (]: Began compiling node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:57:32.111762 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_dataset.unique_fact_orders_order_id.93a68b4064"
[0m13:57:32.113016 [debug] [Thread-1 (]: Began executing node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:57:32.117884 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_dataset.unique_fact_orders_order_id.93a68b4064"
[0m13:57:32.119318 [debug] [Thread-1 (]: On test.olist_dataset.unique_fact_orders_order_id.93a68b4064: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "olist_dataset", "target_name": "dev", "node_id": "test.olist_dataset.unique_fact_orders_order_id.93a68b4064"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `olist-ecommerce-454812`.`olist_data_ingestion_fact_tables`.`fact_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:57:32.120262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:32.887357 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-ecommerce-454812&j=bq:US:01452769-d5bd-4be6-a637-e83859d251ed&page=queryresults
[0m13:57:33.881672 [info ] [Thread-1 (]: 8 of 8 PASS unique_fact_orders_order_id ........................................ [[32mPASS[0m in 1.78s]
[0m13:57:33.883081 [debug] [Thread-1 (]: Finished running node test.olist_dataset.unique_fact_orders_order_id.93a68b4064
[0m13:57:33.886788 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:57:33.888343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:33.889095 [debug] [MainThread]: Connection 'test.olist_dataset.unique_fact_orders_order_id.93a68b4064' was properly closed.
[0m13:57:33.889978 [info ] [MainThread]: 
[0m13:57:33.890910 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 15.62 seconds (15.62s).
[0m13:57:33.894407 [debug] [MainThread]: Command end result
[0m13:57:33.950944 [debug] [MainThread]: Wrote artifact WritableManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/manifest.json
[0m13:57:33.954165 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/kangh/dsai-module-2-project/olist_dataset/target/semantic_manifest.json
[0m13:57:33.967711 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/kangh/dsai-module-2-project/olist_dataset/target/run_results.json
[0m13:57:33.968390 [info ] [MainThread]: 
[0m13:57:33.969066 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:57:33.969657 [info ] [MainThread]: 
[0m13:57:33.970430 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m13:57:33.974330 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 17.377245, "process_in_blocks": "0", "process_kernel_time": 1.162134, "process_mem_max_rss": "254124", "process_out_blocks": "2728", "process_user_time": 3.709636}
[0m13:57:33.975543 [debug] [MainThread]: Command `dbt test` succeeded at 13:57:33.975354 after 17.38 seconds
[0m13:57:33.976130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a5d65e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe676e2abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a5a059f0>]}
[0m13:57:33.976911 [debug] [MainThread]: Flushing usage events
[0m13:57:34.949879 [debug] [MainThread]: An error was encountered while trying to flush usage events
